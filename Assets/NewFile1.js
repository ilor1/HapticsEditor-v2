var P_=Object.defineProperty;var F_=(s,e,t)=>e in s?P_(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var ze=(s,e,t)=>(F_(s,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerpolicy&&(r.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?r.credentials="include":i.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();/**
 * @vue/shared v3.4.18
 * (c) 2018-present Yuxi (Evan) You and Vue contributors
 * @license MIT
 **/function kd(s,e){const t=new Set(s.split(","));return e?n=>t.has(n.toLowerCase()):n=>t.has(n)}const Et={},kr=[],As=()=>{},O_=()=>!1,Bl=s=>s.charCodeAt(0)===111&&s.charCodeAt(1)===110&&(s.charCodeAt(2)>122||s.charCodeAt(2)<97),Ld=s=>s.startsWith("onUpdate:"),zt=Object.assign,Rd=(s,e)=>{const t=s.indexOf(e);t>-1&&s.splice(t,1)},M_=Object.prototype.hasOwnProperty,at=(s,e)=>M_.call(s,e),Ie=Array.isArray,Lr=s=>eo(s)==="[object Map]",Jr=s=>eo(s)==="[object Set]",Jf=s=>eo(s)==="[object Date]",$_=s=>eo(s)==="[object RegExp]",Ye=s=>typeof s=="function",Rt=s=>typeof s=="string",yi=s=>typeof s=="symbol",_t=s=>s!==null&&typeof s=="object",Id=s=>(_t(s)||Ye(s))&&Ye(s.then)&&Ye(s.catch),F1=Object.prototype.toString,eo=s=>F1.call(s),N_=s=>eo(s).slice(8,-1),O1=s=>eo(s)==="[object Object]",Dd=s=>Rt(s)&&s!=="NaN"&&s[0]!=="-"&&""+parseInt(s,10)===s,_o=kd(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ul=s=>{const e=Object.create(null);return t=>e[t]||(e[t]=s(t))},V_=/-(\w)/g,wn=Ul(s=>s.replace(V_,(e,t)=>t?t.toUpperCase():"")),B_=/\B([A-Z])/g,to=Ul(s=>s.replace(B_,"-$1").toLowerCase()),Hl=Ul(s=>s.charAt(0).toUpperCase()+s.slice(1)),wc=Ul(s=>s?`on${Hl(s)}`:""),xi=(s,e)=>!Object.is(s,e),Rr=(s,e)=>{for(let t=0;t<s.length;t++)s[t](e)},rl=(s,e,t)=>{Object.defineProperty(s,e,{configurable:!0,enumerable:!1,value:t})},Io=s=>{const e=parseFloat(s);return isNaN(e)?s:e},M1=s=>{const e=Rt(s)?Number(s):NaN;return isNaN(e)?s:e};let eh;const Pd=()=>eh||(eh=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Vs(s){if(Ie(s)){const e={};for(let t=0;t<s.length;t++){const n=s[t],i=Rt(n)?z_(n):Vs(n);if(i)for(const r in i)e[r]=i[r]}return e}else if(Rt(s)||_t(s))return s}const U_=/;(?![^(]*\))/g,H_=/:([^]+)/,G_=/\/\*[^]*?\*\//g;function z_(s){const e={};return s.replace(G_,"").split(U_).forEach(t=>{if(t){const n=t.split(H_);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function Je(s){let e="";if(Rt(s))e=s;else if(Ie(s))for(let t=0;t<s.length;t++){const n=Je(s[t]);n&&(e+=n+" ")}else if(_t(s))for(const t in s)s[t]&&(e+=t+" ");return e.trim()}const j_="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",q_=kd(j_);function $1(s){return!!s||s===""}function K_(s,e){if(s.length!==e.length)return!1;let t=!0;for(let n=0;t&&n<s.length;n++)t=Ko(s[n],e[n]);return t}function Ko(s,e){if(s===e)return!0;let t=Jf(s),n=Jf(e);if(t||n)return t&&n?s.getTime()===e.getTime():!1;if(t=yi(s),n=yi(e),t||n)return s===e;if(t=Ie(s),n=Ie(e),t||n)return t&&n?K_(s,e):!1;if(t=_t(s),n=_t(e),t||n){if(!t||!n)return!1;const i=Object.keys(s).length,r=Object.keys(e).length;if(i!==r)return!1;for(const o in s){const a=s.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!Ko(s[o],e[o]))return!1}}return String(s)===String(e)}function Fd(s,e){return s.findIndex(t=>Ko(t,e))}const Z=s=>Rt(s)?s:s==null?"":Ie(s)||_t(s)&&(s.toString===F1||!Ye(s.toString))?JSON.stringify(s,N1,2):String(s),N1=(s,e)=>e&&e.__v_isRef?N1(s,e.value):Lr(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[n,i],r)=>(t[Sc(n,r)+" =>"]=i,t),{})}:Jr(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>Sc(t))}:yi(e)?Sc(e):_t(e)&&!Ie(e)&&!O1(e)?String(e):e,Sc=(s,e="")=>{var t;return yi(s)?`Symbol(${(t=s.description)!=null?t:e})`:s};/**
 * @vue/reactivity v3.4.18
 * (c) 2018-present Yuxi (Evan) You and Vue contributors
 * @license MIT
 **/let Ts;class V1{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Ts,!e&&Ts&&(this.index=(Ts.scopes||(Ts.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const t=Ts;try{return Ts=this,e()}finally{Ts=t}}}on(){Ts=this}off(){Ts=this.parent}stop(e){if(this._active){let t,n;for(t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0,this._active=!1}}}function B1(s){return new V1(s)}function W_(s,e=Ts){e&&e.active&&e.effects.push(s)}function Od(){return Ts}function U1(s){Ts&&Ts.cleanups.push(s)}let zi;class Md{constructor(e,t,n,i){this.fn=e,this.trigger=t,this.scheduler=n,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,W_(this,i)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,tr();for(let e=0;e<this._depsLength;e++){const t=this.deps[e];if(t.computed&&(Y_(t.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),sr()}return this._dirtyLevel>=4}set dirty(e){this._dirtyLevel=e?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let e=hi,t=zi;try{return hi=!0,zi=this,this._runnings++,th(this),this.fn()}finally{sh(this),this._runnings--,zi=t,hi=e}}stop(){var e;this.active&&(th(this),sh(this),(e=this.onStop)==null||e.call(this),this.active=!1)}}function Y_(s){return s.value}function th(s){s._trackId++,s._depsLength=0}function sh(s){if(s.deps.length>s._depsLength){for(let e=s._depsLength;e<s.deps.length;e++)H1(s.deps[e],s);s.deps.length=s._depsLength}}function H1(s,e){const t=s.get(e);t!==void 0&&e._trackId!==t&&(s.delete(e),s.size===0&&s.cleanup())}let hi=!0,gu=0;const G1=[];function tr(){G1.push(hi),hi=!1}function sr(){const s=G1.pop();hi=s===void 0?!0:s}function $d(){gu++}function Nd(){for(gu--;!gu&&mu.length;)mu.shift()()}function z1(s,e,t){if(e.get(s)!==s._trackId){e.set(s,s._trackId);const n=s.deps[s._depsLength];n!==e?(n&&H1(n,s),s.deps[s._depsLength++]=e):s._depsLength++}}const mu=[];function j1(s,e,t){$d();for(const n of s.keys()){let i;n._dirtyLevel<e&&(i!=null?i:i=s.get(n)===n._trackId)&&(n._shouldSchedule||(n._shouldSchedule=n._dirtyLevel===0),n._dirtyLevel=e),n._shouldSchedule&&(i!=null?i:i=s.get(n)===n._trackId)&&(n.trigger(),(!n._runnings||n.allowRecurse)&&n._dirtyLevel!==2&&(n._shouldSchedule=!1,n.scheduler&&mu.push(n.scheduler)))}Nd()}const q1=(s,e)=>{const t=new Map;return t.cleanup=s,t.computed=e,t},ol=new WeakMap,ji=Symbol(""),vu=Symbol("");function Ss(s,e,t){if(hi&&zi){let n=ol.get(s);n||ol.set(s,n=new Map);let i=n.get(t);i||n.set(t,i=q1(()=>n.delete(t))),z1(zi,i)}}function Vn(s,e,t,n,i,r){const o=ol.get(s);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(t==="length"&&Ie(s)){const l=Number(n);o.forEach((c,u)=>{(u==="length"||!yi(u)&&u>=l)&&a.push(c)})}else switch(t!==void 0&&a.push(o.get(t)),e){case"add":Ie(s)?Dd(t)&&a.push(o.get("length")):(a.push(o.get(ji)),Lr(s)&&a.push(o.get(vu)));break;case"delete":Ie(s)||(a.push(o.get(ji)),Lr(s)&&a.push(o.get(vu)));break;case"set":Lr(s)&&a.push(o.get(ji));break}$d();for(const l of a)l&&j1(l,4);Nd()}function Z_(s,e){var t;return(t=ol.get(s))==null?void 0:t.get(e)}const X_=kd("__proto__,__v_isRef,__isVue"),K1=new Set(Object.getOwnPropertyNames(Symbol).filter(s=>s!=="arguments"&&s!=="caller").map(s=>Symbol[s]).filter(yi)),nh=Q_();function Q_(){const s={};return["includes","indexOf","lastIndexOf"].forEach(e=>{s[e]=function(...t){const n=nt(this);for(let r=0,o=this.length;r<o;r++)Ss(n,"get",r+"");const i=n[e](...t);return i===-1||i===!1?n[e](...t.map(nt)):i}}),["push","pop","shift","unshift","splice"].forEach(e=>{s[e]=function(...t){tr(),$d();const n=nt(this)[e].apply(this,t);return Nd(),sr(),n}}),s}function J_(s){const e=nt(this);return Ss(e,"has",s),e.hasOwnProperty(s)}class W1{constructor(e=!1,t=!1){this._isReadonly=e,this._shallow=t}get(e,t,n){const i=this._isReadonly,r=this._shallow;if(t==="__v_isReactive")return!i;if(t==="__v_isReadonly")return i;if(t==="__v_isShallow")return r;if(t==="__v_raw")return n===(i?r?fy:Q1:r?X1:Z1).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const o=Ie(e);if(!i){if(o&&at(nh,t))return Reflect.get(nh,t,n);if(t==="hasOwnProperty")return J_}const a=Reflect.get(e,t,n);return(yi(t)?K1.has(t):X_(t))||(i||Ss(e,"get",t),r)?a:It(a)?o&&Dd(t)?a:a.value:_t(a)?i?eg(a):Ps(a):a}}class Y1 extends W1{constructor(e=!1){super(!1,e)}set(e,t,n,i){let r=e[t];if(!this._shallow){const l=Br(r);if(!al(n)&&!Br(n)&&(r=nt(r),n=nt(n)),!Ie(e)&&It(r)&&!It(n))return l?!1:(r.value=n,!0)}const o=Ie(e)&&Dd(t)?Number(t)<e.length:at(e,t),a=Reflect.set(e,t,n,i);return e===nt(i)&&(o?xi(n,r)&&Vn(e,"set",t,n):Vn(e,"add",t,n)),a}deleteProperty(e,t){const n=at(e,t);e[t];const i=Reflect.deleteProperty(e,t);return i&&n&&Vn(e,"delete",t,void 0),i}has(e,t){const n=Reflect.has(e,t);return(!yi(t)||!K1.has(t))&&Ss(e,"has",t),n}ownKeys(e){return Ss(e,"iterate",Ie(e)?"length":ji),Reflect.ownKeys(e)}}class ey extends W1{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const ty=new Y1,sy=new ey,ny=new Y1(!0),Vd=s=>s,Gl=s=>Reflect.getPrototypeOf(s);function oa(s,e,t=!1,n=!1){s=s.__v_raw;const i=nt(s),r=nt(e);t||(xi(e,r)&&Ss(i,"get",e),Ss(i,"get",r));const{has:o}=Gl(i),a=n?Vd:t?Hd:Do;if(o.call(i,e))return a(s.get(e));if(o.call(i,r))return a(s.get(r));s!==i&&s.get(e)}function aa(s,e=!1){const t=this.__v_raw,n=nt(t),i=nt(s);return e||(xi(s,i)&&Ss(n,"has",s),Ss(n,"has",i)),s===i?t.has(s):t.has(s)||t.has(i)}function la(s,e=!1){return s=s.__v_raw,!e&&Ss(nt(s),"iterate",ji),Reflect.get(s,"size",s)}function ih(s){s=nt(s);const e=nt(this);return Gl(e).has.call(e,s)||(e.add(s),Vn(e,"add",s,s)),this}function rh(s,e){e=nt(e);const t=nt(this),{has:n,get:i}=Gl(t);let r=n.call(t,s);r||(s=nt(s),r=n.call(t,s));const o=i.call(t,s);return t.set(s,e),r?xi(e,o)&&Vn(t,"set",s,e):Vn(t,"add",s,e),this}function oh(s){const e=nt(this),{has:t,get:n}=Gl(e);let i=t.call(e,s);i||(s=nt(s),i=t.call(e,s)),n&&n.call(e,s);const r=e.delete(s);return i&&Vn(e,"delete",s,void 0),r}function ah(){const s=nt(this),e=s.size!==0,t=s.clear();return e&&Vn(s,"clear",void 0,void 0),t}function ca(s,e){return function(n,i){const r=this,o=r.__v_raw,a=nt(o),l=e?Vd:s?Hd:Do;return!s&&Ss(a,"iterate",ji),o.forEach((c,u)=>n.call(i,l(c),l(u),r))}}function ua(s,e,t){return function(...n){const i=this.__v_raw,r=nt(i),o=Lr(r),a=s==="entries"||s===Symbol.iterator&&o,l=s==="keys"&&o,c=i[s](...n),u=t?Vd:e?Hd:Do;return!e&&Ss(r,"iterate",l?vu:ji),{next(){const{value:d,done:f}=c.next();return f?{value:d,done:f}:{value:a?[u(d[0]),u(d[1])]:u(d),done:f}},[Symbol.iterator](){return this}}}}function Yn(s){return function(...e){return s==="delete"?!1:s==="clear"?void 0:this}}function iy(){const s={get(r){return oa(this,r)},get size(){return la(this)},has:aa,add:ih,set:rh,delete:oh,clear:ah,forEach:ca(!1,!1)},e={get(r){return oa(this,r,!1,!0)},get size(){return la(this)},has:aa,add:ih,set:rh,delete:oh,clear:ah,forEach:ca(!1,!0)},t={get(r){return oa(this,r,!0)},get size(){return la(this,!0)},has(r){return aa.call(this,r,!0)},add:Yn("add"),set:Yn("set"),delete:Yn("delete"),clear:Yn("clear"),forEach:ca(!0,!1)},n={get(r){return oa(this,r,!0,!0)},get size(){return la(this,!0)},has(r){return aa.call(this,r,!0)},add:Yn("add"),set:Yn("set"),delete:Yn("delete"),clear:Yn("clear"),forEach:ca(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(r=>{s[r]=ua(r,!1,!1),t[r]=ua(r,!0,!1),e[r]=ua(r,!1,!0),n[r]=ua(r,!0,!0)}),[s,t,e,n]}const[ry,oy,ay,ly]=iy();function Bd(s,e){const t=e?s?ly:ay:s?oy:ry;return(n,i,r)=>i==="__v_isReactive"?!s:i==="__v_isReadonly"?s:i==="__v_raw"?n:Reflect.get(at(t,i)&&i in n?t:n,i,r)}const cy={get:Bd(!1,!1)},uy={get:Bd(!1,!0)},dy={get:Bd(!0,!1)},Z1=new WeakMap,X1=new WeakMap,Q1=new WeakMap,fy=new WeakMap;function hy(s){switch(s){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function py(s){return s.__v_skip||!Object.isExtensible(s)?0:hy(N_(s))}function Ps(s){return Br(s)?s:Ud(s,!1,ty,cy,Z1)}function J1(s){return Ud(s,!1,ny,uy,X1)}function eg(s){return Ud(s,!0,sy,dy,Q1)}function Ud(s,e,t,n,i){if(!_t(s)||s.__v_raw&&!(e&&s.__v_isReactive))return s;const r=i.get(s);if(r)return r;const o=py(s);if(o===0)return s;const a=new Proxy(s,o===2?n:t);return i.set(s,a),a}function Bn(s){return Br(s)?Bn(s.__v_raw):!!(s&&s.__v_isReactive)}function Br(s){return!!(s&&s.__v_isReadonly)}function al(s){return!!(s&&s.__v_isShallow)}function tg(s){return Bn(s)||Br(s)}function nt(s){const e=s&&s.__v_raw;return e?nt(e):s}function zl(s){return Object.isExtensible(s)&&rl(s,"__v_skip",!0),s}const Do=s=>_t(s)?Ps(s):s,Hd=s=>_t(s)?eg(s):s;class sg{constructor(e,t,n,i){this._setter=t,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new Md(()=>e(this._value),()=>Oa(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!i,this.__v_isReadonly=n}get value(){const e=nt(this);return(!e._cacheable||e.effect.dirty)&&xi(e._value,e._value=e.effect.run())&&Oa(e,4),ng(e),e.effect._dirtyLevel>=2&&Oa(e,2),e._value}set value(e){this._setter(e)}get _dirty(){return this.effect.dirty}set _dirty(e){this.effect.dirty=e}}function gy(s,e,t=!1){let n,i;const r=Ye(s);return r?(n=s,i=As):(n=s.get,i=s.set),new sg(n,i,r||!i,t)}function ng(s){var e;hi&&zi&&(s=nt(s),z1(zi,(e=s.dep)!=null?e:s.dep=q1(()=>s.dep=void 0,s instanceof sg?s:void 0)))}function Oa(s,e=4,t){s=nt(s);const n=s.dep;n&&j1(n,e)}function It(s){return!!(s&&s.__v_isRef===!0)}function ue(s){return ig(s,!1)}function my(s){return ig(s,!0)}function ig(s,e){return It(s)?s:new vy(s,e)}class vy{constructor(e,t){this.__v_isShallow=t,this.dep=void 0,this.__v_isRef=!0,this._rawValue=t?e:nt(e),this._value=t?e:Do(e)}get value(){return ng(this),this._value}set value(e){const t=this.__v_isShallow||al(e)||Br(e);e=t?e:nt(e),xi(e,this._rawValue)&&(this._rawValue=e,this._value=t?e:Do(e),Oa(this,4))}}function w(s){return It(s)?s.value:s}const _y={get:(s,e,t)=>w(Reflect.get(s,e,t)),set:(s,e,t,n)=>{const i=s[e];return It(i)&&!It(t)?(i.value=t,!0):Reflect.set(s,e,t,n)}};function rg(s){return Bn(s)?s:new Proxy(s,_y)}function yy(s){const e=Ie(s)?new Array(s.length):{};for(const t in s)e[t]=og(s,t);return e}class xy{constructor(e,t,n){this._object=e,this._key=t,this._defaultValue=n,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return Z_(nt(this._object),this._key)}}class by{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function wy(s,e,t){return It(s)?s:Ye(s)?new by(s):_t(s)&&arguments.length>1?og(s,e,t):ue(s)}function og(s,e,t){const n=s[e];return It(n)?n:new xy(s,e,t)}/**
 * @vue/runtime-core v3.4.18
 * (c) 2018-present Yuxi (Evan) You and Vue contributors
 * @license MIT
 **/function pi(s,e,t,n){let i;try{i=n?s(...n):s()}catch(r){Wo(r,e,t)}return i}function Us(s,e,t,n){if(Ye(s)){const r=pi(s,e,t,n);return r&&Id(r)&&r.catch(o=>{Wo(o,e,t)}),r}const i=[];for(let r=0;r<s.length;r++)i.push(Us(s[r],e,t,n));return i}function Wo(s,e,t,n=!0){const i=e?e.vnode:null;if(e){let r=e.parent;const o=e.proxy,a=`https://vuejs.org/error-reference/#runtime-${t}`;for(;r;){const c=r.ec;if(c){for(let u=0;u<c.length;u++)if(c[u](s,o,a)===!1)return}r=r.parent}const l=e.appContext.config.errorHandler;if(l){pi(l,null,10,[s,o,a]);return}}Sy(s,t,i,n)}function Sy(s,e,t,n=!0){console.error(s)}let Po=!1,_u=!1;const ds=[];let mn=0;const Ir=[];let ni=null,Ni=0;const ag=Promise.resolve();let Gd=null;function so(s){const e=Gd||ag;return s?e.then(this?s.bind(this):s):e}function Ey(s){let e=mn+1,t=ds.length;for(;e<t;){const n=e+t>>>1,i=ds[n],r=Fo(i);r<s||r===s&&i.pre?e=n+1:t=n}return e}function zd(s){(!ds.length||!ds.includes(s,Po&&s.allowRecurse?mn+1:mn))&&(s.id==null?ds.push(s):ds.splice(Ey(s.id),0,s),lg())}function lg(){!Po&&!_u&&(_u=!0,Gd=ag.then(ug))}function Ty(s){const e=ds.indexOf(s);e>mn&&ds.splice(e,1)}function yu(s){Ie(s)?Ir.push(...s):(!ni||!ni.includes(s,s.allowRecurse?Ni+1:Ni))&&Ir.push(s),lg()}function lh(s,e,t=Po?mn+1:0){for(;t<ds.length;t++){const n=ds[t];if(n&&n.pre){if(s&&n.id!==s.uid)continue;ds.splice(t,1),t--,n()}}}function cg(s){if(Ir.length){const e=[...new Set(Ir)].sort((t,n)=>Fo(t)-Fo(n));if(Ir.length=0,ni){ni.push(...e);return}for(ni=e,Ni=0;Ni<ni.length;Ni++)ni[Ni]();ni=null,Ni=0}}const Fo=s=>s.id==null?1/0:s.id,Cy=(s,e)=>{const t=Fo(s)-Fo(e);if(t===0){if(s.pre&&!e.pre)return-1;if(e.pre&&!s.pre)return 1}return t};function ug(s){_u=!1,Po=!0,ds.sort(Cy);const e=As;try{for(mn=0;mn<ds.length;mn++){const t=ds[mn];t&&t.active!==!1&&pi(t,null,14)}}finally{mn=0,ds.length=0,cg(),Po=!1,Gd=null,(ds.length||Ir.length)&&ug()}}function Ay(s,e,...t){if(s.isUnmounted)return;const n=s.vnode.props||Et;let i=t;const r=e.startsWith("update:"),o=r&&e.slice(7);if(o&&o in n){const u=`${o==="modelValue"?"model":o}Modifiers`,{number:d,trim:f}=n[u]||Et;f&&(i=t.map(h=>Rt(h)?h.trim():h)),d&&(i=t.map(Io))}let a,l=n[a=wc(e)]||n[a=wc(wn(e))];!l&&r&&(l=n[a=wc(to(e))]),l&&Us(l,s,6,i);const c=n[a+"Once"];if(c){if(!s.emitted)s.emitted={};else if(s.emitted[a])return;s.emitted[a]=!0,Us(c,s,6,i)}}function dg(s,e,t=!1){const n=e.emitsCache,i=n.get(s);if(i!==void 0)return i;const r=s.emits;let o={},a=!1;if(!Ye(s)){const l=c=>{const u=dg(c,e,!0);u&&(a=!0,zt(o,u))};!t&&e.mixins.length&&e.mixins.forEach(l),s.extends&&l(s.extends),s.mixins&&s.mixins.forEach(l)}return!r&&!a?(_t(s)&&n.set(s,null),null):(Ie(r)?r.forEach(l=>o[l]=null):zt(o,r),_t(s)&&n.set(s,o),o)}function jl(s,e){return!s||!Bl(e)?!1:(e=e.slice(2).replace(/Once$/,""),at(s,e[0].toLowerCase()+e.slice(1))||at(s,to(e))||at(s,e))}let Nt=null,fg=null;function ll(s){const e=Nt;return Nt=s,fg=s&&s.type.__scopeId||null,e}function z(s,e=Nt,t){if(!e||s._n)return s;const n=(...i)=>{n._d&&Sh(-1);const r=ll(e);let o;try{o=s(...i)}finally{ll(r),n._d&&Sh(1)}return o};return n._n=!0,n._c=!0,n._d=!0,n}function Ec(s){const{type:e,vnode:t,proxy:n,withProxy:i,props:r,propsOptions:[o],slots:a,attrs:l,emit:c,render:u,renderCache:d,data:f,setupState:h,ctx:p,inheritAttrs:g}=s;let m,_;const y=ll(s);try{if(t.shapeFlag&4){const C=i||n,E=C;m=en(u.call(E,C,d,r,h,f,p)),_=l}else{const C=e;m=en(C.length>1?C(r,{attrs:l,slots:a,emit:c}):C(r,null)),_=e.props?l:Ly(l)}}catch(C){bo.length=0,Wo(C,s,1),m=P(ws)}let S=m;if(_&&g!==!1){const C=Object.keys(_),{shapeFlag:E}=S;C.length&&E&7&&(o&&C.some(Ld)&&(_=Ry(_,o)),S=Hn(S,_))}return t.dirs&&(S=Hn(S),S.dirs=S.dirs?S.dirs.concat(t.dirs):t.dirs),t.transition&&(S.transition=t.transition),m=S,ll(y),m}function ky(s,e=!0){let t;for(let n=0;n<s.length;n++){const i=s[n];if(Hr(i)){if(i.type!==ws||i.children==="v-if"){if(t)return;t=i}}else return}return t}const Ly=s=>{let e;for(const t in s)(t==="class"||t==="style"||Bl(t))&&((e||(e={}))[t]=s[t]);return e},Ry=(s,e)=>{const t={};for(const n in s)(!Ld(n)||!(n.slice(9)in e))&&(t[n]=s[n]);return t};function Iy(s,e,t){const{props:n,children:i,component:r}=s,{props:o,children:a,patchFlag:l}=e,c=r.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return n?ch(n,o,c):!!o;if(l&8){const u=e.dynamicProps;for(let d=0;d<u.length;d++){const f=u[d];if(o[f]!==n[f]&&!jl(c,f))return!0}}}else return(i||a)&&(!a||!a.$stable)?!0:n===o?!1:n?o?ch(n,o,c):!0:!!o;return!1}function ch(s,e,t){const n=Object.keys(e);if(n.length!==Object.keys(s).length)return!0;for(let i=0;i<n.length;i++){const r=n[i];if(e[r]!==s[r]&&!jl(t,r))return!0}return!1}function jd({vnode:s,parent:e},t){for(;e;){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===s&&(n.el=s.el),n===s)(s=e.vnode).el=t,e=e.parent;else break}}const qd="components",Dy="directives";function Es(s,e){return Kd(qd,s,!0,e)||s}const hg=Symbol.for("v-ndc");function vn(s){return Rt(s)?Kd(qd,s,!1)||s:s||hg}function ql(s){return Kd(Dy,s)}function Kd(s,e,t=!0,n=!1){const i=Nt||Yt;if(i){const r=i.type;if(s===qd){const a=Iu(r,!1);if(a&&(a===e||a===wn(e)||a===Hl(wn(e))))return r}const o=uh(i[s]||r[s],e)||uh(i.appContext[s],e);return!o&&n?r:o}}function uh(s,e){return s&&(s[e]||s[wn(e)]||s[Hl(wn(e))])}const pg=s=>s.__isSuspense;let xu=0;const Py={name:"Suspense",__isSuspense:!0,process(s,e,t,n,i,r,o,a,l,c){if(s==null)Oy(e,t,n,i,r,o,a,l,c);else{if(r&&r.deps>0){e.suspense=s.suspense;return}My(s,e,t,n,i,o,a,l,c)}},hydrate:$y,create:Wd,normalize:Ny},Fy=Py;function Oo(s,e){const t=s.props&&s.props[e];Ye(t)&&t()}function Oy(s,e,t,n,i,r,o,a,l){const{p:c,o:{createElement:u}}=l,d=u("div"),f=s.suspense=Wd(s,i,n,e,d,t,r,o,a,l);c(null,f.pendingBranch=s.ssContent,d,null,n,f,r,o),f.deps>0?(Oo(s,"onPending"),Oo(s,"onFallback"),c(null,s.ssFallback,e,t,n,null,r,o),Dr(f,s.ssFallback)):f.resolve(!1,!0)}function My(s,e,t,n,i,r,o,a,{p:l,um:c,o:{createElement:u}}){const d=e.suspense=s.suspense;d.vnode=e,e.el=s.el;const f=e.ssContent,h=e.ssFallback,{activeBranch:p,pendingBranch:g,isInFallback:m,isHydrating:_}=d;if(g)d.pendingBranch=f,nn(f,g)?(l(g,f,d.hiddenContainer,null,i,d,r,o,a),d.deps<=0?d.resolve():m&&(_||(l(p,h,t,n,i,null,r,o,a),Dr(d,h)))):(d.pendingId=xu++,_?(d.isHydrating=!1,d.activeBranch=g):c(g,i,d),d.deps=0,d.effects.length=0,d.hiddenContainer=u("div"),m?(l(null,f,d.hiddenContainer,null,i,d,r,o,a),d.deps<=0?d.resolve():(l(p,h,t,n,i,null,r,o,a),Dr(d,h))):p&&nn(f,p)?(l(p,f,t,n,i,d,r,o,a),d.resolve(!0)):(l(null,f,d.hiddenContainer,null,i,d,r,o,a),d.deps<=0&&d.resolve()));else if(p&&nn(f,p))l(p,f,t,n,i,d,r,o,a),Dr(d,f);else if(Oo(e,"onPending"),d.pendingBranch=f,f.shapeFlag&512?d.pendingId=f.component.suspenseId:d.pendingId=xu++,l(null,f,d.hiddenContainer,null,i,d,r,o,a),d.deps<=0)d.resolve();else{const{timeout:y,pendingId:S}=d;y>0?setTimeout(()=>{d.pendingId===S&&d.fallback(h)},y):y===0&&d.fallback(h)}}function Wd(s,e,t,n,i,r,o,a,l,c,u=!1){const{p:d,m:f,um:h,n:p,o:{parentNode:g,remove:m}}=c;let _;const y=By(s);y&&e!=null&&e.pendingBranch&&(_=e.pendingId,e.deps++);const S=s.props?M1(s.props.timeout):void 0,C=r,E={vnode:s,parent:e,parentComponent:t,namespace:o,container:n,hiddenContainer:i,deps:0,pendingId:xu++,timeout:typeof S=="number"?S:-1,activeBranch:null,pendingBranch:null,isInFallback:!u,isHydrating:u,isUnmounted:!1,effects:[],resolve(A=!1,R=!1){const{vnode:I,activeBranch:D,pendingBranch:L,pendingId:M,effects:$,parentComponent:H,container:ie}=E;let te=!1;E.isHydrating?E.isHydrating=!1:A||(te=D&&L.transition&&L.transition.mode==="out-in",te&&(D.transition.afterLeave=()=>{M===E.pendingId&&(f(L,ie,r===C?p(D):r,0),yu($))}),D&&(g(D.el)!==E.hiddenContainer&&(r=p(D)),h(D,H,E,!0)),te||f(L,ie,r,0)),Dr(E,L),E.pendingBranch=null,E.isInFallback=!1;let X=E.parent,de=!1;for(;X;){if(X.pendingBranch){X.effects.push(...$),de=!0;break}X=X.parent}!de&&!te&&yu($),E.effects=[],y&&e&&e.pendingBranch&&_===e.pendingId&&(e.deps--,e.deps===0&&!R&&e.resolve()),Oo(I,"onResolve")},fallback(A){if(!E.pendingBranch)return;const{vnode:R,activeBranch:I,parentComponent:D,container:L,namespace:M}=E;Oo(R,"onFallback");const $=p(I),H=()=>{!E.isInFallback||(d(null,A,L,$,D,null,M,a,l),Dr(E,A))},ie=A.transition&&A.transition.mode==="out-in";ie&&(I.transition.afterLeave=H),E.isInFallback=!0,h(I,D,null,!0),ie||H()},move(A,R,I){E.activeBranch&&f(E.activeBranch,A,R,I),E.container=A},next(){return E.activeBranch&&p(E.activeBranch)},registerDep(A,R){const I=!!E.pendingBranch;I&&E.deps++;const D=A.vnode.el;A.asyncDep.catch(L=>{Wo(L,A,0)}).then(L=>{if(A.isUnmounted||E.isUnmounted||E.pendingId!==A.suspenseId)return;A.asyncResolved=!0;const{vnode:M}=A;Ru(A,L,!1),D&&(M.el=D);const $=!D&&A.subTree.el;R(A,M,g(D||A.subTree.el),D?null:p(A.subTree),E,o,l),$&&m($),jd(A,M.el),I&&--E.deps===0&&E.resolve()})},unmount(A,R){E.isUnmounted=!0,E.activeBranch&&h(E.activeBranch,t,A,R),E.pendingBranch&&h(E.pendingBranch,t,A,R)}};return E}function $y(s,e,t,n,i,r,o,a,l){const c=e.suspense=Wd(e,n,t,s.parentNode,document.createElement("div"),null,i,r,o,a,!0),u=l(s,c.pendingBranch=e.ssContent,t,c,r,o);return c.deps===0&&c.resolve(!1,!0),u}function Ny(s){const{shapeFlag:e,children:t}=s,n=e&32;s.ssContent=dh(n?t.default:t),s.ssFallback=n?dh(t.fallback):P(ws)}function dh(s){let e;if(Ye(s)){const t=Ur&&s._c;t&&(s._d=!1,x()),s=s(),t&&(s._d=!0,e=Bs,Dg())}return Ie(s)&&(s=ky(s)),s=en(s),e&&!s.dynamicChildren&&(s.dynamicChildren=e.filter(t=>t!==s)),s}function Vy(s,e){e&&e.pendingBranch?Ie(s)?e.effects.push(...s):e.effects.push(s):yu(s)}function Dr(s,e){s.activeBranch=e;const{vnode:t,parentComponent:n}=s;let i=e.el;for(;!i&&e.component;)e=e.component.subTree,i=e.el;t.el=i,n&&n.subTree===t&&(n.vnode.el=i,jd(n,i))}function By(s){var e;return((e=s.props)==null?void 0:e.suspensible)!=null&&s.props.suspensible!==!1}const Uy=Symbol.for("v-scx"),Hy=()=>Hs(Uy),da={};function dt(s,e,t){return gg(s,e,t)}function gg(s,e,{immediate:t,deep:n,flush:i,once:r,onTrack:o,onTrigger:a}=Et){if(e&&r){const A=e;e=(...R)=>{A(...R),E()}}const l=Yt,c=A=>n===!0?A:Bi(A,n===!1?1:void 0);let u,d=!1,f=!1;if(It(s)?(u=()=>s.value,d=al(s)):Bn(s)?(u=()=>c(s),d=!0):Ie(s)?(f=!0,d=s.some(A=>Bn(A)||al(A)),u=()=>s.map(A=>{if(It(A))return A.value;if(Bn(A))return c(A);if(Ye(A))return pi(A,l,2)})):Ye(s)?e?u=()=>pi(s,l,2):u=()=>(h&&h(),Us(s,l,3,[p])):u=As,e&&n){const A=u;u=()=>Bi(A())}let h,p=A=>{h=S.onStop=()=>{pi(A,l,4),h=S.onStop=void 0}},g;if(Jl)if(p=As,e?t&&Us(e,l,3,[u(),f?[]:void 0,p]):u(),i==="sync"){const A=Hy();g=A.__watcherHandles||(A.__watcherHandles=[])}else return As;let m=f?new Array(s.length).fill(da):da;const _=()=>{if(!(!S.active||!S.dirty))if(e){const A=S.run();(n||d||(f?A.some((R,I)=>xi(R,m[I])):xi(A,m)))&&(h&&h(),Us(e,l,3,[A,m===da?void 0:f&&m[0]===da?[]:m,p]),m=A)}else S.run()};_.allowRecurse=!!e;let y;i==="sync"?y=_:i==="post"?y=()=>es(_,l&&l.suspense):(_.pre=!0,l&&(_.id=l.uid),y=()=>zd(_));const S=new Md(u,As,y),C=Od(),E=()=>{S.stop(),C&&Rd(C.effects,S)};return e?t?_():m=S.run():i==="post"?es(S.run.bind(S),l&&l.suspense):S.run(),g&&g.push(E),E}function Gy(s,e,t){const n=this.proxy,i=Rt(s)?s.includes(".")?mg(n,s):()=>n[s]:s.bind(n,n);let r;Ye(e)?r=e:(r=e.handler,t=e);const o=Zi(this),a=gg(i,r.bind(n),t);return o(),a}function mg(s,e){const t=e.split(".");return()=>{let n=s;for(let i=0;i<t.length&&n;i++)n=n[t[i]];return n}}function Bi(s,e,t=0,n){if(!_t(s)||s.__v_skip)return s;if(e&&e>0){if(t>=e)return s;t++}if(n=n||new Set,n.has(s))return s;if(n.add(s),It(s))Bi(s.value,e,t,n);else if(Ie(s))for(let i=0;i<s.length;i++)Bi(s[i],e,t,n);else if(Jr(s)||Lr(s))s.forEach(i=>{Bi(i,e,t,n)});else if(O1(s))for(const i in s)Bi(s[i],e,t,n);return s}function ht(s,e){if(Nt===null)return s;const t=ec(Nt)||Nt.proxy,n=s.dirs||(s.dirs=[]);for(let i=0;i<e.length;i++){let[r,o,a,l=Et]=e[i];r&&(Ye(r)&&(r={mounted:r,updated:r}),r.deep&&Bi(o),n.push({dir:r,instance:t,value:o,oldValue:void 0,arg:a,modifiers:l}))}return s}function Li(s,e,t,n){const i=s.dirs,r=e&&e.dirs;for(let o=0;o<i.length;o++){const a=i[o];r&&(a.oldValue=r[o].value);let l=a.dir[n];l&&(tr(),Us(l,t,8,[s.el,a,s,e]),sr())}}const ii=Symbol("_leaveCb"),fa=Symbol("_enterCb");function zy(){const s={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Xt(()=>{s.isMounted=!0}),Yl(()=>{s.isUnmounting=!0}),s}const Os=[Function,Array],vg={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Os,onEnter:Os,onAfterEnter:Os,onEnterCancelled:Os,onBeforeLeave:Os,onLeave:Os,onAfterLeave:Os,onLeaveCancelled:Os,onBeforeAppear:Os,onAppear:Os,onAfterAppear:Os,onAppearCancelled:Os},jy={name:"BaseTransition",props:vg,setup(s,{slots:e}){const t=Ql(),n=zy();let i;return()=>{const r=e.default&&yg(e.default(),!0);if(!r||!r.length)return;let o=r[0];if(r.length>1){for(const g of r)if(g.type!==ws){o=g;break}}const a=nt(s),{mode:l}=a;if(n.isLeaving)return Tc(o);const c=fh(o);if(!c)return Tc(o);const u=bu(c,a,n,t);cl(c,u);const d=t.subTree,f=d&&fh(d);let h=!1;const{getTransitionKey:p}=c.type;if(p){const g=p();i===void 0?i=g:g!==i&&(i=g,h=!0)}if(f&&f.type!==ws&&(!nn(c,f)||h)){const g=bu(f,a,n,t);if(cl(f,g),l==="out-in")return n.isLeaving=!0,g.afterLeave=()=>{n.isLeaving=!1,t.update.active!==!1&&(t.effect.dirty=!0,t.update())},Tc(o);l==="in-out"&&c.type!==ws&&(g.delayLeave=(m,_,y)=>{const S=_g(n,f);S[String(f.key)]=f,m[ii]=()=>{_(),m[ii]=void 0,delete u.delayedLeave},u.delayedLeave=y})}return o}}},qy=jy;function _g(s,e){const{leavingVNodes:t}=s;let n=t.get(e.type);return n||(n=Object.create(null),t.set(e.type,n)),n}function bu(s,e,t,n){const{appear:i,mode:r,persisted:o=!1,onBeforeEnter:a,onEnter:l,onAfterEnter:c,onEnterCancelled:u,onBeforeLeave:d,onLeave:f,onAfterLeave:h,onLeaveCancelled:p,onBeforeAppear:g,onAppear:m,onAfterAppear:_,onAppearCancelled:y}=e,S=String(s.key),C=_g(t,s),E=(I,D)=>{I&&Us(I,n,9,D)},A=(I,D)=>{const L=D[1];E(I,D),Ie(I)?I.every(M=>M.length<=1)&&L():I.length<=1&&L()},R={mode:r,persisted:o,beforeEnter(I){let D=a;if(!t.isMounted)if(i)D=g||a;else return;I[ii]&&I[ii](!0);const L=C[S];L&&nn(s,L)&&L.el[ii]&&L.el[ii](),E(D,[I])},enter(I){let D=l,L=c,M=u;if(!t.isMounted)if(i)D=m||l,L=_||c,M=y||u;else return;let $=!1;const H=I[fa]=ie=>{$||($=!0,ie?E(M,[I]):E(L,[I]),R.delayedLeave&&R.delayedLeave(),I[fa]=void 0)};D?A(D,[I,H]):H()},leave(I,D){const L=String(s.key);if(I[fa]&&I[fa](!0),t.isUnmounting)return D();E(d,[I]);let M=!1;const $=I[ii]=H=>{M||(M=!0,D(),H?E(p,[I]):E(h,[I]),I[ii]=void 0,C[L]===s&&delete C[L])};C[L]=s,f?A(f,[I,$]):$()},clone(I){return bu(I,e,t,n)}};return R}function Tc(s){if(Kl(s))return s=Hn(s),s.children=null,s}function fh(s){return Kl(s)?s.children?s.children[0]:void 0:s}function cl(s,e){s.shapeFlag&6&&s.component?cl(s.component.subTree,e):s.shapeFlag&128?(s.ssContent.transition=e.clone(s.ssContent),s.ssFallback.transition=e.clone(s.ssFallback)):s.transition=e}function yg(s,e=!1,t){let n=[],i=0;for(let r=0;r<s.length;r++){let o=s[r];const a=t==null?o.key:String(t)+String(o.key!=null?o.key:r);o.type===_e?(o.patchFlag&128&&i++,n=n.concat(yg(o.children,e,a))):(e||o.type!==ws)&&n.push(a!=null?Hn(o,{key:a}):o)}if(i>1)for(let r=0;r<n.length;r++)n[r].patchFlag=-2;return n}/*! #__NO_SIDE_EFFECTS__ */function De(s,e){return Ye(s)?(()=>zt({name:s.name},e,{setup:s}))():s}const Pr=s=>!!s.type.__asyncLoader,Kl=s=>s.type.__isKeepAlive,Ky={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(s,{slots:e}){const t=Ql(),n=t.ctx;if(!n.renderer)return()=>{const y=e.default&&e.default();return y&&y.length===1?y[0]:y};const i=new Map,r=new Set;let o=null;const a=t.suspense,{renderer:{p:l,m:c,um:u,o:{createElement:d}}}=n,f=d("div");n.activate=(y,S,C,E,A)=>{const R=y.component;c(y,S,C,0,a),l(R.vnode,y,S,C,R,a,E,y.slotScopeIds,A),es(()=>{R.isDeactivated=!1,R.a&&Rr(R.a);const I=y.props&&y.props.onVnodeMounted;I&&$s(I,R.parent,y)},a)},n.deactivate=y=>{const S=y.component;c(y,f,null,1,a),es(()=>{S.da&&Rr(S.da);const C=y.props&&y.props.onVnodeUnmounted;C&&$s(C,S.parent,y),S.isDeactivated=!0},a)};function h(y){Cc(y),u(y,t,a,!0)}function p(y){i.forEach((S,C)=>{const E=Iu(S.type);E&&(!y||!y(E))&&g(C)})}function g(y){const S=i.get(y);!o||!nn(S,o)?h(S):o&&Cc(o),i.delete(y),r.delete(y)}dt(()=>[s.include,s.exclude],([y,S])=>{y&&p(C=>fo(y,C)),S&&p(C=>!fo(S,C))},{flush:"post",deep:!0});let m=null;const _=()=>{m!=null&&i.set(m,Ac(t.subTree))};return Xt(_),bg(_),Yl(()=>{i.forEach(y=>{const{subTree:S,suspense:C}=t,E=Ac(S);if(y.type===E.type&&y.key===E.key){Cc(E);const A=E.component.da;A&&es(A,C);return}h(y)})}),()=>{if(m=null,!e.default)return null;const y=e.default(),S=y[0];if(y.length>1)return o=null,y;if(!Hr(S)||!(S.shapeFlag&4)&&!(S.shapeFlag&128))return o=null,S;let C=Ac(S);const E=C.type,A=Iu(Pr(C)?C.type.__asyncResolved||{}:E),{include:R,exclude:I,max:D}=s;if(R&&(!A||!fo(R,A))||I&&A&&fo(I,A))return o=C,S;const L=C.key==null?E:C.key,M=i.get(L);return C.el&&(C=Hn(C),S.shapeFlag&128&&(S.ssContent=C)),m=L,M?(C.el=M.el,C.component=M.component,C.transition&&cl(C,C.transition),C.shapeFlag|=512,r.delete(L),r.add(L)):(r.add(L),D&&r.size>parseInt(D,10)&&g(r.values().next().value)),C.shapeFlag|=256,o=C,pg(S.type)?S:C}}},Wy=Ky;function fo(s,e){return Ie(s)?s.some(t=>fo(t,e)):Rt(s)?s.split(",").includes(e):$_(s)?s.test(e):!1}function Ws(s,e){xg(s,"a",e)}function Yy(s,e){xg(s,"da",e)}function xg(s,e,t=Yt){const n=s.__wdc||(s.__wdc=()=>{let i=t;for(;i;){if(i.isDeactivated)return;i=i.parent}return s()});if(Wl(e,n,t),t){let i=t.parent;for(;i&&i.parent;)Kl(i.parent.vnode)&&Zy(n,e,t,i),i=i.parent}}function Zy(s,e,t,n){const i=Wl(e,s,n,!0);Ci(()=>{Rd(n[e],i)},t)}function Cc(s){s.shapeFlag&=-257,s.shapeFlag&=-513}function Ac(s){return s.shapeFlag&128?s.ssContent:s}function Wl(s,e,t=Yt,n=!1){if(t){const i=t[s]||(t[s]=[]),r=e.__weh||(e.__weh=(...o)=>{if(t.isUnmounted)return;tr();const a=Zi(t),l=Us(e,t,s,o);return a(),sr(),l});return n?i.unshift(r):i.push(r),r}}const zn=s=>(e,t=Yt)=>(!Jl||s==="sp")&&Wl(s,(...n)=>e(...n),t),Yd=zn("bm"),Xt=zn("m"),Xy=zn("bu"),bg=zn("u"),Yl=zn("bum"),Ci=zn("um"),Qy=zn("sp"),Jy=zn("rtg"),e2=zn("rtc");function t2(s,e=Yt){Wl("ec",s,e)}function st(s,e,t,n){let i;const r=t&&t[n];if(Ie(s)||Rt(s)){i=new Array(s.length);for(let o=0,a=s.length;o<a;o++)i[o]=e(s[o],o,void 0,r&&r[o])}else if(typeof s=="number"){i=new Array(s);for(let o=0;o<s;o++)i[o]=e(o+1,o,void 0,r&&r[o])}else if(_t(s))if(s[Symbol.iterator])i=Array.from(s,(o,a)=>e(o,a,void 0,r&&r[a]));else{const o=Object.keys(s);i=new Array(o.length);for(let a=0,l=o.length;a<l;a++){const c=o[a];i[a]=e(s[c],c,a,r&&r[a])}}else i=[];return t&&(t[n]=i),i}function nr(s,e,t={},n,i){if(Nt.isCE||Nt.parent&&Pr(Nt.parent)&&Nt.parent.isCE)return e!=="default"&&(t.name=e),P("slot",t,n&&n());let r=s[e];r&&r._c&&(r._d=!1),x();const o=r&&wg(r(t)),a=ae(_e,{key:t.key||o&&o.key||`_${e}`},o||(n?n():[]),o&&s._===1?64:-2);return!i&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),r&&r._c&&(r._d=!0),a}function wg(s){return s.some(e=>Hr(e)?!(e.type===ws||e.type===_e&&!wg(e.children)):!0)?s:null}const wu=s=>s?Og(s)?ec(s)||s.proxy:wu(s.parent):null,yo=zt(Object.create(null),{$:s=>s,$el:s=>s.vnode.el,$data:s=>s.data,$props:s=>s.props,$attrs:s=>s.attrs,$slots:s=>s.slots,$refs:s=>s.refs,$parent:s=>wu(s.parent),$root:s=>wu(s.root),$emit:s=>s.emit,$options:s=>Zd(s),$forceUpdate:s=>s.f||(s.f=()=>{s.effect.dirty=!0,zd(s.update)}),$nextTick:s=>s.n||(s.n=so.bind(s.proxy)),$watch:s=>Gy.bind(s)}),kc=(s,e)=>s!==Et&&!s.__isScriptSetup&&at(s,e),s2={get({_:s},e){const{ctx:t,setupState:n,data:i,props:r,accessCache:o,type:a,appContext:l}=s;let c;if(e[0]!=="$"){const h=o[e];if(h!==void 0)switch(h){case 1:return n[e];case 2:return i[e];case 4:return t[e];case 3:return r[e]}else{if(kc(n,e))return o[e]=1,n[e];if(i!==Et&&at(i,e))return o[e]=2,i[e];if((c=s.propsOptions[0])&&at(c,e))return o[e]=3,r[e];if(t!==Et&&at(t,e))return o[e]=4,t[e];Su&&(o[e]=0)}}const u=yo[e];let d,f;if(u)return e==="$attrs"&&Ss(s,"get",e),u(s);if((d=a.__cssModules)&&(d=d[e]))return d;if(t!==Et&&at(t,e))return o[e]=4,t[e];if(f=l.config.globalProperties,at(f,e))return f[e]},set({_:s},e,t){const{data:n,setupState:i,ctx:r}=s;return kc(i,e)?(i[e]=t,!0):n!==Et&&at(n,e)?(n[e]=t,!0):at(s.props,e)||e[0]==="$"&&e.slice(1)in s?!1:(r[e]=t,!0)},has({_:{data:s,setupState:e,accessCache:t,ctx:n,appContext:i,propsOptions:r}},o){let a;return!!t[o]||s!==Et&&at(s,o)||kc(e,o)||(a=r[0])&&at(a,o)||at(n,o)||at(yo,o)||at(i.config.globalProperties,o)},defineProperty(s,e,t){return t.get!=null?s._.accessCache[e]=0:at(t,"value")&&this.set(s,e,t.value,null),Reflect.defineProperty(s,e,t)}};function hh(s){return Ie(s)?s.reduce((e,t)=>(e[t]=null,e),{}):s}function js(s){const e=Ql();let t=s();return Lu(),Id(t)&&(t=t.catch(n=>{throw Zi(e),n})),[t,()=>Zi(e)]}let Su=!0;function n2(s){const e=Zd(s),t=s.proxy,n=s.ctx;Su=!1,e.beforeCreate&&ph(e.beforeCreate,s,"bc");const{data:i,computed:r,methods:o,watch:a,provide:l,inject:c,created:u,beforeMount:d,mounted:f,beforeUpdate:h,updated:p,activated:g,deactivated:m,beforeDestroy:_,beforeUnmount:y,destroyed:S,unmounted:C,render:E,renderTracked:A,renderTriggered:R,errorCaptured:I,serverPrefetch:D,expose:L,inheritAttrs:M,components:$,directives:H,filters:ie}=e;if(c&&i2(c,n,null),o)for(const de in o){const xe=o[de];Ye(xe)&&(n[de]=xe.bind(t))}if(i){const de=i.call(t,t);_t(de)&&(s.data=Ps(de))}if(Su=!0,r)for(const de in r){const xe=r[de],le=Ye(xe)?xe.bind(t,t):Ye(xe.get)?xe.get.bind(t,t):As,re=!Ye(xe)&&Ye(xe.set)?xe.set.bind(t):As,Be=ut({get:le,set:re});Object.defineProperty(n,de,{enumerable:!0,configurable:!0,get:()=>Be.value,set:be=>Be.value=be})}if(a)for(const de in a)Sg(a[de],n,t,de);if(l){const de=Ye(l)?l.call(t):l;Reflect.ownKeys(de).forEach(xe=>{Ma(xe,de[xe])})}u&&ph(u,s,"c");function X(de,xe){Ie(xe)?xe.forEach(le=>de(le.bind(t))):xe&&de(xe.bind(t))}if(X(Yd,d),X(Xt,f),X(Xy,h),X(bg,p),X(Ws,g),X(Yy,m),X(t2,I),X(e2,A),X(Jy,R),X(Yl,y),X(Ci,C),X(Qy,D),Ie(L))if(L.length){const de=s.exposed||(s.exposed={});L.forEach(xe=>{Object.defineProperty(de,xe,{get:()=>t[xe],set:le=>t[xe]=le})})}else s.exposed||(s.exposed={});E&&s.render===As&&(s.render=E),M!=null&&(s.inheritAttrs=M),$&&(s.components=$),H&&(s.directives=H)}function i2(s,e,t=As){Ie(s)&&(s=Eu(s));for(const n in s){const i=s[n];let r;_t(i)?"default"in i?r=Hs(i.from||n,i.default,!0):r=Hs(i.from||n):r=Hs(i),It(r)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>r.value,set:o=>r.value=o}):e[n]=r}}function ph(s,e,t){Us(Ie(s)?s.map(n=>n.bind(e.proxy)):s.bind(e.proxy),e,t)}function Sg(s,e,t,n){const i=n.includes(".")?mg(t,n):()=>t[n];if(Rt(s)){const r=e[s];Ye(r)&&dt(i,r)}else if(Ye(s))dt(i,s.bind(t));else if(_t(s))if(Ie(s))s.forEach(r=>Sg(r,e,t,n));else{const r=Ye(s.handler)?s.handler.bind(t):e[s.handler];Ye(r)&&dt(i,r,s)}}function Zd(s){const e=s.type,{mixins:t,extends:n}=e,{mixins:i,optionsCache:r,config:{optionMergeStrategies:o}}=s.appContext,a=r.get(e);let l;return a?l=a:!i.length&&!t&&!n?l=e:(l={},i.length&&i.forEach(c=>ul(l,c,o,!0)),ul(l,e,o)),_t(e)&&r.set(e,l),l}function ul(s,e,t,n=!1){const{mixins:i,extends:r}=e;r&&ul(s,r,t,!0),i&&i.forEach(o=>ul(s,o,t,!0));for(const o in e)if(!(n&&o==="expose")){const a=r2[o]||t&&t[o];s[o]=a?a(s[o],e[o]):e[o]}return s}const r2={data:gh,props:mh,emits:mh,methods:ho,computed:ho,beforeCreate:ps,created:ps,beforeMount:ps,mounted:ps,beforeUpdate:ps,updated:ps,beforeDestroy:ps,beforeUnmount:ps,destroyed:ps,unmounted:ps,activated:ps,deactivated:ps,errorCaptured:ps,serverPrefetch:ps,components:ho,directives:ho,watch:a2,provide:gh,inject:o2};function gh(s,e){return e?s?function(){return zt(Ye(s)?s.call(this,this):s,Ye(e)?e.call(this,this):e)}:e:s}function o2(s,e){return ho(Eu(s),Eu(e))}function Eu(s){if(Ie(s)){const e={};for(let t=0;t<s.length;t++)e[s[t]]=s[t];return e}return s}function ps(s,e){return s?[...new Set([].concat(s,e))]:e}function ho(s,e){return s?zt(Object.create(null),s,e):e}function mh(s,e){return s?Ie(s)&&Ie(e)?[...new Set([...s,...e])]:zt(Object.create(null),hh(s),hh(e!=null?e:{})):e}function a2(s,e){if(!s)return e;if(!e)return s;const t=zt(Object.create(null),s);for(const n in e)t[n]=ps(s[n],e[n]);return t}function Eg(){return{app:null,config:{isNativeTag:O_,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let l2=0;function c2(s,e){return function(n,i=null){Ye(n)||(n=zt({},n)),i!=null&&!_t(i)&&(i=null);const r=Eg(),o=new WeakSet;let a=!1;const l=r.app={_uid:l2++,_component:n,_props:i,_container:null,_context:r,_instance:null,version:O2,get config(){return r.config},set config(c){},use(c,...u){return o.has(c)||(c&&Ye(c.install)?(o.add(c),c.install(l,...u)):Ye(c)&&(o.add(c),c(l,...u))),l},mixin(c){return r.mixins.includes(c)||r.mixins.push(c),l},component(c,u){return u?(r.components[c]=u,l):r.components[c]},directive(c,u){return u?(r.directives[c]=u,l):r.directives[c]},mount(c,u,d){if(!a){const f=P(n,i);return f.appContext=r,d===!0?d="svg":d===!1&&(d=void 0),u&&e?e(f,c):s(f,c,d),a=!0,l._container=c,c.__vue_app__=l,ec(f.component)||f.component.proxy}},unmount(){a&&(s(null,l._container),delete l._container.__vue_app__)},provide(c,u){return r.provides[c]=u,l},runWithContext(c){const u=Fr;Fr=l;try{return c()}finally{Fr=u}}};return l}}let Fr=null;function Ma(s,e){if(Yt){let t=Yt.provides;const n=Yt.parent&&Yt.parent.provides;n===t&&(t=Yt.provides=Object.create(n)),t[s]=e}}function Hs(s,e,t=!1){const n=Yt||Nt;if(n||Fr){const i=n?n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:Fr._context.provides;if(i&&s in i)return i[s];if(arguments.length>1)return t&&Ye(e)?e.call(n&&n.proxy):e}}function u2(){return!!(Yt||Nt||Fr)}function d2(s,e,t,n=!1){const i={},r={};rl(r,Xl,1),s.propsDefaults=Object.create(null),Tg(s,e,i,r);for(const o in s.propsOptions[0])o in i||(i[o]=void 0);t?s.props=n?i:J1(i):s.type.props?s.props=i:s.props=r,s.attrs=r}function f2(s,e,t,n){const{props:i,attrs:r,vnode:{patchFlag:o}}=s,a=nt(i),[l]=s.propsOptions;let c=!1;if((n||o>0)&&!(o&16)){if(o&8){const u=s.vnode.dynamicProps;for(let d=0;d<u.length;d++){let f=u[d];if(jl(s.emitsOptions,f))continue;const h=e[f];if(l)if(at(r,f))h!==r[f]&&(r[f]=h,c=!0);else{const p=wn(f);i[p]=Tu(l,a,p,h,s,!1)}else h!==r[f]&&(r[f]=h,c=!0)}}}else{Tg(s,e,i,r)&&(c=!0);let u;for(const d in a)(!e||!at(e,d)&&((u=to(d))===d||!at(e,u)))&&(l?t&&(t[d]!==void 0||t[u]!==void 0)&&(i[d]=Tu(l,a,d,void 0,s,!0)):delete i[d]);if(r!==a)for(const d in r)(!e||!at(e,d)&&!0)&&(delete r[d],c=!0)}c&&Vn(s,"set","$attrs")}function Tg(s,e,t,n){const[i,r]=s.propsOptions;let o=!1,a;if(e)for(let l in e){if(_o(l))continue;const c=e[l];let u;i&&at(i,u=wn(l))?!r||!r.includes(u)?t[u]=c:(a||(a={}))[u]=c:jl(s.emitsOptions,l)||(!(l in n)||c!==n[l])&&(n[l]=c,o=!0)}if(r){const l=nt(t),c=a||Et;for(let u=0;u<r.length;u++){const d=r[u];t[d]=Tu(i,l,d,c[d],s,!at(c,d))}}return o}function Tu(s,e,t,n,i,r){const o=s[t];if(o!=null){const a=at(o,"default");if(a&&n===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&Ye(l)){const{propsDefaults:c}=i;if(t in c)n=c[t];else{const u=Zi(i);n=c[t]=l.call(null,e),u()}}else n=l}o[0]&&(r&&!a?n=!1:o[1]&&(n===""||n===to(t))&&(n=!0))}return n}function Cg(s,e,t=!1){const n=e.propsCache,i=n.get(s);if(i)return i;const r=s.props,o={},a=[];let l=!1;if(!Ye(s)){const u=d=>{l=!0;const[f,h]=Cg(d,e,!0);zt(o,f),h&&a.push(...h)};!t&&e.mixins.length&&e.mixins.forEach(u),s.extends&&u(s.extends),s.mixins&&s.mixins.forEach(u)}if(!r&&!l)return _t(s)&&n.set(s,kr),kr;if(Ie(r))for(let u=0;u<r.length;u++){const d=wn(r[u]);vh(d)&&(o[d]=Et)}else if(r)for(const u in r){const d=wn(u);if(vh(d)){const f=r[u],h=o[d]=Ie(f)||Ye(f)?{type:f}:zt({},f);if(h){const p=xh(Boolean,h.type),g=xh(String,h.type);h[0]=p>-1,h[1]=g<0||p<g,(p>-1||at(h,"default"))&&a.push(d)}}}const c=[o,a];return _t(s)&&n.set(s,c),c}function vh(s){return s[0]!=="$"&&!_o(s)}function _h(s){const e=s&&s.toString().match(/^\s*(function|class) (\w+)/);return e?e[2]:s===null?"null":""}function yh(s,e){return _h(s)===_h(e)}function xh(s,e){return Ie(e)?e.findIndex(t=>yh(t,s)):Ye(e)&&yh(e,s)?0:-1}const Ag=s=>s[0]==="_"||s==="$stable",Xd=s=>Ie(s)?s.map(en):[en(s)],h2=(s,e,t)=>{if(e._n)return e;const n=z((...i)=>Xd(e(...i)),t);return n._c=!1,n},kg=(s,e,t)=>{const n=s._ctx;for(const i in s){if(Ag(i))continue;const r=s[i];if(Ye(r))e[i]=h2(i,r,n);else if(r!=null){const o=Xd(r);e[i]=()=>o}}},Lg=(s,e)=>{const t=Xd(e);s.slots.default=()=>t},p2=(s,e)=>{if(s.vnode.shapeFlag&32){const t=e._;t?(s.slots=nt(e),rl(e,"_",t)):kg(e,s.slots={})}else s.slots={},e&&Lg(s,e);rl(s.slots,Xl,1)},g2=(s,e,t)=>{const{vnode:n,slots:i}=s;let r=!0,o=Et;if(n.shapeFlag&32){const a=e._;a?t&&a===1?r=!1:(zt(i,e),!t&&a===1&&delete i._):(r=!e.$stable,kg(e,i)),o=e}else e&&(Lg(s,e),o={default:1});if(r)for(const a in i)!Ag(a)&&o[a]==null&&delete i[a]};function Cu(s,e,t,n,i=!1){if(Ie(s)){s.forEach((f,h)=>Cu(f,e&&(Ie(e)?e[h]:e),t,n,i));return}if(Pr(n)&&!i)return;const r=n.shapeFlag&4?ec(n.component)||n.component.proxy:n.el,o=i?null:r,{i:a,r:l}=s,c=e&&e.r,u=a.refs===Et?a.refs={}:a.refs,d=a.setupState;if(c!=null&&c!==l&&(Rt(c)?(u[c]=null,at(d,c)&&(d[c]=null)):It(c)&&(c.value=null)),Ye(l))pi(l,a,12,[o,u]);else{const f=Rt(l),h=It(l);if(f||h){const p=()=>{if(s.f){const g=f?at(d,l)?d[l]:u[l]:l.value;i?Ie(g)&&Rd(g,r):Ie(g)?g.includes(r)||g.push(r):f?(u[l]=[r],at(d,l)&&(d[l]=u[l])):(l.value=[r],s.k&&(u[s.k]=l.value))}else f?(u[l]=o,at(d,l)&&(d[l]=o)):h&&(l.value=o,s.k&&(u[s.k]=o))};o?(p.id=-1,es(p,t)):p()}}}function m2(){typeof __VUE_PROD_HYDRATION_MISMATCH_DETAILS__!="boolean"&&(Pd().__VUE_PROD_HYDRATION_MISMATCH_DETAILS__=!1)}const es=Vy;function v2(s){return _2(s)}function _2(s,e){m2();const t=Pd();t.__VUE__=!0;const{insert:n,remove:i,patchProp:r,createElement:o,createText:a,createComment:l,setText:c,setElementText:u,parentNode:d,nextSibling:f,setScopeId:h=As,insertStaticContent:p}=s,g=(k,O,G,Q=null,Y=null,ce=null,ye=void 0,oe=null,se=!!O.dynamicChildren)=>{if(k===O)return;k&&!nn(k,O)&&(Q=K(k),be(k,Y,ce,!0),k=null),O.patchFlag===-2&&(se=!1,O.dynamicChildren=null);const{type:ne,ref:we,shapeFlag:Pe}=O;switch(ne){case Zl:m(k,O,G,Q);break;case ws:_(k,O,G,Q);break;case $a:k==null&&y(O,G,Q,ye);break;case _e:$(k,O,G,Q,Y,ce,ye,oe,se);break;default:Pe&1?E(k,O,G,Q,Y,ce,ye,oe,se):Pe&6?H(k,O,G,Q,Y,ce,ye,oe,se):(Pe&64||Pe&128)&&ne.process(k,O,G,Q,Y,ce,ye,oe,se,Se)}we!=null&&Y&&Cu(we,k&&k.ref,ce,O||k,!O)},m=(k,O,G,Q)=>{if(k==null)n(O.el=a(O.children),G,Q);else{const Y=O.el=k.el;O.children!==k.children&&c(Y,O.children)}},_=(k,O,G,Q)=>{k==null?n(O.el=l(O.children||""),G,Q):O.el=k.el},y=(k,O,G,Q)=>{[k.el,k.anchor]=p(k.children,O,G,Q,k.el,k.anchor)},S=({el:k,anchor:O},G,Q)=>{let Y;for(;k&&k!==O;)Y=f(k),n(k,G,Q),k=Y;n(O,G,Q)},C=({el:k,anchor:O})=>{let G;for(;k&&k!==O;)G=f(k),i(k),k=G;i(O)},E=(k,O,G,Q,Y,ce,ye,oe,se)=>{O.type==="svg"?ye="svg":O.type==="math"&&(ye="mathml"),k==null?A(O,G,Q,Y,ce,ye,oe,se):D(k,O,Y,ce,ye,oe,se)},A=(k,O,G,Q,Y,ce,ye,oe)=>{let se,ne;const{props:we,shapeFlag:Pe,transition:ke,dirs:Ke}=k;if(se=k.el=o(k.type,ce,we&&we.is,we),Pe&8?u(se,k.children):Pe&16&&I(k.children,se,null,Q,Y,Lc(k,ce),ye,oe),Ke&&Li(k,null,Q,"created"),R(se,k,k.scopeId,ye,Q),we){for(const tt in we)tt!=="value"&&!_o(tt)&&r(se,tt,null,we[tt],ce,k.children,Q,Y,Ue);"value"in we&&r(se,"value",null,we.value,ce),(ne=we.onVnodeBeforeMount)&&$s(ne,Q,k)}Ke&&Li(k,null,Q,"beforeMount");const Qe=y2(Y,ke);Qe&&ke.beforeEnter(se),n(se,O,G),((ne=we&&we.onVnodeMounted)||Qe||Ke)&&es(()=>{ne&&$s(ne,Q,k),Qe&&ke.enter(se),Ke&&Li(k,null,Q,"mounted")},Y)},R=(k,O,G,Q,Y)=>{if(G&&h(k,G),Q)for(let ce=0;ce<Q.length;ce++)h(k,Q[ce]);if(Y){let ce=Y.subTree;if(O===ce){const ye=Y.vnode;R(k,ye,ye.scopeId,ye.slotScopeIds,Y.parent)}}},I=(k,O,G,Q,Y,ce,ye,oe,se=0)=>{for(let ne=se;ne<k.length;ne++){const we=k[ne]=oe?ri(k[ne]):en(k[ne]);g(null,we,O,G,Q,Y,ce,ye,oe)}},D=(k,O,G,Q,Y,ce,ye)=>{const oe=O.el=k.el;let{patchFlag:se,dynamicChildren:ne,dirs:we}=O;se|=k.patchFlag&16;const Pe=k.props||Et,ke=O.props||Et;let Ke;if(G&&Ri(G,!1),(Ke=ke.onVnodeBeforeUpdate)&&$s(Ke,G,O,k),we&&Li(O,k,G,"beforeUpdate"),G&&Ri(G,!0),ne?L(k.dynamicChildren,ne,oe,G,Q,Lc(O,Y),ce):ye||xe(k,O,oe,null,G,Q,Lc(O,Y),ce,!1),se>0){if(se&16)M(oe,O,Pe,ke,G,Q,Y);else if(se&2&&Pe.class!==ke.class&&r(oe,"class",null,ke.class,Y),se&4&&r(oe,"style",Pe.style,ke.style,Y),se&8){const Qe=O.dynamicProps;for(let tt=0;tt<Qe.length;tt++){const yt=Qe[tt],Ft=Pe[yt],rs=ke[yt];(rs!==Ft||yt==="value")&&r(oe,yt,Ft,rs,Y,k.children,G,Q,Ue)}}se&1&&k.children!==O.children&&u(oe,O.children)}else!ye&&ne==null&&M(oe,O,Pe,ke,G,Q,Y);((Ke=ke.onVnodeUpdated)||we)&&es(()=>{Ke&&$s(Ke,G,O,k),we&&Li(O,k,G,"updated")},Q)},L=(k,O,G,Q,Y,ce,ye)=>{for(let oe=0;oe<O.length;oe++){const se=k[oe],ne=O[oe],we=se.el&&(se.type===_e||!nn(se,ne)||se.shapeFlag&70)?d(se.el):G;g(se,ne,we,null,Q,Y,ce,ye,!0)}},M=(k,O,G,Q,Y,ce,ye)=>{if(G!==Q){if(G!==Et)for(const oe in G)!_o(oe)&&!(oe in Q)&&r(k,oe,G[oe],null,ye,O.children,Y,ce,Ue);for(const oe in Q){if(_o(oe))continue;const se=Q[oe],ne=G[oe];se!==ne&&oe!=="value"&&r(k,oe,ne,se,ye,O.children,Y,ce,Ue)}"value"in Q&&r(k,"value",G.value,Q.value,ye)}},$=(k,O,G,Q,Y,ce,ye,oe,se)=>{const ne=O.el=k?k.el:a(""),we=O.anchor=k?k.anchor:a("");let{patchFlag:Pe,dynamicChildren:ke,slotScopeIds:Ke}=O;Ke&&(oe=oe?oe.concat(Ke):Ke),k==null?(n(ne,G,Q),n(we,G,Q),I(O.children||[],G,we,Y,ce,ye,oe,se)):Pe>0&&Pe&64&&ke&&k.dynamicChildren?(L(k.dynamicChildren,ke,G,Y,ce,ye,oe),(O.key!=null||Y&&O===Y.subTree)&&Qd(k,O,!0)):xe(k,O,G,we,Y,ce,ye,oe,se)},H=(k,O,G,Q,Y,ce,ye,oe,se)=>{O.slotScopeIds=oe,k==null?O.shapeFlag&512?Y.ctx.activate(O,G,Q,ye,se):ie(O,G,Q,Y,ce,ye,se):te(k,O,se)},ie=(k,O,G,Q,Y,ce,ye)=>{const oe=k.component=L2(k,Q,Y);if(Kl(k)&&(oe.ctx.renderer=Se),R2(oe),oe.asyncDep){if(Y&&Y.registerDep(oe,X),!k.el){const se=oe.subTree=P(ws);_(null,se,O,G)}}else X(oe,k,O,G,Y,ce,ye)},te=(k,O,G)=>{const Q=O.component=k.component;if(Iy(k,O,G))if(Q.asyncDep&&!Q.asyncResolved){de(Q,O,G);return}else Q.next=O,Ty(Q.update),Q.effect.dirty=!0,Q.update();else O.el=k.el,Q.vnode=O},X=(k,O,G,Q,Y,ce,ye)=>{const oe=()=>{if(k.isMounted){let{next:we,bu:Pe,u:ke,parent:Ke,vnode:Qe}=k;{const Kn=Rg(k);if(Kn){we&&(we.el=Qe.el,de(k,we,ye)),Kn.asyncDep.then(()=>{k.isUnmounted||oe()});return}}let tt=we,yt;Ri(k,!1),we?(we.el=Qe.el,de(k,we,ye)):we=Qe,Pe&&Rr(Pe),(yt=we.props&&we.props.onVnodeBeforeUpdate)&&$s(yt,Ke,we,Qe),Ri(k,!0);const Ft=Ec(k),rs=k.subTree;k.subTree=Ft,g(rs,Ft,d(rs.el),K(rs),k,Y,ce),we.el=Ft.el,tt===null&&jd(k,Ft.el),ke&&es(ke,Y),(yt=we.props&&we.props.onVnodeUpdated)&&es(()=>$s(yt,Ke,we,Qe),Y)}else{let we;const{el:Pe,props:ke}=O,{bm:Ke,m:Qe,parent:tt}=k,yt=Pr(O);if(Ri(k,!1),Ke&&Rr(Ke),!yt&&(we=ke&&ke.onVnodeBeforeMount)&&$s(we,tt,O),Ri(k,!0),Pe&&lt){const Ft=()=>{k.subTree=Ec(k),lt(Pe,k.subTree,k,Y,null)};yt?O.type.__asyncLoader().then(()=>!k.isUnmounted&&Ft()):Ft()}else{const Ft=k.subTree=Ec(k);g(null,Ft,G,Q,k,Y,ce),O.el=Ft.el}if(Qe&&es(Qe,Y),!yt&&(we=ke&&ke.onVnodeMounted)){const Ft=O;es(()=>$s(we,tt,Ft),Y)}(O.shapeFlag&256||tt&&Pr(tt.vnode)&&tt.vnode.shapeFlag&256)&&k.a&&es(k.a,Y),k.isMounted=!0,O=G=Q=null}},se=k.effect=new Md(oe,As,()=>zd(ne),k.scope),ne=k.update=()=>{se.dirty&&se.run()};ne.id=k.uid,Ri(k,!0),ne()},de=(k,O,G)=>{O.component=k;const Q=k.vnode.props;k.vnode=O,k.next=null,f2(k,O.props,Q,G),g2(k,O.children,G),tr(),lh(k),sr()},xe=(k,O,G,Q,Y,ce,ye,oe,se=!1)=>{const ne=k&&k.children,we=k?k.shapeFlag:0,Pe=O.children,{patchFlag:ke,shapeFlag:Ke}=O;if(ke>0){if(ke&128){re(ne,Pe,G,Q,Y,ce,ye,oe,se);return}else if(ke&256){le(ne,Pe,G,Q,Y,ce,ye,oe,se);return}}Ke&8?(we&16&&Ue(ne,Y,ce),Pe!==ne&&u(G,Pe)):we&16?Ke&16?re(ne,Pe,G,Q,Y,ce,ye,oe,se):Ue(ne,Y,ce,!0):(we&8&&u(G,""),Ke&16&&I(Pe,G,Q,Y,ce,ye,oe,se))},le=(k,O,G,Q,Y,ce,ye,oe,se)=>{k=k||kr,O=O||kr;const ne=k.length,we=O.length,Pe=Math.min(ne,we);let ke;for(ke=0;ke<Pe;ke++){const Ke=O[ke]=se?ri(O[ke]):en(O[ke]);g(k[ke],Ke,G,null,Y,ce,ye,oe,se)}ne>we?Ue(k,Y,ce,!0,!1,Pe):I(O,G,Q,Y,ce,ye,oe,se,Pe)},re=(k,O,G,Q,Y,ce,ye,oe,se)=>{let ne=0;const we=O.length;let Pe=k.length-1,ke=we-1;for(;ne<=Pe&&ne<=ke;){const Ke=k[ne],Qe=O[ne]=se?ri(O[ne]):en(O[ne]);if(nn(Ke,Qe))g(Ke,Qe,G,null,Y,ce,ye,oe,se);else break;ne++}for(;ne<=Pe&&ne<=ke;){const Ke=k[Pe],Qe=O[ke]=se?ri(O[ke]):en(O[ke]);if(nn(Ke,Qe))g(Ke,Qe,G,null,Y,ce,ye,oe,se);else break;Pe--,ke--}if(ne>Pe){if(ne<=ke){const Ke=ke+1,Qe=Ke<we?O[Ke].el:Q;for(;ne<=ke;)g(null,O[ne]=se?ri(O[ne]):en(O[ne]),G,Qe,Y,ce,ye,oe,se),ne++}}else if(ne>ke)for(;ne<=Pe;)be(k[ne],Y,ce,!0),ne++;else{const Ke=ne,Qe=ne,tt=new Map;for(ne=Qe;ne<=ke;ne++){const os=O[ne]=se?ri(O[ne]):en(O[ne]);os.key!=null&&tt.set(os.key,ne)}let yt,Ft=0;const rs=ke-Qe+1;let Kn=!1,sa=0;const Wn=new Array(rs);for(ne=0;ne<rs;ne++)Wn[ne]=0;for(ne=Ke;ne<=Pe;ne++){const os=k[ne];if(Ft>=rs){be(os,Y,ce,!0);continue}let Fs;if(os.key!=null)Fs=tt.get(os.key);else for(yt=Qe;yt<=ke;yt++)if(Wn[yt-Qe]===0&&nn(os,O[yt])){Fs=yt;break}Fs===void 0?be(os,Y,ce,!0):(Wn[Fs-Qe]=ne+1,Fs>=sa?sa=Fs:Kn=!0,g(os,O[Fs],G,null,Y,ce,ye,oe,se),Ft++)}const na=Kn?x2(Wn):kr;for(yt=na.length-1,ne=rs-1;ne>=0;ne--){const os=Qe+ne,Fs=O[os],ia=os+1<we?O[os+1].el:Q;Wn[ne]===0?g(null,Fs,G,ia,Y,ce,ye,oe,se):Kn&&(yt<0||ne!==na[yt]?Be(Fs,G,ia,2):yt--)}}},Be=(k,O,G,Q,Y=null)=>{const{el:ce,type:ye,transition:oe,children:se,shapeFlag:ne}=k;if(ne&6){Be(k.component.subTree,O,G,Q);return}if(ne&128){k.suspense.move(O,G,Q);return}if(ne&64){ye.move(k,O,G,Se);return}if(ye===_e){n(ce,O,G);for(let Pe=0;Pe<se.length;Pe++)Be(se[Pe],O,G,Q);n(k.anchor,O,G);return}if(ye===$a){S(k,O,G);return}if(Q!==2&&ne&1&&oe)if(Q===0)oe.beforeEnter(ce),n(ce,O,G),es(()=>oe.enter(ce),Y);else{const{leave:Pe,delayLeave:ke,afterLeave:Ke}=oe,Qe=()=>n(ce,O,G),tt=()=>{Pe(ce,()=>{Qe(),Ke&&Ke()})};ke?ke(ce,Qe,tt):tt()}else n(ce,O,G)},be=(k,O,G,Q=!1,Y=!1)=>{const{type:ce,props:ye,ref:oe,children:se,dynamicChildren:ne,shapeFlag:we,patchFlag:Pe,dirs:ke}=k;if(oe!=null&&Cu(oe,null,G,k,!0),we&256){O.ctx.deactivate(k);return}const Ke=we&1&&ke,Qe=!Pr(k);let tt;if(Qe&&(tt=ye&&ye.onVnodeBeforeUnmount)&&$s(tt,O,k),we&6)ot(k.component,G,Q);else{if(we&128){k.suspense.unmount(G,Q);return}Ke&&Li(k,null,O,"beforeUnmount"),we&64?k.type.remove(k,O,G,Y,Se,Q):ne&&(ce!==_e||Pe>0&&Pe&64)?Ue(ne,O,G,!1,!0):(ce===_e&&Pe&384||!Y&&we&16)&&Ue(se,O,G),Q&&Fe(k)}(Qe&&(tt=ye&&ye.onVnodeUnmounted)||Ke)&&es(()=>{tt&&$s(tt,O,k),Ke&&Li(k,null,O,"unmounted")},G)},Fe=k=>{const{type:O,el:G,anchor:Q,transition:Y}=k;if(O===_e){We(G,Q);return}if(O===$a){C(k);return}const ce=()=>{i(G),Y&&!Y.persisted&&Y.afterLeave&&Y.afterLeave()};if(k.shapeFlag&1&&Y&&!Y.persisted){const{leave:ye,delayLeave:oe}=Y,se=()=>ye(G,ce);oe?oe(k.el,ce,se):se()}else ce()},We=(k,O)=>{let G;for(;k!==O;)G=f(k),i(k),k=G;i(O)},ot=(k,O,G)=>{const{bum:Q,scope:Y,update:ce,subTree:ye,um:oe}=k;Q&&Rr(Q),Y.stop(),ce&&(ce.active=!1,be(ye,k,O,G)),oe&&es(oe,O),es(()=>{k.isUnmounted=!0},O),O&&O.pendingBranch&&!O.isUnmounted&&k.asyncDep&&!k.asyncResolved&&k.suspenseId===O.pendingId&&(O.deps--,O.deps===0&&O.resolve())},Ue=(k,O,G,Q=!1,Y=!1,ce=0)=>{for(let ye=ce;ye<k.length;ye++)be(k[ye],O,G,Q,Y)},K=k=>k.shapeFlag&6?K(k.component.subTree):k.shapeFlag&128?k.suspense.next():f(k.anchor||k.el);let me=!1;const fe=(k,O,G)=>{k==null?O._vnode&&be(O._vnode,null,null,!0):g(O._vnode||null,k,O,null,null,null,G),me||(me=!0,lh(),cg(),me=!1),O._vnode=k},Se={p:g,um:be,m:Be,r:Fe,mt:ie,mc:I,pc:xe,pbc:L,n:K,o:s};let it,lt;return e&&([it,lt]=e(Se)),{render:fe,hydrate:it,createApp:c2(fe,it)}}function Lc({type:s,props:e},t){return t==="svg"&&s==="foreignObject"||t==="mathml"&&s==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function Ri({effect:s,update:e},t){s.allowRecurse=e.allowRecurse=t}function y2(s,e){return(!s||s&&!s.pendingBranch)&&e&&!e.persisted}function Qd(s,e,t=!1){const n=s.children,i=e.children;if(Ie(n)&&Ie(i))for(let r=0;r<n.length;r++){const o=n[r];let a=i[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=i[r]=ri(i[r]),a.el=o.el),t||Qd(o,a)),a.type===Zl&&(a.el=o.el)}}function x2(s){const e=s.slice(),t=[0];let n,i,r,o,a;const l=s.length;for(n=0;n<l;n++){const c=s[n];if(c!==0){if(i=t[t.length-1],s[i]<c){e[n]=i,t.push(n);continue}for(r=0,o=t.length-1;r<o;)a=r+o>>1,s[t[a]]<c?r=a+1:o=a;c<s[t[r]]&&(r>0&&(e[n]=t[r-1]),t[r]=n)}}for(r=t.length,o=t[r-1];r-- >0;)t[r]=o,o=e[o];return t}function Rg(s){const e=s.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Rg(e)}const b2=s=>s.__isTeleport,xo=s=>s&&(s.disabled||s.disabled===""),bh=s=>typeof SVGElement<"u"&&s instanceof SVGElement,wh=s=>typeof MathMLElement=="function"&&s instanceof MathMLElement,Au=(s,e)=>{const t=s&&s.to;return Rt(t)?e?e(t):null:t},w2={name:"Teleport",__isTeleport:!0,process(s,e,t,n,i,r,o,a,l,c){const{mc:u,pc:d,pbc:f,o:{insert:h,querySelector:p,createText:g,createComment:m}}=c,_=xo(e.props);let{shapeFlag:y,children:S,dynamicChildren:C}=e;if(s==null){const E=e.el=g(""),A=e.anchor=g("");h(E,t,n),h(A,t,n);const R=e.target=Au(e.props,p),I=e.targetAnchor=g("");R&&(h(I,R),o==="svg"||bh(R)?o="svg":(o==="mathml"||wh(R))&&(o="mathml"));const D=(L,M)=>{y&16&&u(S,L,M,i,r,o,a,l)};_?D(t,A):R&&D(R,I)}else{e.el=s.el;const E=e.anchor=s.anchor,A=e.target=s.target,R=e.targetAnchor=s.targetAnchor,I=xo(s.props),D=I?t:A,L=I?E:R;if(o==="svg"||bh(A)?o="svg":(o==="mathml"||wh(A))&&(o="mathml"),C?(f(s.dynamicChildren,C,D,i,r,o,a),Qd(s,e,!0)):l||d(s,e,D,L,i,r,o,a,!1),_)I?e.props&&s.props&&e.props.to!==s.props.to&&(e.props.to=s.props.to):ha(e,t,E,c,1);else if((e.props&&e.props.to)!==(s.props&&s.props.to)){const M=e.target=Au(e.props,p);M&&ha(e,M,null,c,0)}else I&&ha(e,A,R,c,1)}Ig(e)},remove(s,e,t,n,{um:i,o:{remove:r}},o){const{shapeFlag:a,children:l,anchor:c,targetAnchor:u,target:d,props:f}=s;if(d&&r(u),o&&r(c),a&16){const h=o||!xo(f);for(let p=0;p<l.length;p++){const g=l[p];i(g,e,t,h,!!g.dynamicChildren)}}},move:ha,hydrate:S2};function ha(s,e,t,{o:{insert:n},m:i},r=2){r===0&&n(s.targetAnchor,e,t);const{el:o,anchor:a,shapeFlag:l,children:c,props:u}=s,d=r===2;if(d&&n(o,e,t),(!d||xo(u))&&l&16)for(let f=0;f<c.length;f++)i(c[f],e,t,2);d&&n(a,e,t)}function S2(s,e,t,n,i,r,{o:{nextSibling:o,parentNode:a,querySelector:l}},c){const u=e.target=Au(e.props,l);if(u){const d=u._lpa||u.firstChild;if(e.shapeFlag&16)if(xo(e.props))e.anchor=c(o(s),e,a(s),t,n,i,r),e.targetAnchor=d;else{e.anchor=o(s);let f=d;for(;f;)if(f=o(f),f&&f.nodeType===8&&f.data==="teleport anchor"){e.targetAnchor=f,u._lpa=e.targetAnchor&&o(e.targetAnchor);break}c(d,e,u,t,n,i,r)}Ig(e)}return e.anchor&&o(e.anchor)}const Jd=w2;function Ig(s){const e=s.ctx;if(e&&e.ut){let t=s.children[0].el;for(;t&&t!==s.targetAnchor;)t.nodeType===1&&t.setAttribute("data-v-owner",e.uid),t=t.nextSibling;e.ut()}}const _e=Symbol.for("v-fgt"),Zl=Symbol.for("v-txt"),ws=Symbol.for("v-cmt"),$a=Symbol.for("v-stc"),bo=[];let Bs=null;function x(s=!1){bo.push(Bs=s?null:[])}function Dg(){bo.pop(),Bs=bo[bo.length-1]||null}let Ur=1;function Sh(s){Ur+=s}function Pg(s){return s.dynamicChildren=Ur>0?Bs||kr:null,Dg(),Ur>0&&Bs&&Bs.push(s),s}function T(s,e,t,n,i,r){return Pg(v(s,e,t,n,i,r,!0))}function ae(s,e,t,n,i){return Pg(P(s,e,t,n,i,!0))}function Hr(s){return s?s.__v_isVNode===!0:!1}function nn(s,e){return s.type===e.type&&s.key===e.key}const Xl="__vInternal",Fg=({key:s})=>s!=null?s:null,Na=({ref:s,ref_key:e,ref_for:t})=>(typeof s=="number"&&(s=""+s),s!=null?Rt(s)||It(s)||Ye(s)?{i:Nt,r:s,k:e,f:!!t}:s:null);function v(s,e=null,t=null,n=0,i=null,r=s===_e?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:s,props:e,key:e&&Fg(e),ref:e&&Na(e),scopeId:fg,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:n,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:Nt};return a?(ef(l,t),r&128&&s.normalize(l)):t&&(l.shapeFlag|=Rt(t)?8:16),Ur>0&&!o&&Bs&&(l.patchFlag>0||r&6)&&l.patchFlag!==32&&Bs.push(l),l}const P=E2;function E2(s,e=null,t=null,n=0,i=null,r=!1){if((!s||s===hg)&&(s=ws),Hr(s)){const a=Hn(s,e,!0);return t&&ef(a,t),Ur>0&&!r&&Bs&&(a.shapeFlag&6?Bs[Bs.indexOf(s)]=a:Bs.push(a)),a.patchFlag|=-2,a}if(F2(s)&&(s=s.__vccOpts),e){e=T2(e);let{class:a,style:l}=e;a&&!Rt(a)&&(e.class=Je(a)),_t(l)&&(tg(l)&&!Ie(l)&&(l=zt({},l)),e.style=Vs(l))}const o=Rt(s)?1:pg(s)?128:b2(s)?64:_t(s)?4:Ye(s)?2:0;return v(s,e,t,n,i,o,r,!0)}function T2(s){return s?tg(s)||Xl in s?zt({},s):s:null}function Hn(s,e,t=!1){const{props:n,ref:i,patchFlag:r,children:o}=s,a=e?C2(n||{},e):n;return{__v_isVNode:!0,__v_skip:!0,type:s.type,props:a,key:a&&Fg(a),ref:e&&e.ref?t&&i?Ie(i)?i.concat(Na(e)):[i,Na(e)]:Na(e):i,scopeId:s.scopeId,slotScopeIds:s.slotScopeIds,children:o,target:s.target,targetAnchor:s.targetAnchor,staticCount:s.staticCount,shapeFlag:s.shapeFlag,patchFlag:e&&s.type!==_e?r===-1?16:r|16:r,dynamicProps:s.dynamicProps,dynamicChildren:s.dynamicChildren,appContext:s.appContext,dirs:s.dirs,transition:s.transition,component:s.component,suspense:s.suspense,ssContent:s.ssContent&&Hn(s.ssContent),ssFallback:s.ssFallback&&Hn(s.ssFallback),el:s.el,anchor:s.anchor,ctx:s.ctx,ce:s.ce}}function W(s=" ",e=0){return P(Zl,null,s,e)}function Yo(s,e){const t=P($a,null,s);return t.staticCount=e,t}function pe(s="",e=!1){return e?(x(),ae(ws,null,s)):P(ws,null,s)}function en(s){return s==null||typeof s=="boolean"?P(ws):Ie(s)?P(_e,null,s.slice()):typeof s=="object"?ri(s):P(Zl,null,String(s))}function ri(s){return s.el===null&&s.patchFlag!==-1||s.memo?s:Hn(s)}function ef(s,e){let t=0;const{shapeFlag:n}=s;if(e==null)e=null;else if(Ie(e))t=16;else if(typeof e=="object")if(n&65){const i=e.default;i&&(i._c&&(i._d=!1),ef(s,i()),i._c&&(i._d=!0));return}else{t=32;const i=e._;!i&&!(Xl in e)?e._ctx=Nt:i===3&&Nt&&(Nt.slots._===1?e._=1:(e._=2,s.patchFlag|=1024))}else Ye(e)?(e={default:e,_ctx:Nt},t=32):(e=String(e),n&64?(t=16,e=[W(e)]):t=8);s.children=e,s.shapeFlag|=t}function C2(...s){const e={};for(let t=0;t<s.length;t++){const n=s[t];for(const i in n)if(i==="class")e.class!==n.class&&(e.class=Je([e.class,n.class]));else if(i==="style")e.style=Vs([e.style,n.style]);else if(Bl(i)){const r=e[i],o=n[i];o&&r!==o&&!(Ie(r)&&r.includes(o))&&(e[i]=r?[].concat(r,o):o)}else i!==""&&(e[i]=n[i])}return e}function $s(s,e,t,n=null){Us(s,e,7,[t,n])}const A2=Eg();let k2=0;function L2(s,e,t){const n=s.type,i=(e?e.appContext:s.appContext)||A2,r={uid:k2++,vnode:s,type:n,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,scope:new V1(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Cg(n,i),emitsOptions:dg(n,i),emit:null,emitted:null,propsDefaults:Et,inheritAttrs:n.inheritAttrs,ctx:Et,data:Et,props:Et,attrs:Et,slots:Et,refs:Et,setupState:Et,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=e?e.root:r,r.emit=Ay.bind(null,r),s.ce&&s.ce(r),r}let Yt=null;const Ql=()=>Yt||Nt;let dl,ku;{const s=Pd(),e=(t,n)=>{let i;return(i=s[t])||(i=s[t]=[]),i.push(n),r=>{i.length>1?i.forEach(o=>o(r)):i[0](r)}};dl=e("__VUE_INSTANCE_SETTERS__",t=>Yt=t),ku=e("__VUE_SSR_SETTERS__",t=>Jl=t)}const Zi=s=>{const e=Yt;return dl(s),s.scope.on(),()=>{s.scope.off(),dl(e)}},Lu=()=>{Yt&&Yt.scope.off(),dl(null)};function Og(s){return s.vnode.shapeFlag&4}let Jl=!1;function R2(s,e=!1){e&&ku(e);const{props:t,children:n}=s.vnode,i=Og(s);d2(s,t,i,e),p2(s,n);const r=i?I2(s,e):void 0;return e&&ku(!1),r}function I2(s,e){const t=s.type;s.accessCache=Object.create(null),s.proxy=zl(new Proxy(s.ctx,s2));const{setup:n}=t;if(n){const i=s.setupContext=n.length>1?P2(s):null,r=Zi(s);tr();const o=pi(n,s,0,[s.props,i]);if(sr(),r(),Id(o)){if(o.then(Lu,Lu),e)return o.then(a=>{Ru(s,a,e)}).catch(a=>{Wo(a,s,0)});s.asyncDep=o}else Ru(s,o,e)}else Mg(s,e)}function Ru(s,e,t){Ye(e)?s.type.__ssrInlineRender?s.ssrRender=e:s.render=e:_t(e)&&(s.setupState=rg(e)),Mg(s,t)}let Eh;function Mg(s,e,t){const n=s.type;if(!s.render){if(!e&&Eh&&!n.render){const i=n.template||Zd(s).template;if(i){const{isCustomElement:r,compilerOptions:o}=s.appContext.config,{delimiters:a,compilerOptions:l}=n,c=zt(zt({isCustomElement:r,delimiters:a},o),l);n.render=Eh(i,c)}}s.render=n.render||As}{const i=Zi(s);tr();try{n2(s)}finally{sr(),i()}}}function D2(s){return s.attrsProxy||(s.attrsProxy=new Proxy(s.attrs,{get(e,t){return Ss(s,"get","$attrs"),e[t]}}))}function P2(s){const e=t=>{s.exposed=t||{}};return{get attrs(){return D2(s)},slots:s.slots,emit:s.emit,expose:e}}function ec(s){if(s.exposed)return s.exposeProxy||(s.exposeProxy=new Proxy(rg(zl(s.exposed)),{get(e,t){if(t in e)return e[t];if(t in yo)return yo[t](s)},has(e,t){return t in e||t in yo}}))}function Iu(s,e=!0){return Ye(s)?s.displayName||s.name:s.name||e&&s.__name}function F2(s){return Ye(s)&&"__vccOpts"in s}const ut=(s,e)=>gy(s,e,Jl);function tf(s,e,t){const n=arguments.length;return n===2?_t(e)&&!Ie(e)?Hr(e)?P(s,null,[e]):P(s,e):P(s,null,e):(n>3?t=Array.prototype.slice.call(arguments,2):n===3&&Hr(t)&&(t=[t]),P(s,e,t))}const O2="3.4.18";/**
 * @vue/runtime-dom v3.4.18
 * (c) 2018-present Yuxi (Evan) You and Vue contributors
 * @license MIT
 **/const M2="http://www.w3.org/2000/svg",$2="http://www.w3.org/1998/Math/MathML",oi=typeof document<"u"?document:null,Th=oi&&oi.createElement("template"),N2={insert:(s,e,t)=>{e.insertBefore(s,t||null)},remove:s=>{const e=s.parentNode;e&&e.removeChild(s)},createElement:(s,e,t,n)=>{const i=e==="svg"?oi.createElementNS(M2,s):e==="mathml"?oi.createElementNS($2,s):oi.createElement(s,t?{is:t}:void 0);return s==="select"&&n&&n.multiple!=null&&i.setAttribute("multiple",n.multiple),i},createText:s=>oi.createTextNode(s),createComment:s=>oi.createComment(s),setText:(s,e)=>{s.nodeValue=e},setElementText:(s,e)=>{s.textContent=e},parentNode:s=>s.parentNode,nextSibling:s=>s.nextSibling,querySelector:s=>oi.querySelector(s),setScopeId(s,e){s.setAttribute(e,"")},insertStaticContent(s,e,t,n,i,r){const o=t?t.previousSibling:e.lastChild;if(i&&(i===r||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),t),!(i===r||!(i=i.nextSibling)););else{Th.innerHTML=n==="svg"?`<svg>${s}</svg>`:n==="mathml"?`<math>${s}</math>`:s;const a=Th.content;if(n==="svg"||n==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},Zn="transition",io="animation",Mo=Symbol("_vtc"),Zo=(s,{slots:e})=>tf(qy,V2(s),e);Zo.displayName="Transition";const $g={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};Zo.props=zt({},vg,$g);const Ii=(s,e=[])=>{Ie(s)?s.forEach(t=>t(...e)):s&&s(...e)},Ch=s=>s?Ie(s)?s.some(e=>e.length>1):s.length>1:!1;function V2(s){const e={};for(const $ in s)$ in $g||(e[$]=s[$]);if(s.css===!1)return e;const{name:t="v",type:n,duration:i,enterFromClass:r=`${t}-enter-from`,enterActiveClass:o=`${t}-enter-active`,enterToClass:a=`${t}-enter-to`,appearFromClass:l=r,appearActiveClass:c=o,appearToClass:u=a,leaveFromClass:d=`${t}-leave-from`,leaveActiveClass:f=`${t}-leave-active`,leaveToClass:h=`${t}-leave-to`}=s,p=B2(i),g=p&&p[0],m=p&&p[1],{onBeforeEnter:_,onEnter:y,onEnterCancelled:S,onLeave:C,onLeaveCancelled:E,onBeforeAppear:A=_,onAppear:R=y,onAppearCancelled:I=S}=e,D=($,H,ie)=>{Di($,H?u:a),Di($,H?c:o),ie&&ie()},L=($,H)=>{$._isLeaving=!1,Di($,d),Di($,h),Di($,f),H&&H()},M=$=>(H,ie)=>{const te=$?R:y,X=()=>D(H,$,ie);Ii(te,[H,X]),Ah(()=>{Di(H,$?l:r),Xn(H,$?u:a),Ch(te)||kh(H,n,g,X)})};return zt(e,{onBeforeEnter($){Ii(_,[$]),Xn($,r),Xn($,o)},onBeforeAppear($){Ii(A,[$]),Xn($,l),Xn($,c)},onEnter:M(!1),onAppear:M(!0),onLeave($,H){$._isLeaving=!0;const ie=()=>L($,H);Xn($,d),G2(),Xn($,f),Ah(()=>{!$._isLeaving||(Di($,d),Xn($,h),Ch(C)||kh($,n,m,ie))}),Ii(C,[$,ie])},onEnterCancelled($){D($,!1),Ii(S,[$])},onAppearCancelled($){D($,!0),Ii(I,[$])},onLeaveCancelled($){L($),Ii(E,[$])}})}function B2(s){if(s==null)return null;if(_t(s))return[Rc(s.enter),Rc(s.leave)];{const e=Rc(s);return[e,e]}}function Rc(s){return M1(s)}function Xn(s,e){e.split(/\s+/).forEach(t=>t&&s.classList.add(t)),(s[Mo]||(s[Mo]=new Set)).add(e)}function Di(s,e){e.split(/\s+/).forEach(n=>n&&s.classList.remove(n));const t=s[Mo];t&&(t.delete(e),t.size||(s[Mo]=void 0))}function Ah(s){requestAnimationFrame(()=>{requestAnimationFrame(s)})}let U2=0;function kh(s,e,t,n){const i=s._endId=++U2,r=()=>{i===s._endId&&n()};if(t)return setTimeout(r,t);const{type:o,timeout:a,propCount:l}=H2(s,e);if(!o)return n();const c=o+"end";let u=0;const d=()=>{s.removeEventListener(c,f),r()},f=h=>{h.target===s&&++u>=l&&d()};setTimeout(()=>{u<l&&d()},a+1),s.addEventListener(c,f)}function H2(s,e){const t=window.getComputedStyle(s),n=p=>(t[p]||"").split(", "),i=n(`${Zn}Delay`),r=n(`${Zn}Duration`),o=Lh(i,r),a=n(`${io}Delay`),l=n(`${io}Duration`),c=Lh(a,l);let u=null,d=0,f=0;e===Zn?o>0&&(u=Zn,d=o,f=r.length):e===io?c>0&&(u=io,d=c,f=l.length):(d=Math.max(o,c),u=d>0?o>c?Zn:io:null,f=u?u===Zn?r.length:l.length:0);const h=u===Zn&&/\b(transform|all)(,|$)/.test(n(`${Zn}Property`).toString());return{type:u,timeout:d,propCount:f,hasTransform:h}}function Lh(s,e){for(;s.length<e.length;)s=s.concat(s);return Math.max(...e.map((t,n)=>Rh(t)+Rh(s[n])))}function Rh(s){return s==="auto"?0:Number(s.slice(0,-1).replace(",","."))*1e3}function G2(){return document.body.offsetHeight}function z2(s,e,t){const n=s[Mo];n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?s.removeAttribute("class"):t?s.setAttribute("class",e):s.className=e}const $o=Symbol("_vod"),Kt={beforeMount(s,{value:e},{transition:t}){s[$o]=s.style.display==="none"?"":s.style.display,t&&e?t.beforeEnter(s):ro(s,e)},mounted(s,{value:e},{transition:t}){t&&e&&t.enter(s)},updated(s,{value:e,oldValue:t},{transition:n}){!e==!t&&s.style.display===s[$o]||(n?e?(n.beforeEnter(s),ro(s,!0),n.enter(s)):n.leave(s,()=>{ro(s,!1)}):ro(s,e))},beforeUnmount(s,{value:e}){ro(s,e)}};function ro(s,e){s.style.display=e?s[$o]:"none"}const j2=Symbol(""),q2=/(^|;)\s*display\s*:/;function K2(s,e,t){const n=s.style,i=Rt(t),r=n.display;let o=!1;if(t&&!i){if(e&&!Rt(e))for(const a in e)t[a]==null&&Du(n,a,"");for(const a in t)a==="display"&&(o=!0),Du(n,a,t[a])}else if(i){if(e!==t){const a=n[j2];a&&(t+=";"+a),n.cssText=t,o=q2.test(t)}}else e&&s.removeAttribute("style");$o in s&&(s[$o]=o?n.display:"",n.display=r)}const Ih=/\s*!important$/;function Du(s,e,t){if(Ie(t))t.forEach(n=>Du(s,e,n));else if(t==null&&(t=""),e.startsWith("--"))s.setProperty(e,t);else{const n=W2(s,e);Ih.test(t)?s.setProperty(to(n),t.replace(Ih,""),"important"):s[n]=t}}const Dh=["Webkit","Moz","ms"],Ic={};function W2(s,e){const t=Ic[e];if(t)return t;let n=wn(e);if(n!=="filter"&&n in s)return Ic[e]=n;n=Hl(n);for(let i=0;i<Dh.length;i++){const r=Dh[i]+n;if(r in s)return Ic[e]=r}return e}const Ph="http://www.w3.org/1999/xlink";function Y2(s,e,t,n,i){if(n&&e.startsWith("xlink:"))t==null?s.removeAttributeNS(Ph,e.slice(6,e.length)):s.setAttributeNS(Ph,e,t);else{const r=q_(e);t==null||r&&!$1(t)?s.removeAttribute(e):s.setAttribute(e,r?"":t)}}function Z2(s,e,t,n,i,r,o){if(e==="innerHTML"||e==="textContent"){n&&o(n,i,r),s[e]=t==null?"":t;return}const a=s.tagName;if(e==="value"&&a!=="PROGRESS"&&!a.includes("-")){s._value=t;const c=a==="OPTION"?s.getAttribute("value"):s.value,u=t==null?"":t;c!==u&&(s.value=u),t==null&&s.removeAttribute(e);return}let l=!1;if(t===""||t==null){const c=typeof s[e];c==="boolean"?t=$1(t):t==null&&c==="string"?(t="",l=!0):c==="number"&&(t=0,l=!0)}try{s[e]=t}catch{}l&&s.removeAttribute(e)}function di(s,e,t,n){s.addEventListener(e,t,n)}function X2(s,e,t,n){s.removeEventListener(e,t,n)}const Fh=Symbol("_vei");function Q2(s,e,t,n,i=null){const r=s[Fh]||(s[Fh]={}),o=r[e];if(n&&o)o.value=n;else{const[a,l]=J2(e);if(n){const c=r[e]=sx(n,i);di(s,a,c,l)}else o&&(X2(s,a,o,l),r[e]=void 0)}}const Oh=/(?:Once|Passive|Capture)$/;function J2(s){let e;if(Oh.test(s)){e={};let n;for(;n=s.match(Oh);)s=s.slice(0,s.length-n[0].length),e[n[0].toLowerCase()]=!0}return[s[2]===":"?s.slice(3):to(s.slice(2)),e]}let Dc=0;const ex=Promise.resolve(),tx=()=>Dc||(ex.then(()=>Dc=0),Dc=Date.now());function sx(s,e){const t=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=t.attached)return;Us(nx(n,t.value),e,5,[n])};return t.value=s,t.attached=tx(),t}function nx(s,e){if(Ie(e)){const t=s.stopImmediatePropagation;return s.stopImmediatePropagation=()=>{t.call(s),s._stopped=!0},e.map(n=>i=>!i._stopped&&n&&n(i))}else return e}const Mh=s=>s.charCodeAt(0)===111&&s.charCodeAt(1)===110&&s.charCodeAt(2)>96&&s.charCodeAt(2)<123,ix=(s,e,t,n,i,r,o,a,l)=>{const c=i==="svg";e==="class"?z2(s,n,c):e==="style"?K2(s,t,n):Bl(e)?Ld(e)||Q2(s,e,t,n,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):rx(s,e,n,c))?Z2(s,e,n,r,o,a,l):(e==="true-value"?s._trueValue=n:e==="false-value"&&(s._falseValue=n),Y2(s,e,n,c))};function rx(s,e,t,n){if(n)return!!(e==="innerHTML"||e==="textContent"||e in s&&Mh(e)&&Ye(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&s.tagName==="INPUT"||e==="type"&&s.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const i=s.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return Mh(e)&&Rt(t)?!1:e in s}const Gr=s=>{const e=s.props["onUpdate:modelValue"]||!1;return Ie(e)?t=>Rr(e,t):e};function ox(s){s.target.composing=!0}function $h(s){const e=s.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const Un=Symbol("_assign"),sf={created(s,{modifiers:{lazy:e,trim:t,number:n}},i){s[Un]=Gr(i);const r=n||i.props&&i.props.type==="number";di(s,e?"change":"input",o=>{if(o.target.composing)return;let a=s.value;t&&(a=a.trim()),r&&(a=Io(a)),s[Un](a)}),t&&di(s,"change",()=>{s.value=s.value.trim()}),e||(di(s,"compositionstart",ox),di(s,"compositionend",$h),di(s,"change",$h))},mounted(s,{value:e}){s.value=e==null?"":e},beforeUpdate(s,{value:e,modifiers:{lazy:t,trim:n,number:i}},r){if(s[Un]=Gr(r),s.composing)return;const o=i||s.type==="number"?Io(s.value):s.value,a=e==null?"":e;o!==a&&(document.activeElement===s&&s.type!=="range"&&(t||n&&s.value.trim()===a)||(s.value=a))}},Nh={deep:!0,created(s,e,t){s[Un]=Gr(t),di(s,"change",()=>{const n=s._modelValue,i=No(s),r=s.checked,o=s[Un];if(Ie(n)){const a=Fd(n,i),l=a!==-1;if(r&&!l)o(n.concat(i));else if(!r&&l){const c=[...n];c.splice(a,1),o(c)}}else if(Jr(n)){const a=new Set(n);r?a.add(i):a.delete(i),o(a)}else o(Ng(s,r))})},mounted:Vh,beforeUpdate(s,e,t){s[Un]=Gr(t),Vh(s,e,t)}};function Vh(s,{value:e,oldValue:t},n){s._modelValue=e,Ie(e)?s.checked=Fd(e,n.props.value)>-1:Jr(e)?s.checked=e.has(n.props.value):e!==t&&(s.checked=Ko(e,Ng(s,!0)))}const Bh={deep:!0,created(s,{value:e,modifiers:{number:t}},n){const i=Jr(e);di(s,"change",()=>{const r=Array.prototype.filter.call(s.options,o=>o.selected).map(o=>t?Io(No(o)):No(o));s[Un](s.multiple?i?new Set(r):r:r[0]),s._assigning=!0,so(()=>{s._assigning=!1})}),s[Un]=Gr(n)},mounted(s,{value:e,oldValue:t,modifiers:{number:n}}){Uh(s,e,t,n)},beforeUpdate(s,e,t){s[Un]=Gr(t)},updated(s,{value:e,oldValue:t,modifiers:{number:n}}){s._assigning||Uh(s,e,t,n)}};function Uh(s,e,t,n){const i=s.multiple,r=Ie(e);if(!(i&&!r&&!Jr(e))){for(let o=0,a=s.options.length;o<a;o++){const l=s.options[o],c=No(l);if(i)if(r){const u=typeof c;u==="string"||u==="number"?l.selected=e.includes(n?Io(c):c):l.selected=Fd(e,c)>-1}else l.selected=e.has(c);else if(Ko(No(l),e)){s.selectedIndex!==o&&(s.selectedIndex=o);return}}!i&&s.selectedIndex!==-1&&(s.selectedIndex=-1)}}function No(s){return"_value"in s?s._value:s.value}function Ng(s,e){const t=e?"_trueValue":"_falseValue";return t in s?s[t]:e}const ax=["ctrl","shift","alt","meta"],lx={stop:s=>s.stopPropagation(),prevent:s=>s.preventDefault(),self:s=>s.target!==s.currentTarget,ctrl:s=>!s.ctrlKey,shift:s=>!s.shiftKey,alt:s=>!s.altKey,meta:s=>!s.metaKey,left:s=>"button"in s&&s.button!==0,middle:s=>"button"in s&&s.button!==1,right:s=>"button"in s&&s.button!==2,exact:(s,e)=>ax.some(t=>s[`${t}Key`]&&!e.includes(t))},Is=(s,e)=>{const t=s._withMods||(s._withMods={}),n=e.join(".");return t[n]||(t[n]=(i,...r)=>{for(let o=0;o<e.length;o++){const a=lx[e[o]];if(a&&a(i,e))return}return s(i,...r)})},cx=zt({patchProp:ix},N2);let Hh;function ux(){return Hh||(Hh=v2(cx))}const dx=(...s)=>{const e=ux().createApp(...s),{mount:t}=e;return e.mount=n=>{const i=hx(n);if(!i)return;const r=e._component;!Ye(r)&&!r.render&&!r.template&&(r.template=i.innerHTML),i.innerHTML="";const o=t(i,!1,fx(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},e};function fx(s){if(s instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&s instanceof MathMLElement)return"mathml"}function hx(s){return Rt(s)?document.querySelector(s):s}/*!
  * vue-router v4.2.5
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */const yr=typeof window<"u";function px(s){return s.__esModule||s[Symbol.toStringTag]==="Module"}const gt=Object.assign;function Pc(s,e){const t={};for(const n in e){const i=e[n];t[n]=ln(i)?i.map(s):s(i)}return t}const wo=()=>{},ln=Array.isArray,gx=/\/$/,mx=s=>s.replace(gx,"");function Fc(s,e,t="/"){let n,i={},r="",o="";const a=e.indexOf("#");let l=e.indexOf("?");return a<l&&a>=0&&(l=-1),l>-1&&(n=e.slice(0,l),r=e.slice(l+1,a>-1?a:e.length),i=s(r)),a>-1&&(n=n||e.slice(0,a),o=e.slice(a,e.length)),n=xx(n!=null?n:e,t),{fullPath:n+(r&&"?")+r+o,path:n,query:i,hash:o}}function vx(s,e){const t=e.query?s(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function Gh(s,e){return!e||!s.toLowerCase().startsWith(e.toLowerCase())?s:s.slice(e.length)||"/"}function _x(s,e,t){const n=e.matched.length-1,i=t.matched.length-1;return n>-1&&n===i&&zr(e.matched[n],t.matched[i])&&Vg(e.params,t.params)&&s(e.query)===s(t.query)&&e.hash===t.hash}function zr(s,e){return(s.aliasOf||s)===(e.aliasOf||e)}function Vg(s,e){if(Object.keys(s).length!==Object.keys(e).length)return!1;for(const t in s)if(!yx(s[t],e[t]))return!1;return!0}function yx(s,e){return ln(s)?zh(s,e):ln(e)?zh(e,s):s===e}function zh(s,e){return ln(e)?s.length===e.length&&s.every((t,n)=>t===e[n]):s.length===1&&s[0]===e}function xx(s,e){if(s.startsWith("/"))return s;if(!s)return e;const t=e.split("/"),n=s.split("/"),i=n[n.length-1];(i===".."||i===".")&&n.push("");let r=t.length-1,o,a;for(o=0;o<n.length;o++)if(a=n[o],a!==".")if(a==="..")r>1&&r--;else break;return t.slice(0,r).join("/")+"/"+n.slice(o-(o===n.length?1:0)).join("/")}var Vo;(function(s){s.pop="pop",s.push="push"})(Vo||(Vo={}));var So;(function(s){s.back="back",s.forward="forward",s.unknown=""})(So||(So={}));function bx(s){if(!s)if(yr){const e=document.querySelector("base");s=e&&e.getAttribute("href")||"/",s=s.replace(/^\w+:\/\/[^\/]+/,"")}else s="/";return s[0]!=="/"&&s[0]!=="#"&&(s="/"+s),mx(s)}const wx=/^[^#]+#/;function Sx(s,e){return s.replace(wx,"#")+e}function Ex(s,e){const t=document.documentElement.getBoundingClientRect(),n=s.getBoundingClientRect();return{behavior:e.behavior,left:n.left-t.left-(e.left||0),top:n.top-t.top-(e.top||0)}}const tc=()=>({left:window.pageXOffset,top:window.pageYOffset});function Tx(s){let e;if("el"in s){const t=s.el,n=typeof t=="string"&&t.startsWith("#"),i=typeof t=="string"?n?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!i)return;e=Ex(i,s)}else e=s;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function jh(s,e){return(history.state?history.state.position-e:-1)+s}const Pu=new Map;function Cx(s,e){Pu.set(s,e)}function Ax(s){const e=Pu.get(s);return Pu.delete(s),e}let kx=()=>location.protocol+"//"+location.host;function Bg(s,e){const{pathname:t,search:n,hash:i}=e,r=s.indexOf("#");if(r>-1){let a=i.includes(s.slice(r))?s.slice(r).length:1,l=i.slice(a);return l[0]!=="/"&&(l="/"+l),Gh(l,"")}return Gh(t,s)+n+i}function Lx(s,e,t,n){let i=[],r=[],o=null;const a=({state:f})=>{const h=Bg(s,location),p=t.value,g=e.value;let m=0;if(f){if(t.value=h,e.value=f,o&&o===p){o=null;return}m=g?f.position-g.position:0}else n(h);i.forEach(_=>{_(t.value,p,{delta:m,type:Vo.pop,direction:m?m>0?So.forward:So.back:So.unknown})})};function l(){o=t.value}function c(f){i.push(f);const h=()=>{const p=i.indexOf(f);p>-1&&i.splice(p,1)};return r.push(h),h}function u(){const{history:f}=window;!f.state||f.replaceState(gt({},f.state,{scroll:tc()}),"")}function d(){for(const f of r)f();r=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",u,{passive:!0}),{pauseListeners:l,listen:c,destroy:d}}function qh(s,e,t,n=!1,i=!1){return{back:s,current:e,forward:t,replaced:n,position:window.history.length,scroll:i?tc():null}}function Rx(s){const{history:e,location:t}=window,n={value:Bg(s,t)},i={value:e.state};i.value||r(n.value,{back:null,current:n.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function r(l,c,u){const d=s.indexOf("#"),f=d>-1?(t.host&&document.querySelector("base")?s:s.slice(d))+l:kx()+s+l;try{e[u?"replaceState":"pushState"](c,"",f),i.value=c}catch(h){console.error(h),t[u?"replace":"assign"](f)}}function o(l,c){const u=gt({},e.state,qh(i.value.back,l,i.value.forward,!0),c,{position:i.value.position});r(l,u,!0),n.value=l}function a(l,c){const u=gt({},i.value,e.state,{forward:l,scroll:tc()});r(u.current,u,!0);const d=gt({},qh(n.value,l,null),{position:u.position+1},c);r(l,d,!1),n.value=l}return{location:n,state:i,push:a,replace:o}}function Ix(s){s=bx(s);const e=Rx(s),t=Lx(s,e.state,e.location,e.replace);function n(r,o=!0){o||t.pauseListeners(),history.go(r)}const i=gt({location:"",base:s,go:n,createHref:Sx.bind(null,s)},e,t);return Object.defineProperty(i,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(i,"state",{enumerable:!0,get:()=>e.state.value}),i}function Dx(s){return typeof s=="string"||s&&typeof s=="object"}function Ug(s){return typeof s=="string"||typeof s=="symbol"}const Qn={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},Hg=Symbol("");var Kh;(function(s){s[s.aborted=4]="aborted",s[s.cancelled=8]="cancelled",s[s.duplicated=16]="duplicated"})(Kh||(Kh={}));function jr(s,e){return gt(new Error,{type:s,[Hg]:!0},e)}function Ln(s,e){return s instanceof Error&&Hg in s&&(e==null||!!(s.type&e))}const Wh="[^/]+?",Px={sensitive:!1,strict:!1,start:!0,end:!0},Fx=/[.+*?^${}()[\]/\\]/g;function Ox(s,e){const t=gt({},Px,e),n=[];let i=t.start?"^":"";const r=[];for(const c of s){const u=c.length?[]:[90];t.strict&&!c.length&&(i+="/");for(let d=0;d<c.length;d++){const f=c[d];let h=40+(t.sensitive?.25:0);if(f.type===0)d||(i+="/"),i+=f.value.replace(Fx,"\\$&"),h+=40;else if(f.type===1){const{value:p,repeatable:g,optional:m,regexp:_}=f;r.push({name:p,repeatable:g,optional:m});const y=_||Wh;if(y!==Wh){h+=10;try{new RegExp(`(${y})`)}catch(C){throw new Error(`Invalid custom RegExp for param "${p}" (${y}): `+C.message)}}let S=g?`((?:${y})(?:/(?:${y}))*)`:`(${y})`;d||(S=m&&c.length<2?`(?:/${S})`:"/"+S),m&&(S+="?"),i+=S,h+=20,m&&(h+=-8),g&&(h+=-20),y===".*"&&(h+=-50)}u.push(h)}n.push(u)}if(t.strict&&t.end){const c=n.length-1;n[c][n[c].length-1]+=.7000000000000001}t.strict||(i+="/?"),t.end?i+="$":t.strict&&(i+="(?:/|$)");const o=new RegExp(i,t.sensitive?"":"i");function a(c){const u=c.match(o),d={};if(!u)return null;for(let f=1;f<u.length;f++){const h=u[f]||"",p=r[f-1];d[p.name]=h&&p.repeatable?h.split("/"):h}return d}function l(c){let u="",d=!1;for(const f of s){(!d||!u.endsWith("/"))&&(u+="/"),d=!1;for(const h of f)if(h.type===0)u+=h.value;else if(h.type===1){const{value:p,repeatable:g,optional:m}=h,_=p in c?c[p]:"";if(ln(_)&&!g)throw new Error(`Provided param "${p}" is an array but it is not repeatable (* or + modifiers)`);const y=ln(_)?_.join("/"):_;if(!y)if(m)f.length<2&&(u.endsWith("/")?u=u.slice(0,-1):d=!0);else throw new Error(`Missing required param "${p}"`);u+=y}}return u||"/"}return{re:o,score:n,keys:r,parse:a,stringify:l}}function Mx(s,e){let t=0;for(;t<s.length&&t<e.length;){const n=e[t]-s[t];if(n)return n;t++}return s.length<e.length?s.length===1&&s[0]===40+40?-1:1:s.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function $x(s,e){let t=0;const n=s.score,i=e.score;for(;t<n.length&&t<i.length;){const r=Mx(n[t],i[t]);if(r)return r;t++}if(Math.abs(i.length-n.length)===1){if(Yh(n))return 1;if(Yh(i))return-1}return i.length-n.length}function Yh(s){const e=s[s.length-1];return s.length>0&&e[e.length-1]<0}const Nx={type:0,value:""},Vx=/[a-zA-Z0-9_]/;function Bx(s){if(!s)return[[]];if(s==="/")return[[Nx]];if(!s.startsWith("/"))throw new Error(`Invalid path "${s}"`);function e(h){throw new Error(`ERR (${t})/"${c}": ${h}`)}let t=0,n=t;const i=[];let r;function o(){r&&i.push(r),r=[]}let a=0,l,c="",u="";function d(){!c||(t===0?r.push({type:0,value:c}):t===1||t===2||t===3?(r.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),r.push({type:1,value:c,regexp:u,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),c="")}function f(){c+=l}for(;a<s.length;){if(l=s[a++],l==="\\"&&t!==2){n=t,t=4;continue}switch(t){case 0:l==="/"?(c&&d(),o()):l===":"?(d(),t=1):f();break;case 4:f(),t=n;break;case 1:l==="("?t=2:Vx.test(l)?f():(d(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case 2:l===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+l:t=3:u+=l;break;case 3:d(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--,u="";break;default:e("Unknown state");break}}return t===2&&e(`Unfinished custom RegExp for param "${c}"`),d(),o(),i}function Ux(s,e,t){const n=Ox(Bx(s.path),t),i=gt(n,{record:s,parent:e,children:[],alias:[]});return e&&!i.record.aliasOf==!e.record.aliasOf&&e.children.push(i),i}function Hx(s,e){const t=[],n=new Map;e=Qh({strict:!1,end:!0,sensitive:!1},e);function i(u){return n.get(u)}function r(u,d,f){const h=!f,p=Gx(u);p.aliasOf=f&&f.record;const g=Qh(e,u),m=[p];if("alias"in u){const S=typeof u.alias=="string"?[u.alias]:u.alias;for(const C of S)m.push(gt({},p,{components:f?f.record.components:p.components,path:C,aliasOf:f?f.record:p}))}let _,y;for(const S of m){const{path:C}=S;if(d&&C[0]!=="/"){const E=d.record.path,A=E[E.length-1]==="/"?"":"/";S.path=d.record.path+(C&&A+C)}if(_=Ux(S,d,g),f?f.alias.push(_):(y=y||_,y!==_&&y.alias.push(_),h&&u.name&&!Xh(_)&&o(u.name)),p.children){const E=p.children;for(let A=0;A<E.length;A++)r(E[A],_,f&&f.children[A])}f=f||_,(_.record.components&&Object.keys(_.record.components).length||_.record.name||_.record.redirect)&&l(_)}return y?()=>{o(y)}:wo}function o(u){if(Ug(u)){const d=n.get(u);d&&(n.delete(u),t.splice(t.indexOf(d),1),d.children.forEach(o),d.alias.forEach(o))}else{const d=t.indexOf(u);d>-1&&(t.splice(d,1),u.record.name&&n.delete(u.record.name),u.children.forEach(o),u.alias.forEach(o))}}function a(){return t}function l(u){let d=0;for(;d<t.length&&$x(u,t[d])>=0&&(u.record.path!==t[d].record.path||!Gg(u,t[d]));)d++;t.splice(d,0,u),u.record.name&&!Xh(u)&&n.set(u.record.name,u)}function c(u,d){let f,h={},p,g;if("name"in u&&u.name){if(f=n.get(u.name),!f)throw jr(1,{location:u});g=f.record.name,h=gt(Zh(d.params,f.keys.filter(y=>!y.optional).map(y=>y.name)),u.params&&Zh(u.params,f.keys.map(y=>y.name))),p=f.stringify(h)}else if("path"in u)p=u.path,f=t.find(y=>y.re.test(p)),f&&(h=f.parse(p),g=f.record.name);else{if(f=d.name?n.get(d.name):t.find(y=>y.re.test(d.path)),!f)throw jr(1,{location:u,currentLocation:d});g=f.record.name,h=gt({},d.params,u.params),p=f.stringify(h)}const m=[];let _=f;for(;_;)m.unshift(_.record),_=_.parent;return{name:g,path:p,params:h,matched:m,meta:jx(m)}}return s.forEach(u=>r(u)),{addRoute:r,resolve:c,removeRoute:o,getRoutes:a,getRecordMatcher:i}}function Zh(s,e){const t={};for(const n of e)n in s&&(t[n]=s[n]);return t}function Gx(s){return{path:s.path,redirect:s.redirect,name:s.name,meta:s.meta||{},aliasOf:void 0,beforeEnter:s.beforeEnter,props:zx(s),children:s.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in s?s.components||null:s.component&&{default:s.component}}}function zx(s){const e={},t=s.props||!1;if("component"in s)e.default=t;else for(const n in s.components)e[n]=typeof t=="object"?t[n]:t;return e}function Xh(s){for(;s;){if(s.record.aliasOf)return!0;s=s.parent}return!1}function jx(s){return s.reduce((e,t)=>gt(e,t.meta),{})}function Qh(s,e){const t={};for(const n in s)t[n]=n in e?e[n]:s[n];return t}function Gg(s,e){return e.children.some(t=>t===s||Gg(s,t))}const zg=/#/g,qx=/&/g,Kx=/\//g,Wx=/=/g,Yx=/\?/g,jg=/\+/g,Zx=/%5B/g,Xx=/%5D/g,qg=/%5E/g,Qx=/%60/g,Kg=/%7B/g,Jx=/%7C/g,Wg=/%7D/g,eb=/%20/g;function nf(s){return encodeURI(""+s).replace(Jx,"|").replace(Zx,"[").replace(Xx,"]")}function tb(s){return nf(s).replace(Kg,"{").replace(Wg,"}").replace(qg,"^")}function Fu(s){return nf(s).replace(jg,"%2B").replace(eb,"+").replace(zg,"%23").replace(qx,"%26").replace(Qx,"`").replace(Kg,"{").replace(Wg,"}").replace(qg,"^")}function sb(s){return Fu(s).replace(Wx,"%3D")}function nb(s){return nf(s).replace(zg,"%23").replace(Yx,"%3F")}function ib(s){return s==null?"":nb(s).replace(Kx,"%2F")}function fl(s){try{return decodeURIComponent(""+s)}catch{}return""+s}function rb(s){const e={};if(s===""||s==="?")return e;const n=(s[0]==="?"?s.slice(1):s).split("&");for(let i=0;i<n.length;++i){const r=n[i].replace(jg," "),o=r.indexOf("="),a=fl(o<0?r:r.slice(0,o)),l=o<0?null:fl(r.slice(o+1));if(a in e){let c=e[a];ln(c)||(c=e[a]=[c]),c.push(l)}else e[a]=l}return e}function Jh(s){let e="";for(let t in s){const n=s[t];if(t=sb(t),n==null){n!==void 0&&(e+=(e.length?"&":"")+t);continue}(ln(n)?n.map(r=>r&&Fu(r)):[n&&Fu(n)]).forEach(r=>{r!==void 0&&(e+=(e.length?"&":"")+t,r!=null&&(e+="="+r))})}return e}function ob(s){const e={};for(const t in s){const n=s[t];n!==void 0&&(e[t]=ln(n)?n.map(i=>i==null?null:""+i):n==null?n:""+n)}return e}const ab=Symbol(""),e0=Symbol(""),sc=Symbol(""),rf=Symbol(""),Ou=Symbol("");function oo(){let s=[];function e(n){return s.push(n),()=>{const i=s.indexOf(n);i>-1&&s.splice(i,1)}}function t(){s=[]}return{add:e,list:()=>s.slice(),reset:t}}function ai(s,e,t,n,i){const r=n&&(n.enterCallbacks[i]=n.enterCallbacks[i]||[]);return()=>new Promise((o,a)=>{const l=d=>{d===!1?a(jr(4,{from:t,to:e})):d instanceof Error?a(d):Dx(d)?a(jr(2,{from:e,to:d})):(r&&n.enterCallbacks[i]===r&&typeof d=="function"&&r.push(d),o())},c=s.call(n&&n.instances[i],e,t,l);let u=Promise.resolve(c);s.length<3&&(u=u.then(l)),u.catch(d=>a(d))})}function Oc(s,e,t,n){const i=[];for(const r of s)for(const o in r.components){let a=r.components[o];if(!(e!=="beforeRouteEnter"&&!r.instances[o]))if(lb(a)){const c=(a.__vccOpts||a)[e];c&&i.push(ai(c,t,n,r,o))}else{let l=a();i.push(()=>l.then(c=>{if(!c)return Promise.reject(new Error(`Couldn't resolve component "${o}" at "${r.path}"`));const u=px(c)?c.default:c;r.components[o]=u;const f=(u.__vccOpts||u)[e];return f&&ai(f,t,n,r,o)()}))}}return i}function lb(s){return typeof s=="object"||"displayName"in s||"props"in s||"__vccOpts"in s}function t0(s){const e=Hs(sc),t=Hs(rf),n=ut(()=>e.resolve(w(s.to))),i=ut(()=>{const{matched:l}=n.value,{length:c}=l,u=l[c-1],d=t.matched;if(!u||!d.length)return-1;const f=d.findIndex(zr.bind(null,u));if(f>-1)return f;const h=s0(l[c-2]);return c>1&&s0(u)===h&&d[d.length-1].path!==h?d.findIndex(zr.bind(null,l[c-2])):f}),r=ut(()=>i.value>-1&&fb(t.params,n.value.params)),o=ut(()=>i.value>-1&&i.value===t.matched.length-1&&Vg(t.params,n.value.params));function a(l={}){return db(l)?e[w(s.replace)?"replace":"push"](w(s.to)).catch(wo):Promise.resolve()}return{route:n,href:ut(()=>n.value.href),isActive:r,isExactActive:o,navigate:a}}const cb=De({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:t0,setup(s,{slots:e}){const t=Ps(t0(s)),{options:n}=Hs(sc),i=ut(()=>({[n0(s.activeClass,n.linkActiveClass,"router-link-active")]:t.isActive,[n0(s.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const r=e.default&&e.default(t);return s.custom?r:tf("a",{"aria-current":t.isExactActive?s.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:i.value},r)}}}),ub=cb;function db(s){if(!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)&&!s.defaultPrevented&&!(s.button!==void 0&&s.button!==0)){if(s.currentTarget&&s.currentTarget.getAttribute){const e=s.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return s.preventDefault&&s.preventDefault(),!0}}function fb(s,e){for(const t in e){const n=e[t],i=s[t];if(typeof n=="string"){if(n!==i)return!1}else if(!ln(i)||i.length!==n.length||n.some((r,o)=>r!==i[o]))return!1}return!0}function s0(s){return s?s.aliasOf?s.aliasOf.path:s.path:""}const n0=(s,e,t)=>s!=null?s:e!=null?e:t,hb=De({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(s,{attrs:e,slots:t}){const n=Hs(Ou),i=ut(()=>s.route||n.value),r=Hs(e0,0),o=ut(()=>{let c=w(r);const{matched:u}=i.value;let d;for(;(d=u[c])&&!d.components;)c++;return c}),a=ut(()=>i.value.matched[o.value]);Ma(e0,ut(()=>o.value+1)),Ma(ab,a),Ma(Ou,i);const l=ue();return dt(()=>[l.value,a.value,s.name],([c,u,d],[f,h,p])=>{u&&(u.instances[d]=c,h&&h!==u&&c&&c===f&&(u.leaveGuards.size||(u.leaveGuards=h.leaveGuards),u.updateGuards.size||(u.updateGuards=h.updateGuards))),c&&u&&(!h||!zr(u,h)||!f)&&(u.enterCallbacks[d]||[]).forEach(g=>g(c))},{flush:"post"}),()=>{const c=i.value,u=s.name,d=a.value,f=d&&d.components[u];if(!f)return i0(t.default,{Component:f,route:c});const h=d.props[u],p=h?h===!0?c.params:typeof h=="function"?h(c):h:null,m=tf(f,gt({},p,e,{onVnodeUnmounted:_=>{_.component.isUnmounted&&(d.instances[u]=null)},ref:l}));return i0(t.default,{Component:m,route:c})||m}}});function i0(s,e){if(!s)return null;const t=s(e);return t.length===1?t[0]:t}const pb=hb;function gb(s){const e=Hx(s.routes,s),t=s.parseQuery||rb,n=s.stringifyQuery||Jh,i=s.history,r=oo(),o=oo(),a=oo(),l=my(Qn);let c=Qn;yr&&s.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=Pc.bind(null,K=>""+K),d=Pc.bind(null,ib),f=Pc.bind(null,fl);function h(K,me){let fe,Se;return Ug(K)?(fe=e.getRecordMatcher(K),Se=me):Se=K,e.addRoute(Se,fe)}function p(K){const me=e.getRecordMatcher(K);me&&e.removeRoute(me)}function g(){return e.getRoutes().map(K=>K.record)}function m(K){return!!e.getRecordMatcher(K)}function _(K,me){if(me=gt({},me||l.value),typeof K=="string"){const O=Fc(t,K,me.path),G=e.resolve({path:O.path},me),Q=i.createHref(O.fullPath);return gt(O,G,{params:f(G.params),hash:fl(O.hash),redirectedFrom:void 0,href:Q})}let fe;if("path"in K)fe=gt({},K,{path:Fc(t,K.path,me.path).path});else{const O=gt({},K.params);for(const G in O)O[G]==null&&delete O[G];fe=gt({},K,{params:d(O)}),me.params=d(me.params)}const Se=e.resolve(fe,me),it=K.hash||"";Se.params=u(f(Se.params));const lt=vx(n,gt({},K,{hash:tb(it),path:Se.path})),k=i.createHref(lt);return gt({fullPath:lt,hash:it,query:n===Jh?ob(K.query):K.query||{}},Se,{redirectedFrom:void 0,href:k})}function y(K){return typeof K=="string"?Fc(t,K,l.value.path):gt({},K)}function S(K,me){if(c!==K)return jr(8,{from:me,to:K})}function C(K){return R(K)}function E(K){return C(gt(y(K),{replace:!0}))}function A(K){const me=K.matched[K.matched.length-1];if(me&&me.redirect){const{redirect:fe}=me;let Se=typeof fe=="function"?fe(K):fe;return typeof Se=="string"&&(Se=Se.includes("?")||Se.includes("#")?Se=y(Se):{path:Se},Se.params={}),gt({query:K.query,hash:K.hash,params:"path"in Se?{}:K.params},Se)}}function R(K,me){const fe=c=_(K),Se=l.value,it=K.state,lt=K.force,k=K.replace===!0,O=A(fe);if(O)return R(gt(y(O),{state:typeof O=="object"?gt({},it,O.state):it,force:lt,replace:k}),me||fe);const G=fe;G.redirectedFrom=me;let Q;return!lt&&_x(n,Se,fe)&&(Q=jr(16,{to:G,from:Se}),Be(Se,Se,!0,!1)),(Q?Promise.resolve(Q):L(G,Se)).catch(Y=>Ln(Y)?Ln(Y,2)?Y:re(Y):xe(Y,G,Se)).then(Y=>{if(Y){if(Ln(Y,2))return R(gt({replace:k},y(Y.to),{state:typeof Y.to=="object"?gt({},it,Y.to.state):it,force:lt}),me||G)}else Y=$(G,Se,!0,k,it);return M(G,Se,Y),Y})}function I(K,me){const fe=S(K,me);return fe?Promise.reject(fe):Promise.resolve()}function D(K){const me=We.values().next().value;return me&&typeof me.runWithContext=="function"?me.runWithContext(K):K()}function L(K,me){let fe;const[Se,it,lt]=mb(K,me);fe=Oc(Se.reverse(),"beforeRouteLeave",K,me);for(const O of Se)O.leaveGuards.forEach(G=>{fe.push(ai(G,K,me))});const k=I.bind(null,K,me);return fe.push(k),Ue(fe).then(()=>{fe=[];for(const O of r.list())fe.push(ai(O,K,me));return fe.push(k),Ue(fe)}).then(()=>{fe=Oc(it,"beforeRouteUpdate",K,me);for(const O of it)O.updateGuards.forEach(G=>{fe.push(ai(G,K,me))});return fe.push(k),Ue(fe)}).then(()=>{fe=[];for(const O of lt)if(O.beforeEnter)if(ln(O.beforeEnter))for(const G of O.beforeEnter)fe.push(ai(G,K,me));else fe.push(ai(O.beforeEnter,K,me));return fe.push(k),Ue(fe)}).then(()=>(K.matched.forEach(O=>O.enterCallbacks={}),fe=Oc(lt,"beforeRouteEnter",K,me),fe.push(k),Ue(fe))).then(()=>{fe=[];for(const O of o.list())fe.push(ai(O,K,me));return fe.push(k),Ue(fe)}).catch(O=>Ln(O,8)?O:Promise.reject(O))}function M(K,me,fe){a.list().forEach(Se=>D(()=>Se(K,me,fe)))}function $(K,me,fe,Se,it){const lt=S(K,me);if(lt)return lt;const k=me===Qn,O=yr?history.state:{};fe&&(Se||k?i.replace(K.fullPath,gt({scroll:k&&O&&O.scroll},it)):i.push(K.fullPath,it)),l.value=K,Be(K,me,fe,k),re()}let H;function ie(){H||(H=i.listen((K,me,fe)=>{if(!ot.listening)return;const Se=_(K),it=A(Se);if(it){R(gt(it,{replace:!0}),Se).catch(wo);return}c=Se;const lt=l.value;yr&&Cx(jh(lt.fullPath,fe.delta),tc()),L(Se,lt).catch(k=>Ln(k,12)?k:Ln(k,2)?(R(k.to,Se).then(O=>{Ln(O,20)&&!fe.delta&&fe.type===Vo.pop&&i.go(-1,!1)}).catch(wo),Promise.reject()):(fe.delta&&i.go(-fe.delta,!1),xe(k,Se,lt))).then(k=>{k=k||$(Se,lt,!1),k&&(fe.delta&&!Ln(k,8)?i.go(-fe.delta,!1):fe.type===Vo.pop&&Ln(k,20)&&i.go(-1,!1)),M(Se,lt,k)}).catch(wo)}))}let te=oo(),X=oo(),de;function xe(K,me,fe){re(K);const Se=X.list();return Se.length?Se.forEach(it=>it(K,me,fe)):console.error(K),Promise.reject(K)}function le(){return de&&l.value!==Qn?Promise.resolve():new Promise((K,me)=>{te.add([K,me])})}function re(K){return de||(de=!K,ie(),te.list().forEach(([me,fe])=>K?fe(K):me()),te.reset()),K}function Be(K,me,fe,Se){const{scrollBehavior:it}=s;if(!yr||!it)return Promise.resolve();const lt=!fe&&Ax(jh(K.fullPath,0))||(Se||!fe)&&history.state&&history.state.scroll||null;return so().then(()=>it(K,me,lt)).then(k=>k&&Tx(k)).catch(k=>xe(k,K,me))}const be=K=>i.go(K);let Fe;const We=new Set,ot={currentRoute:l,listening:!0,addRoute:h,removeRoute:p,hasRoute:m,getRoutes:g,resolve:_,options:s,push:C,replace:E,go:be,back:()=>be(-1),forward:()=>be(1),beforeEach:r.add,beforeResolve:o.add,afterEach:a.add,onError:X.add,isReady:le,install(K){const me=this;K.component("RouterLink",ub),K.component("RouterView",pb),K.config.globalProperties.$router=me,Object.defineProperty(K.config.globalProperties,"$route",{enumerable:!0,get:()=>w(l)}),yr&&!Fe&&l.value===Qn&&(Fe=!0,C(i.location).catch(it=>{}));const fe={};for(const it in Qn)Object.defineProperty(fe,it,{get:()=>l.value[it],enumerable:!0});K.provide(sc,me),K.provide(rf,J1(fe)),K.provide(Ou,l);const Se=K.unmount;We.add(K),K.unmount=function(){We.delete(K),We.size<1&&(c=Qn,H&&H(),H=null,l.value=Qn,Fe=!1,de=!1),Se()}}};function Ue(K){return K.reduce((me,fe)=>me.then(()=>D(fe)),Promise.resolve())}return ot}function mb(s,e){const t=[],n=[],i=[],r=Math.max(e.matched.length,s.matched.length);for(let o=0;o<r;o++){const a=e.matched[o];a&&(s.matched.find(c=>zr(c,a))?n.push(a):t.push(a));const l=s.matched[o];l&&(e.matched.find(c=>zr(c,l))||i.push(l))}return[t,n,i]}function kn(){return Hs(sc)}function Xi(){return Hs(rf)}const hs=De({__name:"Input",props:{modelValue:{},textarea:{type:Boolean},disabled:{type:Boolean},required:{type:Boolean},min:{},max:{},rows:{},type:{},placeholder:{},transparent:{type:Boolean}},emits:["update:modelValue","blur","input"],setup(s,{emit:e}){const t=s,n=e,i=r=>{n("update:modelValue",r.target.value),n("input")};return(r,o)=>(x(),ae(vn(t.textarea?"textarea":"input"),{value:t.modelValue,onInput:i,onBlur:o[0]||(o[0]=a=>n("blur")),type:r.type,required:t.required,disabled:t.disabled,min:t.min,max:t.max,rows:t.rows,placeholder:t.placeholder,class:"w-full py-1.5 px-2 focus-visible:outline-none bg-zinc-800 focus:ring-2 ring-blue-500 disabled:opacity-70 rounded-md text-lg md:text-base"},null,40,["value","type","required","disabled","min","max","rows","placeholder"]))}}),vb={key:0,viewBox:"0 0 24 24"},_b=v("path",{fill:"currentColor",d:"M17.66 11.2C17.43 10.9 17.15 10.64 16.89 10.38C16.22 9.78 15.46 9.35 14.82 8.72C13.33 7.26 13 4.85 13.95 3C13 3.23 12.17 3.75 11.46 4.32C8.87 6.4 7.85 10.07 9.07 13.22C9.11 13.32 9.15 13.42 9.15 13.55C9.15 13.77 9 13.97 8.8 14.05C8.57 14.15 8.33 14.09 8.14 13.93C8.08 13.88 8.04 13.83 8 13.76C6.87 12.33 6.69 10.28 7.45 8.64C5.78 10 4.87 12.3 5 14.47C5.06 14.97 5.12 15.47 5.29 15.97C5.43 16.57 5.7 17.17 6 17.7C7.08 19.43 8.95 20.67 10.96 20.92C13.1 21.19 15.39 20.8 17.03 19.32C18.86 17.66 19.5 15 18.56 12.72L18.43 12.46C18.22 12 17.66 11.2 17.66 11.2M14.5 17.5C14.22 17.74 13.76 18 13.4 18.1C12.28 18.5 11.16 17.94 10.5 17.28C11.69 17 12.4 16.12 12.61 15.23C12.78 14.43 12.46 13.77 12.33 13C12.21 12.26 12.23 11.63 12.5 10.94C12.69 11.32 12.89 11.7 13.13 12C13.9 13 15.11 13.44 15.37 14.8C15.41 14.94 15.43 15.08 15.43 15.23C15.46 16.05 15.1 16.95 14.5 17.5H14.5Z"},null,-1),yb=[_b],xb={key:1,viewBox:"0 0 24 24"},bb=v("path",{fill:"currentColor",d:"M20,11H4V8H20M20,15H13V13H20M20,19H13V17H20M11,19H4V13H11M20.33,4.67L18.67,3L17,4.67L15.33,3L13.67,4.67L12,3L10.33,4.67L8.67,3L7,4.67L5.33,3L3.67,4.67L2,3V19A2,2 0 0,0 4,21H20A2,2 0 0,0 22,19V3L20.33,4.67Z"},null,-1),wb=[bb],Sb={key:2,viewBox:"0 0 24 24"},Eb=v("path",{fill:"currentColor",d:"M3,22V8H7V22H3M10,22V2H14V22H10M17,22V14H21V22H17Z"},null,-1),Tb=[Eb],Cb={key:3,viewBox:"0 0 24 24"},Ab=v("path",{fill:"currentColor",d:"M3,15H1V3A2,2 0 0,1 3,1H19V3H3V15M12,23A1,1 0 0,1 11,22V19H7A2,2 0 0,1 5,17V7A2,2 0 0,1 7,5H21A2,2 0 0,1 23,7V17A2,2 0 0,1 21,19H16.9L13.2,22.71C13,22.89 12.76,23 12.5,23H12M9,9V11H19V9H9M9,13V15H17V13H9Z"},null,-1),kb=[Ab],Lb={key:4,viewBox:"0 0 24 24"},Rb=v("path",{fill:"currentColor",d:"M23,10C23,8.89 22.1,8 21,8H14.68L15.64,3.43C15.66,3.33 15.67,3.22 15.67,3.11C15.67,2.7 15.5,2.32 15.23,2.05L14.17,1L7.59,7.58C7.22,7.95 7,8.45 7,9V19A2,2 0 0,0 9,21H18C18.83,21 19.54,20.5 19.84,19.78L22.86,12.73C22.95,12.5 23,12.26 23,12V10M1,21H5V9H1V21Z"},null,-1),Ib=[Rb],Db={key:5,viewBox:"0 0 24 24"},Pb=v("path",{fill:"currentColor",d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"},null,-1),Fb=[Pb],Ob={key:6,viewBox:"0 0 24 24"},Mb=v("path",{fill:"currentColor",d:"M12,4V2A10,10 0 0,0 2,12H4A8,8 0 0,1 12,4Z"},null,-1),$b=[Mb],Nb={key:7,viewBox:"0 0 24 24"},Vb=v("path",{fill:"currentColor",d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"},null,-1),Bb=[Vb],Ub={key:8,viewBox:"0 0 97 142",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Hb=v("g",{"clip-path":"url(#clip0_7_18)"},[v("path",{d:"M38.5965 19.2044V90.7908C38.5965 101.797 29.4502 110.801 18.4074 110.293C13.4567 110.048 8.78916 107.921 5.36689 104.352C1.94461 100.782 0.0284422 96.0415 0.0133561 91.1072V19.4969C0.0133561 9.12635 8.14455 0.417711 18.5463 0.0161828C21.1397 -0.0783716 23.7257 0.347554 26.1502 1.2686C28.5748 2.18964 30.7885 3.58696 32.6593 5.37736C34.5301 7.16775 36.0199 9.31461 37.0399 11.6901C38.0599 14.0656 38.5892 16.6211 38.5965 19.2044ZM81.937 65.0956V108.357H43.3619V65.0956C43.3619 62.5737 43.8609 60.0765 44.8304 57.7465C45.7999 55.4165 47.2209 53.2995 49.0123 51.5162C50.8037 49.7329 52.9303 48.3184 55.2709 47.3533C57.6115 46.3882 60.12 45.8914 62.6535 45.8914C65.1869 45.8914 67.6954 46.3882 70.036 47.3533C72.3766 48.3184 74.5033 49.7329 76.2946 51.5162C78.086 53.2995 79.507 55.4165 80.4765 57.7465C81.446 60.0765 81.945 62.5737 81.945 65.0956H81.937ZM13.9224 125.862V134.653H9.93159V126.708C9.93159 124.708 8.94057 123.498 7.38592 123.498C5.37449 123.498 3.98813 124.849 3.98813 127.383V134.653H0V113.5H3.98813V122.99C4.89367 120.961 6.53647 120.031 8.60133 120.031C12.0258 120.031 13.9224 122.371 13.9224 125.862ZM15.8751 127.412C15.8751 123.075 18.4234 120.031 22.5264 120.031C24.4764 120.031 26.2661 120.905 26.9686 122.371H26.998V120.342H30.9861V134.653H26.998V132.454H26.9686C26.2047 134.004 24.4497 134.962 22.5264 134.962C18.4234 134.962 15.8751 131.896 15.8751 127.412ZM27.1102 127.553V127.375C27.1102 124.841 25.609 123.208 23.4319 123.208C21.3083 123.208 19.8098 124.87 19.8098 127.404C19.8098 130.109 21.3083 131.771 23.4319 131.771C25.609 131.779 27.1102 130.146 27.1102 127.553ZM47.9377 125.862V134.653H43.9496V126.708C43.9496 124.708 42.9585 123.498 41.4039 123.498C39.3925 123.498 38.0061 124.849 38.0061 127.383V134.653H34.018V120.342H38.0061V123.001C38.9117 120.972 40.5545 120.041 42.6193 120.041C46.0438 120.031 47.9377 122.371 47.9377 125.862ZM49.8824 127.412C49.8824 123.075 52.4307 120.031 56.5337 120.031C58.4863 120.031 60.439 120.905 61.1442 122.371H61.1736V113.5H65.1644V134.653H61.1843V132.454H61.1549C60.4203 134.004 58.4676 134.962 56.5444 134.962C52.4414 134.962 49.8824 131.896 49.8824 127.412ZM53.8171 127.412C53.8171 130.117 55.3156 131.779 57.4392 131.779C59.6163 131.779 61.1175 130.146 61.1175 127.553V127.375C61.1175 124.841 59.6163 123.208 57.4392 123.208C55.3263 123.216 53.8277 124.878 53.8277 127.412H53.8171ZM81.937 136.001C81.937 139.607 78.9586 142 74.8262 142C70.6938 142 67.9211 140.03 67.5551 136.536H71.5994C71.9119 137.972 73.1006 138.958 74.8048 138.958C76.6159 138.958 77.9462 137.804 77.9462 136.225V131.438C77.0406 133.326 75.4272 134.198 73.4478 134.198C70.1649 134.198 68.0146 132.002 68.0146 128.141V120.342H72.0054V127.497C72.0054 129.526 72.967 130.736 74.5511 130.736C76.5598 130.736 77.9462 129.356 77.9462 126.849V120.342H81.937V136.001ZM88.8821 114.398H86.7291V120.32H85.6767V114.398H83.4996V113.492H88.8821V114.398ZM97.0053 113.492V120.32H95.9903V115.162L93.6503 117.885H93.3832L91.0191 115.143V120.323H90.0041V113.492H90.9176L93.506 116.627L96.1185 113.492H97.0053Z",fill:"currentColor"})],-1),Gb=v("defs",null,[v("clipPath",{id:"clip0_7_18"},[v("rect",{width:"97",height:"142",fill:"white"})])],-1),zb=[Hb,Gb],jb={key:9,viewBox:"0 0 24 24"},qb=v("path",{fill:"currentColor",d:"M14.88,16.29L13,18.17V14.41M13,5.83L14.88,7.71L13,9.58M17.71,7.71L12,2H11V9.58L6.41,5L5,6.41L10.59,12L5,17.58L6.41,19L11,14.41V22H12L17.71,16.29L13.41,12L17.71,7.71Z"},null,-1),Kb=[qb],Wb={key:10,viewBox:"0 0 24 24"},Yb=v("path",{fill:"currentColor",d:"M8 2C6.9 2 6 2.9 6 4V12H5V16L9 20V22H15V20L19 16V12H18V4C18 2.9 17.11 2 16 2M8 4H16V12H8M9 7V9H11V7M13 7V9H15V7Z"},null,-1),Zb=[Yb],Xb={key:11,viewBox:"0 0 24 24"},Qb=v("path",{fill:"currentColor",d:"M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z"},null,-1),Jb=[Qb],ew={key:12,viewBox:"0 0 24 24"},tw=v("path",{fill:"currentColor",d:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"},null,-1),sw=[tw],nw={key:13,viewBox:"0 0 24 24"},iw=v("path",{fill:"currentColor",d:"M12,19.2C9.5,19.2 7.29,17.92 6,16C6.03,14 10,12.9 12,12.9C14,12.9 17.97,14 18,16C16.71,17.92 14.5,19.2 12,19.2M12,5A3,3 0 0,1 15,8A3,3 0 0,1 12,11A3,3 0 0,1 9,8A3,3 0 0,1 12,5M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2Z"},null,-1),rw=[iw],ow={key:14,viewBox:"0 0 24 24"},aw=v("path",{fill:"currentColor",d:"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z"},null,-1),lw=[aw],cw={key:15,viewBox:"0 0 24 24"},uw=v("path",{fill:"currentColor",d:"M18,16L14,12.8V16H6V8H14V11.2L18,8M20,4H4A2,2 0 0,0 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.1,4 20,4Z"},null,-1),dw=[uw],fw={key:16,viewBox:"0 0 24 24"},hw=v("path",{fill:"currentColor",d:"M21 8C19.5 8 18.7 9.4 19.1 10.5L15.5 14.1C15.2 14 14.8 14 14.5 14.1L11.9 11.5C12.3 10.4 11.5 9 10 9C8.6 9 7.7 10.4 8.1 11.5L3.5 16C2.4 15.7 1 16.5 1 18C1 19.1 1.9 20 3 20C4.4 20 5.3 18.6 4.9 17.5L9.4 12.9C9.7 13 10.1 13 10.4 12.9L13 15.5C12.7 16.5 13.5 18 15 18C16.5 18 17.3 16.6 16.9 15.5L20.5 11.9C21.6 12.2 23 11.4 23 10C23 8.9 22.1 8 21 8M15 9L15.9 6.9L18 6L15.9 5.1L15 3L14.1 5.1L12 6L14.1 6.9L15 9M3.5 11L4 9L6 8.5L4 8L3.5 6L3 8L1 8.5L3 9L3.5 11Z"},null,-1),pw=[hw],gw={key:17,viewBox:"0 0 24 24"},mw=v("path",{fill:"currentColor",d:"M21.41 11.58L12.41 2.58A2 2 0 0 0 11 2H4A2 2 0 0 0 2 4V11A2 2 0 0 0 2.59 12.41L11.59 21.41A2 2 0 0 0 13 22A2 2 0 0 0 14.41 21.41L21.41 14.41A2 2 0 0 0 22 13A2 2 0 0 0 21.41 11.58M6.5 8A1.5 1.5 0 1 1 8 6.5A1.5 1.5 0 0 1 6.5 8M11.59 15.41L7.59 11.41L9 10L13 14M15.59 14.41L10.09 8.91L11.5 7.5L17 13Z"},null,-1),vw=[mw],_w={key:18,viewBox:"0 0 24 24"},yw=v("path",{fill:"currentColor",d:"M19.5 1L18.41 3.41L16 4.5L18.41 5.59L19.5 8L20.6 5.59L23 4.5L20.6 3.41L19.5 1M12 2C6.5 2 2 6.5 2 12V22H22V12C22 10.53 21.67 9.13 21.1 7.87L19.86 10.59C19.94 11.05 20 11.5 20 12C20 16.43 16.43 20 12 20C7.57 20 4 16.43 4 12C4 11.96 4 11.91 4 11.87A10 10 0 0 0 9.74 6.31A10 10 0 0 0 17.5 10A10 10 0 0 0 18.83 9.91L17.35 6.65L12.6 4.5L16.13 2.9C14.87 2.33 13.47 2 12 2M9 11.75A1.25 1.25 0 0 0 7.75 13A1.25 1.25 0 0 0 9 14.25A1.25 1.25 0 0 0 10.25 13A1.25 1.25 0 0 0 9 11.75M15 11.75A1.25 1.25 0 0 0 13.75 13A1.25 1.25 0 0 0 15 14.25A1.25 1.25 0 0 0 16.25 13A1.25 1.25 0 0 0 15 11.75Z"},null,-1),xw=[yw],bw={key:19,viewBox:"0 0 24 24"},ww=v("path",{fill:"currentColor",d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"},null,-1),Sw=[ww],Ew={key:20,viewBox:"0 0 24 24"},Tw=v("path",{fill:"currentColor",d:"M12,16A3,3 0 0,1 9,13C9,11.88 9.61,10.9 10.5,10.39L20.21,4.77L14.68,14.35C14.18,15.33 13.17,16 12,16M12,3C13.81,3 15.5,3.5 16.97,4.32L14.87,5.53C14,5.19 13,5 12,5A8,8 0 0,0 4,13C4,15.21 4.89,17.21 6.34,18.65H6.35C6.74,19.04 6.74,19.67 6.35,20.06C5.96,20.45 5.32,20.45 4.93,20.07V20.07C3.12,18.26 2,15.76 2,13A10,10 0 0,1 12,3M22,13C22,15.76 20.88,18.26 19.07,20.07V20.07C18.68,20.45 18.05,20.45 17.66,20.06C17.27,19.67 17.27,19.04 17.66,18.65V18.65C19.11,17.2 20,15.21 20,13C20,12 19.81,11 19.46,10.1L20.67,8C21.5,9.5 22,11.18 22,13Z"},null,-1),Cw=[Tw],Aw={key:21,viewBox:"0 0 24 24"},kw=v("path",{fill:"currentColor",d:"M12,21.35L10.55,20.03C5.4,15.36 2,12.27 2,8.5C2,5.41 4.42,3 7.5,3C9.24,3 10.91,3.81 12,5.08C13.09,3.81 14.76,3 16.5,3C19.58,3 22,5.41 22,8.5C22,12.27 18.6,15.36 13.45,20.03L12,21.35Z"},null,-1),Lw=[kw],Rw={key:22,viewBox:"0 0 24 24"},Iw=v("path",{fill:"currentColor",d:"M12,9A3,3 0 0,1 15,12A3,3 0 0,1 12,15A3,3 0 0,1 9,12A3,3 0 0,1 12,9M12,4.5C17,4.5 21.27,7.61 23,12C21.27,16.39 17,19.5 12,19.5C7,19.5 2.73,16.39 1,12C2.73,7.61 7,4.5 12,4.5M3.18,12C4.83,15.36 8.24,17.5 12,17.5C15.76,17.5 19.17,15.36 20.82,12C19.17,8.64 15.76,6.5 12,6.5C8.24,6.5 4.83,8.64 3.18,12Z"},null,-1),Dw=[Iw],Pw={key:23,viewBox:"0 0 24 24"},Fw=v("path",{fill:"currentColor",d:"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"},null,-1),Ow=[Fw],Mw={key:24,viewBox:"0 0 24 24"},$w=v("path",{fill:"currentColor",d:"M21,19V20H3V19L5,17V11C5,7.9 7.03,5.17 10,4.29C10,4.19 10,4.1 10,4A2,2 0 0,1 12,2A2,2 0 0,1 14,4C14,4.1 14,4.19 14,4.29C16.97,5.17 19,7.9 19,11V17L21,19M14,21A2,2 0 0,1 12,23A2,2 0 0,1 10,21"},null,-1),Nw=[$w],Vw={key:25,viewBox:"0 0 24 24"},Bw=v("path",{fill:"currentColor",d:"M10 21H14C14 22.1 13.1 23 12 23S10 22.1 10 21M21 19V20H3V19L5 17V11C5 7.9 7 5.2 10 4.3V4C10 2.9 10.9 2 12 2S14 2.9 14 4V4.3C17 5.2 19 7.9 19 11V17L21 19M17 11C17 8.2 14.8 6 12 6S7 8.2 7 11V18H17V11Z"},null,-1),Uw=[Bw],Hw={key:26,viewBox:"0 0 24 24"},Gw=v("path",{fill:"currentColor",d:"M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z"},null,-1),zw=[Gw],jw={key:27,viewBox:"0 0 24 24"},qw=v("path",{fill:"currentColor",d:"M8,5.14V19.14L19,12.14L8,5.14Z"},null,-1),Kw=[qw],Ww={key:28,viewBox:"0 0 24 24"},Yw=v("path",{fill:"currentColor",d:"M14,3.23V5.29C16.89,6.15 19,8.83 19,12C19,15.17 16.89,17.84 14,18.7V20.77C18,19.86 21,16.28 21,12C21,7.72 18,4.14 14,3.23M16.5,12C16.5,10.23 15.5,8.71 14,7.97V16C15.5,15.29 16.5,13.76 16.5,12M3,9V15H7L12,20V4L7,9H3Z"},null,-1),Zw=[Yw],Xw={key:29,viewBox:"0 0 24 24"},Qw=v("path",{fill:"currentColor",d:"M10,21V19H6.41L10.91,14.5L9.5,13.09L5,17.59V14H3V21H10M14.5,10.91L19,6.41V10H21V3H14V5H17.59L13.09,9.5L14.5,10.91Z"},null,-1),Jw=[Qw],eS={key:30,viewBox:"0 0 24 24"},tS=v("path",{fill:"currentColor",d:"M14.5,13.5H16.5V10.5H14.5M18,14A1,1 0 0,1 17,15H16.25V16.5H14.75V15H14A1,1 0 0,1 13,14V10A1,1 0 0,1 14,9H17A1,1 0 0,1 18,10M11,15H9.5V13H7.5V15H6V9H7.5V11.5H9.5V9H11M19,4H5C3.89,4 3,4.89 3,6V18A2,2 0 0,0 5,20H19A2,2 0 0,0 21,18V6C21,4.89 20.1,4 19,4Z"},null,-1),sS=[tS],nS={key:31,viewBox:"0 0 24 24"},iS=v("path",{fill:"currentColor",d:"M14,19H18V5H14M6,19H10V5H6V19Z"},null,-1),rS=[iS],oS={key:32,viewBox:"0 0 24 24"},aS=v("path",{fill:"currentColor",d:"M19.5,3.09L15,7.59V4H13V11H20V9H16.41L20.91,4.5L19.5,3.09M4,13V15H7.59L3.09,19.5L4.5,20.91L9,16.41V20H11V13H4Z"},null,-1),lS=[aS],cS={key:33,viewBox:"0 0 24 24"},uS=v("path",{fill:"currentColor",d:"M14.08,15.59L16.67,13H7V11H16.67L14.08,8.41L15.5,7L20.5,12L15.5,17L14.08,15.59M19,3A2,2 0 0,1 21,5V9.67L19,7.67V5H5V19H19V16.33L21,14.33V19A2,2 0 0,1 19,21H5C3.89,21 3,20.1 3,19V5C3,3.89 3.89,3 5,3H19Z"},null,-1),dS=[uS],fS={key:34,viewBox:"0 0 24 24"},hS=v("path",{fill:"currentColor",d:"M12,9A3,3 0 0,1 15,12A3,3 0 0,1 12,15A3,3 0 0,1 9,12A3,3 0 0,1 12,9M12,4.5C17,4.5 21.27,7.61 23,12C21.27,16.39 17,19.5 12,19.5C7,19.5 2.73,16.39 1,12C2.73,7.61 7,4.5 12,4.5M3.18,12C4.83,15.36 8.24,17.5 12,17.5C15.76,17.5 19.17,15.36 20.82,12C19.17,8.64 15.76,6.5 12,6.5C8.24,6.5 4.83,8.64 3.18,12Z"},null,-1),pS=[hS],gS={key:35,viewBox:"0 0 24 24"},mS=v("path",{fill:"currentColor",d:"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"},null,-1),vS=[mS],_S={key:36,viewBox:"0 0 24 24"},yS=v("path",{fill:"currentColor",d:"M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z"},null,-1),xS=[yS],bS={key:37,viewBox:"0 0 24 24"},wS=v("path",{fill:"currentColor",d:"M12,5.5A3.5,3.5 0 0,1 15.5,9A3.5,3.5 0 0,1 12,12.5A3.5,3.5 0 0,1 8.5,9A3.5,3.5 0 0,1 12,5.5M5,8C5.56,8 6.08,8.15 6.53,8.42C6.38,9.85 6.8,11.27 7.66,12.38C7.16,13.34 6.16,14 5,14A3,3 0 0,1 2,11A3,3 0 0,1 5,8M19,8A3,3 0 0,1 22,11A3,3 0 0,1 19,14C17.84,14 16.84,13.34 16.34,12.38C17.2,11.27 17.62,9.85 17.47,8.42C17.92,8.15 18.44,8 19,8M5.5,18.25C5.5,16.18 8.41,14.5 12,14.5C15.59,14.5 18.5,16.18 18.5,18.25V20H5.5V18.25M0,20V18.5C0,17.11 1.89,15.94 4.45,15.6C3.86,16.28 3.5,17.22 3.5,18.25V20H0M24,20H20.5V18.25C20.5,17.22 20.14,16.28 19.55,15.6C22.11,15.94 24,17.11 24,18.5V20Z"},null,-1),SS=[wS],ES={key:38,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},TS=v("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"},null,-1),CS=[TS],AS={key:39,viewBox:"0 0 24 24"},kS=v("path",{fill:"currentColor",d:"M13 14H11V9H13M13 18H11V16H13M1 21H23L12 2L1 21Z"},null,-1),LS=[kS],RS={key:40,viewBox:"0 0 24 24"},IS=v("path",{fill:"currentColor",d:"M21,3H3C1.89,3 1,3.89 1,5V17A2,2 0 0,0 3,19H8V21H16V19H21A2,2 0 0,0 23,17V5C23,3.89 22.1,3 21,3M21,17H3V5H21M16,11L9,15V7"},null,-1),DS=[IS],PS={key:41,viewBox:"0 0 24 24"},FS=v("path",{fill:"currentColor",d:"M11,13.5V21.5H3V13.5H11M12,2L17.5,11H6.5L12,2M17.5,13C20,13 22,15 22,17.5C22,20 20,22 17.5,22C15,22 13,20 13,17.5C13,15 15,13 17.5,13Z"},null,-1),OS=[FS],MS={key:42,viewBox:"0 0 24 24"},$S=v("path",{fill:"currentColor",d:"M13,6V18L21.5,12M4,18L12.5,12L4,6V18Z"},null,-1),NS=[$S],VS={key:43,viewBox:"0 0 24 24"},BS=v("path",{fill:"currentColor",d:"M10.6 9.6L9 15L7.4 9.6L2 8L7.4 6.4L9 1L10.6 6.4L16 8L10.6 9.6M17 14.2L21 12L18.8 16L21 20L17 17.8L13 20L15.2 16L13 12L17 14.2M10 16L8.3 19L10 22L7 20.3L4 22L5.7 19L4 16L7 17.7L10 16"},null,-1),US=[BS],HS={key:44,viewBox:"0 0 24 24"},GS=v("path",{fill:"currentColor",d:"M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"},null,-1),zS=[GS],jS={key:45,viewBox:"0 0 24 24"},qS=v("path",{fill:"currentColor",d:"M3,15H1V3A2,2 0 0,1 3,1H19V3H3V15M12,23A1,1 0 0,1 11,22V19H7A2,2 0 0,1 5,17V7A2,2 0 0,1 7,5H21A2,2 0 0,1 23,7V17A2,2 0 0,1 21,19H16.9L13.2,22.71C13,22.89 12.76,23 12.5,23H12M9,9V11H19V9H9M9,13V15H17V13H9Z"},null,-1),KS=[qS],WS={key:46,viewBox:"0 0 24 24"},YS=v("path",{fill:"currentColor",d:"M4 6H2V20C2 21.1 2.9 22 4 22H18V20H4V6M20 4V16H8V4H20M20 2H8C6.9 2 6 2.9 6 4V16C6 17.1 6.9 18 8 18H20C21.1 18 22 17.1 22 16V4C22 2.9 21.1 2 20 2M12 14.5V5.5L18 10L12 14.5Z"},null,-1),ZS=[YS],XS={key:47,viewBox:"0 0 24 24"},QS=v("path",{fill:"currentColor",d:"M14.19,14.19L6,18L9.81,9.81L18,6M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,10.9A1.1,1.1 0 0,0 10.9,12A1.1,1.1 0 0,0 12,13.1A1.1,1.1 0 0,0 13.1,12A1.1,1.1 0 0,0 12,10.9Z"},null,-1),JS=[QS],eE={key:48,viewBox:"0 0 24 24"},tE=v("path",{fill:"currentColor",d:"M17,10.5V7A1,1 0 0,0 16,6H4A1,1 0 0,0 3,7V17A1,1 0 0,0 4,18H16A1,1 0 0,0 17,17V13.5L21,17.5V6.5L17,10.5M14,13H11V16H9V13H6V11H9V8H11V11H14V13Z"},null,-1),sE=[tE],nE={key:49,viewBox:"0 0 24 24"},iE=v("path",{fill:"currentColor",d:"M18 21L14 17H17V7H14L18 3L22 7H19V17H22M2 19V17H12V19M2 13V11H9V13M2 7V5H6V7H2Z"},null,-1),rE=[iE],oE={key:50,viewBox:"0 0 240 240",fill:"none",xmlns:"http://www.w3.org/2000/svg"},aE=Yo('<mask id="mask0_2_58" style="mask-type:alpha;" maskUnits="userSpaceOnUse" x="0" y="0" width="240" height="240"><path fill-rule="evenodd" clip-rule="evenodd" d="M240 0H0V240H240V0ZM132.762 49.0014C123.177 48.9181 113.943 52.6027 107.049 59.2616C107.011 59.2978 106.974 59.3343 106.937 59.3712L99.3595 66.949C95.8448 70.4637 95.8448 76.1622 99.3595 79.6769C102.874 83.1916 108.573 83.1916 112.087 79.6769L119.604 72.16C123.099 68.8107 127.764 66.9586 132.606 67.0007C137.471 67.043 142.125 68.9944 145.565 72.4348C149.006 75.8752 150.957 80.5291 150.999 85.3943C151.041 90.2359 149.189 94.9012 145.84 98.3953L118.346 125.889L118.345 125.89C114.866 129.368 110.147 131.322 105.227 131.322C100.307 131.322 95.5884 129.368 92.1087 125.889C88.5935 122.375 82.895 122.376 79.3808 125.891C75.8666 129.407 75.8675 135.105 79.3827 138.619C86.2379 145.472 95.5343 149.322 105.227 149.322C114.921 149.322 124.217 145.472 131.072 138.619L131.073 138.618L158.629 111.063C158.666 111.026 158.702 110.989 158.738 110.951C165.397 104.057 169.082 94.8227 168.999 85.2379C168.915 75.6532 165.071 66.4846 158.293 59.7069C151.515 52.9292 142.347 49.0847 132.762 49.0014ZM91.4497 90.0006C81.7565 90.0006 72.4601 93.8505 65.6049 100.704L65.604 100.705L38.0999 128.209C34.6366 131.569 31.8727 135.582 29.9678 140.016C28.052 144.476 27.0436 149.273 27.0014 154.127C26.9592 158.981 27.8841 163.794 29.7222 168.287C31.5602 172.779 34.2746 176.861 37.7069 180.293C41.1392 183.725 45.2207 186.44 49.7132 188.278C54.2058 190.116 59.0194 191.041 63.8732 190.999C68.727 190.956 73.5238 189.948 77.9838 188.032C82.4175 186.128 86.4299 183.364 89.79 179.902L97.3286 172.37C100.845 168.857 100.847 163.158 97.3344 159.642C93.8212 156.126 88.1227 156.123 84.6064 159.636L77.0149 167.221C76.977 167.259 76.9395 167.297 76.9023 167.335C75.1907 169.107 73.1431 170.521 70.8793 171.494C68.6154 172.466 66.1806 172.978 63.7168 172.999C61.253 173.021 58.8096 172.551 56.5292 171.618C54.2488 170.685 52.177 169.307 50.4348 167.565C48.6926 165.823 47.3148 163.751 46.3818 161.471C45.4488 159.19 44.9793 156.747 45.0007 154.283C45.0221 151.819 45.534 149.385 46.5065 147.121C47.4789 144.857 48.8925 142.809 50.6648 141.098C50.7023 141.061 50.7395 141.025 50.7763 140.988L78.3309 113.433L78.3319 113.432C81.8115 109.954 86.5299 108.001 91.4497 108.001C96.37 108.001 101.089 109.955 104.568 113.433C108.084 116.948 113.782 116.947 117.296 113.432C120.811 109.916 120.81 104.218 117.294 100.704C110.439 93.8505 101.143 90.0006 91.4497 90.0006Z" fill="#FF0000"></path></mask><g mask="url(#mask0_2_58)"><path d="M0 65C0 29.1015 29.1015 0 65 0H175C210.899 0 240 29.1015 240 65V175C240 210.899 210.899 240 175 240H65C29.1015 240 0 210.899 0 175V65Z" fill="white" fill-opacity="0.6"></path><path d="M0 65C0 29.1015 29.1015 0 65 0H131C166.899 0 196 29.1015 196 65V175C196 210.899 166.899 240 131 240H65C29.1015 240 0 210.899 0 175V65Z" fill="white"></path></g>',2),lE=[aE],cE={key:51,viewBox:"0 0 24 24"},uE=v("path",{fill:"currentColor",d:"M12 5.69L17 10.19V18H15V12H9V18H7V10.19L12 5.69M12 3L2 12H5V20H11V14H13V20H19V12H22"},null,-1),dE=[uE],fE={key:52,viewBox:"0 0 24 24"},hE=v("path",{fill:"currentColor",d:"M12,5A3.5,3.5 0 0,0 8.5,8.5A3.5,3.5 0 0,0 12,12A3.5,3.5 0 0,0 15.5,8.5A3.5,3.5 0 0,0 12,5M12,7A1.5,1.5 0 0,1 13.5,8.5A1.5,1.5 0 0,1 12,10A1.5,1.5 0 0,1 10.5,8.5A1.5,1.5 0 0,1 12,7M5.5,8A2.5,2.5 0 0,0 3,10.5C3,11.44 3.53,12.25 4.29,12.68C4.65,12.88 5.06,13 5.5,13C5.94,13 6.35,12.88 6.71,12.68C7.08,12.47 7.39,12.17 7.62,11.81C6.89,10.86 6.5,9.7 6.5,8.5C6.5,8.41 6.5,8.31 6.5,8.22C6.2,8.08 5.86,8 5.5,8M18.5,8C18.14,8 17.8,8.08 17.5,8.22C17.5,8.31 17.5,8.41 17.5,8.5C17.5,9.7 17.11,10.86 16.38,11.81C16.5,12 16.63,12.15 16.78,12.3C16.94,12.45 17.1,12.58 17.29,12.68C17.65,12.88 18.06,13 18.5,13C18.94,13 19.35,12.88 19.71,12.68C20.47,12.25 21,11.44 21,10.5A2.5,2.5 0 0,0 18.5,8M12,14C9.66,14 5,15.17 5,17.5V19H19V17.5C19,15.17 14.34,14 12,14M4.71,14.55C2.78,14.78 0,15.76 0,17.5V19H3V17.07C3,16.06 3.69,15.22 4.71,14.55M19.29,14.55C20.31,15.22 21,16.06 21,17.07V19H24V17.5C24,15.76 21.22,14.78 19.29,14.55M12,16C13.53,16 15.24,16.5 16.23,17H7.77C8.76,16.5 10.47,16 12,16Z"},null,-1),pE=[hE],gE={key:53,viewBox:"0 0 24 24"},mE=v("path",{fill:"currentColor",d:"M7,17L10.2,10.2L17,7L13.8,13.8L7,17M12,11.1A0.9,0.9 0 0,0 11.1,12A0.9,0.9 0 0,0 12,12.9A0.9,0.9 0 0,0 12.9,12A0.9,0.9 0 0,0 12,11.1M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4Z"},null,-1),vE=[mE],_E={key:54,viewBox:"0 0 24 24"},yE=v("path",{fill:"currentColor",d:"M11,13.5V21.5H3V13.5H11M9,15.5H5V19.5H9V15.5M12,2L17.5,11H6.5L12,2M12,5.86L10.08,9H13.92L12,5.86M17.5,13C20,13 22,15 22,17.5C22,20 20,22 17.5,22C15,22 13,20 13,17.5C13,15 15,13 17.5,13M17.5,15A2.5,2.5 0 0,0 15,17.5A2.5,2.5 0 0,0 17.5,20A2.5,2.5 0 0,0 20,17.5A2.5,2.5 0 0,0 17.5,15Z"},null,-1),xE=[yE],bE={key:55,viewBox:"0 0 24 24"},wE=v("path",{fill:"currentColor",d:"M19.5 1L18.41 3.41L16 4.5L18.41 5.59L19.5 8L20.6 5.59L23 4.5L20.6 3.41M12 2C6.5 2 2 6.5 2 12V22H22V12C22 10.53 21.67 9.13 21.1 7.87L19.86 10.57C19.95 11.04 20 11.5 20 12C20 16.43 16.43 20 12 20C7.57 20 4 16.43 4 12C4 11.95 4 11.91 4 11.86C6.61 10.89 8.69 8.88 9.74 6.31C11.61 8.61 14.44 10 17.5 10C17.94 10 18.39 9.97 18.83 9.91L17.96 8C17.81 8 17.65 8 17.5 8C14.68 8 12.1 6.5 10.66 4.12C11.1 4.05 11.54 4 12 4C12.5 4 12.96 4.05 13.42 4.13L16.13 2.91C14.87 2.33 13.47 2 12 2M8.09 5C7.46 6.91 6.15 8.5 4.41 9.5C5.04 7.57 6.37 6 8.09 5M9 11.75C8.31 11.75 7.75 12.31 7.75 13C7.75 13.69 8.31 14.25 9 14.25C9.69 14.25 10.25 13.69 10.25 13C10.25 12.31 9.69 11.75 9 11.75M15 11.75C14.31 11.75 13.75 12.31 13.75 13C13.75 13.69 14.31 14.25 15 14.25C15.69 14.25 16.25 13.69 16.25 13C16.25 12.31 15.69 11.75 15 11.75M4 17.97C4.58 18.74 5.26 19.42 6.03 20H4M20 17.97V20H17.97C18.74 19.42 19.42 18.74 20 17.97Z"},null,-1),SE=[wE],EE={key:56,viewBox:"0 0 24 24"},TE=v("path",{fill:"currentColor",d:"M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z"},null,-1),CE=[TE],AE={key:57,viewBox:"0 0 24 24"},kE=v("path",{fill:"currentColor",d:"M5.41,21L6.12,17H2.12L2.47,15H6.47L7.53,9H3.53L3.88,7H7.88L8.59,3H10.59L9.88,7H15.88L16.59,3H18.59L17.88,7H21.88L21.53,9H17.53L16.47,15H20.47L20.12,17H16.12L15.41,21H13.41L14.12,17H8.12L7.41,21H5.41M9.53,9L8.47,15H14.47L15.53,9H9.53Z"},null,-1),LE=[kE],RE={key:58,viewBox:"0 0 24 24"},IE=v("path",{fill:"currentColor",d:"M10 16.5L16 12L10 7.5M22 12C22 6.46 17.54 2 12 2C10.83 2 9.7 2.19 8.62 2.56L9.32 4.5C10.17 4.16 11.06 3.97 12 3.97C16.41 3.97 20.03 7.59 20.03 12C20.03 16.41 16.41 20.03 12 20.03C7.59 20.03 3.97 16.41 3.97 12C3.97 11.06 4.16 10.12 4.5 9.28L2.56 8.62C2.19 9.7 2 10.83 2 12C2 17.54 6.46 22 12 22C17.54 22 22 17.54 22 12M5.47 3.97C6.32 3.97 7 4.68 7 5.47C7 6.32 6.32 7 5.47 7C4.68 7 3.97 6.32 3.97 5.47C3.97 4.68 4.68 3.97 5.47 3.97Z"},null,-1),DE=[IE],PE={key:59,viewBox:"0 0 24 24"},FE=v("path",{fill:"currentColor",d:"M22 12C22 6.46 17.54 2 12 2C10.83 2 9.7 2.19 8.62 2.56L9.32 4.5C10.17 4.16 11.06 3.97 12 3.97C16.41 3.97 20.03 7.59 20.03 12C20.03 16.41 16.41 20.03 12 20.03C7.59 20.03 3.97 16.41 3.97 12C3.97 11.06 4.16 10.12 4.5 9.28L2.56 8.62C2.19 9.7 2 10.83 2 12C2 17.54 6.46 22 12 22C17.54 22 22 17.54 22 12M5.47 3.97C6.32 3.97 7 4.68 7 5.47C7 6.32 6.32 7 5.47 7C4.68 7 3.97 6.32 3.97 5.47C3.97 4.68 4.68 3.97 5.47 3.97M18 12C18 8.67 15.33 6 12 6C8.67 6 6 8.67 6 12C6 15.33 8.67 18 12 18C15.33 18 18 15.33 18 12M15 12L10 15V9"},null,-1),OE=[FE],ME={key:60,viewBox:"0 0 24 24"},$E=v("path",{fill:"currentColor",d:"M19 17H22L18 21L14 17H17V3H19M2 17H12V19H2M6 5V7H2V5M2 11H9V13H2V11Z"},null,-1),NE=[$E],VE={key:61,viewBox:"0 0 24 24"},BE=v("path",{fill:"currentColor",d:"M19 7H22L18 3L14 7H17V21H19M2 17H12V19H2M6 5V7H2V5M2 11H9V13H2V11Z"},null,-1),UE=[BE],HE={key:62,viewBox:"0 0 24 24"},GE=v("path",{fill:"currentColor",d:"M11,18H13V16H11V18M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,6A4,4 0 0,0 8,10H10A2,2 0 0,1 12,8A2,2 0 0,1 14,10C14,12 11,11.75 11,15H13C13,12.75 16,12.5 16,10A4,4 0 0,0 12,6Z"},null,-1),zE=[GE],jE={key:63,viewBox:"0 0 24 24"},qE=v("path",{fill:"currentColor",d:"M15.07,11.25L14.17,12.17C13.45,12.89 13,13.5 13,15H11V14.5C11,13.39 11.45,12.39 12.17,11.67L13.41,10.41C13.78,10.05 14,9.55 14,9C14,7.89 13.1,7 12,7A2,2 0 0,0 10,9H8A4,4 0 0,1 12,5A4,4 0 0,1 16,9C16,9.88 15.64,10.67 15.07,11.25M13,19H11V17H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2Z"},null,-1),KE=[qE],WE={key:64,viewBox:"0 0 24 24"},YE=v("path",{fill:"currentColor",d:"M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z"},null,-1),ZE=[YE],XE={key:65,viewBox:"0 0 24 24"},QE=v("path",{fill:"currentColor",d:"M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z"},null,-1),JE=[QE],eT={key:66,viewBox:"0 0 24 24"},tT=v("path",{fill:"currentColor",d:"M13 14H11V9H13M13 18H11V16H13M1 21H23L12 2L1 21Z"},null,-1),sT=[tT],nT={key:67},iT=v("path",{fill:"currentColor",d:"M2,5H10V2H12V22H10V18H6V15H10V13H4V10H10V8H2V5M14,5H17V8H14V5M14,10H19V13H14V10M14,15H22V18H14V15Z"},null,-1),rT=[iT],oT={key:68,viewBox:"0 0 24 24"},aT=v("path",{fill:"currentColor",d:"M15,4V11H5.17L4,12.17V4H15M16,2H3A1,1 0 0,0 2,3V17L6,13H16A1,1 0 0,0 17,12V3A1,1 0 0,0 16,2M21,6H19V15H6V17A1,1 0 0,0 7,18H18L22,22V7A1,1 0 0,0 21,6Z"},null,-1),lT=[aT],cT={key:69,viewBox:"0 0 24 24"},uT=v("path",{fill:"currentColor",d:"M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z"},null,-1),dT=[uT],fT={key:70,viewBox:"0 0 24 24"},hT=v("path",{fill:"currentColor",d:"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"},null,-1),pT=[hT],gT={key:71,viewBox:"0 0 24 24"},mT=v("path",{fill:"currentColor",d:"M4 6H2V20C2 21.1 2.9 22 4 22H18V20H4V6M20 4V16H8V4H20M20 2H8C6.9 2 6 2.9 6 4V16C6 17.1 6.9 18 8 18H20C21.1 18 22 17.1 22 16V4C22 2.9 21.1 2 20 2M12 14.5V5.5L18 10L12 14.5Z"},null,-1),vT=[mT],_T={key:72,viewBox:"0 0 24 24"},yT=v("path",{fill:"currentColor",d:"M12,21.1L10.5,22.4C3.9,16.5 0.5,13.4 0.5,9.6C0.5,8.4 0.9,7.3 1.5,6.4C1.5,6.6 1.5,6.8 1.5,7C1.5,11.7 5.4,15.2 12,21.1M13.6,17C18.3,12.7 21.5,9.9 21.6,7C21.6,5 20.1,3.5 18.1,3.5C16.5,3.5 15,4.5 14.5,5.9H12.6C12,4.5 10.5,3.5 9,3.5C7,3.5 5.5,5 5.5,7C5.5,9.9 8.6,12.7 13.4,17L13.5,17.1M18,1.5C21.1,1.5 23.5,3.9 23.5,7C23.5,10.7 20.1,13.8 13.5,19.8C6.9,13.9 3.5,10.8 3.5,7C3.5,3.9 5.9,1.5 9,1.5C10.7,1.5 12.4,2.3 13.5,3.6C14.6,2.3 16.3,1.5 18,1.5Z"},null,-1),xT=[yT],bT={key:73,viewBox:"0 0 24 24"},wT=v("path",{fill:"currentColor",d:"M20,8H4V6H20V8M18,2H6V4H18V2M22,12V20A2,2 0 0,1 20,22H4A2,2 0 0,1 2,20V12A2,2 0 0,1 4,10H20A2,2 0 0,1 22,12M16,16L10,12.73V19.26L16,16Z"},null,-1),ST=[wT],ET={key:74,viewBox:"0 0 24 24"},TT=v("path",{fill:"currentColor",d:"M12.63,2C18.16,2 22.64,6.5 22.64,12C22.64,17.5 18.16,22 12.63,22C9.12,22 6.05,20.18 4.26,17.43L5.84,16.18C7.25,18.47 9.76,20 12.64,20A8,8 0 0,0 20.64,12A8,8 0 0,0 12.64,4C8.56,4 5.2,7.06 4.71,11H7.47L3.73,14.73L0,11H2.69C3.19,5.95 7.45,2 12.63,2M15.59,10.24C16.09,10.25 16.5,10.65 16.5,11.16V15.77C16.5,16.27 16.09,16.69 15.58,16.69H10.05C9.54,16.69 9.13,16.27 9.13,15.77V11.16C9.13,10.65 9.54,10.25 10.04,10.24V9.23C10.04,7.7 11.29,6.46 12.81,6.46C14.34,6.46 15.59,7.7 15.59,9.23V10.24M12.81,7.86C12.06,7.86 11.44,8.47 11.44,9.23V10.24H14.19V9.23C14.19,8.47 13.57,7.86 12.81,7.86Z"},null,-1),CT=[TT],AT={key:75,viewBox:"0 0 24 24"},kT=v("path",{fill:"currentColor",d:"M20,12A8,8 0 0,0 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12M22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2A10,10 0 0,1 22,12M10,9.5C10,10.3 9.3,11 8.5,11C7.7,11 7,10.3 7,9.5C7,8.7 7.7,8 8.5,8C9.3,8 10,8.7 10,9.5M17,9.5C17,10.3 16.3,11 15.5,11C14.7,11 14,10.3 14,9.5C14,8.7 14.7,8 15.5,8C16.3,8 17,8.7 17,9.5M12,17.23C10.25,17.23 8.71,16.5 7.81,15.42L9.23,14C9.68,14.72 10.75,15.23 12,15.23C13.25,15.23 14.32,14.72 14.77,14L16.19,15.42C15.29,16.5 13.75,17.23 12,17.23Z"},null,-1),LT=[kT],RT={key:76,viewBox:"0 0 24 24"},IT=v("path",{fill:"currentColor",d:"M3 11H11V3H3M5 5H9V9H5M13 21H21V13H13M15 15H19V19H15M3 21H11V13H3M5 15H9V19H5M13 3V11H21V3M19 9H15V5H19Z"},null,-1),DT=[IT],PT={key:77,fill:"none",viewBox:"0 0 24 24"},FT=v("mask",{id:"a",style:{"mask-type":"alpha"},maskUnits:"userSpaceOnUse",x:"1",y:"4",width:"22",height:"17"},[v("path",{d:"M23 4H1v17h22V4z",fill:"currentColor"})],-1),OT=v("g",{mask:"url(#a)"},[v("path",{d:"M19.624 5.514a18.174 18.174 0 00-4.478-1.386.068.068 0 00-.072.034c-.194.343-.408.791-.558 1.143a16.79 16.79 0 00-5.03 0c-.15-.36-.371-.8-.565-1.143a.07.07 0 00-.072-.034c-1.572.27-3.075.743-4.478 1.386a.064.064 0 00-.03.025C1.49 9.79.708 13.935 1.091 18.03c.002.02.013.04.029.051a18.26 18.26 0 005.493 2.77.071.071 0 00.077-.025c.423-.576.8-1.184 1.124-1.823a.07.07 0 00-.038-.097 12.024 12.024 0 01-1.716-.816.07.07 0 01-.007-.117c.115-.086.23-.175.34-.266a.068.068 0 01.072-.01c3.6 1.64 7.498 1.64 11.056 0a.068.068 0 01.072.009c.11.09.226.181.342.267a.07.07 0 01-.006.117c-.548.32-1.118.59-1.717.815a.07.07 0 00-.038.098c.33.638.708 1.246 1.123 1.822a.07.07 0 00.078.026 18.2 18.2 0 005.502-2.77.07.07 0 00.028-.05c.459-4.734-.768-8.846-3.253-12.491a.055.055 0 00-.028-.026zM8.352 15.537c-1.084 0-1.977-.993-1.977-2.212 0-1.22.875-2.212 1.977-2.212 1.11 0 1.994 1.002 1.977 2.212 0 1.22-.876 2.212-1.977 2.212zm7.31 0c-1.084 0-1.977-.993-1.977-2.212 0-1.22.876-2.212 1.977-2.212 1.11 0 1.994 1.002 1.977 2.212 0 1.22-.867 2.212-1.977 2.212z",fill:"currentColor"})],-1),MT=[FT,OT],$T={key:78,fill:"none",viewBox:"0 0 38 36"},NT=v("path",{fill:"currentColor","fill-rule":"evenodd",d:"M25.77 8.53s-1.8-.08-2.65-.34c.77-.78.77-2.24.77-2.24s-1.89.77-4.55.77c-1.88-.08-2.57-.34-3.94 1.04-1.63 1.64-1.63 2.07-2.66 2.07.86 1.2.43 2.4.43 2.4l-.08 1.82.08.34s0 .09.09.26c0 .09 0 .26.09.35l.25 1.37s-.08.1-.17 0c-.26-.34-.6-.51-1.03-.51-.26 0-.68.69-.34 1.63.26.7.51 1.12.77 2.07.26.95.77 1.64 1.03 1.47.09-.09.17-.35.26-.78 0-.08.08 0 .17.09.08.86.26 1.63.43 2.07.17.25.34.6.51.86-.17 1.46-.34 3.27-.68 4.65-2.14.58-5.36 1.53-8.23 2.23 3.28 3.5 7.5 5.24 12.68 5.24 4.04 0 7.15-1.05 10.15-3.29-2.47-1.48-5.56-3.66-6.9-3.66H19c-.77 0-2.4-.7-2.57-1.3a4.48 4.48 0 0 1-.09-1.9c0-.08.18-.08.26 0 .69.78 1.03 1.3 1.72 1.3h1.54c.6 0 2.66-1.8 3.51-4.05.18-.52.35-1.38.43-2.32 0-.1.09-.18.09-.1.08.44.26.96.34.96.26.17.6-.52 1.03-1.47.43-.86.43-1.38.6-2.07.26-.94-.09-1.63-.34-1.63a.78.78 0 0 0-.6.26c-.09 0-.18 0-.18-.09 0-.6.1-1.55.78-2.07-.95-.86-.35-2.32-.35-2.32.35.17.86.17.86.17l-.69-1.12c.52-.09.95-.52.95-.52s-1.37-.34-2.06-.86c.6-.17 1.54-.78 1.54-.78z","clip-rule":"evenodd"},null,-1),VT=[NT],BT={key:79,viewBox:"0 0 24 24"},UT=v("path",{fill:"currentColor",d:"M14.4,6L14,4H5V21H7V14H12.6L13,16H20V6H14.4Z"},null,-1),HT=[UT],GT={key:80,viewBox:"0 0 256 256",fill:"none"},zT=v("path",{d:"M71.3 106.2V83.52h73.08v132.3H191v22.68H65v-22.68h51.66V106.2H71.3z",fill:"currentColor"},null,-1),jT=v("circle",{cx:"126.74",cy:"39.42",r:"21.42",fill:"currentColor"},null,-1),qT=[zT,jT],KT={key:81,viewBox:"0 0 24 24"},WT=v("path",{fill:"currentColor",d:"M12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22C6.47,22 2,17.5 2,12A10,10 0 0,1 12,2M12.5,7V12.25L17,14.92L16.25,16.15L11,13V7H12.5Z"},null,-1),YT=[WT],ZT={key:82,viewBox:"0 0 24 24"},XT=v("path",{fill:"currentColor",d:"M9,16V10H5L12,3L19,10H15V16H9M5,20V18H19V20H5Z"},null,-1),QT=[XT],JT={key:83,viewBox:"0 0 24 24"},e5=v("path",{fill:"currentColor",d:"M7,15H9C9,16.08 10.37,17 12,17C13.63,17 15,16.08 15,15C15,13.9 13.96,13.5 11.76,12.97C9.64,12.44 7,11.78 7,9C7,7.21 8.47,5.69 10.5,5.18V3H13.5V5.18C15.53,5.69 17,7.21 17,9H15C15,7.92 13.63,7 12,7C10.37,7 9,7.92 9,9C9,10.1 10.04,10.5 12.24,11.03C14.36,11.56 17,12.22 17,15C17,16.79 15.53,18.31 13.5,18.82V21H10.5V18.82C8.47,18.31 7,16.79 7,15Z"},null,-1),t5=[e5],s5={key:84,fill:"none",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256"},n5=v("path",{d:"M187.25 189.449L207 179.205v-25.609m-59.25-46.083L128 117.756l19.75-10.243zM128 117.756l-19.75-10.243L128 117.756zm0 0v25.609-25.609zm79-40.948l-19.75 10.23L207 76.782v.026zm0 0l-19.75-10.257L207 76.795v.013zm0 0v25.596-25.622.026zm-59.25-30.744L128 35.834l-19.75 10.243h39.5v-.013zM49 76.782l19.75-10.244L49 76.782v0zm0 0l19.75 10.243L49 76.782zm0 0v25.609-25.61zm79 143.385l-19.75-10.244L128 220.167zm0 0l19.75-10.244L128 220.167zm0 0v-25.596 25.596zm-59.25-30.718L49 179.205v-25.609l19.75 35.853v0z",stroke:"currentColor","stroke-width":"26.333","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),i5=[n5],r5={key:85,viewBox:"0 0 24 24"},o5=v("path",{fill:"currentColor",d:"M12.1,18.55L12,18.65L11.89,18.55C7.14,14.24 4,11.39 4,8.5C4,6.5 5.5,5 7.5,5C9.04,5 10.54,6 11.07,7.36H12.93C13.46,6 14.96,5 16.5,5C18.5,5 20,6.5 20,8.5C20,11.39 16.86,14.24 12.1,18.55M16.5,3C14.76,3 13.09,3.81 12,5.08C10.91,3.81 9.24,3 7.5,3C4.42,3 2,5.41 2,8.5C2,12.27 5.4,15.36 10.55,20.03L12,21.35L13.45,20.03C18.6,15.36 22,12.27 22,8.5C22,5.41 19.58,3 16.5,3Z"},null,-1),a5=[o5],l5={key:86,viewBox:"0 0 24 24"},c5=v("path",{fill:"currentColor",d:"M12,21.35L10.55,20.03C5.4,15.36 2,12.27 2,8.5C2,5.41 4.42,3 7.5,3C9.24,3 10.91,3.81 12,5.08C13.09,3.81 14.76,3 16.5,3C19.58,3 22,5.41 22,8.5C22,12.27 18.6,15.36 13.45,20.03L12,21.35Z"},null,-1),u5=[c5],d5={key:87,viewBox:"0 0 24 24"},f5=v("path",{fill:"currentColor",d:"M7,15H9C9,16.08 10.37,17 12,17C13.63,17 15,16.08 15,15C15,13.9 13.96,13.5 11.76,12.97C9.64,12.44 7,11.78 7,9C7,7.21 8.47,5.69 10.5,5.18V3H13.5V5.18C15.53,5.69 17,7.21 17,9H15C15,7.92 13.63,7 12,7C10.37,7 9,7.92 9,9C9,10.1 10.04,10.5 12.24,11.03C14.36,11.56 17,12.22 17,15C17,16.79 15.53,18.31 13.5,18.82V21H10.5V18.82C8.47,18.31 7,16.79 7,15Z"},null,-1),h5=[f5],p5={key:88,viewBox:"0 0 24 24"},g5=v("path",{fill:"currentColor",d:"M22 5.5H9C7.9 5.5 7 6.4 7 7.5V16.5C7 17.61 7.9 18.5 9 18.5H22C23.11 18.5 24 17.61 24 16.5V7.5C24 6.4 23.11 5.5 22 5.5M22 16.5H9V9.17L15.5 12.5L22 9.17V16.5M15.5 10.81L9 7.5H22L15.5 10.81M5 16.5C5 16.67 5.03 16.83 5.05 17H1C.448 17 0 16.55 0 16S.448 15 1 15H5V16.5M3 7H5.05C5.03 7.17 5 7.33 5 7.5V9H3C2.45 9 2 8.55 2 8S2.45 7 3 7M1 12C1 11.45 1.45 11 2 11H5V13H2C1.45 13 1 12.55 1 12Z"},null,-1),m5=[g5],v5={key:89,viewBox:"0 0 24 24"},_5=v("path",{fill:"currentColor",d:"M11,15H13V17H11V15M11,7H13V13H11V7M12,2C6.47,2 2,6.5 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20Z"},null,-1),y5=[_5],x5={key:90,viewBox:"0 0 24 24"},b5=v("path",{fill:"currentColor",d:"M11 10V12H9V14H7V12H5.8C5.4 13.2 4.3 14 3 14C1.3 14 0 12.7 0 11S1.3 8 3 8C4.3 8 5.4 8.8 5.8 10H11M3 10C2.4 10 2 10.4 2 11S2.4 12 3 12 4 11.6 4 11 3.6 10 3 10M16 14C18.7 14 24 15.3 24 18V20H8V18C8 15.3 13.3 14 16 14M16 12C13.8 12 12 10.2 12 8S13.8 4 16 4 20 5.8 20 8 18.2 12 16 12Z"},null,-1),w5=[b5],S5={key:91,viewBox:"0 0 24 24"},E5=v("path",{fill:"currentColor",d:"M15,14C12.33,14 7,15.33 7,18V20H23V18C23,15.33 17.67,14 15,14M6,10V7H4V10H1V12H4V15H6V12H9V10M15,12A4,4 0 0,0 19,8A4,4 0 0,0 15,4A4,4 0 0,0 11,8A4,4 0 0,0 15,12Z"},null,-1),T5=[E5],C5={key:92,viewBox:"0 0 24 24"},A5=v("path",{fill:"currentColor",d:"M2,21L23,12L2,3V10L17,12L2,14V21Z"},null,-1),k5=[A5],L5={key:93,viewBox:"0 0 24 24"},R5=v("path",{fill:"currentColor",d:"M15,4V11H5.17L4,12.17V4H15M16,2H3A1,1 0 0,0 2,3V17L6,13H16A1,1 0 0,0 17,12V3A1,1 0 0,0 16,2M21,6H19V15H6V17A1,1 0 0,0 7,18H18L22,22V7A1,1 0 0,0 21,6Z"},null,-1),I5=[R5],D5={key:94,viewBox:"0 0 24 24"},P5=v("path",{fill:"currentColor",d:"M7,1A2,2 0 0,0 5,3V21A2,2 0 0,0 7,23H17A2,2 0 0,0 19,21V3A2,2 0 0,0 17,1H7M7,4H17V20H7V4M9,6V10H10.5V7.5H13V6H9M13.5,14V16.5H11V18H15V14H13.5Z"},null,-1),F5=[P5],O5={key:95,viewBox:"0 0 24 24"},M5=v("path",{fill:"currentColor",d:"M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"},null,-1),$5=[M5],N5={key:96,viewBox:"0 0 24 24"},V5=v("path",{fill:"currentColor",d:"M21,9L17,5V8H10V10H17V13M7,11L3,15L7,19V16H14V14H7V11Z"},null,-1),B5=[V5],U5={key:97,viewBox:"0 0 24 24"},H5=v("path",{fill:"currentColor",d:"M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z"},null,-1),G5=[H5],z5={key:98,viewBox:"0 0 24 24"},j5=v("path",{fill:"currentColor",d:"M3 17.25V21H6.75L17.81 9.93L14.06 6.18L3 17.25M22.61 18.36L18.36 22.61L13.16 17.41L14.93 15.64L15.93 16.64L18.4 14.16L19.82 15.58L18.36 17L19.42 18L20.84 16.6L22.61 18.36M6.61 10.83L1.39 5.64L5.64 1.39L7.4 3.16L4.93 5.64L6 6.7L8.46 4.22L9.88 5.64L8.46 7.05L9.46 8.05L6.61 10.83M20.71 7C21.1 6.61 21.1 6 20.71 5.59L18.37 3.29C18 2.9 17.35 2.9 16.96 3.29L15.12 5.12L18.87 8.87L20.71 7Z"},null,-1),q5=[j5],K5={key:99,viewBox:"0 0 24 24"},W5=v("path",{fill:"currentColor",d:"M6.45,17.45L1,12L6.45,6.55L7.86,7.96L4.83,11H19.17L16.14,7.96L17.55,6.55L23,12L17.55,17.45L16.14,16.04L19.17,13H4.83L7.86,16.04L6.45,17.45Z"},null,-1),Y5=[W5],Z5={key:100,viewBox:"0 0 24 24"},X5=v("path",{fill:"currentColor",d:"M4 5V18H21V5H4M14 7V16H11V7H14M6 7H9V16H6V7M19 16H16V7H19V16Z"},null,-1),Q5=[X5],J5={key:101,viewBox:"0 0 24 24"},eC=v("path",{fill:"currentColor",d:"M7 11H9V13H7V11M21 5V19C21 20.11 20.11 21 19 21H5C3.89 21 3 20.1 3 19V5C3 3.9 3.9 3 5 3H6V1H8V3H16V1H18V3H19C20.11 3 21 3.9 21 5M5 7H19V5H5V7M19 19V9H5V19H19M15 13V11H17V13H15M11 13V11H13V13H11M7 15H9V17H7V15M15 17V15H17V17H15M11 17V15H13V17H11Z"},null,-1),tC=[eC],sC={key:102,viewBox:"0 0 24 24"},nC=v("path",{fill:"currentColor",d:"M12 20C16.42 20 20 16.42 20 12S16.42 4 12 4 4 7.58 4 12 7.58 20 12 20M12 2C17.5 2 22 6.5 22 12S17.5 22 12 22C6.47 22 2 17.5 2 12C2 6.5 6.5 2 12 2M12.5 13V13H11V7H12.5V11.26L16.2 9.13L16.95 10.43L12.5 13Z"},null,-1),iC=[nC],rC={key:103,viewBox:"0 0 24 24"},oC=v("path",{fill:"currentColor",d:"M17,10.5V7A1,1 0 0,0 16,6H4A1,1 0 0,0 3,7V17A1,1 0 0,0 4,18H16A1,1 0 0,0 17,17V13.5L21,17.5V6.5L17,10.5M14,13H11V16H9V13H6V11H9V8H11V11H14V13Z"},null,-1),aC=[oC],lC={key:104,viewBox:"0 0 24 24"},cC=v("path",{fill:"currentColor",d:"M10,15L15,12L10,9V15M19.45,13L21.56,14.63C21.78,14.78 21.81,15 21.66,15.28L19.64,18.75C19.5,18.97 19.31,19.03 19.03,18.94L16.55,17.95C15.89,18.42 15.33,18.75 14.86,18.94L14.5,21.56C14.42,21.84 14.27,22 14,22H10C9.73,22 9.58,21.84 9.5,21.56L9.14,18.94C8.55,18.69 8,18.36 7.45,17.95L4.97,18.94C4.69,19.03 4.5,18.97 4.36,18.75L2.34,15.28C2.19,15 2.22,14.78 2.44,14.63L4.55,13C4.5,12.77 4.5,12.44 4.5,12C4.5,11.56 4.5,11.23 4.55,11L2.44,9.38C2.22,9.22 2.19,9 2.34,8.72L4.36,5.25C4.5,5.03 4.69,4.97 4.97,5.06L7.45,6.05C8.11,5.58 8.67,5.25 9.14,5.06L9.5,2.44C9.58,2.16 9.73,2 10,2H14C14.27,2 14.42,2.16 14.5,2.44L14.86,5.06C15.45,5.31 16,5.64 16.55,6.05L19.03,5.06C19.31,4.97 19.5,5.03 19.64,5.25L21.66,8.72C21.81,9 21.78,9.22 21.56,9.38L19.45,11C19.5,11.23 19.5,11.56 19.5,12C19.5,12.44 19.5,12.77 19.45,13Z"},null,-1),uC=[cC],dC={key:105,viewBox:"0 0 24 24"},fC=v("path",{fill:"currentColor",d:"M19 17V11.8C18.5 11.9 18 12 17.5 12H17V18H7V11C7 8.2 9.2 6 12 6C12.1 4.7 12.7 3.6 13.5 2.7C13.2 2.3 12.6 2 12 2C10.9 2 10 2.9 10 4V4.3C7 5.2 5 7.9 5 11V17L3 19V20H21V19L19 17M10 21C10 22.1 10.9 23 12 23S14 22.1 14 21H10M21 6.5C21 8.4 19.4 10 17.5 10S14 8.4 14 6.5 15.6 3 17.5 3 21 4.6 21 6.5"},null,-1),hC=[fC],pC={key:106,viewBox:"0 0 24 24"},gC=v("path",{fill:"currentColor",d:"M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"},null,-1),mC=[gC],vC={key:107,viewBox:"0 0 24 24",fill:"none"},_C=v("path",{d:"M19.58 3H15V1H23V9H21V4.41L16.17 9.24C16.69 10.03 17 11 17 12C17 14.42 15.28 16.44 13 16.9V19H15V21H13V23H11V21H9V19H11V16.9C8.72 16.44 7 14.42 7 12C7 11 7.3 10.04 7.82 9.26L6.64 8.07L5.24 9.46L3.83 8.04L5.23 6.65L3 4.42V8H1V1H8V3H4.41L6.64 5.24L8.08 3.81L9.5 5.23L8.06 6.66L9.23 7.84C10 7.31 11 7 12 7C13 7 13.96 7.3 14.75 7.83L19.58 3ZM12 9C11.2044 9 10.4413 9.31607 9.87868 9.87868C9.31607 10.4413 9 11.2044 9 12C9 12.7956 9.31607 13.5587 9.87868 14.1213C10.4413 14.6839 11.2044 15 12 15C12.7956 15 13.5587 14.6839 14.1213 14.1213C14.6839 13.5587 15 12.7956 15 12C15 11.2044 14.6839 10.4413 14.1213 9.87868C13.5587 9.31607 12.7956 9 12 9Z",fill:"currentColor"},null,-1),yC=[_C],xC={key:108,viewBox:"0 0 24 24",fill:"none"},bC=v("path",{d:"M17.58 4H14V2H21V9H19V5.41L15.17 9.24C15.69 10.03 16 11 16 12C16 14.42 14.28 16.44 12 16.9V19H14V21H12V23H10V21H8V19H10V16.9C7.72 16.44 6 14.42 6 12C6 10.6739 6.52678 9.40215 7.46447 8.46447C8.40215 7.52678 9.67392 7 11 7C12 7 12.96 7.3 13.75 7.83L17.58 4ZM11 9C10.2044 9 9.44129 9.31607 8.87868 9.87868C8.31607 10.4413 8 11.2044 8 12C8 12.7956 8.31607 13.5587 8.87868 14.1213C9.44129 14.6839 10.2044 15 11 15C11.7956 15 12.5587 14.6839 13.1213 14.1213C13.6839 13.5587 14 12.7956 14 12C14 11.2044 13.6839 10.4413 13.1213 9.87868C12.5587 9.31607 11.7956 9 11 9Z",fill:"currentColor"},null,-1),wC=[bC],SC={key:109,viewBox:"0 0 24 24",fill:"none"},EC=v("path",{d:"M13.2222 11.1482C14.2733 11.1482 15.2593 11.4822 16.0496 12.0526L20.2133 7.88889H16.4815V6.25926H23V12.7778H21.3704V9.03778L17.2067 13.1852C17.777 14 18.1111 14.9778 18.1111 16.037C18.1111 17.3337 17.596 18.5772 16.6792 19.494C15.7624 20.4109 14.5188 20.9259 13.2222 20.9259C11.9256 20.9259 10.6821 20.4109 9.76527 19.494C8.84842 18.5772 8.33334 17.3337 8.33334 16.037C8.33334 14.7404 8.84842 13.4969 9.76527 12.5801C10.6821 11.6632 11.9256 11.1482 13.2222 11.1482ZM13.2222 12.7778C12.3578 12.7778 11.5288 13.1212 10.9176 13.7324C10.3064 14.3436 9.96297 15.1726 9.96297 16.037C9.96297 16.9014 10.3064 17.7305 10.9176 18.3417C11.5288 18.9529 12.3578 19.2963 13.2222 19.2963C14.0866 19.2963 14.9156 18.9529 15.5269 18.3417C16.1381 17.7305 16.4815 16.9014 16.4815 16.037C16.4815 15.1726 16.1381 14.3436 15.5269 13.7324C14.9156 13.1212 14.0866 12.7778 13.2222 12.7778Z",fill:"currentColor"},null,-1),TC=v("path",{d:"M5.88889 7.88889C6.94 7.88889 7.92593 8.22296 8.7163 8.79333L12.88 4.62963H9.14815V3H15.6667V9.51852H14.037V5.77852L9.87333 9.92593C10.4437 10.7407 10.7778 11.7185 10.7778 12.7778C10.7778 14.0744 10.2627 15.3179 9.34585 16.2347C8.42901 17.1516 7.1855 17.6667 5.88889 17.6667C4.59227 17.6667 3.34877 17.1516 2.43192 16.2347C1.51508 15.3179 1 14.0744 1 12.7778C1 11.4812 1.51508 10.2377 2.43192 9.32081C3.34877 8.40397 4.59227 7.88889 5.88889 7.88889ZM5.88889 9.51852C5.02448 9.51852 4.19547 9.8619 3.58424 10.4731C2.97301 11.0844 2.62963 11.9134 2.62963 12.7778C2.62963 13.6422 2.97301 14.4712 3.58424 15.0824C4.19547 15.6937 5.02448 16.037 5.88889 16.037C6.7533 16.037 7.5823 15.6937 8.19353 15.0824C8.80476 14.4712 9.14815 13.6422 9.14815 12.7778C9.14815 11.9134 8.80476 11.0844 8.19353 10.4731C7.5823 9.8619 6.7533 9.51852 5.88889 9.51852Z",fill:"currentColor"},null,-1),CC=[EC,TC],AC={key:110,viewBox:"0 0 173 81",fill:"none"},kC=Yo('<rect width="5" height="63" fill="currentColor"></rect><rect x="132" width="5" height="61" fill="currentColor"></rect><circle cx="40.5" cy="60.5" r="17.5" stroke="currentColor" stroke-width="6"></circle><circle cx="96.5" cy="60.5" r="17.5" stroke="currentColor" stroke-width="6"></circle><circle cx="152.5" cy="60.5" r="17.5" stroke="currentColor" stroke-width="6"></circle>',5),LC=[kC],RC={key:111,viewBox:"0 0 24 24"},IC=v("path",{fill:"currentColor",d:"M12 1L21 5V11C21 16.55 17.16 21.74 12 23C6.84 21.74 3 16.55 3 11V5L12 1M16 14H8V15.5C8 15.77 8.19 15.96 8.47 16L8.57 16H15.43C15.74 16 15.95 15.84 16 15.59L16 15.5V14M17 8L17 8L14.33 10.67L12 8.34L9.67 10.67L7 8L7 8L8 13H16L17 8Z"},null,-1),DC=[IC],PC={key:112,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},FC=v("g",null,[v("path",{d:"M216.856339,16.5966031 C200.285002,8.84328665 182.566144,3.2084988 164.041564,0 C161.766523,4.11318106 159.108624,9.64549908 157.276099,14.0464379 C137.583995,11.0849896 118.072967,11.0849896 98.7430163,14.0464379 C96.9108417,9.64549908 94.1925838,4.11318106 91.8971895,0 C73.3526068,3.2084988 55.6133949,8.86399117 39.0420583,16.6376612 C5.61752293,67.146514 -3.4433191,116.400813 1.08711069,164.955721 C23.2560196,181.510915 44.7403634,191.567697 65.8621325,198.148576 C71.0772151,190.971126 75.7283628,183.341335 79.7352139,175.300261 C72.104019,172.400575 64.7949724,168.822202 57.8887866,164.667963 C59.7209612,163.310589 61.5131304,161.891452 63.2445898,160.431257 C105.36741,180.133187 151.134928,180.133187 192.754523,160.431257 C194.506336,161.891452 196.298154,163.310589 198.110326,164.667963 C191.183787,168.842556 183.854737,172.420929 176.223542,175.320965 C180.230393,183.341335 184.861538,190.991831 190.096624,198.16893 C211.238746,191.588051 232.743023,181.531619 254.911949,164.955721 C260.227747,108.668201 245.831087,59.8662432 216.856339,16.5966031 Z M85.4738752,135.09489 C72.8290281,135.09489 62.4592217,123.290155 62.4592217,108.914901 C62.4592217,94.5396472 72.607595,82.7145587 85.4738752,82.7145587 C98.3405064,82.7145587 108.709962,94.5189427 108.488529,108.914901 C108.508531,123.290155 98.3405064,135.09489 85.4738752,135.09489 Z M170.525237,135.09489 C157.88039,135.09489 147.510584,123.290155 147.510584,108.914901 C147.510584,94.5396472 157.658606,82.7145587 170.525237,82.7145587 C183.391518,82.7145587 193.761324,94.5189427 193.539891,108.914901 C193.539891,123.290155 183.391518,135.09489 170.525237,135.09489 Z",fill:"#5865F2","fill-rule":"nonzero"})],-1),OC=[FC],MC={key:113,viewBox:"0 -23.5 256 256",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},$C=v("g",null,[v("path",{d:"M256,25.4500259 C246.580841,29.6272672 236.458451,32.4504868 225.834156,33.7202333 C236.678503,27.2198053 245.00583,16.9269929 248.927437,4.66307685 C238.779765,10.6812633 227.539325,15.0523376 215.57599,17.408298 C205.994835,7.2006971 192.34506,0.822 177.239197,0.822 C148.232605,0.822 124.716076,24.3375931 124.716076,53.3423116 C124.716076,57.4586875 125.181462,61.4673784 126.076652,65.3112644 C82.4258385,63.1210453 43.7257252,42.211429 17.821398,10.4359288 C13.3005011,18.1929938 10.710443,27.2151234 10.710443,36.8402889 C10.710443,55.061526 19.9835254,71.1374907 34.0762135,80.5557137 C25.4660961,80.2832239 17.3681846,77.9207088 10.2862577,73.9869292 C10.2825122,74.2060448 10.2825122,74.4260967 10.2825122,74.647085 C10.2825122,100.094453 28.3867003,121.322443 52.413563,126.14673 C48.0059695,127.347184 43.3661509,127.988612 38.5755734,127.988612 C35.1914554,127.988612 31.9009766,127.659938 28.694773,127.046602 C35.3777973,147.913145 54.7742053,163.097665 77.7569918,163.52185 C59.7820257,177.607983 37.1354036,186.004604 12.5289147,186.004604 C8.28987161,186.004604 4.10888474,185.75646 0,185.271409 C23.2431033,200.173139 50.8507261,208.867532 80.5109185,208.867532 C177.116529,208.867532 229.943977,128.836982 229.943977,59.4326002 C229.943977,57.1552968 229.893412,54.8901664 229.792282,52.6381454 C240.053257,45.2331635 248.958338,35.9825545 256,25.4500259",fill:"#ffffff"})],-1),NC=[$C],Re=De({__name:"Icon",props:{name:{}},setup(s){const e=s,t=n=>e.name===n;return(n,i)=>t("fire")?(x(),T("svg",vb,yb)):t("new")?(x(),T("svg",xb,wb)):t("top")?(x(),T("svg",Sb,Tb)):t("comments")?(x(),T("svg",Cb,kb)):t("thumbs-up")?(x(),T("svg",Lb,Ib)):t("search")?(x(),T("svg",Db,Fb)):t("loading")?(x(),T("svg",Ob,$b)):t("close")?(x(),T("svg",Nb,Bb)):t("thehandy")?(x(),T("svg",Ub,zb)):t("bluetooth")?(x(),T("svg",jb,Kb)):t("usb-port")?(x(),T("svg",Wb,Zb)):t("chevron-left")?(x(),T("svg",Xb,Jb)):t("chevron-right")?(x(),T("svg",ew,sw)):t("account")?(x(),T("svg",nw,rw)):t("more")?(x(),T("svg",ow,lw)):t("video-box")?(x(),T("svg",cw,dw)):t("chart-timeline-sparkles")?(x(),T("svg",fw,pw)):t("tag-text")?(x(),T("svg",gw,vw)):t("woman-face-shimmer")?(x(),T("svg",_w,xw)):t("plus")?(x(),T("svg",bw,Sw)):t("speedometer")?(x(),T("svg",Ew,Cw)):t("heart")?(x(),T("svg",Aw,Lw)):t("eye")?(x(),T("svg",Rw,Dw)):t("pencil")?(x(),T("svg",Pw,Ow)):t("notification")?(x(),T("svg",Mw,Nw)):t("bell")?(x(),T("svg",Vw,Uw)):t("chevron-left")?(x(),T("svg",Hw,zw)):t("play")?(x(),T("svg",jw,Kw)):t("volume-high")?(x(),T("svg",Ww,Zw)):t("arrow-expand")?(x(),T("svg",Xw,Jw)):t("quality-high")?(x(),T("svg",eS,sS)):t("pause")?(x(),T("svg",nS,rS)):t("arrow-collapse")?(x(),T("svg",oS,lS)):t("logout")?(x(),T("svg",cS,dS)):t("eye-outline")?(x(),T("svg",fS,pS)):t("home")?(x(),T("svg",gS,vS)):t("star")?(x(),T("svg",_S,xS)):t("account-group")?(x(),T("svg",bS,SS)):t("link")?(x(),T("svg",ES,CS)):t("warning")?(x(),T("svg",AS,LS)):t("television-play")?(x(),T("svg",RS,DS)):t("shape")?(x(),T("svg",PS,OS)):t("fast-forward")?(x(),T("svg",MS,NS)):t("shimmer")?(x(),T("svg",VS,US)):t("open-in-new")?(x(),T("svg",HS,zS)):t("comment-text-multiple")?(x(),T("svg",jS,KS)):t("playbox-multiple-outline")?(x(),T("svg",WS,ZS)):t("explore")?(x(),T("svg",XS,JS)):t("video-plus")?(x(),T("svg",eE,sE)):t("sort")?(x(),T("svg",nE,rE)):t("faptap")?(x(),T("svg",oE,lE)):t("home-outline")?(x(),T("svg",cE,dE)):t("account-group-outline")?(x(),T("svg",fE,pE)):t("explore-outline")?(x(),T("svg",gE,vE)):t("shape-outline")?(x(),T("svg",_E,xE)):t("woman-face-shimmer-outline")?(x(),T("svg",bE,SE)):t("person")?(x(),T("svg",EE,CE)):t("pound")?(x(),T("svg",AE,LE)):t("motion-play-outline")?(x(),T("svg",RE,DE)):t("motion-play")?(x(),T("svg",PE,OE)):t("sort-ascending")?(x(),T("svg",ME,NE)):t("sort-descending")?(x(),T("svg",VE,UE)):t("help-outline")?(x(),T("svg",HE,zE)):t("help")?(x(),T("svg",jE,KE)):t("download")?(x(),T("svg",WE,ZE)):t("burger")?(x(),T("svg",XE,JE)):t("danger")?(x(),T("svg",eT,sT)):t("chart-gantt")?(x(),T("svg",nT,rT)):t("forum-outline")?(x(),T("svg",oT,lT)):t("unfold")?(x(),T("svg",cT,dT)):t("chevron-down")?(x(),T("svg",fT,pT)):t("playbox-multiple-outline")?(x(),T("svg",gT,vT)):t("heart-multiple-outline")?(x(),T("svg",_T,xT)):t("animation-play-outline")?(x(),T("svg",bT,ST)):t("lock-reset")?(x(),T("svg",ET,CT)):t("smiley")?(x(),T("svg",AT,LT)):t("view-grid-outline")?(x(),T("svg",RT,DT)):t("discord")?(x(),T("svg",PT,MT)):t("profile")?(x(),T("svg",$T,VT)):t("flag")?(x(),T("svg",BT,HT)):t("intiface")?(x(),T("svg",GT,qT)):t("clock-outline")?(x(),T("svg",KT,YT)):t("upload")?(x(),T("svg",ZT,QT)):t("currency")?(x(),T("svg",JT,t5)):t("old-faptap")?(x(),T("svg",s5,i5)):t("heart-outline")?(x(),T("svg",r5,a5)):t("heart")?(x(),T("svg",l5,u5)):t("currency")?(x(),T("svg",d5,h5)):t("mail-fast-outline")?(x(),T("svg",p5,m5)):t("alert-circle-outline")?(x(),T("svg",v5,y5)):t("account-key-outline")?(x(),T("svg",x5,w5)):t("account-plus")?(x(),T("svg",S5,T5)):t("send")?(x(),T("svg",C5,k5)):t("forum-outline")?(x(),T("svg",L5,I5)):t("cellphone-screenshot")?(x(),T("svg",D5,F5)):t("cog")?(x(),T("svg",O5,$5)):t("swap-horizontal")?(x(),T("svg",N5,B5)):t("close-box")?(x(),T("svg",U5,G5)):t("pencil-ruler")?(x(),T("svg",z5,q5)):t("arrow-left-right")?(x(),T("svg",K5,Y5)):t("view-column")?(x(),T("svg",Z5,Q5)):t("calendar")?(x(),T("svg",J5,tC)):t("clock")?(x(),T("svg",sC,iC)):t("video-plus")?(x(),T("svg",rC,aC)):t("youtube-studio")?(x(),T("svg",lC,uC)):t("notification-badge-outline")?(x(),T("svg",dC,hC)):t("arrow-left")?(x(),T("svg",pC,mC)):t("orientation-transgender")?(x(),T("svg",vC,yC)):t("orientation-straight")?(x(),T("svg",xC,wC)):t("orientation-gay")?(x(),T("svg",SC,CC)):t("loob")?(x(),T("svg",AC,LC)):t("shield-crown")?(x(),T("svg",RC,DC)):t("discord")?(x(),T("svg",PC,OC)):t("twitter")?(x(),T("svg",MC,NC)):pe("",!0)}}),Me=De({__name:"Button",props:{theme:{},loading:{type:Boolean},disabled:{type:Boolean},rounded:{type:Boolean},href:{},to:{},type:{},dense:{type:Boolean}},setup(s){const e=s,t=ut(()=>{let i;switch(e.theme){case"green":i=["bg-green-500","hover:bg-green-600","active:bg-green-700"];break;case"red":i=["bg-red-500","hover:bg-red-600","active:bg-red-700"];break;case"blue":i=["bg-blue-500","hover:bg-blue-600","active:bg-blue-700"];break;case"transparent":i=["hover:bg-zinc-800/50"];break;case"light":i=["bg-zinc-700","hover:bg-zinc-600","hover:bg-zinc-500"];break;default:i=["bg-zinc-800","hover:bg-zinc-700","active:bg-zinc-600"];break}return e.dense&&i.push("!px-2","!py-1"),i}),n=ut(()=>{let i="button";return e.to&&(i="router-link"),e.href&&(i="a"),i});return(i,r)=>(x(),ae(vn(n.value),{class:Je([t.value,"block rounded-md px-3 py-1.5 text-center font-semibold md:text-sm overflow-hidden disabled:opacity-75 cursor-pointer disabled:cursor-not-allowed"]),to:i.to,type:i.type,href:i.href||i.to,target:i.href?"_blank":void 0,disabled:i.disabled||e.loading},{default:z(()=>[e.loading?(x(),ae(Re,{key:0,name:"loading",class:"h-5 w-5 animate-spin mx-auto"})):nr(i.$slots,"default",{key:1})]),_:3},8,["class","to","type","href","target","disabled"]))}}),VC=s=>{const e=Object.entries(s).filter(([,t])=>t!==void 0).map(([t,n])=>`${t}=${n}`).join("&");return e?`?${e}`:""},BC=(s,e)=>{const t=VC(e);return`${s}${t}`};class UC{constructor(e){ze(this,"baseUrl");ze(this,"products",{getProducts:()=>this.request("/products")});ze(this,"user",{getSession:()=>this.request("/session"),updateAvatar:e=>this.request("/users/@me/avatar","POST",e),updateBio:e=>this.request("/users/@me/bio","PUT",{bio:e}),updateOrientation:e=>this.request("/users/@me/orientation","PUT",{orientation:e}),updateProfile:e=>this.request("/users/@me/profile","POST",e),getSubscriptions:()=>this.request("/users/@me/subscriptions"),updatePassword:(e,t)=>{const n={old_password:e,new_password:t};return this.request("/users/@me/password","PUT",n)},login:(e,t)=>{const n={email:e,password:t};return this.request("/session","POST",n)},logout:()=>this.request("/session","DELETE").then(()=>window.location.reload()),register:(e,t,n,i)=>{const r={email:t,username:e,password:n,code:i};return this.request("/users","POST",r)},getStatistics:()=>this.request("/users/@me/statistics"),subscribe:e=>this.request(`/users/${e.id}/subscribe`,"POST"),unsubscribe:e=>this.request(`/users/${e.id}/unsubscribe`,"POST"),sendVerificationMail:(e,t)=>this.request("/verify-mail","POST",{email:e,captcha:t})});ze(this,"users",{getUsers:()=>this.request("/users"),getUser:e=>this.request(`/users/${e}`)});ze(this,"comments",{createComment:(e,t,n,i)=>this.request("/comments","POST",{thing_id:e,thing_type:t,comment:n,parent_id:i}),getComments:e=>this.request(`/comments?thing_id=${e}`)});ze(this,"rating",{setRating:(e,t)=>this.request("/rating","POST",{thing_id:e,thing_type:t})});ze(this,"videos",{getVideos:e=>{let t=`/videos?limit=${e.limit}&page=${e.page}&order_by=${e.orderBy}.${e.asc?"asc":"desc"}`;return e.user&&(t+=`&user_id=${e.user}`),e.performer&&(t+=`&performer_id=${e.performer}`),e.tag&&(t+=`&tag_ids=${e.tag}`),e.subscriptions&&(t+="&subscriptions=true"),e.likes&&(t+="&likes=true"),e.query&&(t+=`&q=${e.query}`),e.from&&(t+=`&from=${e.from}`),e.speed&&(t+=`&speed=${e.speed}`),e.source&&(t+=`&source=${e.source}`),e.duration&&(t+=`&duration=${e.duration}`),e.video&&(t+=`&video_id=${e.video}`),e.orientation!==void 0&&(t+=`&orientation=${e.orientation}`),this.request(t)},getVideo:e=>this.request(`/videos/${e}`),getRelatedVideos:e=>this.request(`/videos/${e}/related`),getScript:e=>new Promise((t,n)=>{fetch(gi(e)).then(i=>i.text()).then(i=>{if(i.startsWith('{"error"'))return n("Failed to fetch script");const r=[];i.split(`
`).forEach(a=>{if(a.length===0)return;const l=a.split(","),c=parseInt(l[0]),u=parseInt(l[1]);r.push([c,u])}),t(r)}).catch(i=>n(i))}),viewVideo:e=>this.request(`/videos/${e}/view`,"POST"),getSources:e=>this.request(`/videos/${e}/sources`),createVideo:e=>this.request("/videos","POST",e),updateVideo:e=>this.request(`/videos/${e.id}`,"PUT",e),updateScript:(e,t)=>this.request(`/videos/${e}/script`,"PUT",t),deleteVideo:e=>this.request(`/videos/${e}`,"DELETE")});ze(this,"tags",{getTags:e=>{let t=`/tags?order_by=${e.orderBy}`;return e.query&&(t+=`&query=${e.query}`),e.user&&(t+=`&user=${e.user}`),e.performer&&(t+=`&performer=${e.performer}`),this.request(t)},getTag:e=>this.request(`/tags/${e}`),getTopTags:(e={count:30,order:"desc"})=>this.request(BC("/tags/top",e))});ze(this,"performers",{getPerformer:e=>this.request(`/performers/${e}`),createPerformer:e=>this.request("/performers","POST",{name:e}),createPerformerAvatar:(e,t)=>this.request(`/performers/${e}/avatar`,"POST",t),updatePerformerName:(e,t)=>this.request(`/performers/${e}`,"PUT",{name:t}),getPerformers:e=>{let t=`/performers?page=${e.page}&limit=${e.limit}`;return e.query&&(t+=`&query=${e.query}`),this.request(t)}});ze(this,"providers",{getProviders:()=>this.request("/providers")});ze(this,"feed",{getFeed:e=>{let t="/feed";return e!==void 0&&(t+=`?orientation=${e}`),this.request(t)}});ze(this,"notifications",{getNotifications:(e=1,t=10)=>this.request(`/notifications?page=${e}&limit=${t}`),getUnreadNotificationsCount:()=>this.request("/notifications/unread-count"),markNotificationsAsRead:()=>this.request("/notifications","POST")});ze(this,"admin",{findUsers:e=>this.request(`/admin/users?query=${e}`),updateUser:(e,t)=>this.request(`/admin/users/${e}`,"PATCH",t),deleteUser:e=>this.request(`/admin/users/${e}`,"DELETE")});this.baseUrl=e}request(e,t="GET",n){return new Promise((i,r)=>{n&&!(n instanceof FormData)&&(n=JSON.stringify(n)),fetch(this.baseUrl+e,{method:t,body:n}).then(o=>o.json()).then(o=>"error"in o?r(o.error):i(o.data)).catch(o=>r(o))})}}var pt=(s=>(s[s.Straight=0]="Straight",s[s.Transgender=1]="Transgender",s[s.Gay=2]="Gay",s))(pt||{}),po=(s=>(s.slow="slow",s.medium="medium",s.fast="fast",s.veryfast="veryfast",s))(po||{}),Mi=(s=>(s.day="day",s.week="week",s.month="month",s.year="year",s))(Mi||{}),Va=(s=>(s.short="short",s.medium="medium",s.long="long",s))(Va||{}),Zs=(s=>(s.views="views",s.speed="speed",s.duration="duration",s.likes="likes",s.relevance="relevance",s.creation="creation",s))(Zs||{}),hl=(s=>(s[s.Video=0]="Video",s[s.Comment=1]="Comment",s))(hl||{}),Ba=(s=>(s[s.Report=0]="Report",s[s.VideoComment=1]="VideoComment",s[s.Video=2]="Video",s[s.VideoCommentResponse=3]="VideoCommentResponse",s))(Ba||{});const HC=`${window.location.protocol}//${window.location.hostname}${window.location.port!==""?`:${window.location.port}`:""}/api/assets/`;var P1;const GC={}.FAPTAP_CAPTCHA_KEY||((P1=window.config)==null?void 0:P1.FAPTAP_CAPTCHA_KEY)||"10000000-ffff-ffff-ffff-000000000001",gi=s=>HC+s,qe=new UC("/api"),zC={key:0,class:"text-center text-red-500"},jC=De({__name:"AuthLogin",setup(s){const e=Ps({email:"",password:"",loading:!1}),t=()=>{e.error=void 0,e.loading=!0,qe.user.login(e.email,e.password).then(()=>window.location.reload()).catch(n=>{e.error=n}).finally(()=>{e.loading=!1})};return(n,i)=>(x(),T("form",{onSubmit:Is(t,["prevent"]),class:"flex flex-col gap-y-3 items-center"},[P(hs,{class:"w-full",required:"",disabled:e.loading,modelValue:e.email,"onUpdate:modelValue":i[0]||(i[0]=r=>e.email=r),type:"email",placeholder:"E-Mail"},null,8,["disabled","modelValue"]),P(hs,{class:"w-full",required:"",disabled:e.loading,modelValue:e.password,"onUpdate:modelValue":i[1]||(i[1]=r=>e.password=r),type:"password",placeholder:"Password"},null,8,["disabled","modelValue"]),P(Me,{loading:e.loading,theme:"blue",class:"mt-2 w-full"},{default:z(()=>[W("Login")]),_:1},8,["loading"]),e.error?(x(),T("span",zC,Z(e.error),1)):pe("",!0)],32))}}),r0="hcaptcha-api-script-id",Yg="_hcaptchaOnLoad";let Mu,Zg;const Mc=new Promise((s,e)=>{Mu=s,Zg=e});function qC(s){if(window.hcaptcha)return Mu(),Mc;if(document.getElementById(r0))return Mc;window[Yg]=Mu;const e=KC(s),t=document.createElement("script");return t.id=r0,t.src=e,t.async=!0,t.defer=!0,t.onerror=n=>{console.error("Failed to load api: "+e,n),Zg("Failed to load api.js")},document.head.appendChild(t),Mc}function KC(s){let e=s.apiEndpoint;return e=cn(e,"render","explicit"),e=cn(e,"onload",Yg),e=cn(e,"recaptchacompat",s.reCaptchaCompat===!1?"off":null),e=cn(e,"hl",s.language),e=cn(e,"sentry",s.sentry),e=cn(e,"custom",s.custom),e=cn(e,"endpoint",s.endpoint),e=cn(e,"assethost",s.assethost),e=cn(e,"imghost",s.imghost),e=cn(e,"reportapi",s.reportapi),e}function cn(s,e,t){if(t!=null){const n=s.includes("?")?"&":"?";return s+n+e+"="+encodeURIComponent(t)}return s}var WC=(s,e)=>{for(const[t,n]of e)s[t]=n;return s};const YC={name:"VueHcaptcha",props:{sitekey:{type:String,required:!0},theme:{type:String,default:void 0},size:{type:String,default:void 0},tabindex:{type:String,default:void 0},language:{type:String,default:void 0},reCaptchaCompat:{type:Boolean,default:!0},challengeContainer:{type:String,default:void 0},rqdata:{type:String,default:void 0},sentry:{type:Boolean,default:!0},custom:{type:Boolean,default:void 0},apiEndpoint:{type:String,default:"https://hcaptcha.com/1/api.js"},endpoint:{type:String,default:void 0},reportapi:{type:String,default:void 0},assethost:{type:String,default:void 0},imghost:{type:String,default:void 0}},data:()=>({widgetId:null,hcaptcha:null,renderedCb:null}),mounted(){return qC(this.$props).then(this.onApiLoaded).catch(this.onError)},unmounted(){this.teardown()},destroyed(){this.teardown()},methods:{teardown(){this.widgetId&&(this.hcaptcha.reset(this.widgetId),this.hcaptcha.remove(this.widgetId))},onApiLoaded(){this.hcaptcha=window.hcaptcha;const s={sitekey:this.sitekey,theme:this.theme,size:this.size,tabindex:this.tabindex,callback:this.onVerify,"expired-callback":this.onExpired,"chalexpired-callback":this.onChallengeExpired,"error-callback":this.onError,"open-callback":this.onOpen,"close-callback":this.onClose};this.challengeContainer&&(s["challenge-container"]=this.challengeContainer),this.widgetId=this.hcaptcha.render(this.$el,s),this.rqdata&&this.hcaptcha.setData(this.widgetId,{rqdata:this.rqdata}),this.onRendered()},execute(){this.widgetId?(this.hcaptcha.execute(this.widgetId),this.onExecuted()):this.renderedCb=()=>{this.renderedCb=null,this.execute()}},executeAsync(){if(this.widgetId)return this.onExecuted(),this.hcaptcha.execute(this.widgetId,{async:!0});let s;const e=new Promise(t=>{s=t});return this.renderedCb=()=>{this.renderedCb=null,s()},e.then(this.executeAsync)},reset(){this.widgetId?(this.hcaptcha.reset(this.widgetId),this.onReset()):this.$emit("error","Element is not rendered yet and thus cannot reset it. Wait for `rendered` event to safely call reset.")},onRendered(){this.$emit("rendered"),this.renderedCb&&this.renderedCb()},onExecuted(){this.$emit("executed")},onReset(){this.$emit("reset")},onError(s){this.$emit("error",s),this.reset()},onVerify(){const s=this.hcaptcha.getResponse(this.widgetId),e=this.hcaptcha.getRespKey(this.widgetId);this.$emit("verify",s,e)},onExpired(){this.$emit("expired")},onChallengeExpired(){this.$emit("challengeExpired")},onOpen(){this.$emit("opened")},onClose(){this.$emit("closed")}}},ZC={id:"hcap-script"};function XC(s,e,t,n,i,r){return x(),T("div",ZC)}var QC=WC(YC,[["render",XC]]);function ir(s){this._maxSize=s,this.clear()}ir.prototype.clear=function(){this._size=0,this._values=Object.create(null)};ir.prototype.get=function(s){return this._values[s]};ir.prototype.set=function(s,e){return this._size>=this._maxSize&&this.clear(),s in this._values||this._size++,this._values[s]=e};var JC=/[^.^\]^[]+|(?=\[\]|\.\.)/g,Xg=/^\d+$/,eA=/^\d/,tA=/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/g,sA=/^\s*(['"]?)(.*?)(\1)\s*$/,of=512,o0=new ir(of),a0=new ir(of),l0=new ir(of),qi={Cache:ir,split:$u,normalizePath:$c,setter:function(s){var e=$c(s);return a0.get(s)||a0.set(s,function(n,i){for(var r=0,o=e.length,a=n;r<o-1;){var l=e[r];if(l==="__proto__"||l==="constructor"||l==="prototype")return n;a=a[e[r++]]}a[e[r]]=i})},getter:function(s,e){var t=$c(s);return l0.get(s)||l0.set(s,function(i){for(var r=0,o=t.length;r<o;)if(i!=null||!e)i=i[t[r++]];else return;return i})},join:function(s){return s.reduce(function(e,t){return e+(af(t)||Xg.test(t)?"["+t+"]":(e?".":"")+t)},"")},forEach:function(s,e,t){nA(Array.isArray(s)?s:$u(s),e,t)}};function $c(s){return o0.get(s)||o0.set(s,$u(s).map(function(e){return e.replace(sA,"$2")}))}function $u(s){return s.match(JC)||[""]}function nA(s,e,t){var n=s.length,i,r,o,a;for(r=0;r<n;r++)i=s[r],i&&(oA(i)&&(i='"'+i+'"'),a=af(i),o=!a&&/^\d+$/.test(i),e.call(t,i,a,o,r,s))}function af(s){return typeof s=="string"&&s&&["'",'"'].indexOf(s.charAt(0))!==-1}function iA(s){return s.match(eA)&&!s.match(Xg)}function rA(s){return tA.test(s)}function oA(s){return!af(s)&&(iA(s)||rA(s))}const aA=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?:['](?:d|ll|m|re|s|t|ve))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['](?:D|LL|M|RE|S|T|VE))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['](?:d|ll|m|re|s|t|ve))?|[A-Z\xc0-\xd6\xd8-\xde]+(?:['](?:D|LL|M|RE|S|T|VE))?|\d*(?:1ST|2ND|3RD|(?![123])\dTH)(?=\b|[a-z_])|\d*(?:1st|2nd|3rd|(?![123])\dth)(?=\b|[A-Z_])|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,nc=s=>s.match(aA)||[],ic=s=>s[0].toUpperCase()+s.slice(1),lf=(s,e)=>nc(s).join(e).toLowerCase(),Qg=s=>nc(s).reduce((e,t)=>`${e}${e?t[0].toUpperCase()+t.slice(1).toLowerCase():t.toLowerCase()}`,""),lA=s=>ic(Qg(s)),cA=s=>lf(s,"_"),uA=s=>lf(s,"-"),dA=s=>ic(lf(s," ")),fA=s=>nc(s).map(ic).join(" ");var Nc={words:nc,upperFirst:ic,camelCase:Qg,pascalCase:lA,snakeCase:cA,kebabCase:uA,sentenceCase:dA,titleCase:fA},cf={exports:{}};cf.exports=function(s){return Jg(hA(s),s)};cf.exports.array=Jg;function Jg(s,e){var t=s.length,n=new Array(t),i={},r=t,o=pA(e),a=gA(s);for(e.forEach(function(c){if(!a.has(c[0])||!a.has(c[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")});r--;)i[r]||l(s[r],r,new Set);return n;function l(c,u,d){if(d.has(c)){var f;try{f=", node was:"+JSON.stringify(c)}catch{f=""}throw new Error("Cyclic dependency"+f)}if(!a.has(c))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(c));if(!i[u]){i[u]=!0;var h=o.get(c)||new Set;if(h=Array.from(h),u=h.length){d.add(c);do{var p=h[--u];l(p,a.get(p),d)}while(u);d.delete(c)}n[--t]=c}}}function hA(s){for(var e=new Set,t=0,n=s.length;t<n;t++){var i=s[t];e.add(i[0]),e.add(i[1])}return Array.from(e)}function pA(s){for(var e=new Map,t=0,n=s.length;t<n;t++){var i=s[t];e.has(i[0])||e.set(i[0],new Set),e.has(i[1])||e.set(i[1],new Set),e.get(i[0]).add(i[1])}return e}function gA(s){for(var e=new Map,t=0,n=s.length;t<n;t++)e.set(s[t],t);return e}const mA=Object.prototype.toString,vA=Error.prototype.toString,_A=RegExp.prototype.toString,yA=typeof Symbol<"u"?Symbol.prototype.toString:()=>"",xA=/^Symbol\((.*)\)(.*)$/;function bA(s){return s!=+s?"NaN":s===0&&1/s<0?"-0":""+s}function c0(s,e=!1){if(s==null||s===!0||s===!1)return""+s;const t=typeof s;if(t==="number")return bA(s);if(t==="string")return e?`"${s}"`:s;if(t==="function")return"[Function "+(s.name||"anonymous")+"]";if(t==="symbol")return yA.call(s).replace(xA,"Symbol($1)");const n=mA.call(s).slice(8,-1);return n==="Date"?isNaN(s.getTime())?""+s:s.toISOString(s):n==="Error"||s instanceof Error?"["+vA.call(s)+"]":n==="RegExp"?_A.call(s):null}function mi(s,e){let t=c0(s,e);return t!==null?t:JSON.stringify(s,function(n,i){let r=c0(this[n],e);return r!==null?r:i},2)}function em(s){return s==null?[]:[].concat(s)}let tm,wA=/\$\{\s*(\w+)\s*\}/g;tm=Symbol.toStringTag;class xs extends Error{static formatError(e,t){const n=t.label||t.path||"this";return n!==t.path&&(t=Object.assign({},t,{path:n})),typeof e=="string"?e.replace(wA,(i,r)=>mi(t[r])):typeof e=="function"?e(t):e}static isError(e){return e&&e.name==="ValidationError"}constructor(e,t,n,i,r){super(),this.value=void 0,this.path=void 0,this.type=void 0,this.errors=void 0,this.params=void 0,this.inner=void 0,this[tm]="Error",this.name="ValidationError",this.value=t,this.path=n,this.type=i,this.errors=[],this.inner=[],em(e).forEach(o=>{if(xs.isError(o)){this.errors.push(...o.errors);const a=o.inner.length?o.inner:[o];this.inner.push(...a)}else this.errors.push(o)}),this.message=this.errors.length>1?`${this.errors.length} errors occurred`:this.errors[0],!r&&Error.captureStackTrace&&Error.captureStackTrace(this,xs)}}let hn={default:"${path} is invalid",required:"${path} is a required field",defined:"${path} must be defined",notNull:"${path} cannot be null",oneOf:"${path} must be one of the following values: ${values}",notOneOf:"${path} must not be one of the following values: ${values}",notType:({path:s,type:e,value:t,originalValue:n})=>{const i=n!=null&&n!==t?` (cast from the value \`${mi(n,!0)}\`).`:".";return e!=="mixed"?`${s} must be a \`${e}\` type, but the final value was: \`${mi(t,!0)}\``+i:`${s} must match the configured type. The validated value was: \`${mi(t,!0)}\``+i}},Xs={length:"${path} must be exactly ${length} characters",min:"${path} must be at least ${min} characters",max:"${path} must be at most ${max} characters",matches:'${path} must match the following: "${regex}"',email:"${path} must be a valid email",url:"${path} must be a valid URL",uuid:"${path} must be a valid UUID",trim:"${path} must be a trimmed string",lowercase:"${path} must be a lowercase string",uppercase:"${path} must be a upper case string"},SA={min:"${path} must be greater than or equal to ${min}",max:"${path} must be less than or equal to ${max}",lessThan:"${path} must be less than ${less}",moreThan:"${path} must be greater than ${more}",positive:"${path} must be a positive number",negative:"${path} must be a negative number",integer:"${path} must be an integer"},Nu={min:"${path} field must be later than ${min}",max:"${path} field must be at earlier than ${max}"},EA={isValue:"${path} field must be ${value}"},Vu={noUnknown:"${path} field has unspecified keys: ${unknown}"},TA={min:"${path} field must have at least ${min} items",max:"${path} field must have less than or equal to ${max} items",length:"${path} must have ${length} items"},CA={notType:s=>{const{path:e,value:t,spec:n}=s,i=n.types.length;if(Array.isArray(t)){if(t.length<i)return`${e} tuple value has too few items, expected a length of ${i} but got ${t.length} for value: \`${mi(t,!0)}\``;if(t.length>i)return`${e} tuple value has too many items, expected a length of ${i} but got ${t.length} for value: \`${mi(t,!0)}\``}return xs.formatError(hn.notType,s)}};Object.assign(Object.create(null),{mixed:hn,string:Xs,number:SA,date:Nu,object:Vu,array:TA,boolean:EA,tuple:CA});const uf=s=>s&&s.__isYupSchema__;class pl{static fromOptions(e,t){if(!t.then&&!t.otherwise)throw new TypeError("either `then:` or `otherwise:` is required for `when()` conditions");let{is:n,then:i,otherwise:r}=t,o=typeof n=="function"?n:(...a)=>a.every(l=>l===n);return new pl(e,(a,l)=>{var c;let u=o(...a)?i:r;return(c=u==null?void 0:u(l))!=null?c:l})}constructor(e,t){this.fn=void 0,this.refs=e,this.refs=e,this.fn=t}resolve(e,t){let n=this.refs.map(r=>r.getValue(t==null?void 0:t.value,t==null?void 0:t.parent,t==null?void 0:t.context)),i=this.fn(n,e,t);if(i===void 0||i===e)return e;if(!uf(i))throw new TypeError("conditions must return a schema object");return i.resolve(t)}}const pa={context:"$",value:"."};class rr{constructor(e,t={}){if(this.key=void 0,this.isContext=void 0,this.isValue=void 0,this.isSibling=void 0,this.path=void 0,this.getter=void 0,this.map=void 0,typeof e!="string")throw new TypeError("ref must be a string, got: "+e);if(this.key=e.trim(),e==="")throw new TypeError("ref must be a non-empty string");this.isContext=this.key[0]===pa.context,this.isValue=this.key[0]===pa.value,this.isSibling=!this.isContext&&!this.isValue;let n=this.isContext?pa.context:this.isValue?pa.value:"";this.path=this.key.slice(n.length),this.getter=this.path&&qi.getter(this.path,!0),this.map=t.map}getValue(e,t,n){let i=this.isContext?n:this.isValue?e:t;return this.getter&&(i=this.getter(i||{})),this.map&&(i=this.map(i)),i}cast(e,t){return this.getValue(e,t==null?void 0:t.parent,t==null?void 0:t.context)}resolve(){return this}describe(){return{type:"ref",key:this.key}}toString(){return`Ref(${this.key})`}static isRef(e){return e&&e.__isYupRef}}rr.prototype.__isYupRef=!0;const Ui=s=>s==null;function cr(s){function e({value:t,path:n="",options:i,originalValue:r,schema:o},a,l){const{name:c,test:u,params:d,message:f,skipAbsent:h}=s;let{parent:p,context:g,abortEarly:m=o.spec.abortEarly,disableStackTrace:_=o.spec.disableStackTrace}=i;function y(M){return rr.isRef(M)?M.getValue(t,p,g):M}function S(M={}){var $;const H=Object.assign({value:t,originalValue:r,label:o.spec.label,path:M.path||n,spec:o.spec},d,M.params);for(const te of Object.keys(H))H[te]=y(H[te]);const ie=new xs(xs.formatError(M.message||f,H),t,H.path,M.type||c,($=M.disableStackTrace)!=null?$:_);return ie.params=H,ie}const C=m?a:l;let E={path:n,parent:p,type:c,from:i.from,createError:S,resolve:y,options:i,originalValue:r,schema:o};const A=M=>{xs.isError(M)?C(M):M?l(null):C(S())},R=M=>{xs.isError(M)?C(M):a(M)};if(h&&Ui(t))return A(!0);let D;try{var L;if(D=u.call(E,t,E),typeof((L=D)==null?void 0:L.then)=="function"){if(i.sync)throw new Error(`Validation test of type: "${E.type}" returned a Promise during a synchronous validate. This test will finish after the validate call has returned`);return Promise.resolve(D).then(A,R)}}catch(M){R(M);return}A(D)}return e.OPTIONS=s,e}function AA(s,e,t,n=t){let i,r,o;return e?(qi.forEach(e,(a,l,c)=>{let u=l?a.slice(1,a.length-1):a;s=s.resolve({context:n,parent:i,value:t});let d=s.type==="tuple",f=c?parseInt(u,10):0;if(s.innerType||d){if(d&&!c)throw new Error(`Yup.reach cannot implicitly index into a tuple type. the path part "${o}" must contain an index to the tuple element, e.g. "${o}[0]"`);if(t&&f>=t.length)throw new Error(`Yup.reach cannot resolve an array item at index: ${a}, in the path: ${e}. because there is no value at that index. `);i=t,t=t&&t[f],s=d?s.spec.types[f]:s.innerType}if(!c){if(!s.fields||!s.fields[u])throw new Error(`The schema does not contain the path: ${e}. (failed at: ${o} which is a type: "${s.type}")`);i=t,t=t&&t[u],s=s.fields[u]}r=u,o=l?"["+a+"]":"."+a}),{schema:s,parent:i,parentPath:r}):{parent:i,parentPath:e,schema:s}}class gl extends Set{describe(){const e=[];for(const t of this.values())e.push(rr.isRef(t)?t.describe():t);return e}resolveAll(e){let t=[];for(const n of this.values())t.push(e(n));return t}clone(){return new gl(this.values())}merge(e,t){const n=this.clone();return e.forEach(i=>n.add(i)),t.forEach(i=>n.delete(i)),n}}function xr(s,e=new Map){if(uf(s)||!s||typeof s!="object")return s;if(e.has(s))return e.get(s);let t;if(s instanceof Date)t=new Date(s.getTime()),e.set(s,t);else if(s instanceof RegExp)t=new RegExp(s),e.set(s,t);else if(Array.isArray(s)){t=new Array(s.length),e.set(s,t);for(let n=0;n<s.length;n++)t[n]=xr(s[n],e)}else if(s instanceof Map){t=new Map,e.set(s,t);for(const[n,i]of s.entries())t.set(n,xr(i,e))}else if(s instanceof Set){t=new Set,e.set(s,t);for(const n of s)t.add(xr(n,e))}else if(s instanceof Object){t={},e.set(s,t);for(const[n,i]of Object.entries(s))t[n]=xr(i,e)}else throw Error(`Unable to clone ${s}`);return t}class Sn{constructor(e){this.type=void 0,this.deps=[],this.tests=void 0,this.transforms=void 0,this.conditions=[],this._mutate=void 0,this.internalTests={},this._whitelist=new gl,this._blacklist=new gl,this.exclusiveTests=Object.create(null),this._typeCheck=void 0,this.spec=void 0,this.tests=[],this.transforms=[],this.withMutation(()=>{this.typeError(hn.notType)}),this.type=e.type,this._typeCheck=e.check,this.spec=Object.assign({strip:!1,strict:!1,abortEarly:!0,recursive:!0,disableStackTrace:!1,nullable:!1,optional:!0,coerce:!0},e==null?void 0:e.spec),this.withMutation(t=>{t.nonNullable()})}get _type(){return this.type}clone(e){if(this._mutate)return e&&Object.assign(this.spec,e),this;const t=Object.create(Object.getPrototypeOf(this));return t.type=this.type,t._typeCheck=this._typeCheck,t._whitelist=this._whitelist.clone(),t._blacklist=this._blacklist.clone(),t.internalTests=Object.assign({},this.internalTests),t.exclusiveTests=Object.assign({},this.exclusiveTests),t.deps=[...this.deps],t.conditions=[...this.conditions],t.tests=[...this.tests],t.transforms=[...this.transforms],t.spec=xr(Object.assign({},this.spec,e)),t}label(e){let t=this.clone();return t.spec.label=e,t}meta(...e){if(e.length===0)return this.spec.meta;let t=this.clone();return t.spec.meta=Object.assign(t.spec.meta||{},e[0]),t}withMutation(e){let t=this._mutate;this._mutate=!0;let n=e(this);return this._mutate=t,n}concat(e){if(!e||e===this)return this;if(e.type!==this.type&&this.type!=="mixed")throw new TypeError(`You cannot \`concat()\` schema's of different types: ${this.type} and ${e.type}`);let t=this,n=e.clone();const i=Object.assign({},t.spec,n.spec);return n.spec=i,n.internalTests=Object.assign({},t.internalTests,n.internalTests),n._whitelist=t._whitelist.merge(e._whitelist,e._blacklist),n._blacklist=t._blacklist.merge(e._blacklist,e._whitelist),n.tests=t.tests,n.exclusiveTests=t.exclusiveTests,n.withMutation(r=>{e.tests.forEach(o=>{r.test(o.OPTIONS)})}),n.transforms=[...t.transforms,...n.transforms],n}isType(e){return e==null?!!(this.spec.nullable&&e===null||this.spec.optional&&e===void 0):this._typeCheck(e)}resolve(e){let t=this;if(t.conditions.length){let n=t.conditions;t=t.clone(),t.conditions=[],t=n.reduce((i,r)=>r.resolve(i,e),t),t=t.resolve(e)}return t}resolveOptions(e){var t,n,i,r;return Object.assign({},e,{from:e.from||[],strict:(t=e.strict)!=null?t:this.spec.strict,abortEarly:(n=e.abortEarly)!=null?n:this.spec.abortEarly,recursive:(i=e.recursive)!=null?i:this.spec.recursive,disableStackTrace:(r=e.disableStackTrace)!=null?r:this.spec.disableStackTrace})}cast(e,t={}){let n=this.resolve(Object.assign({value:e},t)),i=t.assert==="ignore-optionality",r=n._cast(e,t);if(t.assert!==!1&&!n.isType(r)){if(i&&Ui(r))return r;let o=mi(e),a=mi(r);throw new TypeError(`The value of ${t.path||"field"} could not be cast to a value that satisfies the schema type: "${n.type}". 

attempted value: ${o} 
`+(a!==o?`result of cast: ${a}`:""))}return r}_cast(e,t){let n=e===void 0?e:this.transforms.reduce((i,r)=>r.call(this,i,e,this),e);return n===void 0&&(n=this.getDefault(t)),n}_validate(e,t={},n,i){let{path:r,originalValue:o=e,strict:a=this.spec.strict}=t,l=e;a||(l=this._cast(l,Object.assign({assert:!1},t)));let c=[];for(let u of Object.values(this.internalTests))u&&c.push(u);this.runTests({path:r,value:l,originalValue:o,options:t,tests:c},n,u=>{if(u.length)return i(u,l);this.runTests({path:r,value:l,originalValue:o,options:t,tests:this.tests},n,i)})}runTests(e,t,n){let i=!1,{tests:r,value:o,originalValue:a,path:l,options:c}=e,u=g=>{i||(i=!0,t(g,o))},d=g=>{i||(i=!0,n(g,o))},f=r.length,h=[];if(!f)return d([]);let p={value:o,originalValue:a,path:l,options:c,schema:this};for(let g=0;g<r.length;g++){const m=r[g];m(p,u,function(y){y&&(Array.isArray(y)?h.push(...y):h.push(y)),--f<=0&&d(h)})}}asNestedTest({key:e,index:t,parent:n,parentPath:i,originalParent:r,options:o}){const a=e!=null?e:t;if(a==null)throw TypeError("Must include `key` or `index` for nested validations");const l=typeof a=="number";let c=n[a];const u=Object.assign({},o,{strict:!0,parent:n,value:c,originalValue:r[a],key:void 0,[l?"index":"key"]:a,path:l||a.includes(".")?`${i||""}[${c?a:`"${a}"`}]`:(i?`${i}.`:"")+e});return(d,f,h)=>this.resolve(u)._validate(c,u,f,h)}validate(e,t){var n;let i=this.resolve(Object.assign({},t,{value:e})),r=(n=t==null?void 0:t.disableStackTrace)!=null?n:i.spec.disableStackTrace;return new Promise((o,a)=>i._validate(e,t,(l,c)=>{xs.isError(l)&&(l.value=c),a(l)},(l,c)=>{l.length?a(new xs(l,c,void 0,void 0,r)):o(c)}))}validateSync(e,t){var n;let i=this.resolve(Object.assign({},t,{value:e})),r,o=(n=t==null?void 0:t.disableStackTrace)!=null?n:i.spec.disableStackTrace;return i._validate(e,Object.assign({},t,{sync:!0}),(a,l)=>{throw xs.isError(a)&&(a.value=l),a},(a,l)=>{if(a.length)throw new xs(a,e,void 0,void 0,o);r=l}),r}isValid(e,t){return this.validate(e,t).then(()=>!0,n=>{if(xs.isError(n))return!1;throw n})}isValidSync(e,t){try{return this.validateSync(e,t),!0}catch(n){if(xs.isError(n))return!1;throw n}}_getDefault(e){let t=this.spec.default;return t==null?t:typeof t=="function"?t.call(this,e):xr(t)}getDefault(e){return this.resolve(e||{})._getDefault(e)}default(e){return arguments.length===0?this._getDefault():this.clone({default:e})}strict(e=!0){return this.clone({strict:e})}nullability(e,t){const n=this.clone({nullable:e});return n.internalTests.nullable=cr({message:t,name:"nullable",test(i){return i===null?this.schema.spec.nullable:!0}}),n}optionality(e,t){const n=this.clone({optional:e});return n.internalTests.optionality=cr({message:t,name:"optionality",test(i){return i===void 0?this.schema.spec.optional:!0}}),n}optional(){return this.optionality(!0)}defined(e=hn.defined){return this.optionality(!1,e)}nullable(){return this.nullability(!0)}nonNullable(e=hn.notNull){return this.nullability(!1,e)}required(e=hn.required){return this.clone().withMutation(t=>t.nonNullable(e).defined(e))}notRequired(){return this.clone().withMutation(e=>e.nullable().optional())}transform(e){let t=this.clone();return t.transforms.push(e),t}test(...e){let t;if(e.length===1?typeof e[0]=="function"?t={test:e[0]}:t=e[0]:e.length===2?t={name:e[0],test:e[1]}:t={name:e[0],message:e[1],test:e[2]},t.message===void 0&&(t.message=hn.default),typeof t.test!="function")throw new TypeError("`test` is a required parameters");let n=this.clone(),i=cr(t),r=t.exclusive||t.name&&n.exclusiveTests[t.name]===!0;if(t.exclusive&&!t.name)throw new TypeError("Exclusive tests must provide a unique `name` identifying the test");return t.name&&(n.exclusiveTests[t.name]=!!t.exclusive),n.tests=n.tests.filter(o=>!(o.OPTIONS.name===t.name&&(r||o.OPTIONS.test===i.OPTIONS.test))),n.tests.push(i),n}when(e,t){!Array.isArray(e)&&typeof e!="string"&&(t=e,e=".");let n=this.clone(),i=em(e).map(r=>new rr(r));return i.forEach(r=>{r.isSibling&&n.deps.push(r.key)}),n.conditions.push(typeof t=="function"?new pl(i,t):pl.fromOptions(i,t)),n}typeError(e){let t=this.clone();return t.internalTests.typeError=cr({message:e,name:"typeError",skipAbsent:!0,test(n){return this.schema._typeCheck(n)?!0:this.createError({params:{type:this.schema.type}})}}),t}oneOf(e,t=hn.oneOf){let n=this.clone();return e.forEach(i=>{n._whitelist.add(i),n._blacklist.delete(i)}),n.internalTests.whiteList=cr({message:t,name:"oneOf",skipAbsent:!0,test(i){let r=this.schema._whitelist,o=r.resolveAll(this.resolve);return o.includes(i)?!0:this.createError({params:{values:Array.from(r).join(", "),resolved:o}})}}),n}notOneOf(e,t=hn.notOneOf){let n=this.clone();return e.forEach(i=>{n._blacklist.add(i),n._whitelist.delete(i)}),n.internalTests.blacklist=cr({message:t,name:"notOneOf",test(i){let r=this.schema._blacklist,o=r.resolveAll(this.resolve);return o.includes(i)?this.createError({params:{values:Array.from(r).join(", "),resolved:o}}):!0}}),n}strip(e=!0){let t=this.clone();return t.spec.strip=e,t}describe(e){const t=(e?this.resolve(e):this).clone(),{label:n,meta:i,optional:r,nullable:o}=t.spec;return{meta:i,label:n,optional:r,nullable:o,default:t.getDefault(e),type:t.type,oneOf:t._whitelist.describe(),notOneOf:t._blacklist.describe(),tests:t.tests.map(l=>({name:l.OPTIONS.name,params:l.OPTIONS.params})).filter((l,c,u)=>u.findIndex(d=>d.name===l.name)===c)}}}Sn.prototype.__isYupSchema__=!0;for(const s of["validate","validateSync"])Sn.prototype[`${s}At`]=function(e,t,n={}){const{parent:i,parentPath:r,schema:o}=AA(this,e,t,n.context);return o[s](i&&i[r],Object.assign({},n,{parent:i,path:e}))};for(const s of["equals","is"])Sn.prototype[s]=Sn.prototype.oneOf;for(const s of["not","nope"])Sn.prototype[s]=Sn.prototype.notOneOf;let kA=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,LA=/^((https?|ftp):)?\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,RA=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,IA=s=>Ui(s)||s===s.trim(),DA={}.toString();function go(){return new sm}class sm extends Sn{constructor(){super({type:"string",check(e){return e instanceof String&&(e=e.valueOf()),typeof e=="string"}}),this.withMutation(()=>{this.transform((e,t,n)=>{if(!n.spec.coerce||n.isType(e)||Array.isArray(e))return e;const i=e!=null&&e.toString?e.toString():e;return i===DA?e:i})})}required(e){return super.required(e).withMutation(t=>t.test({message:e||hn.required,name:"required",skipAbsent:!0,test:n=>!!n.length}))}notRequired(){return super.notRequired().withMutation(e=>(e.tests=e.tests.filter(t=>t.OPTIONS.name!=="required"),e))}length(e,t=Xs.length){return this.test({message:t,name:"length",exclusive:!0,params:{length:e},skipAbsent:!0,test(n){return n.length===this.resolve(e)}})}min(e,t=Xs.min){return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(n){return n.length>=this.resolve(e)}})}max(e,t=Xs.max){return this.test({name:"max",exclusive:!0,message:t,params:{max:e},skipAbsent:!0,test(n){return n.length<=this.resolve(e)}})}matches(e,t){let n=!1,i,r;return t&&(typeof t=="object"?{excludeEmptyString:n=!1,message:i,name:r}=t:i=t),this.test({name:r||"matches",message:i||Xs.matches,params:{regex:e},skipAbsent:!0,test:o=>o===""&&n||o.search(e)!==-1})}email(e=Xs.email){return this.matches(kA,{name:"email",message:e,excludeEmptyString:!0})}url(e=Xs.url){return this.matches(LA,{name:"url",message:e,excludeEmptyString:!0})}uuid(e=Xs.uuid){return this.matches(RA,{name:"uuid",message:e,excludeEmptyString:!1})}ensure(){return this.default("").transform(e=>e===null?"":e)}trim(e=Xs.trim){return this.transform(t=>t!=null?t.trim():t).test({message:e,name:"trim",test:IA})}lowercase(e=Xs.lowercase){return this.transform(t=>Ui(t)?t:t.toLowerCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>Ui(t)||t===t.toLowerCase()})}uppercase(e=Xs.uppercase){return this.transform(t=>Ui(t)?t:t.toUpperCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>Ui(t)||t===t.toUpperCase()})}}go.prototype=sm.prototype;const PA=/^(\d{4}|[+-]\d{6})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:[ T]?(\d{2}):?(\d{2})(?::?(\d{2})(?:[,.](\d{1,}))?)?(?:(Z)|([+-])(\d{2})(?::?(\d{2}))?)?)?$/;function Rn(s,e=0){return Number(s)||e}function FA(s){const e=PA.exec(s);if(!e)return Date.parse?Date.parse(s):Number.NaN;const t={year:Rn(e[1]),month:Rn(e[2],1)-1,day:Rn(e[3],1),hour:Rn(e[4]),minute:Rn(e[5]),second:Rn(e[6]),millisecond:e[7]?Rn(e[7].substring(0,3)):0,z:e[8]||void 0,plusMinus:e[9]||void 0,hourOffset:Rn(e[10]),minuteOffset:Rn(e[11])};if(t.z===void 0&&t.plusMinus===void 0)return new Date(t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond).valueOf();let n=0;return t.z!=="Z"&&t.plusMinus!==void 0&&(n=t.hourOffset*60+t.minuteOffset,t.plusMinus==="+"&&(n=0-n)),Date.UTC(t.year,t.month,t.day,t.hour,t.minute+n,t.second,t.millisecond)}let OA=new Date(""),MA=s=>Object.prototype.toString.call(s)==="[object Date]";class rc extends Sn{constructor(){super({type:"date",check(e){return MA(e)&&!isNaN(e.getTime())}}),this.withMutation(()=>{this.transform((e,t,n)=>!n.spec.coerce||n.isType(e)||e===null?e:(e=FA(e),isNaN(e)?rc.INVALID_DATE:new Date(e)))})}prepareParam(e,t){let n;if(rr.isRef(e))n=e;else{let i=this.cast(e);if(!this._typeCheck(i))throw new TypeError(`\`${t}\` must be a Date or a value that can be \`cast()\` to a Date`);n=i}return n}min(e,t=Nu.min){let n=this.prepareParam(e,"min");return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(i){return i>=this.resolve(n)}})}max(e,t=Nu.max){let n=this.prepareParam(e,"max");return this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(i){return i<=this.resolve(n)}})}}rc.INVALID_DATE=OA;rc.prototype;function $A(s,e=[]){let t=[],n=new Set,i=new Set(e.map(([o,a])=>`${o}-${a}`));function r(o,a){let l=qi.split(o)[0];n.add(l),i.has(`${a}-${l}`)||t.push([a,l])}for(const o of Object.keys(s)){let a=s[o];n.add(o),rr.isRef(a)&&a.isSibling?r(a.path,o):uf(a)&&"deps"in a&&a.deps.forEach(l=>r(l,o))}return cf.exports.array(Array.from(n),t).reverse()}function u0(s,e){let t=1/0;return s.some((n,i)=>{var r;if((r=e.path)!=null&&r.includes(n))return t=i,!0}),t}function nm(s){return(e,t)=>u0(s,e)-u0(s,t)}const NA=(s,e,t)=>{if(typeof s!="string")return s;let n=s;try{n=JSON.parse(s)}catch{}return t.isType(n)?n:s};function Ua(s){if("fields"in s){const e={};for(const[t,n]of Object.entries(s.fields))e[t]=Ua(n);return s.setFields(e)}if(s.type==="array"){const e=s.optional();return e.innerType&&(e.innerType=Ua(e.innerType)),e}return s.type==="tuple"?s.optional().clone({types:s.spec.types.map(Ua)}):"optional"in s?s.optional():s}const VA=(s,e)=>{const t=[...qi.normalizePath(e)];if(t.length===1)return t[0]in s;let n=t.pop(),i=qi.getter(qi.join(t),!0)(s);return!!(i&&n in i)};let d0=s=>Object.prototype.toString.call(s)==="[object Object]";function BA(s,e){let t=Object.keys(s.fields);return Object.keys(e).filter(n=>t.indexOf(n)===-1)}const UA=nm([]);function im(s){return new rm(s)}class rm extends Sn{constructor(e){super({type:"object",check(t){return d0(t)||typeof t=="function"}}),this.fields=Object.create(null),this._sortErrors=UA,this._nodes=[],this._excludedEdges=[],this.withMutation(()=>{e&&this.shape(e)})}_cast(e,t={}){var n;let i=super._cast(e,t);if(i===void 0)return this.getDefault(t);if(!this._typeCheck(i))return i;let r=this.fields,o=(n=t.stripUnknown)!=null?n:this.spec.noUnknown,a=[].concat(this._nodes,Object.keys(i).filter(d=>!this._nodes.includes(d))),l={},c=Object.assign({},t,{parent:l,__validating:t.__validating||!1}),u=!1;for(const d of a){let f=r[d],h=d in i;if(f){let p,g=i[d];c.path=(t.path?`${t.path}.`:"")+d,f=f.resolve({value:g,context:t.context,parent:l});let m=f instanceof Sn?f.spec:void 0,_=m==null?void 0:m.strict;if(m!=null&&m.strip){u=u||d in i;continue}p=!t.__validating||!_?f.cast(i[d],c):i[d],p!==void 0&&(l[d]=p)}else h&&!o&&(l[d]=i[d]);(h!==d in l||l[d]!==i[d])&&(u=!0)}return u?l:i}_validate(e,t={},n,i){let{from:r=[],originalValue:o=e,recursive:a=this.spec.recursive}=t;t.from=[{schema:this,value:o},...r],t.__validating=!0,t.originalValue=o,super._validate(e,t,n,(l,c)=>{if(!a||!d0(c)){i(l,c);return}o=o||c;let u=[];for(let d of this._nodes){let f=this.fields[d];!f||rr.isRef(f)||u.push(f.asNestedTest({options:t,key:d,parent:c,parentPath:t.path,originalParent:o}))}this.runTests({tests:u,value:c,originalValue:o,options:t},n,d=>{i(d.sort(this._sortErrors).concat(l),c)})})}clone(e){const t=super.clone(e);return t.fields=Object.assign({},this.fields),t._nodes=this._nodes,t._excludedEdges=this._excludedEdges,t._sortErrors=this._sortErrors,t}concat(e){let t=super.concat(e),n=t.fields;for(let[i,r]of Object.entries(this.fields)){const o=n[i];n[i]=o===void 0?r:o}return t.withMutation(i=>i.setFields(n,[...this._excludedEdges,...e._excludedEdges]))}_getDefault(e){if("default"in this.spec)return super._getDefault(e);if(!this._nodes.length)return;let t={};return this._nodes.forEach(n=>{var i;const r=this.fields[n];let o=e;(i=o)!=null&&i.value&&(o=Object.assign({},o,{parent:o.value,value:o.value[n]})),t[n]=r&&"getDefault"in r?r.getDefault(o):void 0}),t}setFields(e,t){let n=this.clone();return n.fields=e,n._nodes=$A(e,t),n._sortErrors=nm(Object.keys(e)),t&&(n._excludedEdges=t),n}shape(e,t=[]){return this.clone().withMutation(n=>{let i=n._excludedEdges;return t.length&&(Array.isArray(t[0])||(t=[t]),i=[...n._excludedEdges,...t]),n.setFields(Object.assign(n.fields,e),i)})}partial(){const e={};for(const[t,n]of Object.entries(this.fields))e[t]="optional"in n&&n.optional instanceof Function?n.optional():n;return this.setFields(e)}deepPartial(){return Ua(this)}pick(e){const t={};for(const n of e)this.fields[n]&&(t[n]=this.fields[n]);return this.setFields(t,this._excludedEdges.filter(([n,i])=>e.includes(n)&&e.includes(i)))}omit(e){const t=[];for(const n of Object.keys(this.fields))e.includes(n)||t.push(n);return this.pick(t)}from(e,t,n){let i=qi.getter(e,!0);return this.transform(r=>{if(!r)return r;let o=r;return VA(r,e)&&(o=Object.assign({},r),n||delete o[e],o[t]=i(r)),o})}json(){return this.transform(NA)}noUnknown(e=!0,t=Vu.noUnknown){typeof e!="boolean"&&(t=e,e=!0);let n=this.test({name:"noUnknown",exclusive:!0,message:t,test(i){if(i==null)return!0;const r=BA(this.schema,i);return!e||r.length===0||this.createError({params:{unknown:r.join(", ")}})}});return n.spec.noUnknown=e,n}unknown(e=!0,t=Vu.noUnknown){return this.noUnknown(!e,t)}transformKeys(e){return this.transform(t=>{if(!t)return t;const n={};for(const i of Object.keys(t))n[e(i)]=t[i];return n})}camelCase(){return this.transformKeys(Nc.camelCase)}snakeCase(){return this.transformKeys(Nc.snakeCase)}constantCase(){return this.transformKeys(e=>Nc.snakeCase(e).toUpperCase())}describe(e){const t=(e?this.resolve(e):this).clone(),n=super.describe(e);n.fields={};for(const[r,o]of Object.entries(t.fields)){var i;let a=e;(i=a)!=null&&i.value&&(a=Object.assign({},a,{parent:a.value,value:a.value[r]})),n.fields[r]=o.describe(a)}return n}}im.prototype=rm.prototype;const HA={key:0,class:"text-red-500 text-sm -mt-1.5"},GA={key:1,class:"text-xs text-right text-zinc-400 mb-3 mt-0.5"},zA={key:2,class:"text-red-500 text-sm -mt-1.5"},jA=v("p",{class:"text-xs text-right text-zinc-400 mt-0.5"},[v("span",{class:"mr-0"},"*"),W(" We may send the occasional email ")],-1),qA={key:0,class:"flex gap-3 mt-3 mb-3"},KA={key:0},WA={key:1},YA={key:1,class:"text-sm text-red-500 -mt-1.5"},ZA={key:2,class:"text-sm text-zinc-400 -mt-1.5"},XA={key:4,class:"text-red-500 text-sm -mt-1.5"},QA={key:5,class:"text-sm text-center text-red-500"},f0=60,JA=De({__name:"AuthRegister",setup(s){const e=ue(),t=Ps({email:"",username:"",password:"",code:"",loading:!1}),n=ue({}),i=im().shape({email:go().email().required().test("has-tld","Please enter a valid email address",f=>{const[h,p]=f.split("@");return p!==void 0&&p.includes(".")}),username:go().required().min(3,"Username must be at least 3 characters long").max(20,"Username can be at most 20 characters long").matches(/^[a-zA-Z0-9]+$/,"Only alphanumeric characters are allowed."),password:go().required().min(6).max(60),code:go().required().min(6).max(6)}),r=async f=>{try{await i.validateAt(f,t),delete n.value[f]}catch(h){n.value[f]=h.errors[0]}},o=async()=>{try{await i.validate(t,{abortEarly:!1}),n.value={}}catch(f){n.value=f.inner.reduce((h,p)=>(h[p.path]=p.message,h),{})}},a=ue(!1),l=ue(null),c=ue(f0),u=async f=>{if(a.value=!0,l.value){a.value=!1;return}try{await r("email")}catch(h){a.value=!1,n.value.code=h;return}try{await qe.user.sendVerificationMail(t.email,f)}catch(h){n.value.code=h,e.value.reset();return}finally{a.value=!1}l.value=setInterval(()=>{c.value--,c.value<=0&&(clearInterval(l.value),l.value=null,c.value=f0)},1e3)},d=async()=>{t.loading=!0;try{await o()}catch{t.loading=!1;return}try{await qe.user.register(t.username,t.email,t.password,t.code),window.location.reload()}catch(f){n.value.general=f}finally{t.loading=!1}};return(f,h)=>(x(),T("form",{onSubmit:d},[P(hs,{onBlur:h[0]||(h[0]=p=>r("username")),onInput:h[1]||(h[1]=p=>n.value.username&&r("username")),modelValue:t.username,"onUpdate:modelValue":h[2]||(h[2]=p=>t.username=p),type:"text",placeholder:"Username",class:"mt-3"},null,8,["modelValue"]),n.value.username?(x(),T("span",HA,Z(n.value.username),1)):(x(),T("p",GA,"This will be your publicly visible username")),P(hs,{onBlur:h[3]||(h[3]=p=>r("email")),onInput:h[4]||(h[4]=p=>n.value.email&&r("email")),modelValue:t.email,"onUpdate:modelValue":h[5]||(h[5]=p=>t.email=p),type:"email",placeholder:"E-Mail"},null,8,["modelValue"]),n.value.email?(x(),T("span",zA,Z(n.value.email),1)):pe("",!0),jA,t.email.length?(x(),T(_e,{key:3},[t.email.length?(x(),T("div",qA,[P(hs,{onBlur:h[6]||(h[6]=p=>r("code")),onInput:h[7]||(h[7]=p=>n.value.code&&r("code")),modelValue:t.code,"onUpdate:modelValue":h[8]||(h[8]=p=>t.code=p),type:"text",class:"flex-1",placeholder:"Enter 6-digit code"},null,8,["modelValue"]),P(Me,{type:"button",onClick:h[9]||(h[9]=p=>e.value.execute()),class:"shrink-0",disabled:l.value!=null||n.value.email!==void 0,loading:a.value,theme:"blue"},{default:z(()=>[l.value?(x(),T("span",WA,"Resend ("+Z(c.value)+"s)",1)):(x(),T("span",KA,"Send Code"))]),_:1},8,["disabled","loading"]),P(w(QC),{ref_key:"captcha",ref:e,onVerify:u,class:"absolute",size:"invisible",sitekey:w(GC),theme:"dark"},null,8,["sitekey"])])):pe("",!0),n.value.code?(x(),T("p",YA,Z(n.value.code),1)):(x(),T("p",ZA,"A verification code will be sent to your email address"))],64)):pe("",!0),P(hs,{onBlur:h[10]||(h[10]=p=>r("password")),onInput:h[11]||(h[11]=p=>n.value.password&&r("password")),modelValue:t.password,"onUpdate:modelValue":h[12]||(h[12]=p=>t.password=p),class:"mt-3",type:"password",placeholder:"Password"},null,8,["modelValue"]),n.value.password?(x(),T("span",XA,Z(n.value.password),1)):pe("",!0),P(Me,{onClick:d,loading:t.loading,theme:"blue",class:"mt-3 w-full"},{default:z(()=>[W("Sign Up")]),_:1},8,["loading"]),n.value.general?(x(),T("span",QA,Z(n.value.general),1)):pe("",!0)],32))}}),ek={class:"p-4"},tk={class:"flex gap-3 items-center"},sk={class:"bg-zinc-800 rounded-md p-3"},nk=v("div",null,[v("p",{class:"text-2xl font-medium"},"Welcome Back,"),v("p",{class:"text-zinc-400 text-sm"},"Sign in to use your account")],-1),ik={class:"bg-zinc-800 rounded-md p-3"},rk=v("div",null,[v("p",{class:"text-2xl font-medium"},"Sign Up"),v("p",{class:"text-zinc-400 text-sm"},"Create an account to continue")],-1),ok=v("hr",{class:"-mx-4 my-4 border-zinc-800"},null,-1),ak=v("hr",{class:"-mx-4 my-4 border-zinc-800"},null,-1),h0=De({__name:"Auth",setup(s){const e=ue("login");return(t,n)=>(x(),T("div",ek,[v("div",tk,[e.value==="login"?(x(),T(_e,{key:0},[v("div",sk,[P(Re,{name:"account-key-outline",class:"h-7 w-7"})]),nk],64)):(x(),T(_e,{key:1},[v("div",ik,[P(Re,{name:"account-plus",class:"h-7 w-7"})]),rk],64))]),ok,v("div",null,[e.value==="login"?(x(),ae(jC,{key:0})):(x(),ae(JA,{key:1}))]),ak,e.value==="login"?(x(),ae(Me,{key:0,class:"block w-full",onClick:n[0]||(n[0]=i=>e.value="register")},{default:z(()=>[W("Sign Up")]),_:1})):(x(),ae(Me,{key:1,class:"block w-full",onClick:n[1]||(n[1]=i=>e.value="login")},{default:z(()=>[W("Log In")]),_:1}))]))}}),lk={key:0,class:"fixed inset-0 flex items-center justify-center h-full z-50 px-3"},ck={class:"grid grid-cols-6 items-center"},uk=v("div",{class:"col-span-1"},null,-1),dk={class:"col-span-4 text-center"},fk={class:"text-xl font-medium"},hk={class:"col-span-1 flex justify-end z-50"},oc=De({__name:"Dialog",props:{modelValue:{type:Boolean},title:{},wide:{type:Boolean}},emits:["update:modelValue"],setup(s,{emit:e}){const t=s,n=e;return dt(()=>t.modelValue,i=>{const r="overflow-hidden",o=document.querySelector("html");i?o.classList.add(r):o.classList.remove(r)}),(i,r)=>(x(),ae(Jd,{to:"body"},[t.modelValue?(x(),T("div",lk,[v("div",{class:"fixed inset-0 bg-black/80 overflow-hidden h-full w-full",onClick:r[0]||(r[0]=o=>n("update:modelValue",!1))}),v("div",{class:Je([t.wide?["md:max-w-sm","lg:max-w-[820px]"]:["md:max-w-sm","lg:max-w-md"],"dialog origin-center relative bg-zinc-900 p-4 rounded-md shadow-md overflow-y-auto max-h-[90vh] flex-1 text-white"])},[v("div",ck,[uk,v("div",dk,[v("h3",fk,Z(t.title),1)]),v("div",hk,[P(Me,{theme:"transparent",onClick:r[1]||(r[1]=o=>n("update:modelValue",!1))},{default:z(()=>[P(Re,{name:"close",class:"h-6 w-6 text-zinc-400"})]),_:1})])]),nr(i.$slots,"default")],2)])):pe("",!0)]))}});var pk=!1;/*!
 * pinia v2.1.7
 * (c) 2023 Eduardo San Martin Morote
 * @license MIT
 */let om;const ac=s=>om=s,am=Symbol();function Bu(s){return s&&typeof s=="object"&&Object.prototype.toString.call(s)==="[object Object]"&&typeof s.toJSON!="function"}var Eo;(function(s){s.direct="direct",s.patchObject="patch object",s.patchFunction="patch function"})(Eo||(Eo={}));function gk(){const s=B1(!0),e=s.run(()=>ue({}));let t=[],n=[];const i=zl({install(r){ac(i),i._a=r,r.provide(am,i),r.config.globalProperties.$pinia=i,n.forEach(o=>t.push(o)),n=[]},use(r){return!this._a&&!pk?n.push(r):t.push(r),this},_p:t,_a:null,_e:s,_s:new Map,state:e});return i}const lm=()=>{};function p0(s,e,t,n=lm){s.push(e);const i=()=>{const r=s.indexOf(e);r>-1&&(s.splice(r,1),n())};return!t&&Od()&&U1(i),i}function ur(s,...e){s.slice().forEach(t=>{t(...e)})}const mk=s=>s();function Uu(s,e){s instanceof Map&&e instanceof Map&&e.forEach((t,n)=>s.set(n,t)),s instanceof Set&&e instanceof Set&&e.forEach(s.add,s);for(const t in e){if(!e.hasOwnProperty(t))continue;const n=e[t],i=s[t];Bu(i)&&Bu(n)&&s.hasOwnProperty(t)&&!It(n)&&!Bn(n)?s[t]=Uu(i,n):s[t]=n}return s}const vk=Symbol();function _k(s){return!Bu(s)||!s.hasOwnProperty(vk)}const{assign:ti}=Object;function yk(s){return!!(It(s)&&s.effect)}function xk(s,e,t,n){const{state:i,actions:r,getters:o}=e,a=t.state.value[s];let l;function c(){a||(t.state.value[s]=i?i():{});const u=yy(t.state.value[s]);return ti(u,r,Object.keys(o||{}).reduce((d,f)=>(d[f]=zl(ut(()=>{ac(t);const h=t._s.get(s);return o[f].call(h,h)})),d),{}))}return l=cm(s,c,e,t,n,!0),l}function cm(s,e,t={},n,i,r){let o;const a=ti({actions:{}},t),l={deep:!0};let c,u,d=[],f=[],h;const p=n.state.value[s];!r&&!p&&(n.state.value[s]={}),ue({});let g;function m(I){let D;c=u=!1,typeof I=="function"?(I(n.state.value[s]),D={type:Eo.patchFunction,storeId:s,events:h}):(Uu(n.state.value[s],I),D={type:Eo.patchObject,payload:I,storeId:s,events:h});const L=g=Symbol();so().then(()=>{g===L&&(c=!0)}),u=!0,ur(d,D,n.state.value[s])}const _=r?function(){const{state:D}=t,L=D?D():{};this.$patch(M=>{ti(M,L)})}:lm;function y(){o.stop(),d=[],f=[],n._s.delete(s)}function S(I,D){return function(){ac(n);const L=Array.from(arguments),M=[],$=[];function H(X){M.push(X)}function ie(X){$.push(X)}ur(f,{args:L,name:I,store:E,after:H,onError:ie});let te;try{te=D.apply(this&&this.$id===s?this:E,L)}catch(X){throw ur($,X),X}return te instanceof Promise?te.then(X=>(ur(M,X),X)).catch(X=>(ur($,X),Promise.reject(X))):(ur(M,te),te)}}const C={_p:n,$id:s,$onAction:p0.bind(null,f),$patch:m,$reset:_,$subscribe(I,D={}){const L=p0(d,I,D.detached,()=>M()),M=o.run(()=>dt(()=>n.state.value[s],$=>{(D.flush==="sync"?u:c)&&I({storeId:s,type:Eo.direct,events:h},$)},ti({},l,D)));return L},$dispose:y},E=Ps(C);n._s.set(s,E);const R=(n._a&&n._a.runWithContext||mk)(()=>n._e.run(()=>(o=B1()).run(e)));for(const I in R){const D=R[I];if(It(D)&&!yk(D)||Bn(D))r||(p&&_k(D)&&(It(D)?D.value=p[I]:Uu(D,p[I])),n.state.value[s][I]=D);else if(typeof D=="function"){const L=S(I,D);R[I]=L,a.actions[I]=D}}return ti(E,R),ti(nt(E),R),Object.defineProperty(E,"$state",{get:()=>n.state.value[s],set:I=>{m(D=>{ti(D,I)})}}),n._p.forEach(I=>{ti(E,o.run(()=>I({store:E,app:n._a,pinia:n,options:a})))}),p&&r&&t.hydrate&&t.hydrate(E.$state,p),c=!0,u=!0,E}function lc(s,e,t){let n,i;const r=typeof e=="function";typeof s=="string"?(n=s,i=r?t:e):(i=s,n=s.id);function o(a,l){const c=u2();return a=a||(c?Hs(am,null):null),a&&ac(a),a=om,a._s.has(n)||(r?cm(n,e,i,a):xk(n,i,a)),a._s.get(n)}return o.$id=n,o}function Gt(s){{s=nt(s);const e={};for(const t in s){const n=s[t];(It(n)||Bn(n))&&(e[t]=wy(s,t))}return e}}const jn=lc("dialogs",()=>{const s=ue(!1),e=ue(!1);let t=!1;const n=()=>{const r=document.getElementById("player");!r||r.paused||(r.pause(),t=!0)},i=()=>{if(!t)return;t=!1;const r=document.getElementById("player");!r||r.play()};return dt(()=>s.value,r=>r?n():i()),dt(()=>e.value,r=>r?n():i()),{authDialog:s,deviceDialog:e}}),um="/logo.white.svg";class bk{constructor(){ze(this,"toyName","Handy");ze(this,"storageKey","handy");ze(this,"baseUrl","https://www.handyfeeling.com/api/handy/v2");ze(this,"_connected",!1);ze(this,"_estimatedServerTimeOffset",0);ze(this,"_error");ze(this,"_setupError");ze(this,"_scanning",!1);ze(this,"_prepared",!1);ze(this,"_syncInterval",-1);ze(this,"handler",{get:(e,t)=>typeof e[t]=="object"&&e[t]!==null?new Proxy(e[t],this.handler):e[t],set:(e,t,n)=>(e[t]=n,localStorage.setItem(this.storageKey,JSON.stringify(e)),this._connected&&(t==="limits"?this.json("/slide","PUT",{min:n[0],max:n[1]}).then(i=>console.log(i)).catch(i=>console.log(i)):t==="offset"&&this.json("/hstp/offset","PUT",{offset:n}).then(i=>console.log(i)).catch(i=>console.log(i))),!0)});ze(this,"settings",new Proxy({invert:!1,offset:0,limits:[0,100],key:""},this.handler));const e=localStorage.getItem(this.storageKey);if(e){const t=JSON.parse(e);this.settings.key=t.key||"",this.settings.invert=t.invert||!1,this.settings.offset=t.offset||0,this.settings.limits=t.limits||[0,100]}if(this.settings.key===""){const t=localStorage.getItem("connectionKey");t&&(this.settings.key=t)}}get connected(){return this._connected}get scanning(){return this._scanning}get error(){return this._error}async connect(){if(this.settings.key.length<5||this._scanning)return;this._scanning=!0,this._error=void 0;let e;try{e=await this.json("/connected")}catch(t){this._error=t,this._connected=!1,this._scanning=!1;return}if("connected"in e&&!e.connected){this._error="Device not connected",this._connected=!1,this._scanning=!1;return}try{e=await this.json("/info")}catch(t){this._error=t,this._connected=!1,this._scanning=!1;return}if("error"in e){this._error=e.error.message,this._scanning=!1;return}if(e.fwStatus===1){this._error="Firmware update required",this._scanning=!1;return}try{e=await this.json("/settings")}catch{this._error="Couldn't get Handy settings",this._scanning=!1;return}if("error"in e){this._error=`${e.error.name} (${e.error.code})`,this._connected=e.error.connected,this._scanning=!1;return}this.settings.limits[0]=e.slideMin||0,this.settings.limits[1]=e.slideMax||100;try{e=await this.json("/hstp/offset")}catch{this._error="Couldn't get Handy offset",this._scanning=!1;return}this.settings.offset=e.offset||0;try{e=await this.json("/mode","PUT",{mode:1})}catch(t){this._error=t,this._scanning=!1;return}if("error"in e){this._error=`${e.error.name} (${e.error.code})`,this._connected=e.error.connected,this._scanning=!1;return}try{await this.offset(10)}catch(t){this._scanning=!1,this._error=t;return}this._syncInterval=setInterval(async()=>{await this.offset(10)},6e4),this._connected=!0,this._scanning=!1}disconnect(){this._scanning=!1,this._error=void 0,this._prepared=!1,this._connected=!1,this._setupError=void 0,clearInterval(this._syncInterval)}prepare(e){return this._prepared=!1,new Promise((t,n)=>{if(!this._connected)return t();this._setupError=void 0,this.settings.invert&&(e+="?reverse"),this.json("/hssp/setup","PUT",{url:e}).then(i=>{if("error"in i)return this._connected=i.error.connected,this._setupError=i.error.name,n(`${i.error.name} (${i.error.code})`);this._prepared=!0,this._connected=!0,t()}).catch(i=>n(i))})}play(e){return new Promise(async(t,n)=>{if(!this._connected||this._setupError)return t();this.json("/hssp/play","PUT",{startTime:e,estimatedServerTime:Math.trunc(new Date().getTime()+this._estimatedServerTimeOffset)}).then(i=>{if("error"in i)return this._connected=i.error.connected,n(`${i.error.name} (${i.error.code})`);this._connected=!0,t()}).catch(i=>n(i))})}stop(){return new Promise((e,t)=>{if(!this._connected||!this._prepared)return e();this.json("/hssp/stop","PUT").then(n=>{if("error"in n)return this._connected=n.error.connected,t(`${n.error.name} (${n.error.code})`);this._connected=!0,e(n)}).catch(n=>t(n))})}serverTime(){return new Promise((e,t)=>{this.json("/servertime").then(n=>e(n.serverTime)).catch(n=>t(n))})}async offset(e=30){await this.serverTime();let t=[];for(let o=0;o<e;o++){const a=new Date().valueOf(),l=await this.serverTime(),c=new Date().valueOf(),u=c-a,f=l+u/2-c;t.push(f)}const n=t.reduce((o,a)=>o+a,0)/t.length,i=t.map(o=>Math.pow(o-n,2)),r=Math.sqrt(i.reduce((o,a)=>o+a,0)/i.length);return t=t.filter(o=>Math.abs(o-n)<r),this._estimatedServerTimeOffset=t.reduce((o,a)=>o+a)/t.length,this._estimatedServerTimeOffset}json(e,t="GET",n){return new Promise((i,r)=>{fetch(this.baseUrl+e,{method:t,body:JSON.stringify(n),headers:{"Content-Type":"application/json",Accept:"application/json","X-Connection-Key":this.settings.key}}).then(o=>o.json()).then(o=>{console.log(`[handy] url=${e} method=${t} req_body=${JSON.stringify(n)} resp_body=${JSON.stringify(o)}`),i(o)}).catch(o=>{r(o)})})}}const df=(s,e)=>{const t=localStorage.getItem(s),n=t!==null?JSON.parse(t):e,i={get(r,o){return r[o]},set(r,o,a){return r[o]=a,localStorage.setItem(s,JSON.stringify(r)),!0}};return new Proxy(n,i)};class wk{constructor(){ze(this,"toyName","OSR");ze(this,"_error");ze(this,"_port");ze(this,"_scanning",!1);ze(this,"settings",df("osr",{limits:[0,100],invert:!1}));if(!("serial"in navigator)){this._error="This browser does not support Web Serial";return}navigator.serial.addEventListener("disconnect",()=>this._port=void 0)}connect(){this._scanning=!0,navigator.serial.requestPort().then(e=>{this._port=e,e.open({baudRate:115200}).then(()=>{}).catch(t=>{console.log(t)})}).catch(e=>{console.log(e)}).finally(()=>{this._scanning=!1})}disconnect(){!this._port||this._port.close().catch(e=>{console.log(e)}).finally(()=>{this._port=void 0})}move(e,t){if(!this._port)return;const[n,i]=this.settings.limits;e=e/100*(i-n)+n,e=Math.round(e),this.settings.invert&&(e=100-e),e<1&&(e=1),e>100&&(e=100);const r=("0"+e).slice(-2);console.log("[OSR][SEND]",`L0${r}I${t.toFixed(0)}`);const o=this._port.writable.getWriter();o.write(new TextEncoder().encode(`L0${r}I${t.toFixed(0)}
`)),o.releaseLock()}get error(){return this._error}get scanning(){return this._scanning}get connected(){return this._port}}function Or(s,e){return s.then(t=>[null,t]).catch(t=>e?[Object.assign({},t,e),void 0]:[t,void 0])}class dm{constructor(){ze(this,"_client");ze(this,"_scanning",!1);ze(this,"_devices",[]);ze(this,"_error");ze(this,"buttplug",window.Buttplug);ze(this,"settings",df("buttplug",{limits:[0,100],invert:!1}))}registerListener(){!this._client||(this._client.on("deviceadded",()=>{this._scanning=!1,this._devices=this._client.Devices}),this._client.on("deviceremoved",()=>{this._scanning=!1,this._devices=this._client.Devices}))}get scanning(){return this._scanning}get error(){return this._error}get devices(){return this._devices}get connected(){return this._client&&this._devices.length>0}limit(e){const[t,n]=this.settings.limits;return e=e/100*(n-t)+t,e=Math.round(e),this.settings.invert&&(e=n-e),e}}class Sk extends dm{constructor(){super(...arguments);ze(this,"toyName","buttplug-external");ze(this,"_address","");ze(this,"_connected",!1);ze(this,"_key","intiface")}get address(){return this._address===""&&(this._address=localStorage.getItem(this._key)||"ws://localhost:12345"),this._address}set address(t){this._address=t,localStorage.setItem(this._key,t)}async connect(){if(this._scanning=!0,this._error=void 0,!this._client){let t;if([t]=await Or(this.buttplug.buttplugInit()),t){this._scanning=!1,this._error="This browser does not support WebAssembly";return}const n=new this.buttplug.ButtplugWebsocketConnectorOptions;if(n.Address=this.address,this._client=new this.buttplug.ButtplugClient("FapTap"),[t]=await Or(this._client.connect(n)),t){this._scanning=!1,this._client=void 0,this._error=t.message;return}this._connected=!0,this._devices=this._client.Devices,this.registerListener(),Or(this._client.startScanning()).then()}this._scanning=!1}disconnect(){this._client&&(this._client.disconnect(),this._client=void 0,this._connected=!1)}get connected(){return this._connected}}class Ek extends dm{constructor(){super(...arguments);ze(this,"toyName","buttplug-embedded")}async connect(){if(this._scanning=!0,!this._client){let n;if([n]=await Or(this.buttplug.buttplugInit()),n){this._scanning=!1,this._error="This browser does not support WebAssembly";return}if(!this.hasWebBluetooth()){this._scanning=!1,this._error="This browser does not support Bluetooth";return}const i=new this.buttplug.ButtplugEmbeddedConnectorOptions;if(this._client=new this.buttplug.ButtplugClient("FapTap"),[n]=await Or(this._client.connect(i)),n){this._scanning=!1,this._error=n.message;return}this.registerListener()}const[t]=await Or(this._client.startScanning());if(t){this._scanning=!1,this._error=t.message;return}setTimeout(()=>{!this._client.Connected||(this._scanning=!1,this._client.stopScanning().catch(n=>console.log(n)))},2e4)}hasWebBluetooth(){return typeof window<"u"&&typeof window.navigator<"u"&&navigator.bluetooth!==void 0}}function g0(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(s,i).enumerable})),t.push.apply(t,n)}return t}function Oe(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?g0(Object(t),!0).forEach(function(n){Ce(s,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):g0(Object(t)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(t,n))})}return s}function Bo(s){return Bo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bo(s)}function Dt(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function m0(s,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,n.key,n)}}function Pt(s,e,t){return e&&m0(s.prototype,e),t&&m0(s,t),Object.defineProperty(s,"prototype",{writable:!1}),s}function Ce(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function fm(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),e&&Hu(s,e)}function ml(s){return ml=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ml(s)}function Hu(s,e){return Hu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},Hu(s,e)}function Tk(s,e){if(s==null)return{};var t,n,i=function(o,a){if(o==null)return{};var l,c,u={},d=Object.keys(o);for(c=0;c<d.length;c++)l=d[c],a.indexOf(l)>=0||(u[l]=o[l]);return u}(s,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);for(n=0;n<r.length;n++)t=r[n],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(s,t)&&(i[t]=s[t])}return i}function Ck(s,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(s)}function hm(s){var e=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var t,n=ml(s);if(e){var i=ml(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return Ck(this,t)}}function tn(s,e){return function(t){if(Array.isArray(t))return t}(s)||function(t,n){var i=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(i!=null){var r,o,a=[],l=!0,c=!1;try{for(i=i.call(t);!(l=(r=i.next()).done)&&(a.push(r.value),!n||a.length!==n);l=!0);}catch(u){c=!0,o=u}finally{try{l||i.return==null||i.return()}finally{if(c)throw o}}return a}}(s,e)||ff(s,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function vl(s){return function(e){if(Array.isArray(e))return Gu(e)}(s)||function(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}(s)||ff(s)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ff(s,e){if(s){if(typeof s=="string")return Gu(s,e);var t=Object.prototype.toString.call(s).slice(8,-1);return t==="Object"&&s.constructor&&(t=s.constructor.name),t==="Map"||t==="Set"?Array.from(s):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Gu(s,e):void 0}}function Gu(s,e){(e==null||e>s.length)&&(e=s.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=s[t];return n}function En(s,e){var t=typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(!t){if(Array.isArray(s)||(t=ff(s))||e&&s&&typeof s.length=="number"){t&&(s=t);var n=0,i=function(){};return{s:i,n:function(){return n>=s.length?{done:!0}:{done:!1,value:s[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var r,o=!0,a=!1;return{s:function(){t=t.call(s)},n:function(){var l=t.next();return o=l.done,l},e:function(l){a=!0,r=l},f:function(){try{o||t.return==null||t.return()}finally{if(a)throw r}}}}var Qi={DEBUG:!1,LIB_VERSION:"1.105.7"},Ak=Array.isArray,pm=Object.prototype,gm=pm.hasOwnProperty,Xo=pm.toString,Ht=Ak||function(s){return Xo.call(s)==="[object Array]"},v0=function(s){return Xo.call(s)==="[object Uint8Array]"},Gs=function(s){return typeof s=="function"},vi=function(s){return s===Object(s)&&!Ht(s)},et=function(s){return s===void 0},ks=function(s){return Xo.call(s)=="[object String]"},zs=function(s){return s===null},rn=function(s){return Xo.call(s)=="[object Number]"},zu=function(s){return Xo.call(s)==="[object Boolean]"},q=typeof window<"u"?window:void 0,Tn=typeof globalThis<"u"?globalThis:q,mm=Array.prototype,_0=mm.forEach,y0=mm.indexOf,x0=Tn==null?void 0:Tn.navigator,Le=Tn==null?void 0:Tn.document,li=Tn==null?void 0:Tn.location,ju=Tn==null?void 0:Tn.fetch,b0=Tn==null?void 0:Tn.XMLHttpRequest,Ot=x0==null?void 0:x0.userAgent,fs=q!=null?q:{},w0="[PostHog.js]",he={_log:function(s){if(q&&(Qi.DEBUG||fs.POSTHOG_DEBUG)&&!et(q.console)&&q.console){for(var e=("__rrweb_original__"in q.console[s])?q.console[s].__rrweb_original__:q.console[s],t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];e.apply(void 0,[w0].concat(n))}},info:function(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];he._log.apply(he,["log"].concat(e))},warn:function(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];he._log.apply(he,["warn"].concat(e))},error:function(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];he._log.apply(he,["error"].concat(e))},critical:function(){for(var s,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];(s=console).error.apply(s,[w0].concat(t))},uninitializedWarning:function(s){he.error("You must initialize PostHog before calling ".concat(s))}},hf={},_l=function(s){return s.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};function Mr(s,e,t){if(Ht(s)){if(_0&&s.forEach===_0)s.forEach(e,t);else if("length"in s&&s.length===+s.length){for(var n=0,i=s.length;n<i;n++)if(n in s&&e.call(t,s[n],n)===hf)return}}}function vt(s,e,t){if(!zs(s)&&!et(s)){if(Ht(s))return Mr(s,e,t);for(var n in s)if(gm.call(s,n)&&e.call(t,s[n],n)===hf)return}}var ss=function(s){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return Mr(t,function(i){for(var r in i)i[r]!==void 0&&(s[r]=i[r])}),s};function ct(s,e){return s.indexOf(e)!==-1}function Ha(s){for(var e=Object.keys(s),t=e.length,n=new Array(t);t--;)n[t]=[e[t],s[e[t]]];return n}var vm=function(){return Date.now=Date.now||function(){return+new Date},Date.now()},S0=function(s){try{return s()}catch{return}},_m=function(s){return function(){try{for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return s.apply(this,t)}catch(i){he.critical("Implementation error. Please turn on debug mode and open a ticket on https://app.posthog.com/home#panel=support%3Asupport%3A."),he.critical(i)}}},qu=function(s){var e={};return vt(s,function(t,n){ks(t)&&t.length>0&&(e[n]=t)}),e};function kk(s,e){return t=s,n=function(r){return ks(r)&&!zs(e)?r.slice(0,e):r},i=new Set,function r(o,a){return o!==Object(o)?n?n(o,a):o:i.has(o)?void 0:(i.add(o),Ht(o)?(l=[],Mr(o,function(c){l.push(r(c))})):(l={},vt(o,function(c,u){i.has(c)||(l[u]=r(c,u))})),l);var l}(t);var t,n,i}function pf(s){var e,t,n,i,r,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a=0,l=0,c="",u=[];if(!s)return s;s=Lk(s);do e=(r=s.charCodeAt(a++)<<16|s.charCodeAt(a++)<<8|s.charCodeAt(a++))>>18&63,t=r>>12&63,n=r>>6&63,i=63&r,u[l++]=o.charAt(e)+o.charAt(t)+o.charAt(n)+o.charAt(i);while(a<s.length);switch(c=u.join(""),s.length%3){case 1:c=c.slice(0,-2)+"==";break;case 2:c=c.slice(0,-1)+"="}return c}var Lk=function(s){var e,t,n,i,r="";for(e=t=0,n=(s=(s+"").replace(/\r\n/g,`
`).replace(/\r/g,`
`)).length,i=0;i<n;i++){var o=s.charCodeAt(i),a=null;o<128?t++:a=o>127&&o<2048?String.fromCharCode(o>>6|192,63&o|128):String.fromCharCode(o>>12|224,o>>6&63|128,63&o|128),zs(a)||(t>e&&(r+=s.substring(e,t)),r+=a,e=t=i+1)}return t>e&&(r+=s.substring(e,s.length)),r},To=function(){function s(e){return e&&(e.preventDefault=s.preventDefault,e.stopPropagation=s.stopPropagation),e}return s.preventDefault=function(){this.returnValue=!1},s.stopPropagation=function(){this.cancelBubble=!0},function(e,t,n,i,r){if(e)if(e.addEventListener&&!i)e.addEventListener(t,n,!!r);else{var o="on"+t,a=e[o];e[o]=function(l,c,u){return function(d){if(d=d||s(q==null?void 0:q.event)){var f,h=!0;Gs(u)&&(f=u(d));var p=c.call(l,d);return f!==!1&&p!==!1||(h=!1),h}}}(e,n,a)}else he.error("No valid element provided to register_event")}}();function Co(s,e){var t=function(){if(!Le)return e("document not found");var n=Le.createElement("script");n.type="text/javascript",n.src=s,n.onload=function(o){return e(void 0,o)},n.onerror=function(o){return e(o)};var i,r=Le.querySelectorAll("body > script");r.length>0?(i=r[0].parentNode)===null||i===void 0||i.insertBefore(n,r[0]):Le.body.appendChild(n)};Le!=null&&Le.body?t():Le==null||Le.addEventListener("DOMContentLoaded",t)}function gf(s){return s?_l(s).split(/\s+/):[]}function yl(s){var e="";switch(Bo(s.className)){case"string":e=s.className;break;case"object":e=("baseVal"in s.className?s.className.baseVal:null)||s.getAttribute("class")||"";break;default:e=""}return gf(e)}function xl(s){var e="";return Ga(s)&&!wm(s)&&s.childNodes&&s.childNodes.length&&vt(s.childNodes,function(t){xm(t)&&t.textContent&&(e+=_l(t.textContent).split(/(\s+)/).filter(br).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255))}),_l(e)}function ym(s){return!!s&&s.nodeType===1}function Ki(s,e){return!!s&&!!s.tagName&&s.tagName.toLowerCase()===e.toLowerCase()}function xm(s){return!!s&&s.nodeType===3}function bm(s){return!!s&&s.nodeType===11}var Ku=["a","button","form","input","select","textarea","label"];function Rk(s,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;if(!q||!s||Ki(s,"html")||!ym(s))return!1;if(t!=null&&t.url_allowlist){var n=q.location.href,i=t.url_allowlist;if(i&&!i.some(function(h){return n.match(h)}))return!1}if(t!=null&&t.dom_event_allowlist){var r=t.dom_event_allowlist;if(r&&!r.some(function(h){return e.type===h}))return!1}for(var o=!1,a=[s],l=!0,c=s;c.parentNode&&!Ki(c,"body");)if(bm(c.parentNode))a.push(c.parentNode.host),c=c.parentNode.host;else{if(!(l=c.parentNode||!1))break;if(Ku.indexOf(l.tagName.toLowerCase())>-1)o=!0;else{var u=q.getComputedStyle(l);u&&u.getPropertyValue("cursor")==="pointer"&&(o=!0)}a.push(l),c=l}if(!function(h,p){var g=p==null?void 0:p.element_allowlist;if(et(g))return!0;var m,_=En(h);try{var y=function(){var C=m.value;if(g.some(function(E){return C.tagName.toLowerCase()===E}))return{v:!0}};for(_.s();!(m=_.n()).done;){var S=y();if(Bo(S)==="object")return S.v}}catch(C){_.e(C)}finally{_.f()}return!1}(a,t)||!function(h,p){var g=p==null?void 0:p.css_selector_allowlist;if(et(g))return!0;var m,_=En(h);try{var y=function(){var C=m.value;if(g.some(function(E){return C.matches(E)}))return{v:!0}};for(_.s();!(m=_.n()).done;){var S=y();if(Bo(S)==="object")return S.v}}catch(C){_.e(C)}finally{_.f()}return!1}(a,t))return!1;var d=q.getComputedStyle(s);if(d&&d.getPropertyValue("cursor")==="pointer"&&e.type==="click")return!0;var f=s.tagName.toLowerCase();switch(f){case"html":return!1;case"form":return e.type==="submit";case"input":case"select":case"textarea":return e.type==="change"||e.type==="click";default:return o?e.type==="click":e.type==="click"&&(Ku.indexOf(f)>-1||s.getAttribute("contenteditable")==="true")}}function Ga(s){for(var e=s;e.parentNode&&!Ki(e,"body");e=e.parentNode){var t=yl(e);if(ct(t,"ph-sensitive")||ct(t,"ph-no-capture"))return!1}if(ct(yl(s),"ph-include"))return!0;var n=s.type||"";if(ks(n))switch(n.toLowerCase()){case"hidden":case"password":return!1}var i=s.name||s.id||"";return!(ks(i)&&/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(i.replace(/[^a-zA-Z0-9]/g,"")))}function wm(s){return!!(Ki(s,"input")&&!["button","checkbox","submit","reset"].includes(s.type)||Ki(s,"select")||Ki(s,"textarea")||s.getAttribute("contenteditable")==="true")}function br(s){return!(zs(s)||et(s)||ks(s)&&(s=_l(s),/^(?:(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11}))$/.test((s||"").replace(/[- ]/g,""))||/(^\d{3}-?\d{2}-?\d{4}$)/.test(s)))}function E0(s){var e=xl(s);return br(e="".concat(e," ").concat(Sm(s)).trim())?e:""}function Sm(s){var e="";return s&&s.childNodes&&s.childNodes.length&&vt(s.childNodes,function(t){var n;if(t&&((n=t.tagName)===null||n===void 0?void 0:n.toLowerCase())==="span")try{var i=xl(t);e="".concat(e," ").concat(i).trim(),t.childNodes&&t.childNodes.length&&(e="".concat(e," ").concat(Sm(t)).trim())}catch(r){he.error(r)}}),e}function Ik(s){return function(e){var t=e.map(function(n){var i,r,o="";if(n.tag_name&&(o+=n.tag_name),n.attr_class){n.attr_class.sort();var a,l=En(n.attr_class);try{for(l.s();!(a=l.n()).done;){var c=a.value;o+=".".concat(c.replace(/"/g,""))}}catch(f){l.e(f)}finally{l.f()}}var u=Oe(Oe(Oe(Oe({},n.text?{text:n.text}:{}),{},{"nth-child":(i=n.nth_child)!==null&&i!==void 0?i:0,"nth-of-type":(r=n.nth_of_type)!==null&&r!==void 0?r:0},n.href?{href:n.href}:{}),n.attr_id?{attr_id:n.attr_id}:{}),n.attributes),d={};return Ha(u).sort(function(f,h){var p=tn(f,1)[0],g=tn(h,1)[0];return p.localeCompare(g)}).forEach(function(f){var h=tn(f,2),p=h[0],g=h[1];return d[T0(p.toString())]=T0(g.toString())}),o+=":",o+=Ha(u).map(function(f){var h=tn(f,2),p=h[0],g=h[1];return"".concat(p,'="').concat(g,'"')}).join("")});return t.join(";")}(function(e){return e.map(function(t){var n,i,r={text:(n=t.$el_text)===null||n===void 0?void 0:n.slice(0,400),tag_name:t.tag_name,href:(i=t.attr__href)===null||i===void 0?void 0:i.slice(0,2048),attr_class:Dk(t),attr_id:t.attr__id,nth_child:t.nth_child,nth_of_type:t.nth_of_type,attributes:{}};return Ha(t).filter(function(o){return tn(o,1)[0].indexOf("attr__")===0}).forEach(function(o){var a=tn(o,2),l=a[0],c=a[1];return r.attributes[l]=c}),r})}(s))}function T0(s){return s.replace(/"|\\"/g,'\\"')}function Dk(s){var e=s.attr__class;return e?Ht(e)?e:gf(e):void 0}var Pk=function(){function s(e){Dt(this,s),this.clicks=[],this.enabled=e}return Pt(s,[{key:"isRageClick",value:function(e,t,n){if(!this.enabled)return!1;var i=this.clicks[this.clicks.length-1];if(i&&Math.abs(e-i.x)+Math.abs(t-i.y)<30&&n-i.timestamp<1e3){if(this.clicks.push({x:e,y:t,timestamp:n}),this.clicks.length===3)return!0}else this.clicks=[{x:e,y:t,timestamp:n}];return!1}}]),s}(),Em="$people_distinct_id",za="__alias",mo="__timers",C0="$autocapture_disabled_server_side",Wu="$session_recording_enabled_server_side",A0="$console_log_recording_enabled_server_side",k0="$session_recording_recorder_version_server_side",L0="$session_recording_network_payload_capture",R0="$session_recording_canvas_recording",bl="$sesid",ja="$session_is_sampled",wr="$enabled_feature_flags",Yu="$early_access_features",Sr="$stored_person_properties",ci="$stored_group_properties",Zu="$surveys",wl="$flag_call_reported",Xu="$user_state",Qu="$posthog_quota_limited",Ju="$client_session_props",Fk=[Em,za,"__cmpns",mo,Wu,bl,wr,Xu,Qu,Yu,ci,Sr,Zu,wl,Ju];function Vc(s,e){return e.length>s?e.slice(0,s)+"...":e}var fi={_initializedTokens:[],_isDisabledServerSide:null,_isAutocaptureEnabled:!1,_setIsAutocaptureEnabled:function(s){var e,t=zs(this._isDisabledServerSide)?!((e=s.persistence)===null||e===void 0||!e.props[C0]):this._isDisabledServerSide,n=!!s.config.autocapture;this._isAutocaptureEnabled=n&&!t},_previousElementSibling:function(s){if(s.previousElementSibling)return s.previousElementSibling;var e=s;do e=e.previousSibling;while(e&&!ym(e));return e},_getAugmentPropertiesFromElement:function(s){if(!Ga(s))return{};var e={};return vt(s.attributes,function(t){if(t.name.indexOf("data-ph-capture-attribute")===0){var n=t.name.replace("data-ph-capture-attribute-",""),i=t.value;n&&i&&br(i)&&(e[n]=i)}}),e},_getPropertiesFromElement:function(s,e,t){var n,i=s.tagName.toLowerCase(),r={tag_name:i};Ku.indexOf(i)>-1&&!t&&(i.toLowerCase()==="a"||i.toLowerCase()==="button"?r.$el_text=Vc(1024,E0(s)):r.$el_text=Vc(1024,xl(s)));var o=yl(s);o.length>0&&(r.classes=o.filter(function(d){return d!==""}));var a=(n=this.config)===null||n===void 0?void 0:n.element_attribute_ignorelist;vt(s.attributes,function(d){var f;if((!wm(s)||["name","id","class"].indexOf(d.name)!==-1)&&(a==null||!a.includes(d.name))&&!e&&br(d.value)&&(f=d.name,!ks(f)||f.substring(0,10)!=="_ngcontent"&&f.substring(0,7)!=="_nghost")){var h=d.value;d.name==="class"&&(h=gf(h).join(" ")),r["attr__"+d.name]=Vc(1024,h)}});for(var l=1,c=1,u=s;u=this._previousElementSibling(u);)l++,u.tagName===s.tagName&&c++;return r.nth_child=l,r.nth_of_type=c,r},_getDefaultProperties:function(s){return{$event_type:s,$ce_version:1}},_extractCustomPropertyValue:function(s){var e=[];return vt(Le==null?void 0:Le.querySelectorAll(s.css_selector),function(t){var n;["input","select"].indexOf(t.tagName.toLowerCase())>-1?n=t.value:t.textContent&&(n=t.textContent),br(n)&&e.push(n)}),e.join(", ")},_getCustomProperties:function(s){var e=this,t={};return vt(this._customProperties,function(n){vt(n.event_selectors,function(i){vt(Le==null?void 0:Le.querySelectorAll(i),function(r){ct(s,r)&&Ga(r)&&(t[n.name]=e._extractCustomPropertyValue(n))})})}),t},_getEventTarget:function(s){return et(s.target)?s.srcElement||null:(e=s.target)!==null&&e!==void 0&&e.shadowRoot?s.composedPath()[0]||null:s.target||null;var e},_captureEvent:function(s,e){var t,n=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"$autocapture",r=this._getEventTarget(s);if(xm(r)&&(r=r.parentNode||null),i==="$autocapture"&&s.type==="click"&&s instanceof MouseEvent&&(t=this.rageclicks)!==null&&t!==void 0&&t.isRageClick(s.clientX,s.clientY,new Date().getTime())&&this._captureEvent(s,e,"$rageclick"),r&&Rk(r,s,this.config)){for(var o,a,l=[r],c=r;c.parentNode&&!Ki(c,"body");)bm(c.parentNode)?(l.push(c.parentNode.host),c=c.parentNode.host):(l.push(c.parentNode),c=c.parentNode);var u,d=[],f={},h=!1;if(vt(l,function(g){var m=Ga(g);g.tagName.toLowerCase()==="a"&&(u=g.getAttribute("href"),u=m&&br(u)&&u),ct(yl(g),"ph-no-capture")&&(h=!0),d.push(n._getPropertiesFromElement(g,e.config.mask_all_element_attributes,e.config.mask_all_text));var _=n._getAugmentPropertiesFromElement(g);ss(f,_)}),e.config.mask_all_text||(r.tagName.toLowerCase()==="a"||r.tagName.toLowerCase()==="button"?d[0].$el_text=E0(r):d[0].$el_text=xl(r)),u&&(d[0].attr__href=u),h)return!1;var p=ss(this._getDefaultProperties(s.type),e.elementsChainAsString?{$elements_chain:Ik(d)}:{$elements:d},(o=d[0])!==null&&o!==void 0&&o.$el_text?{$el_text:(a=d[0])===null||a===void 0?void 0:a.$el_text}:{},this._getCustomProperties(l),f);return e.capture(i,p),!0}},_navigate:function(s){q&&(q.location.href=s)},_addDomEventHandlers:function(s){var e=this;if(q&&Le){var t=function(n){n=n||(q==null?void 0:q.event),e._captureEvent(n,s)};To(Le,"submit",t,!1,!0),To(Le,"change",t,!1,!0),To(Le,"click",t,!1,!0)}},_customProperties:[],rageclicks:null,config:void 0,init:function(s){var e;zu(s.__autocapture)||(this.config=s.__autocapture),(e=this.config)!==null&&e!==void 0&&e.url_allowlist&&(this.config.url_allowlist=this.config.url_allowlist.map(function(t){return new RegExp(t)})),this.rageclicks=new Pk(s.config.rageclick)},afterDecideResponse:function(s,e){var t=e.config.token;this._initializedTokens.indexOf(t)>-1?he.info('autocapture already initialized for token "'+t+'"'):(e.persistence&&e.persistence.register(Ce({},C0,!!s.autocapture_opt_out)),this._isDisabledServerSide=!!s.autocapture_opt_out,this._setIsAutocaptureEnabled(e),this._initializedTokens.push(t),s&&s.config&&s.config.enable_collect_everything&&this._isAutocaptureEnabled?(s.custom_properties&&(this._customProperties=s.custom_properties),this._addDomEventHandlers(e)):e.__autocapture=!1)},enabledForProject:function(s,e,t){if(!s)return!0;e=et(e)?10:e,t=et(t)?10:t;for(var n=0,i=0;i<s.length;i++)n+=s.charCodeAt(i);return n%e<t},isBrowserSupported:function(){return Gs(Le==null?void 0:Le.querySelectorAll)}};(function(s){for(var e in s)Gs(s[e])&&(s[e]=s[e].bind(s))})(fi),function(s){for(var e in s)Gs(s[e])&&(s[e]=_m(s[e]))}(fi);var Bc="$active_feature_flags",ga="$override_feature_flags",I0="$feature_flag_payloads",D0=function(s){var e,t={},n=En(Ha(s||{}));try{for(n.s();!(e=n.n()).done;){var i=tn(e.value,2),r=i[0],o=i[1];o&&(t[r]=o)}}catch(a){n.e(a)}finally{n.f()}return t},Ok=function(){function s(e){Dt(this,s),this.instance=e,this._override_warning=!1,this.featureFlagEventHandlers=[],this.reloadFeatureFlagsQueued=!1,this.reloadFeatureFlagsInAction=!1}return Pt(s,[{key:"getFlags",value:function(){return Object.keys(this.getFlagVariants())}},{key:"getFlagVariants",value:function(){var e=this.instance.get_property(wr),t=this.instance.get_property(ga);if(!t)return e||{};for(var n=ss({},e),i=Object.keys(t),r=0;r<i.length;r++)t[i[r]]===!1?delete n[i[r]]:n[i[r]]=t[i[r]];return this._override_warning||(he.warn(" Overriding feature flags!",{enabledFlags:e,overriddenFlags:t,finalFlags:n}),this._override_warning=!0),n}},{key:"getFlagPayloads",value:function(){return this.instance.get_property(I0)||{}}},{key:"reloadFeatureFlags",value:function(){this.reloadFeatureFlagsQueued||(this.reloadFeatureFlagsQueued=!0,this._startReloadTimer())}},{key:"setAnonymousDistinctId",value:function(e){this.$anon_distinct_id=e}},{key:"setReloadingPaused",value:function(e){this.reloadFeatureFlagsInAction=e}},{key:"resetRequestQueue",value:function(){this.reloadFeatureFlagsQueued=!1}},{key:"_startReloadTimer",value:function(){var e=this;this.reloadFeatureFlagsQueued&&!this.reloadFeatureFlagsInAction&&setTimeout(function(){!e.reloadFeatureFlagsInAction&&e.reloadFeatureFlagsQueued&&(e.reloadFeatureFlagsQueued=!1,e._reloadFeatureFlagsRequest())},5)}},{key:"_reloadFeatureFlagsRequest",value:function(){var e=this;if(!this.instance.config.advanced_disable_feature_flags){this.setReloadingPaused(!0);var t=this.instance.config.token,n=this.instance.get_property(Sr),i=this.instance.get_property(ci),r=pf(JSON.stringify({token:t,distinct_id:this.instance.get_distinct_id(),groups:this.instance.getGroups(),$anon_distinct_id:this.$anon_distinct_id,person_properties:n,group_properties:i,disable_flags:this.instance.config.advanced_disable_feature_flags||void 0}));this.instance._send_request(this.instance.requestRouter.endpointFor("decide","/decide/?v=3"),{data:r},{method:"POST"},this.instance._prepare_callback(function(o){e.$anon_distinct_id=void 0,e.receivedFeatureFlags(o),e.setReloadingPaused(!1),e._startReloadTimer()}))}}},{key:"getFeatureFlag",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.instance.decideEndpointWasHit||this.getFlags()&&this.getFlags().length>0){var n,i=this.getFlagVariants()[e],r="".concat(i),o=this.instance.get_property(wl)||{};return(t.send_event||!("send_event"in t))&&(!(e in o)||!o[e].includes(r))&&(Ht(o[e])?o[e].push(r):o[e]=[r],(n=this.instance.persistence)===null||n===void 0||n.register(Ce({},wl,o)),this.instance.capture("$feature_flag_called",{$feature_flag:e,$feature_flag_response:i})),i}he.warn('getFeatureFlag for key "'+e+`" failed. Feature flags didn't load in time.`)}},{key:"getFeatureFlagPayload",value:function(e){return this.getFlagPayloads()[e]}},{key:"isFeatureEnabled",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.instance.decideEndpointWasHit||this.getFlags()&&this.getFlags().length>0)return!!this.getFeatureFlag(e,t);he.warn('isFeatureEnabled for key "'+e+`" failed. Feature flags didn't load in time.`)}},{key:"addFeatureFlagsHandler",value:function(e){this.featureFlagEventHandlers.push(e)}},{key:"removeFeatureFlagsHandler",value:function(e){this.featureFlagEventHandlers=this.featureFlagEventHandlers.filter(function(t){return t!==e})}},{key:"receivedFeatureFlags",value:function(e){if(this.instance.persistence){this.instance.decideEndpointWasHit=!0;var t=this.getFlagVariants(),n=this.getFlagPayloads();(function(i,r){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},l=i.featureFlags,c=i.featureFlagPayloads;if(l)if(Ht(l)){var u,d={};if(l)for(var f=0;f<l.length;f++)d[l[f]]=!0;r&&r.register((Ce(u={},Bc,l),Ce(u,wr,d),u))}else{var h,p=l,g=c;i.errorsWhileComputingFlags&&(p=Oe(Oe({},o),p),g=Oe(Oe({},a),g)),r&&r.register((Ce(h={},Bc,Object.keys(D0(p))),Ce(h,wr,p||{}),Ce(h,I0,g||{}),h))}})(e,this.instance.persistence,t,n),this._fireFeatureFlagsCallbacks()}}},{key:"override",value:function(e){if(!this.instance.__loaded||!this.instance.persistence)return he.uninitializedWarning("posthog.feature_flags.override");if(this._override_warning=!1,e===!1)this.instance.persistence.unregister(ga);else if(Ht(e)){for(var t={},n=0;n<e.length;n++)t[e[n]]=!0;this.instance.persistence.register(Ce({},ga,t))}else this.instance.persistence.register(Ce({},ga,e))}},{key:"onFeatureFlags",value:function(e){var t=this;if(this.addFeatureFlagsHandler(e),this.instance.decideEndpointWasHit){var n=this._prepareFeatureFlagsForCallbacks(),i=n.flags,r=n.flagVariants;e(i,r)}return function(){return t.removeFeatureFlagsHandler(e)}}},{key:"updateEarlyAccessFeatureEnrollment",value:function(e,t){var n,i,r=Ce({},"$feature_enrollment/".concat(e),t);this.instance.capture("$feature_enrollment_update",{$feature_flag:e,$feature_enrollment:t,$set:r}),this.setPersonPropertiesForFlags(r,!1);var o=Oe(Oe({},this.getFlagVariants()),{},Ce({},e,t));(n=this.instance.persistence)===null||n===void 0||n.register((Ce(i={},Bc,Object.keys(D0(o))),Ce(i,wr,o),i)),this._fireFeatureFlagsCallbacks()}},{key:"getEarlyAccessFeatures",value:function(e){var t=this,n=arguments.length>1&&arguments[1]!==void 0&&arguments[1],i=this.instance.get_property(Yu);if(i&&!n)return e(i);this.instance._send_request(this.instance.requestRouter.endpointFor("api","/api/early_access_features/?token=".concat(this.instance.config.token)),{},{method:"GET"},function(r){var o,a=r.earlyAccessFeatures;return(o=t.instance.persistence)===null||o===void 0||o.register(Ce({},Yu,a)),e(a)})}},{key:"_prepareFeatureFlagsForCallbacks",value:function(){var e=this.getFlags(),t=this.getFlagVariants();return{flags:e.filter(function(n){return t[n]}),flagVariants:Object.keys(t).filter(function(n){return t[n]}).reduce(function(n,i){return n[i]=t[i],n},{})}}},{key:"_fireFeatureFlagsCallbacks",value:function(){var e=this._prepareFeatureFlagsForCallbacks(),t=e.flags,n=e.flagVariants;this.featureFlagEventHandlers.forEach(function(i){return i(t,n)})}},{key:"setPersonPropertiesForFlags",value:function(e){var t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],n=this.instance.get_property(Sr)||{};this.instance.register(Ce({},Sr,Oe(Oe({},n),e))),t&&this.instance.reloadFeatureFlags()}},{key:"resetPersonPropertiesForFlags",value:function(){this.instance.unregister(Sr)}},{key:"setGroupPropertiesForFlags",value:function(e){var t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],n=this.instance.get_property(ci)||{};Object.keys(n).length!==0&&Object.keys(n).forEach(function(i){n[i]=Oe(Oe({},n[i]),e[i]),delete e[i]}),this.instance.register(Ce({},ci,Oe(Oe({},n),e))),t&&this.instance.reloadFeatureFlags()}},{key:"resetGroupPropertiesForFlags",value:function(e){if(e){var t=this.instance.get_property(ci)||{};this.instance.register(Ce({},ci,Oe(Oe({},t),{},Ce({},e,{}))))}else this.instance.unregister(ci)}}]),s}();Math.trunc||(Math.trunc=function(s){return s<0?Math.ceil(s):Math.floor(s)}),Number.isInteger||(Number.isInteger=function(s){return rn(s)&&isFinite(s)&&Math.floor(s)===s});var P0="0123456789abcdef",Mk=function(){function s(e){if(Dt(this,s),this.bytes=e,e.length!==16)throw new TypeError("not 128-bit length")}return Pt(s,[{key:"toString",value:function(){for(var e="",t=0;t<this.bytes.length;t++)e=e+P0.charAt(this.bytes[t]>>>4)+P0.charAt(15&this.bytes[t]),t!==3&&t!==5&&t!==7&&t!==9||(e+="-");if(e.length!==36)throw new Error("Invalid UUIDv7 was generated");return e}},{key:"clone",value:function(){return new s(this.bytes.slice(0))}},{key:"equals",value:function(e){return this.compareTo(e)===0}},{key:"compareTo",value:function(e){for(var t=0;t<16;t++){var n=this.bytes[t]-e.bytes[t];if(n!==0)return Math.sign(n)}return 0}}],[{key:"fromFieldsV7",value:function(e,t,n,i){if(!Number.isInteger(e)||!Number.isInteger(t)||!Number.isInteger(n)||!Number.isInteger(i)||e<0||t<0||n<0||i<0||e>0xffffffffffff||t>4095||n>1073741823||i>4294967295)throw new RangeError("invalid field value");var r=new Uint8Array(16);return r[0]=e/Math.pow(2,40),r[1]=e/Math.pow(2,32),r[2]=e/Math.pow(2,24),r[3]=e/Math.pow(2,16),r[4]=e/Math.pow(2,8),r[5]=e,r[6]=112|t>>>8,r[7]=t,r[8]=128|n>>>24,r[9]=n>>>16,r[10]=n>>>8,r[11]=n,r[12]=i>>>24,r[13]=i>>>16,r[14]=i>>>8,r[15]=i,new s(r)}}]),s}(),$k=function(){function s(){Dt(this,s),Ce(this,"timestamp",0),Ce(this,"counter",0),Ce(this,"random",new Nk)}return Pt(s,[{key:"generate",value:function(){var e=this.generateOrAbort();if(et(e)){this.timestamp=0;var t=this.generateOrAbort();if(et(t))throw new Error("Could not generate UUID after timestamp reset");return t}return e}},{key:"generateOrAbort",value:function(){var e=Date.now();if(e>this.timestamp)this.timestamp=e,this.resetCounter();else{if(!(e+1e4>this.timestamp))return;this.counter++,this.counter>4398046511103&&(this.timestamp++,this.resetCounter())}return Mk.fromFieldsV7(this.timestamp,Math.trunc(this.counter/Math.pow(2,30)),this.counter&Math.pow(2,30)-1,this.random.nextUint32())}},{key:"resetCounter",value:function(){this.counter=1024*this.random.nextUint32()+(1023&this.random.nextUint32())}}]),s}(),Tm=function(s){if(typeof UUIDV7_DENY_WEAK_RNG<"u"&&UUIDV7_DENY_WEAK_RNG)throw new Error("no cryptographically strong RNG available");for(var e=0;e<s.length;e++)s[e]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return s};q&&!et(q.crypto)&&crypto.getRandomValues&&(Tm=function(s){return crypto.getRandomValues(s)});var F0,Nk=function(){function s(){Dt(this,s),Ce(this,"buffer",new Uint32Array(8)),Ce(this,"cursor",1/0)}return Pt(s,[{key:"nextUint32",value:function(){return this.cursor>=this.buffer.length&&(Tm(this.buffer),this.cursor=0),this.buffer[this.cursor++]}}]),s}(),Hi=function(){return Vk().toString()},Vk=function(){return(F0||(F0=new $k)).generate()},Bk="Thu, 01 Jan 1970 00:00:00 GMT",ao="",Uk=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i;function Hk(s,e){if(e){var t=function(i){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Le;if(ao)return ao;if(!r||["localhost","127.0.0.1"].includes(i))return"";for(var o=i.split("."),a=Math.min(o.length,8),l="dmn_chk_"+Hi(),c=new RegExp("(^|;)\\s*"+l+"=1");!ao&&a--;){var u=o.slice(a).join("."),d=l+"=1;domain=."+u;r.cookie=d,c.test(r.cookie)&&(r.cookie=d+";expires="+Bk,ao=u)}return ao}(s);if(!t){var n=function(i){var r=i.match(Uk);return r?r[0]:""}(s);n!==t&&he.info("Warning: cookie subdomain discovery mismatch",n,t),t=n}return t?"; domain=."+t:""}return""}var xn={is_supported:function(){return!!Le},error:function(s){he.error("cookieStore error: "+s)},get:function(s){if(Le){try{for(var e=s+"=",t=Le.cookie.split(";").filter(function(r){return r.length}),n=0;n<t.length;n++){for(var i=t[n];i.charAt(0)==" ";)i=i.substring(1,i.length);if(i.indexOf(e)===0)return decodeURIComponent(i.substring(e.length,i.length))}}catch{}return null}},parse:function(s){var e;try{e=JSON.parse(xn.get(s))||{}}catch{}return e},set:function(s,e,t,n,i){if(Le)try{var r="",o="",a=Hk(Le.location.hostname,n);if(t){var l=new Date;l.setTime(l.getTime()+24*t*60*60*1e3),r="; expires="+l.toUTCString()}i&&(o="; secure");var c=s+"="+encodeURIComponent(JSON.stringify(e))+r+"; SameSite=Lax; path=/"+a+o;return c.length>3686.4&&he.warn("cookieStore warning: large cookie, len="+c.length),Le.cookie=c,c}catch{return}},remove:function(s,e){try{xn.set(s,"",-1,e)}catch{return}}},Uc=null,$t={is_supported:function(){if(!zs(Uc))return Uc;var s=!0;if(et(q))s=!1;else try{var e="__mplssupport__";$t.set(e,"xyz"),$t.get(e)!=='"xyz"'&&(s=!1),$t.remove(e)}catch{s=!1}return s||he.error("localStorage unsupported; falling back to cookie store"),Uc=s,s},error:function(s){he.error("localStorage error: "+s)},get:function(s){try{return q==null?void 0:q.localStorage.getItem(s)}catch(e){$t.error(e)}return null},parse:function(s){try{return JSON.parse($t.get(s))||{}}catch{}return null},set:function(s,e){try{q==null||q.localStorage.setItem(s,JSON.stringify(e))}catch(t){$t.error(t)}},remove:function(s){try{q==null||q.localStorage.removeItem(s)}catch(e){$t.error(e)}}},Gk=["distinct_id",bl,ja],vo=Oe(Oe({},$t),{},{parse:function(s){try{var e={};try{e=xn.parse(s)||{}}catch{}var t=ss(e,JSON.parse($t.get(s)||"{}"));return $t.set(s,t),t}catch{}return null},set:function(s,e,t,n,i){try{$t.set(s,e);var r={};Gk.forEach(function(o){e[o]&&(r[o]=e[o])}),Object.keys(r).length&&xn.set(s,r,t,n,i)}catch(o){$t.error(o)}},remove:function(s,e){try{q==null||q.localStorage.removeItem(s),xn.remove(s,e)}catch(t){$t.error(t)}}}),ma={},zk={is_supported:function(){return!0},error:function(s){he.error("memoryStorage error: "+s)},get:function(s){return ma[s]||null},parse:function(s){return ma[s]||null},set:function(s,e){ma[s]=e},remove:function(s){delete ma[s]}},Pi=null,is={is_supported:function(){if(!zs(Pi))return Pi;if(Pi=!0,et(q))Pi=!1;else try{var s="__support__";is.set(s,"xyz"),is.get(s)!=='"xyz"'&&(Pi=!1),is.remove(s)}catch{Pi=!1}return Pi},error:function(s){he.error("sessionStorage error: ",s)},get:function(s){try{return q==null?void 0:q.sessionStorage.getItem(s)}catch(e){is.error(e)}return null},parse:function(s){try{return JSON.parse(is.get(s))||null}catch{}return null},set:function(s,e){try{q==null||q.sessionStorage.setItem(s,JSON.stringify(e))}catch(t){is.error(t)}},remove:function(s){try{q==null||q.sessionStorage.removeItem(s)}catch(e){is.error(e)}}},jk=["localhost","127.0.0.1"],qa=!(!b0||!("withCredentials"in new b0))||!!ju,Cm=function(s){var e=Le==null?void 0:Le.createElement("a");return et(e)?null:(e.href=s,e)},qk=function(s,e){return!!function(t){try{new RegExp(t)}catch{return!1}return!0}(e)&&new RegExp(e).test(s)},O0=function(s,e){for(var t,n=((s.split("#")[0]||"").split("?")[1]||"").split("&"),i=0;i<n.length;i++){var r=n[i].split("=");if(r[0]===e){t=r;break}}if(!Ht(t)||t.length<2)return"";var o=t[1];try{o=decodeURIComponent(o)}catch{he.error("Skipping decoding for malformed query param: "+o)}return o.replace(/\+/g," ")},Sl=function(s,e){var t=s.match(new RegExp(e+"=([^&]*)"));return t?t[1]:null},Ut={campaignParams:function(s){var e=["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gclid","gad_source","gbraid","wbraid","fbclid","msclkid"].concat(s||[]),t={};return vt(e,function(n){var i=Le?O0(Le.URL,n):"";i.length&&(t[n]=i)}),t},searchEngine:function(){var s=Le==null?void 0:Le.referrer;return s?s.search("https?://(.*)google.([^/?]*)")===0?"google":s.search("https?://(.*)bing.com")===0?"bing":s.search("https?://(.*)yahoo.com")===0?"yahoo":s.search("https?://(.*)duckduckgo.com")===0?"duckduckgo":null:null},searchInfo:function(){var s=Ut.searchEngine(),e=s!="yahoo"?"q":"p",t={};if(!zs(s)){t.$search_engine=s;var n=Le?O0(Le.referrer,e):"";n.length&&(t.ph_keyword=n)}return t},browser:function(s,e,t){return e=e||"",t||ct(s," OPR/")?ct(s,"Mini")?"Opera Mini":"Opera":/(BlackBerry|PlayBook|BB10)/i.test(s)?"BlackBerry":ct(s,"IEMobile")||ct(s,"WPDesktop")?"Internet Explorer Mobile":ct(s,"SamsungBrowser/")?"Samsung Internet":ct(s,"Edge")||ct(s,"Edg/")?"Microsoft Edge":ct(s,"FBIOS")?"Facebook Mobile":ct(s,"Chrome")?"Chrome":ct(s,"CriOS")?"Chrome iOS":ct(s,"UCWEB")||ct(s,"UCBrowser")?"UC Browser":ct(s,"FxiOS")?"Firefox iOS":ct(e,"Apple")||function(n){return ct(n,"Safari")&&!ct(n,"Chrome")&&!ct(n,"Android")}(s)?ct(s,"Mobile")?"Mobile Safari":"Safari":ct(s,"Android")?"Android Mobile":ct(s,"Konqueror")||ct(s,"konqueror")?"Konqueror":ct(s,"Firefox")?"Firefox":ct(s,"MSIE")||ct(s,"Trident/")?"Internet Explorer":ct(s,"Gecko")?"Mozilla":""},browserVersion:function(s,e,t){var n={"Internet Explorer Mobile":[/rv:(\d+(\.\d+)?)/],"Microsoft Edge":[/Edge?\/(\d+(\.\d+)?)/],Chrome:[/Chrome\/(\d+(\.\d+)?)/],"Chrome iOS":[/CriOS\/(\d+(\.\d+)?)/],"UC Browser":[/(UCBrowser|UCWEB)\/(\d+(\.\d+)?)/],Safari:[/Version\/(\d+(\.\d+)?)/],"Mobile Safari":[/Version\/(\d+(\.\d+)?)/],Opera:[/(Opera|OPR)\/(\d+(\.\d+)?)/],Firefox:[/Firefox\/(\d+(\.\d+)?)/],"Firefox iOS":[/FxiOS\/(\d+(\.\d+)?)/],Konqueror:[/Konqueror[:/]?(\d+(\.\d+)?)/i],BlackBerry:[/BlackBerry (\d+(\.\d+)?)/,/Version\/(\d+(\.\d+)?)/],"Android Mobile":[/android\s(\d+(\.\d+)?)/],"Samsung Internet":[/SamsungBrowser\/(\d+(\.\d+)?)/],"Internet Explorer":[/(rv:|MSIE )(\d+(\.\d+)?)/],Mozilla:[/rv:(\d+(\.\d+)?)/]}[Ut.browser(s,e,t)];if(et(n))return null;for(var i=0;i<n.length;i++){var r=n[i],o=s.match(r);if(o)return parseFloat(o[o.length-2])}return null},browserLanguage:function(){return navigator.language||navigator.userLanguage},os:function(s){if(/Windows/i.test(s)){if(/Phone/.test(s)||/WPDesktop/.test(s))return{os_name:"Windows Phone",os_version:""};var e=/Windows NT ([0-9.]+)/i.exec(s);return e&&e[1]?{os_name:"Windows",os_version:e[1]}:{os_name:"Windows",os_version:""}}if(/(iPhone|iPad|iPod)/.test(s)){var t=/OS (\d+)_(\d+)_?(\d+)?/i.exec(s);return t&&t[1]?{os_name:"iOS",os_version:[t[1],t[2],t[3]||"0"].join(".")}:{os_name:"iOS",os_version:""}}if(/Android/.test(s)){var n=/Android (\d+)\.(\d+)\.?(\d+)?/i.exec(s);return n&&n[1]?{os_name:"Android",os_version:[n[1],n[2],n[3]||"0"].join(".")}:{os_name:"Android",os_version:""}}if(/(BlackBerry|PlayBook|BB10)/i.test(s))return{os_name:"BlackBerry",os_version:""};if(/Mac/i.test(s)){var i=/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i.exec(s);return i&&i[1]?{os_name:"Mac OS X",os_version:[i[1],i[2],i[3]||"0"].join(".")}:{os_name:"Mac OS X",os_version:""}}return/Linux/.test(s)?{os_name:"Linux",os_version:""}:/CrOS/.test(s)?{os_name:"Chrome OS",os_version:""}:{os_name:"",os_version:""}},device:function(s){return/Windows Phone/i.test(s)||/WPDesktop/.test(s)?"Windows Phone":/iPad/.test(s)?"iPad":/iPod/.test(s)?"iPod Touch":/iPhone/.test(s)?"iPhone":/(BlackBerry|PlayBook|BB10)/i.test(s)?"BlackBerry":/Android/.test(s)&&!/Mobile/.test(s)?"Android Tablet":/Android/.test(s)?"Android":""},deviceType:function(s){var e=this.device(s);return e==="iPad"||e==="Android Tablet"?"Tablet":e?"Mobile":"Desktop"},referrer:function(){return(Le==null?void 0:Le.referrer)||"$direct"},referringDomain:function(){var s;return Le!=null&&Le.referrer&&((s=Cm(Le.referrer))===null||s===void 0?void 0:s.host)||"$direct"},properties:function(){if(!Ot)return{};var s=Ut.os(Ot),e=s.os_name,t=s.os_version;return ss(qu({$os:e,$os_version:t,$browser:Ut.browser(Ot,navigator.vendor,fs.opera),$device:Ut.device(Ot),$device_type:Ut.deviceType(Ot)}),{$current_url:li==null?void 0:li.href,$host:li==null?void 0:li.host,$pathname:li==null?void 0:li.pathname,$raw_user_agent:Ot.length>1e3?Ot.substring(0,997)+"...":Ot,$browser_version:Ut.browserVersion(Ot,navigator.vendor,fs.opera),$browser_language:Ut.browserLanguage(),$screen_height:q==null?void 0:q.screen.height,$screen_width:q==null?void 0:q.screen.width,$viewport_height:q==null?void 0:q.innerHeight,$viewport_width:q==null?void 0:q.innerWidth,$lib:"web",$lib_version:Qi.LIB_VERSION,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),$time:vm()/1e3})},people_properties:function(){if(!Ot)return{};var s=Ut.os(Ot),e=s.os_name,t=s.os_version;return ss(qu({$os:e,$os_version:t,$browser:Ut.browser(Ot,navigator.vendor,fs.opera)}),{$browser_version:Ut.browserVersion(Ot,navigator.vendor,fs.opera)})}},Kk=["cookie","localstorage","localstorage+cookie","sessionstorage","memory"],M0=function(){function s(e){Dt(this,s);var t="";e.token&&(t=e.token.replace(/\+/g,"PL").replace(/\//g,"SL").replace(/=/g,"EQ")),this.props={},this.campaign_params_saved=!1,this.custom_campaign_params=e.custom_campaign_params||[],e.persistence_name?this.name="ph_"+e.persistence_name:this.name="ph_"+t+"_posthog",Kk.indexOf(e.persistence.toLowerCase())===-1&&(he.critical("Unknown persistence type "+e.persistence+"; falling back to localStorage+cookie"),e.persistence="localStorage+cookie");var n=e.persistence.toLowerCase();n==="localstorage"&&$t.is_supported()?this.storage=$t:n==="localstorage+cookie"&&vo.is_supported()?this.storage=vo:n==="sessionstorage"&&is.is_supported()?this.storage=is:n==="memory"?this.storage=zk:n==="cookie"?this.storage=xn:vo.is_supported()?this.storage=vo:this.storage=xn,this.load(),this.update_config(e),this.save()}return Pt(s,[{key:"properties",value:function(){var e={};return vt(this.props,function(t,n){if(n===wr&&vi(t))for(var i=Object.keys(t),r=0;r<i.length;r++)e["$feature/".concat(i[r])]=t[i[r]];else a=n,l=!1,(zs(o=Fk)?l:y0&&o.indexOf===y0?o.indexOf(a)!=-1:(vt(o,function(c){if(l||(l=c===a))return hf}),l))||(e[n]=t);var o,a,l}),e}},{key:"load",value:function(){if(!this.disabled){var e=this.storage.parse(this.name);e&&(this.props=ss({},e))}}},{key:"save",value:function(){this.disabled||this.storage.set(this.name,this.props,this.expire_days,this.cross_subdomain,this.secure)}},{key:"remove",value:function(){this.storage.remove(this.name,!1),this.storage.remove(this.name,!0)}},{key:"clear",value:function(){this.remove(),this.props={}}},{key:"register_once",value:function(e,t,n){var i=this;if(vi(e)){et(t)&&(t="None"),this.expire_days=et(n)?this.default_expiry:n;var r=!1;if(vt(e,function(o,a){i.props.hasOwnProperty(a)&&i.props[a]!==t||(i.props[a]=o,r=!0)}),r)return this.save(),!0}return!1}},{key:"register",value:function(e,t){var n=this;if(vi(e)){this.expire_days=et(t)?this.default_expiry:t;var i=!1;if(vt(e,function(r,o){e.hasOwnProperty(o)&&n.props[o]!==r&&(n.props[o]=r,i=!0)}),i)return this.save(),!0}return!1}},{key:"unregister",value:function(e){e in this.props&&(delete this.props[e],this.save())}},{key:"update_campaign_params",value:function(){this.campaign_params_saved||(this.register(Ut.campaignParams(this.custom_campaign_params)),this.campaign_params_saved=!0)}},{key:"update_search_keyword",value:function(){this.register(Ut.searchInfo())}},{key:"update_referrer_info",value:function(){this.register({$referrer:this.props.$referrer||Ut.referrer(),$referring_domain:this.props.$referring_domain||Ut.referringDomain()})}},{key:"get_referrer_info",value:function(){return qu({$referrer:this.props.$referrer,$referring_domain:this.props.$referring_domain})}},{key:"safe_merge",value:function(e){return vt(this.props,function(t,n){n in e||(e[n]=t)}),e}},{key:"update_config",value:function(e){this.default_expiry=this.expire_days=e.cookie_expiration,this.set_disabled(e.disable_persistence),this.set_cross_subdomain(e.cross_subdomain_cookie),this.set_secure(e.secure_cookie)}},{key:"set_disabled",value:function(e){this.disabled=e,this.disabled?this.remove():this.save()}},{key:"set_cross_subdomain",value:function(e){e!==this.cross_subdomain&&(this.cross_subdomain=e,this.remove(),this.save())}},{key:"get_cross_subdomain",value:function(){return!!this.cross_subdomain}},{key:"set_secure",value:function(e){e!==this.secure&&(this.secure=e,this.remove(),this.save())}},{key:"set_event_timer",value:function(e,t){var n=this.props[mo]||{};n[e]=t,this.props[mo]=n,this.save()}},{key:"remove_event_timer",value:function(e){var t=(this.props[mo]||{})[e];return et(t)||(delete this.props[mo][e],this.save()),t}},{key:"get_user_state",value:function(){return this.props[Xu]||"anonymous"}},{key:"set_user_state",value:function(e){this.props[Xu]=e,this.save()}},{key:"get_quota_limits",value:function(){return this.props[Qu]||{}}},{key:"set_quota_limits",value:function(e){this.props[Qu]=e,this.save()}}]),s}(),$0=2,Wk=4,Yk=Pt(function s(e){var t,n,i=this,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Dt(this,s),Ce(this,"bucketSize",100),Ce(this,"refillRate",10),Ce(this,"mutationBuckets",{}),Ce(this,"loggedTracker",{}),Ce(this,"refillBuckets",function(){Object.keys(i.mutationBuckets).forEach(function(o){i.mutationBuckets[o]=i.mutationBuckets[o]+i.refillRate,i.mutationBuckets[o]>=i.bucketSize&&delete i.mutationBuckets[o]})}),Ce(this,"getNodeOrRelevantParent",function(o){var a=i.rrweb.mirror.getNode(o);if((a==null?void 0:a.nodeName)!=="svg"&&a instanceof Element){var l=a.closest("svg");if(l)return[i.rrweb.mirror.getId(l),l]}return[o,a]}),Ce(this,"numberOfChanges",function(o){var a,l,c,u,d,f,h,p;return((a=(l=o.removes)===null||l===void 0?void 0:l.length)!==null&&a!==void 0?a:0)+((c=(u=o.attributes)===null||u===void 0?void 0:u.length)!==null&&c!==void 0?c:0)+((d=(f=o.texts)===null||f===void 0?void 0:f.length)!==null&&d!==void 0?d:0)+((h=(p=o.adds)===null||p===void 0?void 0:p.length)!==null&&h!==void 0?h:0)}),Ce(this,"throttleMutations",function(o){if(o.type!==3||o.data.source!==0)return o;var a=o.data,l=i.numberOfChanges(a);a.attributes&&(a.attributes=a.attributes.filter(function(u){var d,f,h,p=tn(i.getNodeOrRelevantParent(u.id),2),g=p[0],m=p[1];return i.mutationBuckets[g]===0?!1:(i.mutationBuckets[g]=(d=i.mutationBuckets[g])!==null&&d!==void 0?d:i.bucketSize,i.mutationBuckets[g]=Math.max(i.mutationBuckets[g]-1,0),i.mutationBuckets[g]===0&&(i.loggedTracker[g]||(i.loggedTracker[g]=!0,(f=(h=i.options).onBlockedNode)===null||f===void 0||f.call(h,g,m))),u)}));var c=i.numberOfChanges(a);return c!==0||l===c?o:void 0}),this.rrweb=e,this.options=r,this.refillRate=(t=this.options.refillRate)!==null&&t!==void 0?t:this.refillRate,this.bucketSize=(n=this.options.bucketSize)!==null&&n!==void 0?n:this.bucketSize,setInterval(function(){i.refillBuckets()},1e3)}),Ka=function(s){return s[s.DomContentLoaded=0]="DomContentLoaded",s[s.Load=1]="Load",s[s.FullSnapshot=2]="FullSnapshot",s[s.IncrementalSnapshot=3]="IncrementalSnapshot",s[s.Meta=4]="Meta",s[s.Custom=5]="Custom",s[s.Plugin=6]="Plugin",s}(Ka||{}),Zk={initiatorTypes:["audio","beacon","body","css","early-hint","embed","fetch","frame","iframe","icon","image","img","input","link","navigation","object","ping","script","track","video","xmlhttprequest"],maskRequestFn:function(s){return s},recordHeaders:!1,recordBody:!1,recordInitialRequests:!1,recordPerformance:!1,performanceEntryTypeToObserve:["first-input","navigation","paint","resource"],payloadSizeLimitBytes:1e6},Xk=["authorization","x-forwarded-for","authorization","cookie","set-cookie","x-api-key","x-real-ip","remote-addr","forwarded","proxy-authorization","x-csrf-token","x-csrftoken","x-xsrf-token"],Qk=["/s/","/e/","/i/vo/e/"];function N0(s,e,t,n){var i=e==null?void 0:e["content-length"];return et(i)?"[SessionReplay] no content-length header for ".concat(n,", cannot determine payload size"):i&&parseInt(i)>t?"[SessionReplay] ".concat(n," body too large to record"):s}var Jk=function(s,e){var t,n,i,r=s.session_recording,o=r.recordHeaders!==!1&&e.recordHeaders,a=r.recordBody!==!1&&e.recordBody,l=r.recordPerformance!==!1&&e.recordPerformance,c=(t=r,i=Math.min(1e6,(n=t.payloadSizeLimitBytes)!==null&&n!==void 0?n:1e6),function(f){return f!=null&&f.requestBody&&(f.requestBody=N0(f.requestBody,f.requestHeaders,i,"Request")),f!=null&&f.responseBody&&(f.responseBody=N0(f.responseBody,f.responseHeaders,i,"Response")),f}),u=function(f){return c(function(g){var m=Cm(g.name);if(!(m&&m.pathname&&Qk.includes(m.pathname)))return g}((h=f,Object.keys((p=h.requestHeaders)!==null&&p!==void 0?p:{}).forEach(function(g){var m;Xk.includes(g.toLowerCase())&&((m=h.requestHeaders)===null||m===void 0||delete m[g])}),h)));var h,p},d=Gs(s.session_recording.maskNetworkRequestFn);return d&&Gs(s.session_recording.maskCapturedNetworkRequestFn)&&he.warn("Both `maskNetworkRequestFn` and `maskCapturedNetworkRequestFn` are defined. `maskNetworkRequestFn` will be ignored."),d&&(s.session_recording.maskCapturedNetworkRequestFn=function(f){var h=s.session_recording.maskNetworkRequestFn({url:f.name});return Oe(Oe({},f),{},{name:h==null?void 0:h.url})}),r.maskRequestFn=Gs(s.session_recording.maskCapturedNetworkRequestFn)?function(f){var h,p,g,m=u(f);return m&&(h=(p=(g=s.session_recording).maskCapturedNetworkRequestFn)===null||p===void 0?void 0:p.call(g,m))!==null&&h!==void 0?h:void 0}:void 0,r.maskRequestFn||(r.maskRequestFn=u),Oe(Oe(Oe({},Zk),r),{},{recordHeaders:o,recordBody:a,recordPerformance:l,recordInitialRequests:l})},eL="__ph_opt_in_out_";function tL(s,e){Lm(!0,s,e)}function sL(s,e){Lm(!1,s,e)}function nL(s,e){return km(s,e)==="1"}function Am(s,e){return!!function(t){if(t&&t.respectDnt){var n=t&&t.window||q,i=n==null?void 0:n.navigator,r=!1;return vt([i==null?void 0:i.doNotTrack,i.msDoNotTrack,n.doNotTrack],function(o){ct([!0,1,"1","yes"],o)&&(r=!0)}),r}return!1}(e)||km(s,e)==="0"}function iL(s,e){mf(e=e||{}).remove(vf(s,e),!!e.crossSubdomainCookie)}function mf(s){return(s=s||{}).persistenceType==="localStorage"?$t:s.persistenceType==="localStorage+cookie"?vo:xn}function vf(s,e){return((e=e||{}).persistencePrefix||eL)+s}function km(s,e){return mf(e).get(vf(s,e))}function Lm(s,e,t){ks(e)&&e.length?(mf(t=t||{}).set(vf(e,t),s?1:0,rn(t.cookieExpiration)?t.cookieExpiration:null,t.crossSubdomainCookie,t.secureCookie),t.capture&&s&&t.capture(t.captureEventName||"$opt_in",t.captureProperties||{},{send_instantly:!0})):he.error("gdpr."+(s?"optIn":"optOut")+" called with an invalid token")}function ed(s){var e=!1;try{var t=s.config.token,n=s.config.respect_dnt,i=s.config.opt_out_capturing_persistence_type,r=s.config.opt_out_capturing_cookie_prefix||void 0,o=s.config.window;t&&(e=Am(t,{respectDnt:n,persistenceType:i,persistencePrefix:r,window:o}))}catch(a){he.error("Unexpected error when checking capturing opt-out status: "+a)}return e}var fn,Rm=3e5,V0=Rm;(function(s){s[s.Mutation=0]="Mutation",s[s.MouseMove=1]="MouseMove",s[s.MouseInteraction=2]="MouseInteraction",s[s.Scroll=3]="Scroll",s[s.ViewportResize=4]="ViewportResize",s[s.Input=5]="Input",s[s.TouchMove=6]="TouchMove",s[s.MediaInteraction=7]="MediaInteraction",s[s.StyleSheetRule=8]="StyleSheetRule",s[s.CanvasMutation=9]="CanvasMutation",s[s.Font=10]="Font",s[s.Log=11]="Log",s[s.Drag=12]="Drag",s[s.StyleDeclaration=13]="StyleDeclaration",s[s.Selection=14]="Selection",s[s.AdoptedStyleSheet=15]="AdoptedStyleSheet"})(fn||(fn={}));var rL=[fn.MouseMove,fn.MouseInteraction,fn.Scroll,fn.ViewportResize,fn.Input,fn.TouchMove,fn.MediaInteraction,fn.Drag],B0=function(s){return{rrwebMethod:s,enqueuedAt:Date.now(),attempt:1}},oL=function(){function s(e){var t=this;if(Dt(this,s),Ce(this,"queuedRRWebEvents",[]),Ce(this,"isIdle",!1),Ce(this,"_linkedFlagSeen",!1),Ce(this,"_lastActivityTimestamp",Date.now()),Ce(this,"windowId",null),Ce(this,"sessionId",null),Ce(this,"_linkedFlag",null),Ce(this,"_sampleRate",null),Ce(this,"_minimumDuration",null),Ce(this,"_forceAllowLocalhostNetworkCapture",!1),this.instance=e,this._captureStarted=!1,this._endpoint="/s/",this.stopRrweb=void 0,this.receivedDecide=!1,q==null||q.addEventListener("beforeunload",function(){t._flushBuffer()}),q==null||q.addEventListener("offline",function(){t._tryAddCustomEvent("browser offline",{})}),q==null||q.addEventListener("online",function(){t._tryAddCustomEvent("browser online",{})}),!this.instance.sessionManager)throw he.error("Session recording started without valid sessionManager"),new Error("Session recording started without valid sessionManager. This is a bug.");this.buffer=this.clearBuffer()}return Pt(s,[{key:"started",get:function(){return this._captureStarted}},{key:"sessionManager",get:function(){if(!this.instance.sessionManager)throw he.error("Session recording started without valid sessionManager"),new Error("Session recording started without valid sessionManager. This is a bug.");return this.instance.sessionManager}},{key:"isSampled",get:function(){return rn(this._sampleRate)?this.instance.get_property(ja):null}},{key:"sessionDuration",get:function(){var e,t,n=(e=this.buffer)===null||e===void 0?void 0:e.data[((t=this.buffer)===null||t===void 0?void 0:t.data.length)-1],i=this.sessionManager.checkAndGetSessionAndWindowId(!0).sessionStartTimestamp;return n?n.timestamp-i:null}},{key:"isRecordingEnabled",get:function(){var e=!!this.instance.get_property(Wu),t=!this.instance.config.disable_session_recording;return q&&e&&t}},{key:"isConsoleLogCaptureEnabled",get:function(){var e=!!this.instance.get_property(A0),t=this.instance.config.enable_recording_console_log;return t!=null?t:e}},{key:"canvasRecording",get:function(){var e=this.instance.get_property(R0);return e&&e.fps&&e.quality?{enabled:e.enabled,fps:e.fps,quality:e.quality}:void 0}},{key:"recordingVersion",get:function(){var e,t=this.instance.get_property(k0);return((e=this.instance.config.session_recording)===null||e===void 0?void 0:e.recorderVersion)||t||"v1"}},{key:"networkPayloadCapture",get:function(){var e,t,n=this.instance.get_property(L0),i={recordHeaders:(e=this.instance.config.session_recording)===null||e===void 0?void 0:e.recordHeaders,recordBody:(t=this.instance.config.session_recording)===null||t===void 0?void 0:t.recordBody},r=(i==null?void 0:i.recordHeaders)||(n==null?void 0:n.recordHeaders),o=(i==null?void 0:i.recordBody)||(n==null?void 0:n.recordBody),a=this.instance.config.capture_performance||(n==null?void 0:n.capturePerformance);return r||o||a?{recordHeaders:r,recordBody:o,recordPerformance:a}:void 0}},{key:"status",get:function(){return this.receivedDecide?this.isRecordingEnabled?ks(this._linkedFlag)&&!this._linkedFlagSeen?"buffering":zu(this.isSampled)?this.isSampled?"sampled":"disabled":"active":"disabled":"buffering"}},{key:"startRecordingIfEnabled",value:function(){this.isRecordingEnabled?(this.startCaptureAndTrySendingQueuedSnapshots(),he.info("[SessionRecording] started")):(this.stopRecording(),this.clearBuffer())}},{key:"stopRecording",value:function(){this._captureStarted&&this.stopRrweb&&(this.stopRrweb(),this.stopRrweb=void 0,this._captureStarted=!1,he.info("[SessionRecording] stopped"))}},{key:"makeSamplingDecision",value:function(e){var t,n=this.sessionId!==e;if(rn(this._sampleRate)){var i,r=this.isSampled;n||!zu(r)?i=Math.random()<this._sampleRate:i=r,i||he.warn("[SessionSampling] Sample rate (".concat(this._sampleRate,") has determined that this sessionId (").concat(e,") will not be sent to the server.")),(t=this.instance.persistence)===null||t===void 0||t.register(Ce({},ja,i))}else{var o;(o=this.instance.persistence)===null||o===void 0||o.register(Ce({},ja,null))}}},{key:"afterDecideResponse",value:function(e){var t,n,i,r,o,a,l,c,u,d,f,h=this;this.instance.persistence&&this.instance.persistence.register((Ce(f={},Wu,!!e.sessionRecording),Ce(f,A0,(o=e.sessionRecording)===null||o===void 0?void 0:o.consoleLogRecordingEnabled),Ce(f,k0,(a=e.sessionRecording)===null||a===void 0?void 0:a.recorderVersion),Ce(f,L0,Oe({capturePerformance:e.capturePerformance},(l=e.sessionRecording)===null||l===void 0?void 0:l.networkPayloadCapture)),Ce(f,R0,{enabled:(c=e.sessionRecording)===null||c===void 0?void 0:c.recordCanvas,fps:(u=e.sessionRecording)===null||u===void 0?void 0:u.canvasFps,quality:(d=e.sessionRecording)===null||d===void 0?void 0:d.canvasQuality}),f));var p=(t=e.sessionRecording)===null||t===void 0?void 0:t.sampleRate;this._sampleRate=et(p)||zs(p)?null:parseFloat(p);var g,m=(n=e.sessionRecording)===null||n===void 0?void 0:n.minimumDurationMilliseconds;if(this._minimumDuration=et(m)?null:m,this._linkedFlag=((i=e.sessionRecording)===null||i===void 0?void 0:i.linkedFlag)||null,(r=e.sessionRecording)!==null&&r!==void 0&&r.endpoint&&(this._endpoint=(g=e.sessionRecording)===null||g===void 0?void 0:g.endpoint),rn(this._sampleRate)&&this.sessionManager.onSessionId(function(y){h.makeSamplingDecision(y)}),ks(this._linkedFlag)){var _=this._linkedFlag;this.instance.onFeatureFlags(function(y){h._linkedFlagSeen=y.includes(_)})}this.receivedDecide=!0,this.startRecordingIfEnabled()}},{key:"log",value:function(e){var t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"log";(t=this.instance.sessionRecording)===null||t===void 0||t.onRRwebEmit({type:6,data:{plugin:"rrweb/console@1",payload:{level:n,trace:[],payload:[JSON.stringify(e)]}},timestamp:vm()})}},{key:"startCaptureAndTrySendingQueuedSnapshots",value:function(){this._startCapture()}},{key:"_startCapture",value:function(){var e=this;if(!et(Object.assign)&&!(this._captureStarted||this.instance.config.disable_session_recording||ed(this.instance))){this._captureStarted=!0,this.sessionManager.checkAndGetSessionAndWindowId();var t=this.recordingVersion==="v2"?"recorder-v2.js":"recorder.js";this.instance.__loaded_recorder_version!==this.recordingVersion?Co(this.instance.requestRouter.endpointFor("assets","/static/".concat(t,"?v=").concat(Qi.LIB_VERSION)),function(n){if(n)return he.error("Could not load ".concat(t),n);e._onScriptLoaded()}):this._onScriptLoaded()}}},{key:"_isInteractiveEvent",value:function(e){var t;return e.type===3&&rL.indexOf((t=e.data)===null||t===void 0?void 0:t.source)!==-1}},{key:"_updateWindowAndSessionIds",value:function(e){var t=this._isInteractiveEvent(e);t||this.isIdle||e.timestamp-this._lastActivityTimestamp>V0&&(this.isIdle=!0,this._tryAddCustomEvent("sessionIdle",{reason:"user inactivity",timeSinceLastActive:e.timestamp-this._lastActivityTimestamp,threshold:V0}));var n=!1;if(t&&(this._lastActivityTimestamp=e.timestamp,this.isIdle&&(this.isIdle=!1,this._tryAddCustomEvent("sessionNoLongerIdle",{reason:"user activity",type:e.type}),n=!0)),!this.isIdle){var i=this.sessionManager.checkAndGetSessionAndWindowId(!t,e.timestamp),r=i.windowId,o=i.sessionId,a=this.sessionId!==o,l=this.windowId!==r;this.windowId=r,this.sessionId=o,(n||[$0,Wk].indexOf(e.type)===-1&&(l||a))&&this._tryTakeFullSnapshot()}}},{key:"_tryRRWebMethod",value:function(e){try{return e.rrwebMethod(),!0}catch(t){return he.warn("[Session-Recording] could not emit queued rrweb event.",t),this.queuedRRWebEvents.length<10&&this.queuedRRWebEvents.push({enqueuedAt:e.enqueuedAt||Date.now(),attempt:e.attempt++,rrwebMethod:e.rrwebMethod}),!1}}},{key:"_tryAddCustomEvent",value:function(e,t){var n=this;return this._tryRRWebMethod(B0(function(){return n.rrwebRecord.addCustomEvent(e,t)}))}},{key:"_tryTakeFullSnapshot",value:function(){var e=this;return this._tryRRWebMethod(B0(function(){return e.rrwebRecord.takeFullSnapshot()}))}},{key:"_onScriptLoaded",value:function(){var e,t=this,n={blockClass:"ph-no-capture",blockSelector:void 0,ignoreClass:"ph-ignore-input",maskTextClass:"ph-mask",maskTextSelector:void 0,maskTextFn:void 0,maskAllInputs:!0,maskInputOptions:{},maskInputFn:void 0,slimDOMOptions:{},collectFonts:!1,inlineStylesheet:!0,recordCrossOriginIframes:!1};this.rrwebRecord=q.rrweb?q.rrweb.record:q.rrwebRecord;for(var i=this.instance.config.session_recording,r=0,o=Object.entries(i||{});r<o.length;r++){var a=tn(o[r],2),l=a[0],c=a[1];l in n&&(n[l]=c)}if(this.canvasRecording&&this.canvasRecording.enabled&&(n.recordCanvas=!0,n.sampling={canvas:this.canvasRecording.fps},n.dataURLOptions={type:"image/webp",quality:this.canvasRecording.quality}),this.rrwebRecord){this.mutationRateLimiter=(e=this.mutationRateLimiter)!==null&&e!==void 0?e:new Yk(this.rrwebRecord,{onBlockedNode:function(d,f){var h="Too many mutations on node '".concat(d,"'. Rate limiting. This could be due to SVG animations or something similar");he.info(h,{node:f}),t.log("[PostHog Recorder] "+h,"warn")}}),this._scheduleFullSnapshot();var u=this._gatherRRWebPlugins();this.stopRrweb=this.rrwebRecord(Oe({emit:function(d){t.onRRwebEmit(d)},plugins:u},n)),this.instance._addCaptureHook(function(d){try{if(d==="$pageview"){var f=q?t._maskUrl(q.location.href):"";if(!f)return;t._tryAddCustomEvent("$pageview",{href:f}),t._tryTakeFullSnapshot()}}catch(h){he.error("Could not add $pageview to rrweb session",h)}}),this._lastActivityTimestamp=Date.now(),this.isIdle=!1,this._tryAddCustomEvent("$session_options",{sessionRecordingOptions:n,activePlugins:u.map(function(d){return d==null?void 0:d.name})}),this._tryAddCustomEvent("$posthog_config",{config:this.instance.config})}else he.error("onScriptLoaded was called but rrwebRecord is not available. This indicates something has gone wrong.")}},{key:"_scheduleFullSnapshot",value:function(){var e=this;this._fullSnapshotTimer&&clearInterval(this._fullSnapshotTimer),this._fullSnapshotTimer=setInterval(function(){e._tryTakeFullSnapshot()},Rm)}},{key:"_gatherRRWebPlugins",value:function(){var e=[];return fs.rrwebConsoleRecord&&this.isConsoleLogCaptureEnabled&&e.push(fs.rrwebConsoleRecord.getRecordConsolePlugin()),this.networkPayloadCapture&&Gs(fs.getRecordNetworkPlugin)&&(!jk.includes(location.hostname)||this._forceAllowLocalhostNetworkCapture?e.push(fs.getRecordNetworkPlugin(Jk(this.instance.config,this.networkPayloadCapture))):he.info("[SessionReplay-NetworkCapture] not started because we are on localhost.")),e}},{key:"onRRwebEmit",value:function(e){if(this._processQueuedEvents(),e&&vi(e)){if(e.type===Ka.Meta){var t=this._maskUrl(e.data.href);if(!t)return;e.data.href=t}e.type===Ka.FullSnapshot&&this._scheduleFullSnapshot();var n=this.mutationRateLimiter?this.mutationRateLimiter.throttleMutations(e):e;if(n){var i=function(a){var l=a;if(l&&vi(l)&&l.type===6&&vi(l.data)&&l.data.plugin==="rrweb/console@1"){l.data.payload.payload.length>10&&(l.data.payload.payload=l.data.payload.payload.slice(0,10),l.data.payload.payload.push("...[truncated]"));for(var c=[],u=0;u<l.data.payload.payload.length;u++)l.data.payload.payload[u]&&l.data.payload.payload[u].length>2e3?c.push(l.data.payload.payload[u].slice(0,2e3)+"...[truncated]"):c.push(l.data.payload.payload[u]);return l.data.payload.payload=c,a}return a}(n),r=JSON.stringify(i).length;if(this._updateWindowAndSessionIds(i),!this.isIdle||i.type===Ka.Custom){var o={$snapshot_bytes:r,$snapshot_data:i,$session_id:this.sessionId,$window_id:this.windowId};this.status!=="disabled"?this._captureSnapshotBuffered(o):this.clearBuffer()}}}}},{key:"_processQueuedEvents",value:function(){var e=this;if(this.queuedRRWebEvents.length){var t=vl(this.queuedRRWebEvents);this.queuedRRWebEvents=[],t.forEach(function(n){Date.now()-n.enqueuedAt>2e3?e._tryAddCustomEvent("rrwebQueueTimeout",{enqueuedAt:n.enqueuedAt,attempt:n.attempt,queueLength:t.length}):e._tryRRWebMethod(n)&&e._tryAddCustomEvent("rrwebQueueSuccess",{enqueuedAt:n.enqueuedAt,attempt:n.attempt,queueLength:t.length})})}}},{key:"_maskUrl",value:function(e){var t=this.instance.config.session_recording;if(t.maskNetworkRequestFn){var n,i={url:e};return(n=i=t.maskNetworkRequestFn(i))===null||n===void 0?void 0:n.url}return e}},{key:"clearBuffer",value:function(){return this.buffer=void 0,{size:0,data:[],sessionId:this.sessionId,windowId:this.windowId}}},{key:"_flushBuffer",value:function(){var e=this;this.flushBufferTimer&&(clearTimeout(this.flushBufferTimer),this.flushBufferTimer=void 0);var t=this._minimumDuration,n=this.sessionDuration,i=rn(n)&&n>=0,r=rn(t)&&i&&n<t;return this.status==="buffering"||r?(this.flushBufferTimer=setTimeout(function(){e._flushBuffer()},2e3),this.buffer||this.clearBuffer()):this.buffer&&this.buffer.data.length!==0?(this._captureSnapshot({$snapshot_bytes:this.buffer.size,$snapshot_data:this.buffer.data,$session_id:this.buffer.sessionId,$window_id:this.buffer.windowId}),this.clearBuffer()):this.buffer||this.clearBuffer()}},{key:"_captureSnapshotBuffered",value:function(e){var t,n=this,i=2+(((t=this.buffer)===null||t===void 0?void 0:t.data.length)||0);(!this.buffer||this.buffer.size+e.$snapshot_bytes+i>943718.4||this.buffer.sessionId&&this.buffer.sessionId!==this.sessionId)&&(this.buffer=this._flushBuffer()),zs(this.buffer.sessionId)&&!zs(this.sessionId)&&(this.buffer.sessionId=this.sessionId,this.buffer.windowId=this.windowId),this.buffer.size+=e.$snapshot_bytes,this.buffer.data.push(e.$snapshot_data),this.flushBufferTimer||(this.flushBufferTimer=setTimeout(function(){n._flushBuffer()},2e3))}},{key:"_captureSnapshot",value:function(e){this.instance.capture("$snapshot",e,{method:"POST",_url:this.instance.requestRouter.endpointFor("capture_recordings",this._endpoint),_noTruncate:!0,_batchKey:"recordings",_metrics:{rrweb_full_snapshot:e.$snapshot_data.type===$0}})}}]),s}(),aL=function(){function s(e){Dt(this,s),this.instance=e,this.instance.decideEndpointWasHit=this.instance._hasBootstrappedFeatureFlags()}return Pt(s,[{key:"call",value:function(){var e=this,t=pf(JSON.stringify({token:this.instance.config.token,distinct_id:this.instance.get_distinct_id(),groups:this.instance.getGroups(),person_properties:this.instance.get_property(Sr),group_properties:this.instance.get_property(ci),disable_flags:this.instance.config.advanced_disable_feature_flags||this.instance.config.advanced_disable_feature_flags_on_first_load||void 0}));this.instance._send_request(this.instance.requestRouter.endpointFor("decide","/decide/?v=3"),{data:t,verbose:!0},{method:"POST"},function(n){return e.parseDecideResponse(n)})}},{key:"parseDecideResponse",value:function(e){var t,n=this;if(this.instance.featureFlags.setReloadingPaused(!1),this.instance.featureFlags._startReloadTimer(),(e==null?void 0:e.status)!==0){if(!Le||!Le.body)return he.info("document not ready yet, trying again in 500 milliseconds..."),void setTimeout(function(){n.parseDecideResponse(e)},500);this.instance.toolbar.afterDecideResponse(e),(t=this.instance.sessionRecording)===null||t===void 0||t.afterDecideResponse(e),fi.afterDecideResponse(e,this.instance),this.instance._afterDecideResponse(e),this.instance.config.advanced_disable_feature_flags_on_first_load||this.instance.config.advanced_disable_feature_flags||this.instance.featureFlags.receivedFeatureFlags(e);var i=q==null?void 0:q.extendPostHogWithSurveys;e.surveys&&!i&&Co(this.instance.requestRouter.endpointFor("assets","/static/surveys.js"),function(c){if(c)return he.error("Could not load surveys script",c);q.extendPostHogWithSurveys(n.instance)});var r=q==null?void 0:q.extendPostHogWithExceptionAutoCapture;if(e.autocaptureExceptions&&e.autocaptureExceptions&&et(r)&&Co(this.instance.requestRouter.endpointFor("assets","/static/exception-autocapture.js"),function(c){if(c)return he.error("Could not load exception autocapture script",c);q.extendPostHogWithExceptionAutocapture(n.instance,e)}),e.siteApps)if(this.instance.config.opt_in_site_apps){var o,a=En(e.siteApps);try{var l=function(){var c=o.value,u=c.id,d=c.url,f=n.instance.requestRouter.endpointFor("assets",d);fs["__$$ph_site_app_".concat(u)]=n.instance,Co(f,function(h){h&&he.error("Error while initializing PostHog app with config id ".concat(u),h)})};for(a.s();!(o=a.n()).done;)l()}catch(c){a.e(c)}finally{a.f()}}else e.siteApps.length>0&&he.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.')}else he.error("Failed to fetch feature flags from PostHog.")}}]),s}(),lL=["source"],cL=q!=null&&q.location?Sl(q.location.hash,"__posthog")||Sl(location.hash,"state"):null,uL=function(){function s(e){Dt(this,s),this.instance=e}return Pt(s,[{key:"afterDecideResponse",value:function(e){var t=e.toolbarParams||e.editorParams||(e.toolbarVersion?{toolbarVersion:e.toolbarVersion}:{});e.isAuthenticated&&t.toolbarVersion&&t.toolbarVersion.indexOf("toolbar")===0&&this.loadToolbar(Oe({},t))}},{key:"maybeLoadToolbar",value:function(){var e,t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;if(!q||!Le)return!1;n=(e=n)!==null&&e!==void 0?e:q.location,r=(t=r)!==null&&t!==void 0?t:q.history;try{if(!i){try{q.localStorage.setItem("test","test"),q.localStorage.removeItem("test")}catch{return!1}i=q==null?void 0:q.localStorage}var o,a=cL||Sl(n.hash,"__posthog")||Sl(n.hash,"state"),l=a?S0(function(){return JSON.parse(atob(decodeURIComponent(a)))})||S0(function(){return JSON.parse(decodeURIComponent(a))}):null;return l&&l.action==="ph_authorize"?((o=l).source="url",o&&Object.keys(o).length>0&&(l.desiredHash?n.hash=l.desiredHash:r?r.replaceState("",Le.title,n.pathname+n.search):n.hash="")):((o=JSON.parse(i.getItem("_postHogToolbarParams")||"{}")).source="localstorage",delete o.userIntent),!(!o.token||this.instance.config.token!==o.token)&&(this.loadToolbar(o),!0)}catch{return!1}}},{key:"loadToolbar",value:function(e){var t=this;if(!q||fs._postHogToolbarLoaded)return!1;fs._postHogToolbarLoaded=!0;var n=3e5,i=Math.floor(Date.now()/n)*n,r=this.instance.requestRouter.endpointFor("assets","/static/toolbar.js?t=".concat(i)),o=this.instance.requestRouter.region==="custom"&&this.instance.config.advanced_disable_toolbar_metrics,a=Oe(Oe({token:this.instance.config.token},e),{},{apiURL:this.instance.requestRouter.endpointFor("api")},o?{instrument:!1}:{});a.source;var l=Tk(a,lL);return q.localStorage.setItem("_postHogToolbarParams",JSON.stringify(l)),Co(r,function(c){c?he.error("Failed to load toolbar",c):(fs.ph_load_toolbar||fs.ph_load_editor)(a,t.instance)}),To(q,"turbolinks:load",function(){fs._postHogToolbarLoaded=!1,t.loadToolbar(a)}),!0}},{key:"_loadEditor",value:function(e){return this.loadToolbar(e)}},{key:"maybeLoadEditor",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;return this.maybeLoadToolbar(e,t,n)}}]),s}(),Im=function(){function s(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3e3;Dt(this,s),this.isPolling=!0,this._event_queue=[],this._empty_queue_count=0,this._poller=void 0,this._pollInterval=e}return Pt(s,[{key:"setPollInterval",value:function(e){this._pollInterval=e,this.isPolling&&this.poll()}},{key:"poll",value:function(){}},{key:"unload",value:function(){}},{key:"getTime",value:function(){return new Date().getTime()}}]),s}(),dL=function(s){fm(t,Im);var e=hm(t);function t(n){var i,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3e3;return Dt(this,t),(i=e.call(this,r)).handlePollRequest=n,i}return Pt(t,[{key:"enqueue",value:function(n,i,r){this._event_queue.push({url:n,data:i,options:r}),this.isPolling||(this.isPolling=!0,this.poll())}},{key:"poll",value:function(){var n=this;clearTimeout(this._poller),this._poller=setTimeout(function(){if(n._event_queue.length>0){var i=n.formatQueue(),r=function(a){var l=i[a],c=l.url,u=l.data,d=l.options;vt(u,function(f,h){u[h].offset=Math.abs(u[h].timestamp-n.getTime()),delete u[h].timestamp}),n.handlePollRequest(c,u,d)};for(var o in i)r(o);n._event_queue.length=0,n._empty_queue_count=0}else n._empty_queue_count++;n._empty_queue_count>4&&(n.isPolling=!1,n._empty_queue_count=0),n.isPolling&&n.poll()},this._pollInterval)}},{key:"unload",value:function(){var n=this;clearTimeout(this._poller);var i=this._event_queue.length>0?this.formatQueue():{};this._event_queue.length=0;var r=Object.values(i);[].concat(vl(r.filter(function(o){return o.url.indexOf("/e")===0})),vl(r.filter(function(o){return o.url.indexOf("/e")!==0}))).map(function(o){var a=o.url,l=o.data,c=o.options;n.handlePollRequest(a,l,Oe(Oe({},c),{},{transport:"sendBeacon"}))})}},{key:"formatQueue",value:function(){var n={};return vt(this._event_queue,function(i){var r=i.url,o=i.data,a=i.options,l=(a?a._batchKey:null)||r;et(n[l])&&(n[l]={data:[],url:r,options:a}),a&&n[l].options&&n[l].options._metrics&&!n[l].options._metrics.rrweb_full_snapshot&&(n[l].options._metrics.rrweb_full_snapshot=a._metrics.rrweb_full_snapshot),n[l].data.push(o)}),n}}]),t}(),Ls=Uint8Array,ms=Uint16Array,qr=Uint32Array,_f=new Ls([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),yf=new Ls([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),U0=new Ls([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Dm=function(s,e){for(var t=new ms(31),n=0;n<31;++n)t[n]=e+=1<<s[n-1];var i=new qr(t[30]);for(n=1;n<30;++n)for(var r=t[n];r<t[n+1];++r)i[r]=r-t[n]<<5|n;return[t,i]},Pm=Dm(_f,2),fL=Pm[0],td=Pm[1];fL[28]=258,td[258]=28;for(var H0=Dm(yf,0)[1],sd=new ms(32768),Tt=0;Tt<32768;++Tt){var Fi=(43690&Tt)>>>1|(21845&Tt)<<1;Fi=(61680&(Fi=(52428&Fi)>>>2|(13107&Fi)<<2))>>>4|(3855&Fi)<<4,sd[Tt]=((65280&Fi)>>>8|(255&Fi)<<8)>>>1}var Ao=function(s,e,t){for(var n=s.length,i=0,r=new ms(e);i<n;++i)++r[s[i]-1];var o,a=new ms(e);for(i=0;i<e;++i)a[i]=a[i-1]+r[i-1]<<1;if(t){o=new ms(1<<e);var l=15-e;for(i=0;i<n;++i)if(s[i])for(var c=i<<4|s[i],u=e-s[i],d=a[s[i]-1]++<<u,f=d|(1<<u)-1;d<=f;++d)o[sd[d]>>>l]=c}else for(o=new ms(n),i=0;i<n;++i)o[i]=sd[a[s[i]-1]++]>>>15-s[i];return o},Ji=new Ls(288);for(Tt=0;Tt<144;++Tt)Ji[Tt]=8;for(Tt=144;Tt<256;++Tt)Ji[Tt]=9;for(Tt=256;Tt<280;++Tt)Ji[Tt]=7;for(Tt=280;Tt<288;++Tt)Ji[Tt]=8;var El=new Ls(32);for(Tt=0;Tt<32;++Tt)El[Tt]=5;var Vi,hL=Ao(Ji,9,0),pL=Ao(El,5,0),Fm=function(s){return(s/8>>0)+(7&s&&1)},Om=function(s,e,t){(e==null||e<0)&&(e=0),(t==null||t>s.length)&&(t=s.length);var n=new(s instanceof ms?ms:s instanceof qr?qr:Ls)(t-e);return n.set(s.subarray(e,t)),n},In=function(s,e,t){t<<=7&e;var n=e/8>>0;s[n]|=t,s[n+1]|=t>>>8},lo=function(s,e,t){t<<=7&e;var n=e/8>>0;s[n]|=t,s[n+1]|=t>>>8,s[n+2]|=t>>>16},Hc=function(s,e){for(var t=[],n=0;n<s.length;++n)s[n]&&t.push({s:n,f:s[n]});var i=t.length,r=t.slice();if(!i)return[new Ls(0),0];if(i==1){var o=new Ls(t[0].s+1);return o[t[0].s]=1,[o,1]}t.sort(function(E,A){return E.f-A.f}),t.push({s:-1,f:25001});var a=t[0],l=t[1],c=0,u=1,d=2;for(t[0]={s:-1,f:a.f+l.f,l:a,r:l};u!=i-1;)a=t[t[c].f<t[d].f?c++:d++],l=t[c!=u&&t[c].f<t[d].f?c++:d++],t[u++]={s:-1,f:a.f+l.f,l:a,r:l};var f=r[0].s;for(n=1;n<i;++n)r[n].s>f&&(f=r[n].s);var h=new ms(f+1),p=gL(t[u-1],h,0);if(p>e){n=0;var g=0,m=p-e,_=1<<m;for(r.sort(function(E,A){return h[A.s]-h[E.s]||E.f-A.f});n<i;++n){var y=r[n].s;if(!(h[y]>e))break;g+=_-(1<<p-h[y]),h[y]=e}for(g>>>=m;g>0;){var S=r[n].s;h[S]<e?g-=1<<e-h[S]++-1:++n}for(;n>=0&&g;--n){var C=r[n].s;h[C]==e&&(--h[C],++g)}p=e}return[new Ls(h),p]},gL=function s(e,t,n){return e.s==-1?Math.max(s(e.l,t,n+1),s(e.r,t,n+1)):t[e.s]=n},G0=function(s){for(var e=s.length;e&&!s[--e];);for(var t=new ms(++e),n=0,i=s[0],r=1,o=function(l){t[n++]=l},a=1;a<=e;++a)if(s[a]==i&&a!=e)++r;else{if(!i&&r>2){for(;r>138;r-=138)o(32754);r>2&&(o(r>10?r-11<<5|28690:r-3<<5|12305),r=0)}else if(r>3){for(o(i),--r;r>6;r-=6)o(8304);r>2&&(o(r-3<<5|8208),r=0)}for(;r--;)o(i);r=1,i=s[a]}return[t.subarray(0,n),e]},co=function(s,e){for(var t=0,n=0;n<e.length;++n)t+=s[n]*e[n];return t},Wa=function(s,e,t){var n=t.length,i=Fm(e+2);s[i]=255&n,s[i+1]=n>>>8,s[i+2]=255^s[i],s[i+3]=255^s[i+1];for(var r=0;r<n;++r)s[i+r+4]=t[r];return 8*(i+4+n)},z0=function(s,e,t,n,i,r,o,a,l,c,u){In(e,u++,t),++i[256];for(var d=Hc(i,15),f=d[0],h=d[1],p=Hc(r,15),g=p[0],m=p[1],_=G0(f),y=_[0],S=_[1],C=G0(g),E=C[0],A=C[1],R=new ms(19),I=0;I<y.length;++I)R[31&y[I]]++;for(I=0;I<E.length;++I)R[31&E[I]]++;for(var D=Hc(R,7),L=D[0],M=D[1],$=19;$>4&&!L[U0[$-1]];--$);var H,ie,te,X,de=c+5<<3,xe=co(i,Ji)+co(r,El)+o,le=co(i,f)+co(r,g)+o+14+3*$+co(R,L)+(2*R[16]+3*R[17]+7*R[18]);if(de<=xe&&de<=le)return Wa(e,u,s.subarray(l,l+c));if(In(e,u,1+(le<xe)),u+=2,le<xe){H=Ao(f,h,0),ie=f,te=Ao(g,m,0),X=g;var re=Ao(L,M,0);for(In(e,u,S-257),In(e,u+5,A-1),In(e,u+10,$-4),u+=14,I=0;I<$;++I)In(e,u+3*I,L[U0[I]]);u+=3*$;for(var Be=[y,E],be=0;be<2;++be){var Fe=Be[be];for(I=0;I<Fe.length;++I){var We=31&Fe[I];In(e,u,re[We]),u+=L[We],We>15&&(In(e,u,Fe[I]>>>5&127),u+=Fe[I]>>>12)}}}else H=hL,ie=Ji,te=pL,X=El;for(I=0;I<a;++I)if(n[I]>255){We=n[I]>>>18&31,lo(e,u,H[We+257]),u+=ie[We+257],We>7&&(In(e,u,n[I]>>>23&31),u+=_f[We]);var ot=31&n[I];lo(e,u,te[ot]),u+=X[ot],ot>3&&(lo(e,u,n[I]>>>5&8191),u+=yf[ot])}else lo(e,u,H[n[I]]),u+=ie[n[I]];return lo(e,u,H[256]),u+ie[256]},mL=new qr([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),vL=new Ls(0),_L=function(){for(var s=new qr(256),e=0;e<256;++e){for(var t=e,n=9;--n;)t=(1&t&&3988292384)^t>>>1;s[e]=t}return s}(),yL=function(){var s=4294967295;return{p:function(e){for(var t=s,n=0;n<e.length;++n)t=_L[255&t^e[n]]^t>>>8;s=t},d:function(){return 4294967295^s}}},xL=function(s,e,t,n,i){return function(r,o,a,l,c,u){var d=r.length,f=new Ls(l+d+5*(1+Math.floor(d/7e3))+c),h=f.subarray(l,f.length-c),p=0;if(!o||d<8)for(var g=0;g<=d;g+=65535){var m=g+65535;m<d?p=Wa(h,p,r.subarray(g,m)):(h[g]=u,p=Wa(h,p,r.subarray(g,d)))}else{for(var _=mL[o-1],y=_>>>13,S=8191&_,C=(1<<a)-1,E=new ms(32768),A=new ms(C+1),R=Math.ceil(a/3),I=2*R,D=function(Y){return(r[Y]^r[Y+1]<<R^r[Y+2]<<I)&C},L=new qr(25e3),M=new ms(288),$=new ms(32),H=0,ie=0,te=(g=0,0),X=0,de=0;g<d;++g){var xe=D(g),le=32767&g,re=A[xe];if(E[le]=re,A[xe]=le,X<=g){var Be=d-g;if((H>7e3||te>24576)&&Be>423){p=z0(r,h,0,L,M,$,ie,te,de,g-de,p),te=H=ie=0,de=g;for(var be=0;be<286;++be)M[be]=0;for(be=0;be<30;++be)$[be]=0}var Fe=2,We=0,ot=S,Ue=le-re&32767;if(Be>2&&xe==D(g-Ue))for(var K=Math.min(y,Be)-1,me=Math.min(32767,g),fe=Math.min(258,Be);Ue<=me&&--ot&&le!=re;){if(r[g+Fe]==r[g+Fe-Ue]){for(var Se=0;Se<fe&&r[g+Se]==r[g+Se-Ue];++Se);if(Se>Fe){if(Fe=Se,We=Ue,Se>K)break;var it=Math.min(Ue,Se-2),lt=0;for(be=0;be<it;++be){var k=g-Ue+be+32768&32767,O=k-E[k]+32768&32767;O>lt&&(lt=O,re=k)}}}Ue+=(le=re)-(re=E[le])+32768&32767}if(We){L[te++]=268435456|td[Fe]<<18|H0[We];var G=31&td[Fe],Q=31&H0[We];ie+=_f[G]+yf[Q],++M[257+G],++$[Q],X=g+Fe,++H}else L[te++]=r[g],++M[r[g]]}}p=z0(r,h,u,L,M,$,ie,te,de,g-de,p),u||(p=Wa(h,p,vL))}return Om(f,0,l+Fm(p)+c)}(s,e.level==null?6:e.level,e.mem==null?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(s.length)))):12+e.mem,t,n,!i)},nd=function(s,e,t){for(;t;++e)s[e]=t,t>>>=8},bL=function(s,e){var t=e.filename;if(s[0]=31,s[1]=139,s[2]=8,s[8]=e.level<2?4:e.level==9?2:0,s[9]=3,e.mtime!=0&&nd(s,4,Math.floor(new Date(e.mtime||Date.now())/1e3)),t){s[3]=8;for(var n=0;n<=t.length;++n)s[n+10]=t.charCodeAt(n)}},wL=function(s){return 10+(s.filename&&s.filename.length+1||0)};function SL(s,e){e===void 0&&(e={});var t=yL(),n=s.length;t.p(s);var i=xL(s,e,wL(e),8),r=i.length;return bL(i,e),nd(i,r-8,t.d()),nd(i,r-4,n),i}function EL(s,e){var t=s.length;if(!e&&typeof TextEncoder<"u")return new TextEncoder().encode(s);for(var n=new Ls(s.length+(s.length>>>1)),i=0,r=function(c){n[i++]=c},o=0;o<t;++o){if(i+5>n.length){var a=new Ls(i+8+(t-o<<1));a.set(n),n=a}var l=s.charCodeAt(o);l<128||e?r(l):l<2048?(r(192|l>>>6),r(128|63&l)):l>55295&&l<57344?(r(240|(l=65536+(1047552&l)|1023&s.charCodeAt(++o))>>>18),r(128|l>>>12&63),r(128|l>>>6&63),r(128|63&l)):(r(224|l>>>12),r(128|l>>>6&63),r(128|63&l))}return Om(n,0,i)}(function(s){s.GZipJS="gzip-js",s.Base64="base64"})(Vi||(Vi={}));var xf=function(s,e,t){var n=e||{};n.ip=t.ip?1:0,n._=new Date().getTime().toString(),n.ver=Qi.LIB_VERSION;var i=s.split("?");if(i.length>1){var r,o=En(i[1].split("&"));try{for(o.s();!(r=o.n()).done;){var a=r.value.split("=")[0];et(n[a])||delete n[a]}}catch(c){o.e(c)}finally{o.f()}}var l=s.indexOf("?")>-1?"&":"?";return s+l+function(c){var u,d,f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"&",h=[];return vt(c,function(p,g){et(p)||et(g)||g==="undefined"||(u=encodeURIComponent(p.toString()),d=encodeURIComponent(g),h[h.length]=d+"="+u)}),h.join(f)}(n)},cc=function s(e,t){if(t.blob&&e.buffer)return new Blob([v0(e)?e:e.buffer],{type:"text/plain"});if(t.sendBeacon||t.blob){var n=s(e,{method:"POST"});return new Blob([n],{type:"application/x-www-form-urlencoded"})}return t.method!=="POST"?null:(i=Ht(e)||v0(e)?"data="+encodeURIComponent(e):"data="+encodeURIComponent(e.data),"compression"in e&&e.compression&&(i+="&compression="+e.compression),i);var i},Mm=function(s){if(ju&&s.options.transport==="fetch"){var e,t=cc(s.data,s.options),n=new Headers;vt(n,function(r,o){n.append(o,r)}),s.options.method!=="POST"||s.options.blob||n.append("Content-Type","application/x-www-form-urlencoded");var i=s.url;return rn(s.retriesPerformedSoFar)&&s.retriesPerformedSoFar>0&&(i=xf(i,{retry_count:s.retriesPerformedSoFar},{})),void ju(i,{method:((e=s.options)===null||e===void 0?void 0:e.method)||"GET",headers:n,keepalive:s.options.method==="POST",body:t}).then(function(r){var o=r.status;return r.text().then(function(a){var l,c;if((l=s.onResponse)===null||l===void 0||l.call(s,{statusCode:o,responseText:a}),o!==200)Gs(s.onError)&&s.onError({statusCode:o,responseText:a}),(o<400||o>500)&&s.retryQueue.enqueue(Oe(Oe({},s),{},{headers:n,retriesPerformedSoFar:(s.retriesPerformedSoFar||0)+1})),(c=s.callback)===null||c===void 0||c.call(s,{status:0});else try{var u;(u=s.callback)===null||u===void 0||u.call(s,JSON.parse(a))}catch(d){he.error(d)}})}).catch(function(r){var o;he.error(r),(o=s.callback)===null||o===void 0||o.call(s,{status:0})})}return TL(s)},TL=function(s){var e=s.url,t=s.data,n=s.headers,i=s.options,r=s.callback,o=s.retriesPerformedSoFar,a=s.retryQueue,l=s.onError,c=s.timeout,u=c===void 0?6e4:c,d=s.onResponse;rn(o)&&o>0&&(e=xf(e,{retry_count:o},{}));var f=new XMLHttpRequest;f.open(i.method||"GET",e,!0);var h=cc(t,i);vt(n,function(p,g){f.setRequestHeader(g,p)}),i.method!=="POST"||i.blob||f.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),f.timeout=u,f.withCredentials=!0,f.onreadystatechange=function(){if(f.readyState===4){var p={statusCode:f.status,responseText:f.responseText};if(d==null||d(p),f.status===200){if(r){var g;try{g=JSON.parse(f.responseText)}catch(m){return void he.error(m)}r(g)}}else Gs(l)&&l(p),(f.status<400||f.status>500)&&a.enqueue({url:e,data:t,options:i,headers:n,retriesPerformedSoFar:(o||0)+1,callback:r}),r==null||r({status:0})}},f.send(h)},Er,CL=function(s){fm(t,Im);var e=hm(t);function t(n,i){var r;return Dt(this,t),(r=e.call(this)).isPolling=!1,r.queue=[],r.areWeOnline=!0,r.onRequestError=n,r.rateLimiter=i,!et(q)&&"onLine"in q.navigator&&(r.areWeOnline=q.navigator.onLine,q.addEventListener("online",function(){r._handleWeAreNowOnline()}),q.addEventListener("offline",function(){r.areWeOnline=!1})),r}return Pt(t,[{key:"enqueue",value:function(n){var i=n.retriesPerformedSoFar||0;if(!(i>=10)){var r=function(l){var c=3e3*Math.pow(2,l),u=c/2,d=Math.min(18e5,c),f=(Math.random()-.5)*(d-u);return Math.ceil(d+f)}(i),o=new Date(Date.now()+r);this.queue.push({retryAt:o,requestData:n});var a="Enqueued failed request for retry in ".concat(r);navigator.onLine||(a+=" (Browser is offline)"),he.warn(a),this.isPolling||(this.isPolling=!0,this.poll())}}},{key:"poll",value:function(){var n=this;this._poller&&clearTimeout(this._poller),this._poller=setTimeout(function(){n.areWeOnline&&n.queue.length>0&&n.flush(),n.poll()},this._pollInterval)}},{key:"flush",value:function(){var n=new Date(Date.now()),i=this.queue.filter(function(l){return l.retryAt<n});if(i.length>0){this.queue=this.queue.filter(function(l){return l.retryAt>=n});var r,o=En(i);try{for(o.s();!(r=o.n()).done;){var a=r.value.requestData;this._executeXhrRequest(a)}}catch(l){o.e(l)}finally{o.f()}}}},{key:"unload",value:function(){this._poller&&(clearTimeout(this._poller),this._poller=void 0);var n,i=En(this.queue);try{for(i.s();!(n=i.n()).done;){var r=n.value.requestData,o=r.url,a=r.data,l=r.options;if(this.rateLimiter.isRateLimited(l._batchKey))he.warn("[RetryQueue] is quota limited. Dropping request.");else try{q==null||q.navigator.sendBeacon(o,cc(a,Oe(Oe({},l),{},{sendBeacon:!0})))}catch(c){he.error(c)}}}catch(c){i.e(c)}finally{i.f()}this.queue=[]}},{key:"_executeXhrRequest",value:function(n){var i=n.url,r=n.data,o=n.options,a=n.headers,l=n.callback,c=n.retriesPerformedSoFar;this.rateLimiter.isRateLimited(o._batchKey)||Mm({url:i,data:r||{},options:o||{},headers:a||{},retriesPerformedSoFar:c||0,callback:l,retryQueue:this,onError:this.onRequestError,onResponse:this.rateLimiter.checkForLimiting})}},{key:"_handleWeAreNowOnline",value:function(){this.areWeOnline=!0,this.flush()}}]),t}(),va=1800,AL=function(){function s(e,t,n,i){Dt(this,s),Ce(this,"_sessionIdChangedHandlers",[]),this.config=e,this.persistence=t,this._windowId=void 0,this._sessionId=void 0,this._sessionStartTimestamp=null,this._sessionActivityTimestamp=null,this._sessionIdGenerator=n||Hi,this._windowIdGenerator=i||Hi;var r=e.persistence_name||e.token,o=e.session_idle_timeout_seconds||va;if(rn(o)?o>va?he.warn("session_idle_timeout_seconds cannot be  greater than 30 minutes. Using 30 minutes instead."):o<60&&he.warn("session_idle_timeout_seconds cannot be less than 60 seconds. Using 60 seconds instead."):(he.warn("session_idle_timeout_seconds must be a number. Defaulting to 30 minutes."),o=va),this._sessionTimeoutMs=1e3*Math.min(Math.max(o,60),va),this._window_id_storage_key="ph_"+r+"_window_id",this._primary_window_exists_storage_key="ph_"+r+"_primary_window_exists",this._canUseSessionStorage()){var a=is.parse(this._window_id_storage_key),l=is.parse(this._primary_window_exists_storage_key);a&&!l?this._windowId=a:is.remove(this._window_id_storage_key),is.set(this._primary_window_exists_storage_key,!0)}this._listenToReloadWindow()}return Pt(s,[{key:"onSessionId",value:function(e){var t=this;return et(this._sessionIdChangedHandlers)&&(this._sessionIdChangedHandlers=[]),this._sessionIdChangedHandlers.push(e),this._sessionId&&e(this._sessionId,this._windowId),function(){t._sessionIdChangedHandlers=t._sessionIdChangedHandlers.filter(function(n){return n!==e})}}},{key:"_canUseSessionStorage",value:function(){return this.config.persistence!=="memory"&&!this.persistence.disabled&&is.is_supported()}},{key:"_setWindowId",value:function(e){e!==this._windowId&&(this._windowId=e,this._canUseSessionStorage()&&is.set(this._window_id_storage_key,e))}},{key:"_getWindowId",value:function(){return this._windowId?this._windowId:this._canUseSessionStorage()?is.parse(this._window_id_storage_key):null}},{key:"_setSessionId",value:function(e,t,n){e===this._sessionId&&t===this._sessionActivityTimestamp&&n===this._sessionStartTimestamp||(this._sessionStartTimestamp=n,this._sessionActivityTimestamp=t,this._sessionId=e,this.persistence.register(Ce({},bl,[t,e,n])))}},{key:"_getSessionId",value:function(){if(this._sessionId&&this._sessionActivityTimestamp&&this._sessionStartTimestamp)return[this._sessionActivityTimestamp,this._sessionId,this._sessionStartTimestamp];var e=this.persistence.props[bl];return Ht(e)&&e.length===2&&e.push(e[0]),e||[0,null,0]}},{key:"resetSessionId",value:function(){this._setSessionId(null,null,null)}},{key:"_listenToReloadWindow",value:function(){var e=this;q==null||q.addEventListener("beforeunload",function(){e._canUseSessionStorage()&&is.remove(e._primary_window_exists_storage_key)})}},{key:"checkAndGetSessionAndWindowId",value:function(){var e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:null)||new Date().getTime(),n=tn(this._getSessionId(),3),i=n[0],r=n[1],o=n[2],a=this._getWindowId(),l=o&&o>0&&Math.abs(t-o)>864e5,c=!1,u=!r,d=!e&&Math.abs(t-i)>this._sessionTimeoutMs;u||d||l?(r=this._sessionIdGenerator(),a=this._windowIdGenerator(),he.info("[SessionId] new session ID generated",{sessionId:r,windowId:a,changeReason:{noSessionId:u,activityTimeout:d,sessionPastMaximumLength:l}}),o=t,c=!0):a||(a=this._windowIdGenerator(),c=!0);var f=i===0||!e||l?t:i,h=o===0?new Date().getTime():o;return this._setWindowId(a),this._setSessionId(r,f,h),c&&this._sessionIdChangedHandlers.forEach(function(p){return p(r,a)}),{sessionId:r,windowId:a,sessionStartTimestamp:h}}}]),s}();(function(s){s.US="us",s.EU="eu",s.CUSTOM="custom"})(Er||(Er={}));var kL=function(){function s(e){Dt(this,s),this.instance=e}return Pt(s,[{key:"apiHost",get:function(){return this.instance.config.api_host.replace(/\/$/,"")}},{key:"uiHost",get:function(){var e;return(e=this.instance.config.ui_host)===null||e===void 0?void 0:e.replace(/\/$/,"")}},{key:"region",get:function(){switch(this.apiHost){case"https://app.posthog.com":case"https://us.posthog.com":return Er.US;case"https://eu.posthog.com":return Er.EU;default:return Er.CUSTOM}}},{key:"endpointFor",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(t&&(t=t[0]==="/"?t:"/".concat(t)),e==="ui")return(this.uiHost||this.apiHost)+t;if(!this.instance.config.__preview_ingestion_endpoints||this.region===Er.CUSTOM)return this.apiHost+t;var n="i.posthog.com"+t;switch(e){case"capture_events":return"https://".concat(this.region,"-c.").concat(n);case"capture_recordings":return"https://".concat(this.region,"-s.").concat(n);case"decide":return"https://".concat(this.region,"-d.").concat(n);case"assets":return"https://".concat(this.region,"-assets.").concat(n);case"api":return"https://".concat(this.region,"-api.").concat(n)}}}]),s}(),LL=Pt(function s(e,t,n,i){Dt(this,s),this.name="posthog-js",this.setupOnce=function(r){r(function(o){var a,l,c,u,d;if(o.level!=="error"||!e.__loaded)return o;o.tags||(o.tags={});var f=e.requestRouter.endpointFor("ui","/person/"+e.get_distinct_id());o.tags["PostHog Person URL"]=f,e.sessionRecordingStarted()&&(o.tags["PostHog Recording URL"]=e.get_session_replay_url({withTimestamp:!0}));var h=((a=o.exception)===null||a===void 0?void 0:a.values)||[],p={$exception_message:(l=h[0])===null||l===void 0?void 0:l.value,$exception_type:(c=h[0])===null||c===void 0?void 0:c.type,$exception_personURL:f,$sentry_event_id:o.event_id,$sentry_exception:o.exception,$sentry_exception_message:(u=h[0])===null||u===void 0?void 0:u.value,$sentry_exception_type:(d=h[0])===null||d===void 0?void 0:d.type,$sentry_tags:o.tags};return t&&n&&(p.$sentry_url=(i||"https://sentry.io/organizations/")+t+"/issues/?project="+n+"&query="+o.event_id),e.capture("$exception",p),o})}}),RL=function(){function s(e){var t=this;Dt(this,s),Ce(this,"_hasSeenPageView",!1),Ce(this,"_updateScrollData",function(){var n,i,r,o;t._pageViewData||(t._pageViewData=t._createPageViewData());var a=t._pageViewData,l=t._scrollY(),c=t._scrollHeight(),u=t._contentY(),d=t._contentHeight();a.lastScrollY=l,a.maxScrollY=Math.max(l,(n=a.maxScrollY)!==null&&n!==void 0?n:0),a.maxScrollHeight=Math.max(c,(i=a.maxScrollHeight)!==null&&i!==void 0?i:0),a.lastContentY=u,a.maxContentY=Math.max(u,(r=a.maxContentY)!==null&&r!==void 0?r:0),a.maxContentHeight=Math.max(d,(o=a.maxContentHeight)!==null&&o!==void 0?o:0)}),this._instance=e}return Pt(s,[{key:"_createPageViewData",value:function(){var e;return{pathname:(e=q==null?void 0:q.location.pathname)!==null&&e!==void 0?e:""}}},{key:"doPageView",value:function(){var e,t;return this._hasSeenPageView?(t=this._pageViewData,this._pageViewData=this._createPageViewData()):(this._hasSeenPageView=!0,t=void 0,this._pageViewData||(this._pageViewData=this._createPageViewData())),setTimeout(this._updateScrollData,0),Oe({$prev_pageview_pathname:(e=t)===null||e===void 0?void 0:e.pathname},this._calculatePrevPageScrollProperties(t))}},{key:"doPageLeave",value:function(){var e=this._pageViewData;return Oe({$prev_pageview_pathname:e==null?void 0:e.pathname},this._calculatePrevPageScrollProperties(e))}},{key:"_calculatePrevPageScrollProperties",value:function(e){if(!e||e.maxScrollHeight==null||e.lastScrollY==null||e.maxScrollY==null||e.maxContentHeight==null||e.lastContentY==null||e.maxContentY==null)return{};var t=e.maxScrollHeight,n=e.lastScrollY,i=e.maxScrollY,r=e.maxContentHeight,o=e.lastContentY,a=e.maxContentY;return t=Math.ceil(t),n=Math.ceil(n),i=Math.ceil(i),r=Math.ceil(r),o=Math.ceil(o),a=Math.ceil(a),{$prev_pageview_last_scroll:n,$prev_pageview_last_scroll_percentage:t<=1?1:_a(n/t,0,1),$prev_pageview_max_scroll:i,$prev_pageview_max_scroll_percentage:t<=1?1:_a(i/t,0,1),$prev_pageview_last_content:o,$prev_pageview_last_content_percentage:r<=1?1:_a(o/r,0,1),$prev_pageview_max_content:a,$prev_pageview_max_content_percentage:r<=1?1:_a(a/r,0,1)}}},{key:"startMeasuringScrollPosition",value:function(){q==null||q.addEventListener("scroll",this._updateScrollData,!0),q==null||q.addEventListener("scrollend",this._updateScrollData,!0),q==null||q.addEventListener("resize",this._updateScrollData)}},{key:"stopMeasuringScrollPosition",value:function(){q==null||q.removeEventListener("scroll",this._updateScrollData),q==null||q.removeEventListener("scrollend",this._updateScrollData),q==null||q.removeEventListener("resize",this._updateScrollData)}},{key:"_scrollElement",value:function(){if(!this._instance.config.scroll_root_selector)return q==null?void 0:q.document.documentElement;var e,t=En(Ht(this._instance.config.scroll_root_selector)?this._instance.config.scroll_root_selector:[this._instance.config.scroll_root_selector]);try{for(t.s();!(e=t.n()).done;){var n=e.value,i=q==null?void 0:q.document.querySelector(n);if(i)return i}}catch(r){t.e(r)}finally{t.f()}}},{key:"_scrollHeight",value:function(){var e=this._scrollElement();return e?Math.max(0,e.scrollHeight-e.clientHeight):0}},{key:"_scrollY",value:function(){if(this._instance.config.scroll_root_selector){var e=this._scrollElement();return e&&e.scrollTop||0}return q&&(q.scrollY||q.pageYOffset||q.document.documentElement.scrollTop)||0}},{key:"_contentHeight",value:function(){var e=this._scrollElement();return(e==null?void 0:e.scrollHeight)||0}},{key:"_contentY",value:function(){var e=this._scrollElement(),t=(e==null?void 0:e.clientHeight)||0;return this._scrollY()+t}}]),s}();function _a(s,e,t){return Math.max(e,Math.min(s,t))}var Uo,bf,ns,IL={icontains:function(s){return!!q&&q.location.href.toLowerCase().indexOf(s.toLowerCase())>-1},regex:function(s){return!!q&&qk(q.location.href,s)},exact:function(s){return(q==null?void 0:q.location.href)===s}},DL=function(){function s(e){Dt(this,s),this.instance=e}return Pt(s,[{key:"getSurveys",value:function(e){var t=this,n=arguments.length>1&&arguments[1]!==void 0&&arguments[1],i=this.instance.get_property(Zu);if(i&&!n)return e(i);this.instance._send_request(this.instance.requestRouter.endpointFor("api","/api/surveys/?token=".concat(this.instance.config.token)),{},{method:"GET"},function(r){var o,a=r.surveys||[];return(o=t.instance.persistence)===null||o===void 0||o.register(Ce({},Zu,a)),e(a)})}},{key:"getActiveMatchingSurveys",value:function(e){var t=this,n=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this.getSurveys(function(i){var r=i.filter(function(o){return!(!o.start_date||o.end_date)}).filter(function(o){var a,l,c,u;if(!o.conditions)return!0;var d=(a=o.conditions)===null||a===void 0||!a.url||IL[(l=(c=o.conditions)===null||c===void 0?void 0:c.urlMatchType)!==null&&l!==void 0?l:"icontains"](o.conditions.url),f=(u=o.conditions)===null||u===void 0||!u.selector||(Le==null?void 0:Le.querySelector(o.conditions.selector));return d&&f}).filter(function(o){if(!o.linked_flag_key&&!o.targeting_flag_key)return!0;var a=!o.linked_flag_key||t.instance.featureFlags.isFeatureEnabled(o.linked_flag_key),l=!o.targeting_flag_key||t.instance.featureFlags.isFeatureEnabled(o.targeting_flag_key);return a&&l});return e(r)},n)}}]),s}(),PL=function(){function s(){var e=this;Dt(this,s),Ce(this,"limits",{}),Ce(this,"checkForLimiting",function(t){var n=t.responseText;if(n&&n.length)try{(JSON.parse(n).quota_limited||[]).forEach(function(i){he.info("[RateLimiter] ".concat(i||"events"," is quota limited.")),e.limits[i]=new Date().getTime()+6e4})}catch(i){return void he.warn('[RateLimiter] could not rate limit - continuing. Error: "'.concat(i==null?void 0:i.message,'"'),{text:n})}})}return Pt(s,[{key:"isRateLimited",value:function(e){var t=this.limits[e||"events"]||!1;return t!==!1&&new Date().getTime()<t}}]),s}(),FL=function(){return Oe({initialPathName:(li==null?void 0:li.pathname)||"",referringDomain:Ut.referringDomain()},Ut.campaignParams())},OL=function(){function s(e,t,n){var i=this;Dt(this,s),Ce(this,"_onSessionIdCallback",function(r){var o=i._getStoredProps();if(!o||o.sessionId!==r){var a={sessionId:r,props:i._sessionSourceParamGenerator()};i._persistence.register(Ce({},Ju,a))}}),this._sessionIdManager=e,this._persistence=t,this._sessionSourceParamGenerator=n||FL,this._sessionIdManager.onSessionId(this._onSessionIdCallback)}return Pt(s,[{key:"_getStoredProps",value:function(){return this._persistence.props[Ju]}},{key:"getSessionProps",value:function(){var e,t=(e=this._getStoredProps())===null||e===void 0?void 0:e.props;return t?{$client_session_initial_referring_host:t.referringDomain,$client_session_initial_pathname:t.initialPathName,$client_session_initial_utm_source:t.utm_source,$client_session_initial_utm_campaign:t.utm_campaign,$client_session_initial_utm_medium:t.utm_medium,$client_session_initial_utm_content:t.utm_content,$client_session_initial_utm_term:t.utm_term}:{}}}]),s}(),ML=["ahrefsbot","ahrefssiteaudit","applebot","baiduspider","bingbot","bingpreview","bot.htm","bot.php","crawler","duckduckbot","facebookexternal","facebookcatalog","gptbot","http://yandex.com/bots","hubspot","ia_archiver","linkedinbot","mj12bot","msnbot","nessus","petalbot","pinterest","prerender","rogerbot","screaming frog","semrushbot","sitebulb","slurp","turnitin","twitterbot","vercelbot","yahoo! slurp","yandexbot","adsbot-google","apis-google","duplexweb-google","feedfetcher-google","google favicon","google web preview","google-read-aloud","googlebot","googleweblight","mediapartners-google","storebot-google"],j0=function(s,e){if(!s)return!1;var t=s.toLowerCase();return ML.concat(e||[]).some(function(n){var i=n.toLowerCase();return t.includes?t.includes(i):t.indexOf(i)!==-1})};(function(s){s[s.INIT_MODULE=0]="INIT_MODULE",s[s.INIT_SNIPPET=1]="INIT_SNIPPET"})(Uo||(Uo={}));var id=function(){},ya={},ys="posthog",$m=!qa&&(Ot==null?void 0:Ot.indexOf("MSIE"))===-1&&(Ot==null?void 0:Ot.indexOf("Mozilla"))===-1,q0=function(){var s,e,t;return{api_host:"https://app.posthog.com",api_method:"POST",api_transport:"XHR",ui_host:null,token:"",autocapture:!0,rageclick:!0,cross_subdomain_cookie:(e=Le==null?void 0:Le.location,t=e==null?void 0:e.hostname,!!ks(t)&&t.split(".").slice(-2).join(".")!=="herokuapp.com"),persistence:"localStorage+cookie",persistence_name:"",cookie_name:"",loaded:id,store_google:!0,custom_campaign_params:[],custom_blocked_useragents:[],save_referrer:!0,capture_pageview:!0,capture_pageleave:!0,debug:!1,verbose:!1,cookie_expiration:365,upgrade:!1,disable_session_recording:!1,disable_persistence:!1,disable_cookie:!1,enable_recording_console_log:void 0,secure_cookie:(q==null||(s=q.location)===null||s===void 0?void 0:s.protocol)==="https:",ip:!0,opt_out_capturing_by_default:!1,opt_out_persistence_by_default:!1,opt_out_useragent_filter:!1,opt_out_capturing_persistence_type:"localStorage",opt_out_capturing_cookie_prefix:null,opt_in_site_apps:!1,property_blacklist:[],respect_dnt:!1,sanitize_properties:null,request_headers:{},inapp_protocol:"//",inapp_link_new_window:!1,request_batching:!0,properties_string_max_length:65535,session_recording:{},mask_all_element_attributes:!1,mask_all_text:!1,advanced_disable_decide:!1,advanced_disable_feature_flags:!1,advanced_disable_feature_flags_on_first_load:!1,advanced_disable_toolbar_metrics:!1,on_request_error:function(n){var i="Bad HTTP status: "+n.statusCode+" "+n.responseText;he.error(i)},get_device_id:function(n){return n},_onCapture:id,capture_performance:void 0,name:"posthog",callback_fn:"posthog._jsc",bootstrap:{},disable_compression:!1,session_idle_timeout_seconds:1800}},rd=function(s,e,t,n){var i,r=t!==ys&&ns?t?ns[t]:void 0:ns,o={initComplete:!1,syncCode:!1},a=function(l){return function(c){o[l]||(o[l]=!0,o.initComplete&&o.syncCode&&(n==null||n(c)))}};if(r&&bf===Uo.INIT_MODULE)i=r;else{if(r&&!Ht(r))return void he.error("You have already initialized "+t);i=new wf}return i._init(s,e,t,a("initComplete")),i.toolbar.maybeLoadToolbar(),i.sessionRecording=new oL(i),i.sessionRecording.startRecordingIfEnabled(),i.config.disable_scroll_properties||i.pageViewManager.startMeasuringScrollPosition(),i.__autocapture=i.config.autocapture,fi._setIsAutocaptureEnabled(i),fi._isAutocaptureEnabled&&(i.__autocapture=i.config.autocapture,fi.enabledForProject(i.config.token,100,100)?fi.isBrowserSupported()?fi.init(i):(i.__autocapture=!1,he.info("Disabling Automatic Event Collection because this browser is not supported")):(i.__autocapture=!1,he.info("Not in active bucket: disabling Automatic Event Collection."))),Qi.DEBUG=Qi.DEBUG||i.config.debug,!et(r)&&Ht(r)&&(i._execute_array.call(i.people,r.people),i._execute_array(r)),a("syncCode")(i),i},$L=function(){function s(){Dt(this,s),Ce(this,"__forceAllowLocalhost",!1)}return Pt(s,[{key:"_forceAllowLocalhost",get:function(){return this.__forceAllowLocalhost},set:function(e){he.error("WebPerformanceObserver is deprecated and has no impact on network capture. Use `_forceAllowLocalhostNetworkCapture` on `posthog.sessionRecording`"),this.__forceAllowLocalhost=e}}]),s}(),wf=function(){function s(){var e=this;Dt(this,s),Ce(this,"webPerformance",new $L),this.config=q0(),this.compression={},this.decideEndpointWasHit=!1,this.SentryIntegration=LL,this.segmentIntegration=function(){return function(t){Promise&&Promise.resolve||he.warn("This browser does not have Promise support, and can not use the segment integration");var n=function(i,r){i.event.userId||i.event.anonymousId===t.get_distinct_id()||t.reset(),i.event.userId&&i.event.userId!==t.get_distinct_id()&&(t.register({distinct_id:i.event.userId}),t.reloadFeatureFlags());var o=t._calculate_event_properties(r,i.event.properties);return i.event.properties=Object.assign({},o,i.event.properties),i};return{name:"PostHog JS",type:"enrichment",version:"1.0.0",isLoaded:function(){return!0},load:function(){return Promise.resolve()},track:function(i){return n(i,i.event.event)},page:function(i){return n(i,"$pageview")},identify:function(i){return n(i,"$identify")},screen:function(i){return n(i,"$screen")}}}(e)},this.__captureHooks=[],this.__request_queue=[],this.__loaded=!1,this.__loaded_recorder_version=void 0,this.__autocapture=void 0,this._jsc=function(){},this.analyticsDefaultEndpoint="/e/",this.elementsChainAsString=!1,this.featureFlags=new Ok(this),this.toolbar=new uL(this),this.pageViewManager=new RL(this),this.surveys=new DL(this),this.rateLimiter=new PL,this.requestRouter=new kL(this),this.people={set:function(t,n,i){var r=ks(t)?Ce({},t,n):t;e.setPersonProperties(r),i==null||i({})},set_once:function(t,n,i){var r=ks(t)?Ce({},t,n):t;e.setPersonProperties(void 0,r),i==null||i({})}}}return Pt(s,[{key:"init",value:function(e,t,n){if(et(n))he.critical("You must name your new library: init(token, config, name)");else{if(n!==ys){var i=rd(e,t,n,function(r){ns[n]=r,r._loaded()});return ns[n]=i,i}he.critical("You must initialize the main posthog object right after you include the PostHog js snippet")}}},{key:"_init",value:function(e){var t,n,i,r=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0;this.__loaded=!0,this.config={},this._triggered_notifs=[];var c,u={segmentRegister:!1,syncCode:!1},d=function(E){return function(){u[E]||(u[E]=!0,u.segmentRegister&&u.syncCode&&(l==null||l(r)))}};if(o.request_headers=o.request_headers||o.xhr_headers,this.set_config(ss({},q0(),o,{name:a,token:e,callback_fn:(a===ys?a:ys+"."+a)+"._jsc"})),this._jsc=function(){},(q!=null&&(t=q.rrweb)!==null&&t!==void 0&&t.record||q!=null&&q.rrwebRecord)&&(this.__loaded_recorder_version=q==null||(c=q.rrweb)===null||c===void 0?void 0:c.version),this.persistence=new M0(this.config),this._requestQueue=new dL(this._handle_queued_event.bind(this)),this._retryQueue=new CL(this.config.on_request_error,this.rateLimiter),this.__captureHooks=[],this.__request_queue=[],this.sessionManager=new AL(this.config,this.persistence),this.sessionPropsManager=new OL(this.sessionManager,this.persistence),this.sessionPersistence=this.config.persistence==="sessionStorage"?this.persistence:new M0(Oe(Oe({},this.config),{},{persistence:"sessionStorage"})),this._gdpr_init(),o.segment?(this.config.get_device_id=function(){return o.segment.user().anonymousId()},o.segment.user().id()&&(this.register({distinct_id:o.segment.user().id()}),this.persistence.set_user_state("identified")),o.segment.register(this.segmentIntegration()).then(d("segmentRegister"))):d("segmentRegister")(),((n=o.bootstrap)===null||n===void 0?void 0:n.distinctID)!==void 0){var f,h,p=this.config.get_device_id(Hi()),g=(f=o.bootstrap)!==null&&f!==void 0&&f.isIdentifiedID?p:o.bootstrap.distinctID;this.persistence.set_user_state((h=o.bootstrap)!==null&&h!==void 0&&h.isIdentifiedID?"identified":"anonymous"),this.register({distinct_id:o.bootstrap.distinctID,$device_id:g})}if(this._hasBootstrappedFeatureFlags()){var m,_,y=Object.keys(((m=o.bootstrap)===null||m===void 0?void 0:m.featureFlags)||{}).filter(function(E){var A,R;return!((A=o.bootstrap)===null||A===void 0||(R=A.featureFlags)===null||R===void 0||!R[E])}).reduce(function(E,A){var R,I;return E[A]=((R=o.bootstrap)===null||R===void 0||(I=R.featureFlags)===null||I===void 0?void 0:I[A])||!1,E},{}),S=Object.keys(((_=o.bootstrap)===null||_===void 0?void 0:_.featureFlagPayloads)||{}).filter(function(E){return y[E]}).reduce(function(E,A){var R,I,D,L;return(R=o.bootstrap)!==null&&R!==void 0&&(I=R.featureFlagPayloads)!==null&&I!==void 0&&I[A]&&(E[A]=(D=o.bootstrap)===null||D===void 0||(L=D.featureFlagPayloads)===null||L===void 0?void 0:L[A]),E},{});this.featureFlags.receivedFeatureFlags({featureFlags:y,featureFlagPayloads:S})}if(!this.get_distinct_id()){var C=this.config.get_device_id(Hi());this.register_once({distinct_id:C,$device_id:C},""),this.persistence.set_user_state("anonymous")}q==null||(i=q.addEventListener)===null||i===void 0||i.call(q,"onpagehide"in self?"pagehide":"unload",this._handle_unload.bind(this)),d("syncCode")()}},{key:"_afterDecideResponse",value:function(e){var t;if(this.compression={},e.supportedCompression&&!this.config.disable_compression){var n,i={},r=En(e.supportedCompression);try{for(r.s();!(n=r.n()).done;)i[n.value]=!0}catch(o){r.e(o)}finally{r.f()}this.compression=i}(t=e.analytics)!==null&&t!==void 0&&t.endpoint&&(this.analyticsDefaultEndpoint=e.analytics.endpoint),e.elementsChainAsString&&(this.elementsChainAsString=e.elementsChainAsString),e.__preview_ingestion_endpoints&&(this.config.__preview_ingestion_endpoints=e.__preview_ingestion_endpoints)}},{key:"_loaded",value:function(){var e=this.config.advanced_disable_decide;e||this.featureFlags.setReloadingPaused(!0);try{this.config.loaded(this)}catch(t){he.critical("`loaded` function failed",t)}this._start_queue_if_opted_in(),this.config.capture_pageview&&Le&&this.capture("$pageview",{title:Le.title},{send_instantly:!0}),e||(new aL(this).call(),this.featureFlags.resetRequestQueue())}},{key:"_start_queue_if_opted_in",value:function(){var e;this.has_opted_out_capturing()||this.config.request_batching&&((e=this._requestQueue)===null||e===void 0||e.poll())}},{key:"_dom_loaded",value:function(){var e=this;this.has_opted_out_capturing()||Mr(this.__request_queue,function(t){e._send_request.apply(e,vl(t))}),this.__request_queue=[],this._start_queue_if_opted_in()}},{key:"_prepare_callback",value:function(e,t){if(et(e))return null;if(qa)return function(o){e(o,t)};var n=this._jsc,i=""+Math.floor(1e8*Math.random()),r=this.config.callback_fn+"["+i+"]";return n[i]=function(o){delete n[i],e(o,t)},r}},{key:"_handle_unload",value:function(){var e,t;this.config.request_batching?(this.config.capture_pageview&&this.config.capture_pageleave&&this.capture("$pageleave"),(e=this._requestQueue)===null||e===void 0||e.unload(),(t=this._retryQueue)===null||t===void 0||t.unload()):this.config.capture_pageview&&this.config.capture_pageleave&&this.capture("$pageleave",null,{transport:"sendBeacon"})}},{key:"_handle_queued_event",value:function(e,t,n){var i=JSON.stringify(t);this.__compress_and_send_json_request(e,i,n||ya,id)}},{key:"__compress_and_send_json_request",value:function(e,t,n,i){var r=function(c,u,d){return c===Vi.GZipJS?[SL(EL(u),{mtime:0}),Oe(Oe({},d),{},{blob:!0,urlQueryArgs:{compression:Vi.GZipJS}})]:[{data:pf(u)},d]}(this.compression[Vi.GZipJS]?Vi.GZipJS:Vi.Base64,t,n),o=tn(r,2),a=o[0],l=o[1];this._send_request(e,a,l,i)}},{key:"_send_request",value:function(e,t,n,i){if(this.__loaded&&this._retryQueue&&!this.rateLimiter.isRateLimited(n._batchKey))if($m)this.__request_queue.push([e,t,n,i]);else{var r={method:this.config.api_method,transport:this.config.api_transport,verbose:this.config.verbose};n=ss(r,n||{}),qa||(n.method="GET");var o=q&&"sendBeacon"in q.navigator&&n.transport==="sendBeacon";if(e=xf(e,n.urlQueryArgs||{},{ip:this.config.ip}),o)try{q==null||q.navigator.sendBeacon(e,cc(t,Oe(Oe({},n),{},{sendBeacon:!0})))}catch{}else if(qa||!Le)try{Mm({url:e,data:t,headers:this.config.request_headers,options:n,callback:i,retriesPerformedSoFar:0,retryQueue:this._retryQueue,onError:this.config.on_request_error,onResponse:this.rateLimiter.checkForLimiting})}catch(u){he.error(u)}else{var a,l=Le.createElement("script");l.type="text/javascript",l.async=!0,l.defer=!0,l.src=e;var c=Le.getElementsByTagName("script")[0];(a=c.parentNode)===null||a===void 0||a.insertBefore(l,c)}}}},{key:"_execute_array",value:function(e){var t,n=this,i=[],r=[],o=[];Mr(e,function(l){l&&(t=l[0],Ht(t)?o.push(l):Gs(l)?l.call(n):Ht(l)&&t==="alias"?i.push(l):Ht(l)&&t.indexOf("capture")!==-1&&Gs(n[t])?o.push(l):r.push(l))});var a=function(l,c){Mr(l,function(u){if(Ht(u[0])){var d=c;vt(u,function(f){d=d[f[0]].apply(d,f.slice(1))})}else this[u[0]].apply(this,u.slice(1))},c)};a(i,this),a(r,this),a(o,this)}},{key:"_hasBootstrappedFeatureFlags",value:function(){var e,t;return((e=this.config.bootstrap)===null||e===void 0?void 0:e.featureFlags)&&Object.keys((t=this.config.bootstrap)===null||t===void 0?void 0:t.featureFlags).length>0||!1}},{key:"push",value:function(e){this._execute_array([e])}},{key:"capture",value:function(e,t){var n,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ya;if(!this.__loaded||!this.sessionPersistence||!this._requestQueue)return he.uninitializedWarning("posthog.capture");if(!ed(this)){var r=(i=i||ya).transport;if(r&&(i.transport=r),!et(e)&&ks(e)){if(!Ot||this.config.opt_out_useragent_filter||!j0(Ot,this.config.custom_blocked_useragents)){this.sessionPersistence.update_search_keyword(),this.config.store_google&&this.sessionPersistence.update_campaign_params(),this.config.save_referrer&&this.sessionPersistence.update_referrer_info();var o={uuid:Hi(),event:e,properties:this._calculate_event_properties(e,t||{})};e==="$identify"&&(o.$set=i.$set,o.$set_once=i.$set_once),(o=kk(o,i._noTruncate?null:this.config.properties_string_max_length)).timestamp=i.timestamp||new Date;var a=Oe(Oe({},o.properties.$set),o.$set);(function(d){if(vi(d)){for(var f in d)if(gm.call(d,f))return!1;return!0}return!1})(a)||this.setPersonPropertiesForFlags(a),he.info("send",o);var l=JSON.stringify(o),c=(n=i._url)!==null&&n!==void 0?n:this.requestRouter.endpointFor("capture_events",this.analyticsDefaultEndpoint),u=i!==ya;return!this.config.request_batching||u&&!i._batchKey||i.send_instantly?this.__compress_and_send_json_request(c,l,i):this._requestQueue.enqueue(c,o,i),this._invokeCaptureHooks(e,o),o}}else he.error("No event name provided to posthog.capture")}}},{key:"_addCaptureHook",value:function(e){this.__captureHooks.push(e)}},{key:"_invokeCaptureHooks",value:function(e,t){this.config._onCapture(e,t),vt(this.__captureHooks,function(n){return n(e)})}},{key:"_calculate_event_properties",value:function(e,t){if(!this.persistence||!this.sessionPersistence)return t;var n=this.persistence.remove_event_timer(e),i=Oe({},t);if(i.token=this.config.token,e==="$snapshot"){var r=Oe(Oe({},this.persistence.properties()),this.sessionPersistence.properties());return i.distinct_id=r.distinct_id,i}var o=Ut.properties();if(this.sessionManager){var a=this.sessionManager.checkAndGetSessionAndWindowId(),l=a.sessionId,c=a.windowId;i.$session_id=l,i.$window_id=c}if(this.sessionPropsManager&&this.config.__preview_send_client_session_params&&(e==="$pageview"||e==="$pageleave"||e==="$autocapture")){var u=this.sessionPropsManager.getSessionProps();i=ss(i,u)}if(!this.config.disable_scroll_properties){var d={};e==="$pageview"?d=this.pageViewManager.doPageView():e==="$pageleave"&&(d=this.pageViewManager.doPageLeave()),i=ss(i,d)}if(e==="$pageview"&&Le&&(i.title=Le.title),e==="$performance_event"){var f=this.persistence.properties();return i.distinct_id=f.distinct_id,i.$current_url=o.$current_url,i}if(!et(n)){var h=new Date().getTime()-n;i.$duration=parseFloat((h/1e3).toFixed(3))}Ot&&this.config.opt_out_useragent_filter&&(i.$browser_type=j0(Ot,this.config.custom_blocked_useragents)?"bot":"browser"),i=ss({},Ut.properties(),this.persistence.properties(),this.sessionPersistence.properties(),i);var p=this.config.property_blacklist;Ht(p)?vt(p,function(m){delete i[m]}):he.error("Invalid value for property_blacklist config: "+p);var g=this.config.sanitize_properties;return g&&(i=g(i,e)),i}},{key:"register",value:function(e,t){var n;(n=this.persistence)===null||n===void 0||n.register(e,t)}},{key:"register_once",value:function(e,t,n){var i;(i=this.persistence)===null||i===void 0||i.register_once(e,t,n)}},{key:"register_for_session",value:function(e){var t;(t=this.sessionPersistence)===null||t===void 0||t.register(e)}},{key:"unregister",value:function(e){var t;(t=this.persistence)===null||t===void 0||t.unregister(e)}},{key:"unregister_for_session",value:function(e){var t;(t=this.sessionPersistence)===null||t===void 0||t.unregister(e)}},{key:"_register_single",value:function(e,t){this.register(Ce({},e,t))}},{key:"getFeatureFlag",value:function(e,t){return this.featureFlags.getFeatureFlag(e,t)}},{key:"getFeatureFlagPayload",value:function(e){var t=this.featureFlags.getFeatureFlagPayload(e);try{return JSON.parse(t)}catch{return t}}},{key:"isFeatureEnabled",value:function(e,t){return this.featureFlags.isFeatureEnabled(e,t)}},{key:"reloadFeatureFlags",value:function(){this.featureFlags.reloadFeatureFlags()}},{key:"updateEarlyAccessFeatureEnrollment",value:function(e,t){this.featureFlags.updateEarlyAccessFeatureEnrollment(e,t)}},{key:"getEarlyAccessFeatures",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return this.featureFlags.getEarlyAccessFeatures(e,t)}},{key:"onFeatureFlags",value:function(e){return this.featureFlags.onFeatureFlags(e)}},{key:"onSessionId",value:function(e){var t,n;return(t=(n=this.sessionManager)===null||n===void 0?void 0:n.onSessionId(e))!==null&&t!==void 0?t:function(){}}},{key:"getSurveys",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this.surveys.getSurveys(e,t)}},{key:"getActiveMatchingSurveys",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this.surveys.getActiveMatchingSurveys(e,t)}},{key:"identify",value:function(e,t,n){if(!this.__loaded||!this.persistence)return he.uninitializedWarning("posthog.identify");if(rn(e)&&(e=e.toString(),he.warn("The first argument to posthog.identify was a number, but it should be a string. It has been converted to a string.")),e)if(["distinct_id","distinctid"].includes(e.toLowerCase()))he.critical('The string "'.concat(e,'" was set in posthog.identify which indicates an error. This ID should be unique to the user and not a hardcoded string.'));else{var i=this.get_distinct_id();if(this.register({$user_id:e}),!this.get_property("$device_id")){var r=i;this.register_once({$had_persisted_distinct_id:!0,$device_id:r},"")}e!==i&&e!==this.get_property(za)&&(this.unregister(za),this.register({distinct_id:e}));var o=this.persistence.get_user_state()==="anonymous";e!==i&&o?(this.persistence.set_user_state("identified"),this.setPersonPropertiesForFlags(t||{},!1),this.capture("$identify",{distinct_id:e,$anon_distinct_id:i},{$set:t||{},$set_once:n||{}}),this.featureFlags.setAnonymousDistinctId(i)):(t||n)&&this.setPersonProperties(t,n),e!==i&&(this.reloadFeatureFlags(),this.unregister(wl))}else he.error("Unique user id has not been set in posthog.identify")}},{key:"setPersonProperties",value:function(e,t){(e||t)&&(this.setPersonPropertiesForFlags(e||{}),this.capture("$set",{$set:e||{},$set_once:t||{}}))}},{key:"group",value:function(e,t,n){if(e&&t){var i=this.getGroups();i[e]!==t&&this.resetGroupPropertiesForFlags(e),this.register({$groups:Oe(Oe({},i),{},Ce({},e,t))}),n&&(this.capture("$groupidentify",{$group_type:e,$group_key:t,$group_set:n}),this.setGroupPropertiesForFlags(Ce({},e,n))),i[e]===t||n||this.reloadFeatureFlags()}else he.error("posthog.group requires a group type and group key")}},{key:"resetGroups",value:function(){this.register({$groups:{}}),this.resetGroupPropertiesForFlags(),this.reloadFeatureFlags()}},{key:"setPersonPropertiesForFlags",value:function(e){var t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this.featureFlags.setPersonPropertiesForFlags(e,t)}},{key:"resetPersonPropertiesForFlags",value:function(){this.featureFlags.resetPersonPropertiesForFlags()}},{key:"setGroupPropertiesForFlags",value:function(e){var t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this.featureFlags.setGroupPropertiesForFlags(e,t)}},{key:"resetGroupPropertiesForFlags",value:function(e){this.featureFlags.resetGroupPropertiesForFlags(e)}},{key:"reset",value:function(e){var t,n,i,r;if(!this.__loaded)return he.uninitializedWarning("posthog.reset");var o=this.get_property("$device_id");(t=this.persistence)===null||t===void 0||t.clear(),(n=this.sessionPersistence)===null||n===void 0||n.clear(),(i=this.persistence)===null||i===void 0||i.set_user_state("anonymous"),(r=this.sessionManager)===null||r===void 0||r.resetSessionId();var a=this.config.get_device_id(Hi());this.register_once({distinct_id:a,$device_id:e?a:o},"")}},{key:"get_distinct_id",value:function(){return this.get_property("distinct_id")}},{key:"getGroups",value:function(){return this.get_property("$groups")||{}}},{key:"get_session_id",value:function(){var e,t;return(e=(t=this.sessionManager)===null||t===void 0?void 0:t.checkAndGetSessionAndWindowId(!0).sessionId)!==null&&e!==void 0?e:""}},{key:"get_session_replay_url",value:function(e){if(!this.sessionManager)return"";var t=this.sessionManager.checkAndGetSessionAndWindowId(!0),n=t.sessionId,i=t.sessionStartTimestamp,r=this.requestRouter.endpointFor("ui","/replay/"+n);if(e!=null&&e.withTimestamp&&i){var o,a=(o=e.timestampLookBack)!==null&&o!==void 0?o:10;if(!i)return r;var l=Math.max(Math.floor((new Date().getTime()-i)/1e3)-a,0);r+="?t=".concat(l)}return r}},{key:"alias",value:function(e,t){return e===this.get_property(Em)?(he.critical("Attempting to create alias for existing People user - aborting."),-2):(et(t)&&(t=this.get_distinct_id()),e!==t?(this._register_single(za,e),this.capture("$create_alias",{alias:e,distinct_id:t})):(he.warn("alias matches current distinct_id - skipping api call."),this.identify(e),-1))}},{key:"set_config",value:function(e){var t,n,i=Oe({},this.config);if(vi(e)&&(ss(this.config,e),this.config.persistence_name||(this.config.persistence_name=this.config.cookie_name),this.config.disable_persistence||(this.config.disable_persistence=this.config.disable_cookie),(t=this.persistence)===null||t===void 0||t.update_config(this.config),(n=this.sessionPersistence)===null||n===void 0||n.update_config(this.config),$t.is_supported()&&$t.get("ph_debug")==="true"&&(this.config.debug=!0),this.config.debug&&(Qi.DEBUG=!0),this.sessionRecording&&!et(e.disable_session_recording))){var r=i.disable_session_recording!==e.disable_session_recording,o=!ed(this)&&!e.disable_session_recording&&!this.sessionRecording.started;(r||o)&&(e.disable_session_recording?this.sessionRecording.stopRecording():this.sessionRecording.startRecordingIfEnabled())}}},{key:"startSessionRecording",value:function(){this.set_config({disable_session_recording:!1})}},{key:"stopSessionRecording",value:function(){this.set_config({disable_session_recording:!0})}},{key:"sessionRecordingStarted",value:function(){var e;return!((e=this.sessionRecording)===null||e===void 0||!e.started)}},{key:"loadToolbar",value:function(e){return this.toolbar.loadToolbar(e)}},{key:"get_property",value:function(e){var t;return(t=this.persistence)===null||t===void 0?void 0:t.props[e]}},{key:"getSessionProperty",value:function(e){var t;return(t=this.sessionPersistence)===null||t===void 0?void 0:t.props[e]}},{key:"toString",value:function(){var e,t=(e=this.config.name)!==null&&e!==void 0?e:ys;return t!==ys&&(t=ys+"."+t),t}},{key:"_gdpr_init",value:function(){this.config.opt_out_capturing_persistence_type==="localStorage"&&$t.is_supported()&&(!this.has_opted_in_capturing()&&this.has_opted_in_capturing({persistence_type:"cookie"})&&this.opt_in_capturing({enable_persistence:!1}),!this.has_opted_out_capturing()&&this.has_opted_out_capturing({persistence_type:"cookie"})&&this.opt_out_capturing({clear_persistence:!1}),this.clear_opt_in_out_capturing({persistence_type:"cookie",enable_persistence:!1})),this.has_opted_out_capturing()?this._gdpr_update_persistence({clear_persistence:!0}):this.has_opted_in_capturing()||!this.config.opt_out_capturing_by_default&&!xn.get("ph_optout")||(xn.remove("ph_optout"),this.opt_out_capturing({clear_persistence:this.config.opt_out_persistence_by_default}))}},{key:"_gdpr_update_persistence",value:function(e){var t,n,i,r,o;if(e&&e.clear_persistence)i=!0;else{if(!e||!e.enable_persistence)return;i=!1}this.config.disable_persistence||((t=this.persistence)===null||t===void 0?void 0:t.disabled)===i||(r=this.persistence)===null||r===void 0||r.set_disabled(i),this.config.disable_persistence||((n=this.sessionPersistence)===null||n===void 0?void 0:n.disabled)===i||(o=this.sessionPersistence)===null||o===void 0||o.set_disabled(i)}},{key:"_gdpr_call_func",value:function(e,t){return t=ss({capture:this.capture.bind(this),persistence_type:this.config.opt_out_capturing_persistence_type,cookie_prefix:this.config.opt_out_capturing_cookie_prefix,cookie_expiration:this.config.cookie_expiration,cross_subdomain_cookie:this.config.cross_subdomain_cookie,secure_cookie:this.config.secure_cookie},t||{}),$t.is_supported()||t.persistence_type!=="localStorage"||(t.persistence_type="cookie"),e(this.config.token,{capture:t.capture,captureEventName:t.capture_event_name,captureProperties:t.capture_properties,persistenceType:t.persistence_type,persistencePrefix:t.cookie_prefix,cookieExpiration:t.cookie_expiration,crossSubdomainCookie:t.cross_subdomain_cookie,secureCookie:t.secure_cookie})}},{key:"opt_in_capturing",value:function(e){e=ss({enable_persistence:!0},e||{}),this._gdpr_call_func(tL,e),this._gdpr_update_persistence(e)}},{key:"opt_out_capturing",value:function(e){var t=ss({clear_persistence:!0},e||{});this._gdpr_call_func(sL,t),this._gdpr_update_persistence(t)}},{key:"has_opted_in_capturing",value:function(e){return this._gdpr_call_func(nL,e)}},{key:"has_opted_out_capturing",value:function(e){return this._gdpr_call_func(Am,e)}},{key:"clear_opt_in_out_capturing",value:function(e){var t=ss({enable_persistence:!0},e!=null?e:{});this._gdpr_call_func(iL,t),this._gdpr_update_persistence(t)}},{key:"debug",value:function(e){e===!1?(q==null||q.console.log("You've disabled debug mode."),localStorage&&localStorage.removeItem("ph_debug"),this.set_config({debug:!1})):(q==null||q.console.log("You're now in debug mode. All calls to PostHog will be logged in your console.\nYou can disable this with `posthog.debug(false)`."),localStorage&&localStorage.setItem("ph_debug","true"),this.set_config({debug:!0}))}}]),s}();(function(s,e){for(var t=0;t<e.length;t++)s.prototype[e[t]]=_m(s.prototype[e[t]])})(wf,["identify"]);var K0,W0,si={},NL=function(){ns.init=function(s,e,t){if(t)return ns[t]||(ns[t]=si[t]=rd(s||"",e||{},t,function(i){ns[t]=si[t]=i,i._loaded()})),ns[t];var n=ns;return si[ys]?n=si[ys]:s&&(n=rd(s,e||{},ys,function(i){si[ys]=i,i._loaded()}),si[ys]=n),ns=n,bf===Uo.INIT_SNIPPET&&(fs[ys]=ns),vt(si,function(i,r){r!==ys&&(ns[r]=i)}),n}};(function(s){s.Popover="popover",s.API="api",s.Widget="widget"})(K0||(K0={})),function(s){s.Open="open",s.MultipleChoice="multiple_choice",s.SingleChoice="single_choice",s.Rating="rating",s.Link="link"}(W0||(W0={}));var Qo=(bf=Uo.INIT_MODULE,ns=new wf,NL(),ns.init(),function(){function s(){s.done||(s.done=!0,$m=!1,vt(si,function(e){e._dom_loaded()}))}Le!=null&&Le.addEventListener&&(Le.readyState==="complete"?s():Le.addEventListener("DOMContentLoaded",s,!1)),q&&To(q,"load",s,!0)}(),ns);class VL{constructor(){ze(this,"toyName","Loob");ze(this,"_error");ze(this,"_loob");ze(this,"_device");ze(this,"_scanning",!1);ze(this,"settings",df("loob",{limits:[0,100]}))}async connect(){var e;if(this._scanning=!0,this._error=void 0,!window.navigator.bluetooth){this._error="Bluetooth is not supported in this browser",this._scanning=!1;return}try{this._device=await navigator.bluetooth.requestDevice({filters:[{namePrefix:"LOOB"}],optionalServices:["b75c49d2-04a3-4071-a0b5-35853eb08307"]}),this._device.addEventListener("gattserverdisconnected",()=>{this._loob=void 0,this._device=void 0});const t=await((e=this._device.gatt)==null?void 0:e.connect()),n=await(t==null?void 0:t.getPrimaryService("b75c49d2-04a3-4071-a0b5-35853eb08307"));this._loob=await(n==null?void 0:n.getCharacteristic("ba5c49d2-04a3-4071-a0b5-35853eb08307"))}catch(t){this._error=t}finally{this._scanning=!1}}async disconnect(){var e,t;!this._loob||!this._device||(t=(e=this._device)==null?void 0:e.gatt)==null||t.disconnect()}intToUint8Array(e){const t=new Uint8Array(4);return t[0]=(e&4278190080)>>24,t[1]=(e&16711680)>>16,t[2]=(e&65280)>>8,t[3]=e&255,t}async move(e,t){var l;if(!this._loob)return;const[n,i]=this.settings.limits;e=e/100*(i-n)+n,e=Math.round(e*10),e<1&&(e=1),e>1e3&&(e=1e3);const r=this.intToUint8Array(e),o=this.intToUint8Array(t),a=new Uint8Array([r[2],r[3],o[2],o[3]]);await((l=this._loob)==null?void 0:l.writeValueWithoutResponse(a))}get connected(){return this._loob!=null}get error(){return this._error}get scanning(){return this._scanning}}var Cs=(s=>(s.Handy="Handy",s.Bluetooth="Bluetooth",s.Intiface="Intiface",s.OSR="OSR",s.LOOB="LOOB",s))(Cs||{}),Jt=(s=>(s[s.Start=0]="Start",s[s.Handy=1]="Handy",s[s.Bluetooth=2]="Bluetooth",s[s.Osr=3]="Osr",s[s.Intiface=4]="Intiface",s[s.Loob=5]="Loob",s))(Jt||{});const or=lc("device",()=>{const s=ue(new bk),e=ue(new wk),t=ue(new Ek),n=ue(new Sk),i=ue(new VL),r=ue({open:!1,page:1}),o=ut(()=>{const l=[];return t.value.connected&&l.push(...t.value.devices.map(c=>({instance:c,name:c.Name,connector:"Bluetooth"}))),n.value.connected&&l.push(...n.value.devices.map(c=>({instance:c,name:c.Name,connector:"Intiface"}))),s.value.connected&&l.push({name:"The Handy",connector:"Handy"}),e.value.connected&&l.push({name:"OSR",connector:"OSR"}),i.value.connected&&l.push({name:"LOOB",connector:"LOOB"}),l});dt(()=>o.value,(l,c)=>{if(c.length>l.length||l.length===0)return;l.filter(d=>!c.includes(d)).forEach(d=>{Qo.capture("toy_connected",{device:d.name})})});const a=ut(()=>s.value.scanning||e.value.scanning||t.value.scanning||n.value.scanning);return{handy:s,bluetooth:t,intiface:n,osr:e,loob:i,devices:o,connecting:a,ui:r}}),vs=lc("user",()=>{const s=ue(),e=ue([]),t=ue([]),n=ue(0),i=ut(()=>s.value!==void 0),r=ut(()=>s.value&&s.value.creator),o=ut(()=>s.value&&s.value.admin);async function a(p){s.value=p,p&&(Qo.identify(p.id),e.value=await qe.user.getSubscriptions(),t.value=await qe.notifications.getNotifications(),n.value=await qe.notifications.getUnreadNotificationsCount())}async function l(p){!s.value||(s.value.avatar_url=await qe.user.updateAvatar(p))}async function c(p){!s.value||(await qe.user.updateBio(p),s.value.bio=p)}async function u(){await qe.notifications.markNotificationsAsRead(),n.value=0}async function d(p){s.value?await qe.user.updateOrientation(p):localStorage.setItem("o",p==null?"-1":p.toString()),window.location.reload()}function f(){var g;if(s.value)return(g=s.value)==null?void 0:g.orientation;const p=localStorage.getItem("o");if(!p)return localStorage.setItem("o","0"),f();switch(parseInt(p)){case pt.Straight:return pt.Straight;case pt.Gay:return pt.Gay;case pt.Transgender:return pt.Transgender;default:return}}function h(){switch(f()){case pt.Straight:return"orientation-straight";case pt.Transgender:return"orientation-transgender";case pt.Gay:return"orientation-gay";default:return"close"}}return{user:s,setUser:a,isAuthorized:i,subscriptions:e,setAvatar:l,setBio:c,isCreator:r,isAdmin:o,markNotificationsAsRead:u,notifications:t,unreadNotificationsCount:n,setOrientation:d,getOrientation:f,getOrientationIcon:h}}),Kr=Math.min,Wi=Math.max,Tl=Math.round,xa=Math.floor,bi=s=>({x:s,y:s});function od(s,e,t){return Wi(s,Kr(e,t))}function uc(s,e){return typeof s=="function"?s(e):s}function dc(s){return s.split("-")[0]}function Sf(s){return s.split("-")[1]}function Nm(s){return s==="x"?"y":"x"}function Vm(s){return s==="y"?"height":"width"}function fc(s){return["top","bottom"].includes(dc(s))?"y":"x"}function Bm(s){return Nm(fc(s))}function BL(s){return{top:0,right:0,bottom:0,left:0,...s}}function Um(s){return typeof s!="number"?BL(s):{top:s,right:s,bottom:s,left:s}}function Cl(s){return{...s,top:s.y,left:s.x,right:s.x+s.width,bottom:s.y+s.height}}function Y0(s,e,t){let{reference:n,floating:i}=s;const r=fc(e),o=Bm(e),a=Vm(o),l=dc(e),c=r==="y",u=n.x+n.width/2-i.width/2,d=n.y+n.height/2-i.height/2,f=n[a]/2-i[a]/2;let h;switch(l){case"top":h={x:u,y:n.y-i.height};break;case"bottom":h={x:u,y:n.y+n.height};break;case"right":h={x:n.x+n.width,y:d};break;case"left":h={x:n.x-i.width,y:d};break;default:h={x:n.x,y:n.y}}switch(Sf(e)){case"start":h[o]-=f*(t&&c?-1:1);break;case"end":h[o]+=f*(t&&c?-1:1);break}return h}const UL=async(s,e,t)=>{const{placement:n="bottom",strategy:i="absolute",middleware:r=[],platform:o}=t,a=r.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:s,floating:e,strategy:i}),{x:u,y:d}=Y0(c,n,l),f=n,h={},p=0;for(let g=0;g<a.length;g++){const{name:m,fn:_}=a[g],{x:y,y:S,data:C,reset:E}=await _({x:u,y:d,initialPlacement:n,placement:f,strategy:i,middlewareData:h,rects:c,platform:o,elements:{reference:s,floating:e}});u=y!=null?y:u,d=S!=null?S:d,h={...h,[m]:{...h[m],...C}},E&&p<=50&&(p++,typeof E=="object"&&(E.placement&&(f=E.placement),E.rects&&(c=E.rects===!0?await o.getElementRects({reference:s,floating:e,strategy:i}):E.rects),{x:u,y:d}=Y0(c,f,l)),g=-1)}return{x:u,y:d,placement:f,strategy:i,middlewareData:h}};async function HL(s,e){var t;e===void 0&&(e={});const{x:n,y:i,platform:r,rects:o,elements:a,strategy:l}=s,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:f=!1,padding:h=0}=uc(e,s),p=Um(h),m=a[f?d==="floating"?"reference":"floating":d],_=Cl(await r.getClippingRect({element:(t=await(r.isElement==null?void 0:r.isElement(m)))==null||t?m:m.contextElement||await(r.getDocumentElement==null?void 0:r.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),y=d==="floating"?{...o.floating,x:n,y:i}:o.reference,S=await(r.getOffsetParent==null?void 0:r.getOffsetParent(a.floating)),C=await(r.isElement==null?void 0:r.isElement(S))?await(r.getScale==null?void 0:r.getScale(S))||{x:1,y:1}:{x:1,y:1},E=Cl(r.convertOffsetParentRelativeRectToViewportRelativeRect?await r.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:y,offsetParent:S,strategy:l}):y);return{top:(_.top-E.top+p.top)/C.y,bottom:(E.bottom-_.bottom+p.bottom)/C.y,left:(_.left-E.left+p.left)/C.x,right:(E.right-_.right+p.right)/C.x}}const GL=s=>({name:"arrow",options:s,async fn(e){const{x:t,y:n,placement:i,rects:r,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=uc(s,e)||{};if(c==null)return{};const d=Um(u),f={x:t,y:n},h=Bm(i),p=Vm(h),g=await o.getDimensions(c),m=h==="y",_=m?"top":"left",y=m?"bottom":"right",S=m?"clientHeight":"clientWidth",C=r.reference[p]+r.reference[h]-f[h]-r.floating[p],E=f[h]-r.reference[h],A=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let R=A?A[S]:0;(!R||!await(o.isElement==null?void 0:o.isElement(A)))&&(R=a.floating[S]||r.floating[p]);const I=C/2-E/2,D=R/2-g[p]/2-1,L=Kr(d[_],D),M=Kr(d[y],D),$=L,H=R-g[p]-M,ie=R/2-g[p]/2+I,te=od($,ie,H),X=!l.arrow&&Sf(i)!=null&&ie!==te&&r.reference[p]/2-(ie<$?L:M)-g[p]/2<0,de=X?ie<$?ie-$:ie-H:0;return{[h]:f[h]+de,data:{[h]:te,centerOffset:ie-te-de,...X&&{alignmentOffset:de}},reset:X}}});async function zL(s,e){const{placement:t,platform:n,elements:i}=s,r=await(n.isRTL==null?void 0:n.isRTL(i.floating)),o=dc(t),a=Sf(t),l=fc(t)==="y",c=["left","top"].includes(o)?-1:1,u=r&&l?-1:1,d=uc(e,s);let{mainAxis:f,crossAxis:h,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return a&&typeof p=="number"&&(h=a==="end"?p*-1:p),l?{x:h*u,y:f*c}:{x:f*c,y:h*u}}const jL=function(s){return s===void 0&&(s=0),{name:"offset",options:s,async fn(e){var t,n;const{x:i,y:r,placement:o,middlewareData:a}=e,l=await zL(e,s);return o===((t=a.offset)==null?void 0:t.placement)&&(n=a.arrow)!=null&&n.alignmentOffset?{}:{x:i+l.x,y:r+l.y,data:{...l,placement:o}}}}},qL=function(s){return s===void 0&&(s={}),{name:"shift",options:s,async fn(e){const{x:t,y:n,placement:i}=e,{mainAxis:r=!0,crossAxis:o=!1,limiter:a={fn:m=>{let{x:_,y}=m;return{x:_,y}}},...l}=uc(s,e),c={x:t,y:n},u=await HL(e,l),d=fc(dc(i)),f=Nm(d);let h=c[f],p=c[d];if(r){const m=f==="y"?"top":"left",_=f==="y"?"bottom":"right",y=h+u[m],S=h-u[_];h=od(y,h,S)}if(o){const m=d==="y"?"top":"left",_=d==="y"?"bottom":"right",y=p+u[m],S=p-u[_];p=od(y,p,S)}const g=a.fn({...e,[f]:h,[d]:p});return{...g,data:{x:g.x-t,y:g.y-n}}}}};function wi(s){return Hm(s)?(s.nodeName||"").toLowerCase():"#document"}function Rs(s){var e;return(s==null||(e=s.ownerDocument)==null?void 0:e.defaultView)||window}function qn(s){var e;return(e=(Hm(s)?s.ownerDocument:s.document)||window.document)==null?void 0:e.documentElement}function Hm(s){return s instanceof Node||s instanceof Rs(s).Node}function Gn(s){return s instanceof Element||s instanceof Rs(s).Element}function Cn(s){return s instanceof HTMLElement||s instanceof Rs(s).HTMLElement}function Z0(s){return typeof ShadowRoot>"u"?!1:s instanceof ShadowRoot||s instanceof Rs(s).ShadowRoot}function Jo(s){const{overflow:e,overflowX:t,overflowY:n,display:i}=qs(s);return/auto|scroll|overlay|hidden|clip/.test(e+n+t)&&!["inline","contents"].includes(i)}function KL(s){return["table","td","th"].includes(wi(s))}function Ef(s){const e=Tf(),t=qs(s);return t.transform!=="none"||t.perspective!=="none"||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||["transform","perspective","filter"].some(n=>(t.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(t.contain||"").includes(n))}function WL(s){let e=Wr(s);for(;Cn(e)&&!hc(e);){if(Ef(e))return e;e=Wr(e)}return null}function Tf(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function hc(s){return["html","body","#document"].includes(wi(s))}function qs(s){return Rs(s).getComputedStyle(s)}function pc(s){return Gn(s)?{scrollLeft:s.scrollLeft,scrollTop:s.scrollTop}:{scrollLeft:s.pageXOffset,scrollTop:s.pageYOffset}}function Wr(s){if(wi(s)==="html")return s;const e=s.assignedSlot||s.parentNode||Z0(s)&&s.host||qn(s);return Z0(e)?e.host:e}function Gm(s){const e=Wr(s);return hc(e)?s.ownerDocument?s.ownerDocument.body:s.body:Cn(e)&&Jo(e)?e:Gm(e)}function Ho(s,e,t){var n;e===void 0&&(e=[]),t===void 0&&(t=!0);const i=Gm(s),r=i===((n=s.ownerDocument)==null?void 0:n.body),o=Rs(i);return r?e.concat(o,o.visualViewport||[],Jo(i)?i:[],o.frameElement&&t?Ho(o.frameElement):[]):e.concat(i,Ho(i,[],t))}function zm(s){const e=qs(s);let t=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const i=Cn(s),r=i?s.offsetWidth:t,o=i?s.offsetHeight:n,a=Tl(t)!==r||Tl(n)!==o;return a&&(t=r,n=o),{width:t,height:n,$:a}}function Cf(s){return Gn(s)?s:s.contextElement}function $r(s){const e=Cf(s);if(!Cn(e))return bi(1);const t=e.getBoundingClientRect(),{width:n,height:i,$:r}=zm(e);let o=(r?Tl(t.width):t.width)/n,a=(r?Tl(t.height):t.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const YL=bi(0);function jm(s){const e=Rs(s);return!Tf()||!e.visualViewport?YL:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function ZL(s,e,t){return e===void 0&&(e=!1),!t||e&&t!==Rs(s)?!1:e}function er(s,e,t,n){e===void 0&&(e=!1),t===void 0&&(t=!1);const i=s.getBoundingClientRect(),r=Cf(s);let o=bi(1);e&&(n?Gn(n)&&(o=$r(n)):o=$r(s));const a=ZL(r,t,n)?jm(r):bi(0);let l=(i.left+a.x)/o.x,c=(i.top+a.y)/o.y,u=i.width/o.x,d=i.height/o.y;if(r){const f=Rs(r),h=n&&Gn(n)?Rs(n):n;let p=f.frameElement;for(;p&&n&&h!==f;){const g=$r(p),m=p.getBoundingClientRect(),_=qs(p),y=m.left+(p.clientLeft+parseFloat(_.paddingLeft))*g.x,S=m.top+(p.clientTop+parseFloat(_.paddingTop))*g.y;l*=g.x,c*=g.y,u*=g.x,d*=g.y,l+=y,c+=S,p=Rs(p).frameElement}}return Cl({width:u,height:d,x:l,y:c})}const XL=[":popover-open",":modal"];function qm(s){return XL.some(e=>{try{return s.matches(e)}catch{return!1}})}function QL(s){let{elements:e,rect:t,offsetParent:n,strategy:i}=s;const r=i==="fixed",o=qn(n),a=e?qm(e.floating):!1;if(n===o||a&&r)return t;let l={scrollLeft:0,scrollTop:0},c=bi(1);const u=bi(0),d=Cn(n);if((d||!d&&!r)&&((wi(n)!=="body"||Jo(o))&&(l=pc(n)),Cn(n))){const f=er(n);c=$r(n),u.x=f.x+n.clientLeft,u.y=f.y+n.clientTop}return{width:t.width*c.x,height:t.height*c.y,x:t.x*c.x-l.scrollLeft*c.x+u.x,y:t.y*c.y-l.scrollTop*c.y+u.y}}function JL(s){return Array.from(s.getClientRects())}function Km(s){return er(qn(s)).left+pc(s).scrollLeft}function e3(s){const e=qn(s),t=pc(s),n=s.ownerDocument.body,i=Wi(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),r=Wi(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let o=-t.scrollLeft+Km(s);const a=-t.scrollTop;return qs(n).direction==="rtl"&&(o+=Wi(e.clientWidth,n.clientWidth)-i),{width:i,height:r,x:o,y:a}}function t3(s,e){const t=Rs(s),n=qn(s),i=t.visualViewport;let r=n.clientWidth,o=n.clientHeight,a=0,l=0;if(i){r=i.width,o=i.height;const c=Tf();(!c||c&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:r,height:o,x:a,y:l}}function s3(s,e){const t=er(s,!0,e==="fixed"),n=t.top+s.clientTop,i=t.left+s.clientLeft,r=Cn(s)?$r(s):bi(1),o=s.clientWidth*r.x,a=s.clientHeight*r.y,l=i*r.x,c=n*r.y;return{width:o,height:a,x:l,y:c}}function X0(s,e,t){let n;if(e==="viewport")n=t3(s,t);else if(e==="document")n=e3(qn(s));else if(Gn(e))n=s3(e,t);else{const i=jm(s);n={...e,x:e.x-i.x,y:e.y-i.y}}return Cl(n)}function Wm(s,e){const t=Wr(s);return t===e||!Gn(t)||hc(t)?!1:qs(t).position==="fixed"||Wm(t,e)}function n3(s,e){const t=e.get(s);if(t)return t;let n=Ho(s,[],!1).filter(a=>Gn(a)&&wi(a)!=="body"),i=null;const r=qs(s).position==="fixed";let o=r?Wr(s):s;for(;Gn(o)&&!hc(o);){const a=qs(o),l=Ef(o);!l&&a.position==="fixed"&&(i=null),(r?!l&&!i:!l&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||Jo(o)&&!l&&Wm(s,o))?n=n.filter(u=>u!==o):i=a,o=Wr(o)}return e.set(s,n),n}function i3(s){let{element:e,boundary:t,rootBoundary:n,strategy:i}=s;const o=[...t==="clippingAncestors"?n3(e,this._c):[].concat(t),n],a=o[0],l=o.reduce((c,u)=>{const d=X0(e,u,i);return c.top=Wi(d.top,c.top),c.right=Kr(d.right,c.right),c.bottom=Kr(d.bottom,c.bottom),c.left=Wi(d.left,c.left),c},X0(e,a,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function r3(s){const{width:e,height:t}=zm(s);return{width:e,height:t}}function o3(s,e,t){const n=Cn(e),i=qn(e),r=t==="fixed",o=er(s,!0,r,e);let a={scrollLeft:0,scrollTop:0};const l=bi(0);if(n||!n&&!r)if((wi(e)!=="body"||Jo(i))&&(a=pc(e)),n){const d=er(e,!0,r,e);l.x=d.x+e.clientLeft,l.y=d.y+e.clientTop}else i&&(l.x=Km(i));const c=o.left+a.scrollLeft-l.x,u=o.top+a.scrollTop-l.y;return{x:c,y:u,width:o.width,height:o.height}}function Q0(s,e){return!Cn(s)||qs(s).position==="fixed"?null:e?e(s):s.offsetParent}function Ym(s,e){const t=Rs(s);if(!Cn(s)||qm(s))return t;let n=Q0(s,e);for(;n&&KL(n)&&qs(n).position==="static";)n=Q0(n,e);return n&&(wi(n)==="html"||wi(n)==="body"&&qs(n).position==="static"&&!Ef(n))?t:n||WL(s)||t}const a3=async function(s){const e=this.getOffsetParent||Ym,t=this.getDimensions;return{reference:o3(s.reference,await e(s.floating),s.strategy),floating:{x:0,y:0,...await t(s.floating)}}};function l3(s){return qs(s).direction==="rtl"}const c3={convertOffsetParentRelativeRectToViewportRelativeRect:QL,getDocumentElement:qn,getClippingRect:i3,getOffsetParent:Ym,getElementRects:a3,getClientRects:JL,getDimensions:r3,getScale:$r,isElement:Gn,isRTL:l3};function u3(s,e){let t=null,n;const i=qn(s);function r(){var a;clearTimeout(n),(a=t)==null||a.disconnect(),t=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),r();const{left:c,top:u,width:d,height:f}=s.getBoundingClientRect();if(a||e(),!d||!f)return;const h=xa(u),p=xa(i.clientWidth-(c+d)),g=xa(i.clientHeight-(u+f)),m=xa(c),y={rootMargin:-h+"px "+-p+"px "+-g+"px "+-m+"px",threshold:Wi(0,Kr(1,l))||1};let S=!0;function C(E){const A=E[0].intersectionRatio;if(A!==l){if(!S)return o();A?o(!1,A):n=setTimeout(()=>{o(!1,1e-7)},100)}S=!1}try{t=new IntersectionObserver(C,{...y,root:i.ownerDocument})}catch{t=new IntersectionObserver(C,y)}t.observe(s)}return o(!0),r}function d3(s,e,t,n){n===void 0&&(n={});const{ancestorScroll:i=!0,ancestorResize:r=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=n,c=Cf(s),u=i||r?[...c?Ho(c):[],...Ho(e)]:[];u.forEach(_=>{i&&_.addEventListener("scroll",t,{passive:!0}),r&&_.addEventListener("resize",t)});const d=c&&a?u3(c,t):null;let f=-1,h=null;o&&(h=new ResizeObserver(_=>{let[y]=_;y&&y.target===c&&h&&(h.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var S;(S=h)==null||S.observe(e)})),t()}),c&&!l&&h.observe(c),h.observe(e));let p,g=l?er(s):null;l&&m();function m(){const _=er(s);g&&(_.x!==g.x||_.y!==g.y||_.width!==g.width||_.height!==g.height)&&t(),g=_,p=requestAnimationFrame(m)}return t(),()=>{var _;u.forEach(y=>{i&&y.removeEventListener("scroll",t),r&&y.removeEventListener("resize",t)}),d==null||d(),(_=h)==null||_.disconnect(),h=null,l&&cancelAnimationFrame(p)}}const f3=qL,h3=GL,p3=(s,e,t)=>{const n=new Map,i={platform:c3,...t},r={...i.platform,_c:n};return UL(s,e,{...i,platform:r})},on=De({__name:"Popup",props:{modelValue:{type:Boolean},target:{},placement:{default:"bottom"},offset:{default:0},teleport:{type:Boolean,default:!0},class:{}},emits:["update:modelValue"],setup(s,{emit:e}){const t=s,n=e,i=ue(),r=ue();let o;const a=()=>{const d=[jL(t.offset),f3(),h3({element:r.value,padding:6})];o=d3(t.target,i.value,()=>{p3(t.target,i.value,{strategy:"fixed",placement:t.placement,middleware:d}).then(({x:f,y:h,placement:p,middlewareData:g})=>{Object.assign(i.value.style,{left:`${f}px`,top:`${h}px`});const{x:m,y:_}=g.arrow,y={top:"bottom",right:"left",bottom:"top",left:"right"}[p.split("-")[0]];Object.assign(r.value.style,{left:m?`${m}px`:"",top:_?`${_}px`:"",right:"",bottom:"",[y]:"-4px"})})})};Xt(()=>{window.addEventListener("mousedown",c),window.addEventListener("mouseup",u)}),Ci(()=>{window.removeEventListener("mousedown",c),window.removeEventListener("mouseup",u)}),dt(()=>t.modelValue,d=>{if(!d)return o();requestAnimationFrame(()=>a())});let l=!1;const c=d=>{if(!t.modelValue||!t.target||!i.value){l=!1;return}l=d.target===i.value||i.value.contains(d.target)},u=d=>{if(!t.modelValue||!t.target||!i.value||l)return;const f=d.target===i.value||i.value.contains(d.target),h=d.target===t.target||t.target.contains(d.target);f||h||n("update:modelValue",!1)};return(d,f)=>(x(),ae(Jd,{to:"body",disabled:!d.teleport},[t.modelValue?(x(),T("div",{key:0,ref_key:"floatingElement",ref:i,class:"rounded-md fixed bg-zinc-700 z-50"},[v("div",{ref_key:"arrowElement",ref:r,class:"absolute bg-zinc-700 w-3 h-3 rotate-45 -z-10"},null,512),v("div",{class:Je([t.class,"overflow-hidden max-h-screen overflow-y-auto rounded"])},[nr(d.$slots,"default")],2)],512)):pe("",!0)],8,["disabled"]))}}),g3={class:"flex items-center justify-center py-1.5 gap-1 text-zinc-300 text-lg md:text-base"},m3={class:"font-medium"},Gc=De({__name:"SettingsPopupHeader",props:{title:{},icon:{}},setup(s){const e=s;return(t,n)=>(x(),T("div",g3,[P(Re,{name:e.icon,class:"h-5 w-5"},null,8,["name"]),v("p",m3,Z(e.title),1)]))}}),v3={class:"flex-1"},Xe=De({__name:"SettingsPopupListItem",props:{icon:{},arrow:{type:Boolean},active:{type:Boolean}},setup(s){const e=s;return(t,n)=>(x(),T("div",{class:Je(["flex py-1.5 md:py-1.5 px-3 items-center gap-3 hover:bg-blue-500 cursor-pointer text-lg md:text-base",{"bg-blue-500":e.active}])},[e.icon?(x(),ae(Re,{key:0,name:e.icon,class:"h-6 md:h-5 md:w-5"},null,8,["name"])):pe("",!0),v("div",v3,[nr(t.$slots,"default")]),e.arrow?(x(),ae(Re,{key:1,name:"chevron-right",class:"h-5 w-5"})):pe("",!0)],2))}}),_3=(s,e)=>{const t=s.__vccOpts||s;for(const[n,i]of e)t[n]=i;return t},y3={},x3={class:"border-zinc-500 my-1"};function b3(s,e){return x(),T("hr",x3)}const zc=_3(y3,[["render",b3]]),w3={key:0,class:"fixed flex inset-0 w-full z-50 pt-6"},S3=v("div",{class:"flex justify-center py-2.5"},[v("div",{class:"h-2 bg-zinc-700 w-16 h-1.5 rounded-full"})],-1),$n=De({__name:"BottomSheet",props:{modelValue:{type:Boolean},teleport:{type:Boolean,default:!0}},emits:["update:modelValue"],setup(s,{emit:e}){const t=s,n=e,i=ue(),r=ue(),o=ue(),a=Ps({transform:{value:100,start:{value:100,ms:0}},dragging:!1,contentScrolled:!1}),l=()=>{!i.value||!r.value||!o.value||(a.transform.value=0,i.value.addEventListener("touchmove",c),i.value.addEventListener("touchstart",d),i.value.addEventListener("touchend",f),o.value.addEventListener("scroll",h=>a.contentScrolled=!0))},c=h=>{if(!a.dragging||!i.value)return;const p=h.touches[0].clientY-u.clientY,g=h.target;if((g===o.value||o.value.contains(g))&&a.transform.value===0&&!(o.value.scrollTop===0&&p>0&&!a.contentScrolled))return;h.preventDefault();const m=i.value.offsetHeight,_=p/m*100;let y=a.transform.value+_;y>100&&(y=100),y<0&&(y=0),a.transform.value=y,u=h.touches[0]};let u;const d=h=>{a.dragging=!0,a.contentScrolled=!1,a.transform.start.value=a.transform.value,a.transform.start.ms=new Date().getTime(),u=h.touches[0]},f=h=>{a.dragging=!1;const p=a.transform.start,g={value:a.transform.value,ms:new Date().getTime()};if(g.value>p.value&&g.value-p.value>15&&g.ms-p.ms<200){a.transform.value=100;return}if(g.value>=80){a.transform.value=100;return}if(g.value<p.value&&p.value-g.value>5){a.transform.value=0;return}const m=[100,0].reduce((_,y)=>Math.abs(y-g.value)<Math.abs(_-g.value)?y:_);a.transform.value=m};return dt(()=>a.transform.value,h=>{h===100&&setTimeout(()=>n("update:modelValue",!1),150)}),dt(()=>t.modelValue,h=>{const p="overflow-hidden",g=document.querySelector("body");setTimeout(()=>{h?(g.classList.add(p),requestAnimationFrame(l)):g.classList.remove(p)},10)}),(h,p)=>(x(),ae(Jd,{disabled:!t.teleport,to:"body"},[P(Zo,null,{default:z(()=>[t.modelValue?(x(),T("div",w3,[v("div",{class:Je(["fixed inset-0 bg-black overflow-hidden",{"transition-opacity":!a.dragging}]),style:Vs(`opacity: ${(100-a.transform.value)*.8}%`),onClick:p[0]||(p[0]=g=>a.transform.value=100)},null,6),v("div",{class:"flex flex-col flex-grow flex-1 justify-end items-center",ref_key:"container",ref:r},[v("div",{class:Je(["bg-zinc-900 rounded-t-md flex flex-col overflow-hidden shadow-xl w-full max-w-lg",{"transition-transform":!a.dragging}]),style:Vs(`transform: translateY(${a.transform.value}%)`),ref_key:"sheet",ref:i},[S3,v("div",{class:"py-2.5 overflow-y-overlay",ref_key:"content",ref:o},[nr(h.$slots,"default")],512)],6)],512)])):pe("",!0)]),_:3})],8,["disabled"]))}});function Ai(){return{isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}}const E3=v("span",null,"Menu",-1),T3={key:0,class:"text-red-500 font-medium"},C3={key:0},A3={key:0,class:"text-red-500 font-medium"},k3={class:"font-medium"},L3={key:1},R3={key:0,class:"max-h-[400px] overflow-y-auto text-sm"},I3={class:"font-medium text-white"},D3={class:"font-medium text-white"},P3={class:"font-medium text-white"},F3={key:1,class:"text-center py-2 px-2"},O3=v("p",null,"No notifications",-1),M3=v("p",{class:"text-sm text-zinc-300 mt-1.5"}," Subscribe to your favorite creators to get notified about their latest videos. ",-1),$3=[O3,M3],N3={key:2},Zm=De({__name:"SettingsPopup",setup(s){const e=ue(!1),t=vs(),{isMobile:n}=Ai(),{user:i,isAuthorized:r,isCreator:o,isAdmin:a,notifications:l,unreadNotificationsCount:c}=Gt(t),{authDialog:u}=Gt(jn()),d=kn(),f=ue(0);return(h,p)=>{var g;return x(),T(_e,null,[w(r)?(x(),ae(Me,{key:0,ref:"profile",onClick:p[0]||(p[0]=m=>e.value=!e.value),theme:"blue",class:"flex gap-x-1.5 items-center"},{default:z(()=>[E3,w(c)?(x(),T("span",T3," ("+Z(w(c))+") ",1)):pe("",!0),P(Re,{name:"account",class:"h-5 w-5"})]),_:1},512)):pe("",!0),(x(),ae(vn(w(n)?$n:on),{target:(g=h.$refs.profile)==null?void 0:g.$el,modelValue:e.value,"onUpdate:modelValue":p[19]||(p[19]=m=>e.value=m),placement:"bottom-end",offset:8,class:"text-white md:w-80 py-1"},{default:z(()=>[P(Zo,{mode:"out-in"},{default:z(()=>[f.value===0?(x(),T("div",C3,[P(Gc,{title:"Account",icon:"account"}),w(r)?(x(),T(_e,{key:0},[P(Xe,{icon:"notification-badge-outline",arrow:!0,onClick:p[1]||(p[1]=m=>(f.value=1,w(t).markNotificationsAsRead()))},{default:z(()=>[W(" Notifications "),w(c)?(x(),T("span",A3,"("+Z(w(c))+") ",1)):pe("",!0)]),_:1}),P(Xe,{icon:"animation-play-outline",onClick:p[2]||(p[2]=m=>(w(d).push("/feed"),e.value=!1))},{default:z(()=>[W(" Subscriptions ")]),_:1}),P(Xe,{icon:"heart",onClick:p[3]||(p[3]=m=>(w(d).push("/likes"),e.value=!1))},{default:z(()=>[W(" Likes ")]),_:1}),P(Xe,{icon:"account",onClick:p[4]||(p[4]=m=>(w(d).push(`/u/${w(i).username}`),e.value=!1))},{default:z(()=>[W(" My Profile ")]),_:1}),P(Xe,{icon:w(t).getOrientationIcon(),arrow:!0,onClick:p[5]||(p[5]=m=>f.value=2)},{default:z(()=>[W(" Orientation: "),v("span",k3,Z(w(i).orientation!==void 0?w(pt)[w(i).orientation]:"None"),1)]),_:1},8,["icon"]),P(Xe,{icon:"cog",onClick:p[6]||(p[6]=m=>(w(d).push("/preferences"),e.value=!1))},{default:z(()=>[W(" Preferences ")]),_:1}),w(o)?(x(),T(_e,{key:0},[P(Gc,{title:"Studio",icon:"youtube-studio"}),P(Xe,{icon:"chart-timeline-sparkles",onClick:p[7]||(p[7]=m=>(e.value=!1,w(d).push("/studio")))},{default:z(()=>[W(" Analytics ")]),_:1}),P(Xe,{icon:"video-box",onClick:p[8]||(p[8]=m=>(e.value=!1,w(d).push("/studio/videos")))},{default:z(()=>[W(" My Videos ")]),_:1})],64)):pe("",!0),w(a)?(x(),T(_e,{key:1},[P(Gc,{title:"Administration",icon:"shield-crown"}),P(Xe,{icon:"account-group",onClick:p[9]||(p[9]=m=>(e.value=!1,w(d).push("/admin")))},{default:z(()=>[W(" User Management ")]),_:1})],64)):pe("",!0),P(zc),P(Xe,{icon:"logout",onClick:p[10]||(p[10]=m=>w(qe).user.logout())},{default:z(()=>[W(" Log Out ")]),_:1})],64)):(x(),T(_e,{key:1},[P(Xe,{icon:"animation-play-outline",onClick:p[11]||(p[11]=m=>u.value=!0)},{default:z(()=>[W(" Subscriptions ")]),_:1}),P(Xe,{icon:"heart",onClick:p[12]||(p[12]=m=>u.value=!0)},{default:z(()=>[W(" Favorites ")]),_:1})],64))])):f.value===1?(x(),T("div",L3,[P(Xe,{icon:"chevron-left",onClick:p[13]||(p[13]=m=>f.value=0)}),P(zc),w(l).length?(x(),T("div",R3,[(x(!0),T(_e,null,st(w(l),m=>(x(),T(_e,null,[m.type===w(Ba).Video?(x(),ae(Xe,{key:0,onClick:_=>(w(d).push(`/v/${m.data.id}`),e.value=!1)},{default:z(()=>[W(Z(m.data.username)+" uploaded a new video ",1),v("span",I3,Z(m.data.name),1)]),_:2},1032,["onClick"])):pe("",!0),m.type===w(Ba).VideoComment?(x(),ae(Xe,{key:1,onClick:_=>(w(d).push(`/v/${m.data.video_id}?comments=true`),e.value=!1)},{default:z(()=>[W(Z(m.data.username)+" commented on your video ",1),v("span",D3,Z(m.data.video_name),1)]),_:2},1032,["onClick"])):pe("",!0),m.type===w(Ba).VideoCommentResponse?(x(),ae(Xe,{key:2,onClick:_=>(w(d).push(`/v/${m.data.video_id}?comments=true`),e.value=!1)},{default:z(()=>[W(Z(m.data.username)+" responded to your comment on video ",1),v("span",P3,Z(m.data.video_name),1)]),_:2},1032,["onClick"])):pe("",!0)],64))),256))])):(x(),T("div",F3,$3))])):f.value===2?(x(),T("div",N3,[P(Xe,{icon:"chevron-left",onClick:p[14]||(p[14]=m=>f.value=0)}),P(zc),P(Xe,{active:w(t).getOrientation()===void 0,icon:"close",onClick:p[15]||(p[15]=m=>w(t).setOrientation(null))},{default:z(()=>[W(" None ")]),_:1},8,["active"]),P(Xe,{active:w(t).getOrientation()===w(pt).Straight,icon:"orientation-straight",onClick:p[16]||(p[16]=m=>w(t).setOrientation(w(pt).Straight))},{default:z(()=>[W(" Straight ")]),_:1},8,["active"]),P(Xe,{active:w(t).getOrientation()===w(pt).Transgender,icon:"orientation-transgender",onClick:p[17]||(p[17]=m=>w(t).setOrientation(w(pt).Transgender))},{default:z(()=>[W(" Transgender ")]),_:1},8,["active"]),P(Xe,{active:w(t).getOrientation()===w(pt).Gay,icon:"orientation-gay",onClick:p[18]||(p[18]=m=>w(t).setOrientation(w(pt).Gay))},{default:z(()=>[W(" Gay ")]),_:1},8,["active"])])):pe("",!0)]),_:1})]),_:1},8,["target","modelValue"]))],64)}}}),V3="/handy.webm";var Mn;(function(s){s.Range="range",s.Steps="steps",s.Positions="positions",s.Count="count",s.Values="values"})(Mn||(Mn={}));var gs;(function(s){s[s.None=-1]="None",s[s.NoValue=0]="NoValue",s[s.LargeValue=1]="LargeValue",s[s.SmallValue=2]="SmallValue"})(gs||(gs={}));function B3(s){return Al(s)&&typeof s.from=="function"}function Al(s){return typeof s=="object"&&typeof s.to=="function"}function J0(s){s.parentElement.removeChild(s)}function ad(s){return s!=null}function ep(s){s.preventDefault()}function U3(s){return s.filter(function(e){return this[e]?!1:this[e]=!0},{})}function H3(s,e){return Math.round(s/e)*e}function G3(s,e){var t=s.getBoundingClientRect(),n=s.ownerDocument,i=n.documentElement,r=Xm(n);return/webkit.*Chrome.*Mobile/i.test(navigator.userAgent)&&(r.x=0),e?t.top+r.y-i.clientTop:t.left+r.x-i.clientLeft}function an(s){return typeof s=="number"&&!isNaN(s)&&isFinite(s)}function tp(s,e,t){t>0&&(ls(s,e),setTimeout(function(){Ya(s,e)},t))}function sp(s){return Math.max(Math.min(s,100),0)}function gc(s){return Array.isArray(s)?s:[s]}function z3(s){s=String(s);var e=s.split(".");return e.length>1?e[1].length:0}function ls(s,e){s.classList&&!/\s/.test(e)?s.classList.add(e):s.className+=" "+e}function Ya(s,e){s.classList&&!/\s/.test(e)?s.classList.remove(e):s.className=s.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," ")}function j3(s,e){return s.classList?s.classList.contains(e):new RegExp("\\b"+e+"\\b").test(s.className)}function Xm(s){var e=window.pageXOffset!==void 0,t=(s.compatMode||"")==="CSS1Compat",n=e?window.pageXOffset:t?s.documentElement.scrollLeft:s.body.scrollLeft,i=e?window.pageYOffset:t?s.documentElement.scrollTop:s.body.scrollTop;return{x:n,y:i}}function q3(){return window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"}}function K3(){var s=!1;try{var e=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("test",null,e)}catch{}return s}function W3(){return window.CSS&&CSS.supports&&CSS.supports("touch-action","none")}function Af(s,e){return 100/(e-s)}function ld(s,e,t){return e*100/(s[t+1]-s[t])}function Y3(s,e){return ld(s,s[0]<0?e+Math.abs(s[0]):e-s[0],0)}function Z3(s,e){return e*(s[1]-s[0])/100+s[0]}function Go(s,e){for(var t=1;s>=e[t];)t+=1;return t}function X3(s,e,t){if(t>=s.slice(-1)[0])return 100;var n=Go(t,s),i=s[n-1],r=s[n],o=e[n-1],a=e[n];return o+Y3([i,r],t)/Af(o,a)}function Q3(s,e,t){if(t>=100)return s.slice(-1)[0];var n=Go(t,e),i=s[n-1],r=s[n],o=e[n-1],a=e[n];return Z3([i,r],(t-o)*Af(o,a))}function J3(s,e,t,n){if(n===100)return n;var i=Go(n,s),r=s[i-1],o=s[i];return t?n-r>(o-r)/2?o:r:e[i-1]?s[i-1]+H3(n-s[i-1],e[i-1]):n}var Qm=function(){function s(e,t,n){this.xPct=[],this.xVal=[],this.xSteps=[],this.xNumSteps=[],this.xHighestCompleteStep=[],this.xSteps=[n||!1],this.xNumSteps=[!1],this.snap=t;var i,r=[];for(Object.keys(e).forEach(function(o){r.push([gc(e[o]),o])}),r.sort(function(o,a){return o[0][0]-a[0][0]}),i=0;i<r.length;i++)this.handleEntryPoint(r[i][1],r[i][0]);for(this.xNumSteps=this.xSteps.slice(0),i=0;i<this.xNumSteps.length;i++)this.handleStepPoint(i,this.xNumSteps[i])}return s.prototype.getDistance=function(e){for(var t=[],n=0;n<this.xNumSteps.length-1;n++)t[n]=ld(this.xVal,e,n);return t},s.prototype.getAbsoluteDistance=function(e,t,n){var i=0;if(e<this.xPct[this.xPct.length-1])for(;e>this.xPct[i+1];)i++;else e===this.xPct[this.xPct.length-1]&&(i=this.xPct.length-2);!n&&e===this.xPct[i+1]&&i++,t===null&&(t=[]);var r,o=1,a=t[i],l=0,c=0,u=0,d=0;for(n?r=(e-this.xPct[i])/(this.xPct[i+1]-this.xPct[i]):r=(this.xPct[i+1]-e)/(this.xPct[i+1]-this.xPct[i]);a>0;)l=this.xPct[i+1+d]-this.xPct[i+d],t[i+d]*o+100-r*100>100?(c=l*r,o=(a-100*r)/t[i+d],r=1):(c=t[i+d]*l/100*o,o=0),n?(u=u-c,this.xPct.length+d>=1&&d--):(u=u+c,this.xPct.length-d>=1&&d++),a=t[i+d]*o;return e+u},s.prototype.toStepping=function(e){return e=X3(this.xVal,this.xPct,e),e},s.prototype.fromStepping=function(e){return Q3(this.xVal,this.xPct,e)},s.prototype.getStep=function(e){return e=J3(this.xPct,this.xSteps,this.snap,e),e},s.prototype.getDefaultStep=function(e,t,n){var i=Go(e,this.xPct);return(e===100||t&&e===this.xPct[i-1])&&(i=Math.max(i-1,1)),(this.xVal[i]-this.xVal[i-1])/n},s.prototype.getNearbySteps=function(e){var t=Go(e,this.xPct);return{stepBefore:{startValue:this.xVal[t-2],step:this.xNumSteps[t-2],highestStep:this.xHighestCompleteStep[t-2]},thisStep:{startValue:this.xVal[t-1],step:this.xNumSteps[t-1],highestStep:this.xHighestCompleteStep[t-1]},stepAfter:{startValue:this.xVal[t],step:this.xNumSteps[t],highestStep:this.xHighestCompleteStep[t]}}},s.prototype.countStepDecimals=function(){var e=this.xNumSteps.map(z3);return Math.max.apply(null,e)},s.prototype.hasNoSize=function(){return this.xVal[0]===this.xVal[this.xVal.length-1]},s.prototype.convert=function(e){return this.getStep(this.toStepping(e))},s.prototype.handleEntryPoint=function(e,t){var n;if(e==="min"?n=0:e==="max"?n=100:n=parseFloat(e),!an(n)||!an(t[0]))throw new Error("noUiSlider: 'range' value isn't numeric.");this.xPct.push(n),this.xVal.push(t[0]);var i=Number(t[1]);n?this.xSteps.push(isNaN(i)?!1:i):isNaN(i)||(this.xSteps[0]=i),this.xHighestCompleteStep.push(0)},s.prototype.handleStepPoint=function(e,t){if(!!t){if(this.xVal[e]===this.xVal[e+1]){this.xSteps[e]=this.xHighestCompleteStep[e]=this.xVal[e];return}this.xSteps[e]=ld([this.xVal[e],this.xVal[e+1]],t,0)/Af(this.xPct[e],this.xPct[e+1]);var n=(this.xVal[e+1]-this.xVal[e])/this.xNumSteps[e],i=Math.ceil(Number(n.toFixed(3))-1),r=this.xVal[e]+this.xNumSteps[e]*i;this.xHighestCompleteStep[e]=r}},s}(),np={to:function(s){return s===void 0?"":s.toFixed(2)},from:Number},Jm={target:"target",base:"base",origin:"origin",handle:"handle",handleLower:"handle-lower",handleUpper:"handle-upper",touchArea:"touch-area",horizontal:"horizontal",vertical:"vertical",background:"background",connect:"connect",connects:"connects",ltr:"ltr",rtl:"rtl",textDirectionLtr:"txt-dir-ltr",textDirectionRtl:"txt-dir-rtl",draggable:"draggable",drag:"state-drag",tap:"state-tap",active:"active",tooltip:"tooltip",pips:"pips",pipsHorizontal:"pips-horizontal",pipsVertical:"pips-vertical",marker:"marker",markerHorizontal:"marker-horizontal",markerVertical:"marker-vertical",markerNormal:"marker-normal",markerLarge:"marker-large",markerSub:"marker-sub",value:"value",valueHorizontal:"value-horizontal",valueVertical:"value-vertical",valueNormal:"value-normal",valueLarge:"value-large",valueSub:"value-sub"},Jn={tooltips:".__tooltips",aria:".__aria"};function e4(s,e){if(!an(e))throw new Error("noUiSlider: 'step' is not numeric.");s.singleStep=e}function t4(s,e){if(!an(e))throw new Error("noUiSlider: 'keyboardPageMultiplier' is not numeric.");s.keyboardPageMultiplier=e}function s4(s,e){if(!an(e))throw new Error("noUiSlider: 'keyboardMultiplier' is not numeric.");s.keyboardMultiplier=e}function n4(s,e){if(!an(e))throw new Error("noUiSlider: 'keyboardDefaultStep' is not numeric.");s.keyboardDefaultStep=e}function i4(s,e){if(typeof e!="object"||Array.isArray(e))throw new Error("noUiSlider: 'range' is not an object.");if(e.min===void 0||e.max===void 0)throw new Error("noUiSlider: Missing 'min' or 'max' in 'range'.");s.spectrum=new Qm(e,s.snap||!1,s.singleStep)}function r4(s,e){if(e=gc(e),!Array.isArray(e)||!e.length)throw new Error("noUiSlider: 'start' option is incorrect.");s.handles=e.length,s.start=e}function o4(s,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'snap' option must be a boolean.");s.snap=e}function a4(s,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'animate' option must be a boolean.");s.animate=e}function l4(s,e){if(typeof e!="number")throw new Error("noUiSlider: 'animationDuration' option must be a number.");s.animationDuration=e}function c4(s,e){var t=[!1],n;if(e==="lower"?e=[!0,!1]:e==="upper"&&(e=[!1,!0]),e===!0||e===!1){for(n=1;n<s.handles;n++)t.push(e);t.push(!1)}else{if(!Array.isArray(e)||!e.length||e.length!==s.handles+1)throw new Error("noUiSlider: 'connect' option doesn't match handle count.");t=e}s.connect=t}function u4(s,e){switch(e){case"horizontal":s.ort=0;break;case"vertical":s.ort=1;break;default:throw new Error("noUiSlider: 'orientation' option is invalid.")}}function ev(s,e){if(!an(e))throw new Error("noUiSlider: 'margin' option must be numeric.");e!==0&&(s.margin=s.spectrum.getDistance(e))}function d4(s,e){if(!an(e))throw new Error("noUiSlider: 'limit' option must be numeric.");if(s.limit=s.spectrum.getDistance(e),!s.limit||s.handles<2)throw new Error("noUiSlider: 'limit' option is only supported on linear sliders with 2 or more handles.")}function f4(s,e){var t;if(!an(e)&&!Array.isArray(e))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(Array.isArray(e)&&!(e.length===2||an(e[0])||an(e[1])))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(e!==0){for(Array.isArray(e)||(e=[e,e]),s.padding=[s.spectrum.getDistance(e[0]),s.spectrum.getDistance(e[1])],t=0;t<s.spectrum.xNumSteps.length-1;t++)if(s.padding[0][t]<0||s.padding[1][t]<0)throw new Error("noUiSlider: 'padding' option must be a positive number(s).");var n=e[0]+e[1],i=s.spectrum.xVal[0],r=s.spectrum.xVal[s.spectrum.xVal.length-1];if(n/(r-i)>1)throw new Error("noUiSlider: 'padding' option must not exceed 100% of the range.")}}function h4(s,e){switch(e){case"ltr":s.dir=0;break;case"rtl":s.dir=1;break;default:throw new Error("noUiSlider: 'direction' option was not recognized.")}}function p4(s,e){if(typeof e!="string")throw new Error("noUiSlider: 'behaviour' must be a string containing options.");var t=e.indexOf("tap")>=0,n=e.indexOf("drag")>=0,i=e.indexOf("fixed")>=0,r=e.indexOf("snap")>=0,o=e.indexOf("hover")>=0,a=e.indexOf("unconstrained")>=0,l=e.indexOf("drag-all")>=0,c=e.indexOf("smooth-steps")>=0;if(i){if(s.handles!==2)throw new Error("noUiSlider: 'fixed' behaviour must be used with 2 handles");ev(s,s.start[1]-s.start[0])}if(a&&(s.margin||s.limit))throw new Error("noUiSlider: 'unconstrained' behaviour cannot be used with margin or limit");s.events={tap:t||r,drag:n,dragAll:l,smoothSteps:c,fixed:i,snap:r,hover:o,unconstrained:a}}function g4(s,e){if(e!==!1)if(e===!0||Al(e)){s.tooltips=[];for(var t=0;t<s.handles;t++)s.tooltips.push(e)}else{if(e=gc(e),e.length!==s.handles)throw new Error("noUiSlider: must pass a formatter for all handles.");e.forEach(function(n){if(typeof n!="boolean"&&!Al(n))throw new Error("noUiSlider: 'tooltips' must be passed a formatter or 'false'.")}),s.tooltips=e}}function m4(s,e){if(e.length!==s.handles)throw new Error("noUiSlider: must pass a attributes for all handles.");s.handleAttributes=e}function v4(s,e){if(!Al(e))throw new Error("noUiSlider: 'ariaFormat' requires 'to' method.");s.ariaFormat=e}function _4(s,e){if(!B3(e))throw new Error("noUiSlider: 'format' requires 'to' and 'from' methods.");s.format=e}function y4(s,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'keyboardSupport' option must be a boolean.");s.keyboardSupport=e}function x4(s,e){s.documentElement=e}function b4(s,e){if(typeof e!="string"&&e!==!1)throw new Error("noUiSlider: 'cssPrefix' must be a string or `false`.");s.cssPrefix=e}function w4(s,e){if(typeof e!="object")throw new Error("noUiSlider: 'cssClasses' must be an object.");typeof s.cssPrefix=="string"?(s.cssClasses={},Object.keys(e).forEach(function(t){s.cssClasses[t]=s.cssPrefix+e[t]})):s.cssClasses=e}function tv(s){var e={margin:null,limit:null,padding:null,animate:!0,animationDuration:300,ariaFormat:np,format:np},t={step:{r:!1,t:e4},keyboardPageMultiplier:{r:!1,t:t4},keyboardMultiplier:{r:!1,t:s4},keyboardDefaultStep:{r:!1,t:n4},start:{r:!0,t:r4},connect:{r:!0,t:c4},direction:{r:!0,t:h4},snap:{r:!1,t:o4},animate:{r:!1,t:a4},animationDuration:{r:!1,t:l4},range:{r:!0,t:i4},orientation:{r:!1,t:u4},margin:{r:!1,t:ev},limit:{r:!1,t:d4},padding:{r:!1,t:f4},behaviour:{r:!0,t:p4},ariaFormat:{r:!1,t:v4},format:{r:!1,t:_4},tooltips:{r:!1,t:g4},keyboardSupport:{r:!0,t:y4},documentElement:{r:!1,t:x4},cssPrefix:{r:!0,t:b4},cssClasses:{r:!0,t:w4},handleAttributes:{r:!1,t:m4}},n={connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal",keyboardSupport:!0,cssPrefix:"noUi-",cssClasses:Jm,keyboardPageMultiplier:5,keyboardMultiplier:1,keyboardDefaultStep:10};s.format&&!s.ariaFormat&&(s.ariaFormat=s.format),Object.keys(t).forEach(function(l){if(!ad(s[l])&&n[l]===void 0){if(t[l].r)throw new Error("noUiSlider: '"+l+"' is required.");return}t[l].t(e,ad(s[l])?s[l]:n[l])}),e.pips=s.pips;var i=document.createElement("div"),r=i.style.msTransform!==void 0,o=i.style.transform!==void 0;e.transformRule=o?"transform":r?"msTransform":"webkitTransform";var a=[["left","top"],["right","bottom"]];return e.style=a[e.dir][e.ort],e}function S4(s,e,t){var n=q3(),i=W3(),r=i&&K3(),o=s,a,l,c,u,d,f=e.spectrum,h=[],p=[],g=[],m=0,_={},y=s.ownerDocument,S=e.documentElement||y.documentElement,C=y.body,E=y.dir==="rtl"||e.ort===1?0:100;function A(F,N){var U=y.createElement("div");return N&&ls(U,N),F.appendChild(U),U}function R(F,N){var U=A(F,e.cssClasses.origin),ee=A(U,e.cssClasses.handle);if(A(ee,e.cssClasses.touchArea),ee.setAttribute("data-handle",String(N)),e.keyboardSupport&&(ee.setAttribute("tabindex","0"),ee.addEventListener("keydown",function(ge){return Q(ge,N)})),e.handleAttributes!==void 0){var ve=e.handleAttributes[N];Object.keys(ve).forEach(function(ge){ee.setAttribute(ge,ve[ge])})}return ee.setAttribute("role","slider"),ee.setAttribute("aria-orientation",e.ort?"vertical":"horizontal"),N===0?ls(ee,e.cssClasses.handleLower):N===e.handles-1&&ls(ee,e.cssClasses.handleUpper),U.handle=ee,U}function I(F,N){return N?A(F,e.cssClasses.connect):!1}function D(F,N){var U=A(N,e.cssClasses.connects);l=[],c=[],c.push(I(U,F[0]));for(var ee=0;ee<e.handles;ee++)l.push(R(N,ee)),g[ee]=ee,c.push(I(U,F[ee+1]))}function L(F){ls(F,e.cssClasses.target),e.dir===0?ls(F,e.cssClasses.ltr):ls(F,e.cssClasses.rtl),e.ort===0?ls(F,e.cssClasses.horizontal):ls(F,e.cssClasses.vertical);var N=getComputedStyle(F).direction;return N==="rtl"?ls(F,e.cssClasses.textDirectionRtl):ls(F,e.cssClasses.textDirectionLtr),A(F,e.cssClasses.base)}function M(F,N){return!e.tooltips||!e.tooltips[N]?!1:A(F.firstChild,e.cssClasses.tooltip)}function $(){return o.hasAttribute("disabled")}function H(F){var N=l[F];return N.hasAttribute("disabled")}function ie(F){F!=null?(l[F].setAttribute("disabled",""),l[F].handle.removeAttribute("tabindex")):(o.setAttribute("disabled",""),l.forEach(function(N){N.handle.removeAttribute("tabindex")}))}function te(F){F!=null?(l[F].removeAttribute("disabled"),l[F].handle.setAttribute("tabindex","0")):(o.removeAttribute("disabled"),l.forEach(function(N){N.removeAttribute("disabled"),N.handle.setAttribute("tabindex","0")}))}function X(){d&&(oe("update"+Jn.tooltips),d.forEach(function(F){F&&J0(F)}),d=null)}function de(){X(),d=l.map(M),ce("update"+Jn.tooltips,function(F,N,U){if(!(!d||!e.tooltips)&&d[N]!==!1){var ee=F[N];e.tooltips[N]!==!0&&(ee=e.tooltips[N].to(U[N])),d[N].innerHTML=ee}})}function xe(){oe("update"+Jn.aria),ce("update"+Jn.aria,function(F,N,U,ee,ve){g.forEach(function(ge){var je=l[ge],Ae=ne(p,ge,0,!0,!0,!0),St=ne(p,ge,100,!0,!0,!0),xt=ve[ge],At=String(e.ariaFormat.to(U[ge]));Ae=f.fromStepping(Ae).toFixed(1),St=f.fromStepping(St).toFixed(1),xt=f.fromStepping(xt).toFixed(1),je.children[0].setAttribute("aria-valuemin",Ae),je.children[0].setAttribute("aria-valuemax",St),je.children[0].setAttribute("aria-valuenow",xt),je.children[0].setAttribute("aria-valuetext",At)})})}function le(F){if(F.mode===Mn.Range||F.mode===Mn.Steps)return f.xVal;if(F.mode===Mn.Count){if(F.values<2)throw new Error("noUiSlider: 'values' (>= 2) required for mode 'count'.");for(var N=F.values-1,U=100/N,ee=[];N--;)ee[N]=N*U;return ee.push(100),re(ee,F.stepped)}return F.mode===Mn.Positions?re(F.values,F.stepped):F.mode===Mn.Values?F.stepped?F.values.map(function(ve){return f.fromStepping(f.getStep(f.toStepping(ve)))}):F.values:[]}function re(F,N){return F.map(function(U){return f.fromStepping(N?f.getStep(U):U)})}function Be(F){function N(xt,At){return Number((xt+At).toFixed(7))}var U=le(F),ee={},ve=f.xVal[0],ge=f.xVal[f.xVal.length-1],je=!1,Ae=!1,St=0;return U=U3(U.slice().sort(function(xt,At){return xt-At})),U[0]!==ve&&(U.unshift(ve),je=!0),U[U.length-1]!==ge&&(U.push(ge),Ae=!0),U.forEach(function(xt,At){var kt,ft,Mt,as=xt,jt=U[At+1],Qt,_c,yc,xc,Zf,bc,Xf,Qf=F.mode===Mn.Steps;for(Qf&&(kt=f.xNumSteps[At]),kt||(kt=jt-as),jt===void 0&&(jt=as),kt=Math.max(kt,1e-7),ft=as;ft<=jt;ft=N(ft,kt)){for(Qt=f.toStepping(ft),_c=Qt-St,Zf=_c/(F.density||1),bc=Math.round(Zf),Xf=_c/bc,Mt=1;Mt<=bc;Mt+=1)yc=St+Mt*Xf,ee[yc.toFixed(5)]=[f.fromStepping(yc),0];xc=U.indexOf(ft)>-1?gs.LargeValue:Qf?gs.SmallValue:gs.NoValue,!At&&je&&ft!==jt&&(xc=0),ft===jt&&Ae||(ee[Qt.toFixed(5)]=[ft,xc]),St=Qt}}),ee}function be(F,N,U){var ee,ve,ge=y.createElement("div"),je=(ee={},ee[gs.None]="",ee[gs.NoValue]=e.cssClasses.valueNormal,ee[gs.LargeValue]=e.cssClasses.valueLarge,ee[gs.SmallValue]=e.cssClasses.valueSub,ee),Ae=(ve={},ve[gs.None]="",ve[gs.NoValue]=e.cssClasses.markerNormal,ve[gs.LargeValue]=e.cssClasses.markerLarge,ve[gs.SmallValue]=e.cssClasses.markerSub,ve),St=[e.cssClasses.valueHorizontal,e.cssClasses.valueVertical],xt=[e.cssClasses.markerHorizontal,e.cssClasses.markerVertical];ls(ge,e.cssClasses.pips),ls(ge,e.ort===0?e.cssClasses.pipsHorizontal:e.cssClasses.pipsVertical);function At(ft,Mt){var as=Mt===e.cssClasses.value,jt=as?St:xt,Qt=as?je:Ae;return Mt+" "+jt[e.ort]+" "+Qt[ft]}function kt(ft,Mt,as){if(as=N?N(Mt,as):as,as!==gs.None){var jt=A(ge,!1);jt.className=At(as,e.cssClasses.marker),jt.style[e.style]=ft+"%",as>gs.NoValue&&(jt=A(ge,!1),jt.className=At(as,e.cssClasses.value),jt.setAttribute("data-value",String(Mt)),jt.style[e.style]=ft+"%",jt.innerHTML=String(U.to(Mt)))}}return Object.keys(F).forEach(function(ft){kt(ft,F[ft][0],F[ft][1])}),ge}function Fe(){u&&(J0(u),u=null)}function We(F){Fe();var N=Be(F),U=F.filter,ee=F.format||{to:function(ve){return String(Math.round(ve))}};return u=o.appendChild(be(N,U,ee)),u}function ot(){var F=a.getBoundingClientRect(),N="offset"+["Width","Height"][e.ort];return e.ort===0?F.width||a[N]:F.height||a[N]}function Ue(F,N,U,ee){var ve=function(je){var Ae=K(je,ee.pageOffset,ee.target||N);if(!Ae||$()&&!ee.doNotReject||j3(o,e.cssClasses.tap)&&!ee.doNotReject||F===n.start&&Ae.buttons!==void 0&&Ae.buttons>1||ee.hover&&Ae.buttons)return!1;r||Ae.preventDefault(),Ae.calcPoint=Ae.points[e.ort],U(Ae,ee)},ge=[];return F.split(" ").forEach(function(je){N.addEventListener(je,ve,r?{passive:!0}:!1),ge.push([je,ve])}),ge}function K(F,N,U){var ee=F.type.indexOf("touch")===0,ve=F.type.indexOf("mouse")===0,ge=F.type.indexOf("pointer")===0,je=0,Ae=0;if(F.type.indexOf("MSPointer")===0&&(ge=!0),F.type==="mousedown"&&!F.buttons&&!F.touches)return!1;if(ee){var St=function(kt){var ft=kt.target;return ft===U||U.contains(ft)||F.composed&&F.composedPath().shift()===U};if(F.type==="touchstart"){var xt=Array.prototype.filter.call(F.touches,St);if(xt.length>1)return!1;je=xt[0].pageX,Ae=xt[0].pageY}else{var At=Array.prototype.find.call(F.changedTouches,St);if(!At)return!1;je=At.pageX,Ae=At.pageY}}return N=N||Xm(y),(ve||ge)&&(je=F.clientX+N.x,Ae=F.clientY+N.y),F.pageOffset=N,F.points=[je,Ae],F.cursor=ve||ge,F}function me(F){var N=F-G3(a,e.ort),U=N*100/ot();return U=sp(U),e.dir?100-U:U}function fe(F){var N=100,U=!1;return l.forEach(function(ee,ve){if(!H(ve)){var ge=p[ve],je=Math.abs(ge-F),Ae=je===100&&N===100,St=je<N,xt=je<=N&&F>ge;(St||xt||Ae)&&(U=ve,N=je)}}),U}function Se(F,N){F.type==="mouseout"&&F.target.nodeName==="HTML"&&F.relatedTarget===null&&lt(F,N)}function it(F,N){if(navigator.appVersion.indexOf("MSIE 9")===-1&&F.buttons===0&&N.buttonsProperty!==0)return lt(F,N);var U=(e.dir?-1:1)*(F.calcPoint-N.startCalcPoint),ee=U*100/N.baseSize;Pe(U>0,ee,N.locations,N.handleNumbers,N.connect)}function lt(F,N){N.handle&&(Ya(N.handle,e.cssClasses.active),m-=1),N.listeners.forEach(function(U){S.removeEventListener(U[0],U[1])}),m===0&&(Ya(o,e.cssClasses.drag),Qe(),F.cursor&&(C.style.cursor="",C.removeEventListener("selectstart",ep))),e.events.smoothSteps&&(N.handleNumbers.forEach(function(U){tt(U,p[U],!0,!0,!1,!1)}),N.handleNumbers.forEach(function(U){se("update",U)})),N.handleNumbers.forEach(function(U){se("change",U),se("set",U),se("end",U)})}function k(F,N){if(!N.handleNumbers.some(H)){var U;if(N.handleNumbers.length===1){var ee=l[N.handleNumbers[0]];U=ee.children[0],m+=1,ls(U,e.cssClasses.active)}F.stopPropagation();var ve=[],ge=Ue(n.move,S,it,{target:F.target,handle:U,connect:N.connect,listeners:ve,startCalcPoint:F.calcPoint,baseSize:ot(),pageOffset:F.pageOffset,handleNumbers:N.handleNumbers,buttonsProperty:F.buttons,locations:p.slice()}),je=Ue(n.end,S,lt,{target:F.target,handle:U,listeners:ve,doNotReject:!0,handleNumbers:N.handleNumbers}),Ae=Ue("mouseout",S,Se,{target:F.target,handle:U,listeners:ve,doNotReject:!0,handleNumbers:N.handleNumbers});ve.push.apply(ve,ge.concat(je,Ae)),F.cursor&&(C.style.cursor=getComputedStyle(F.target).cursor,l.length>1&&ls(o,e.cssClasses.drag),C.addEventListener("selectstart",ep,!1)),N.handleNumbers.forEach(function(St){se("start",St)})}}function O(F){F.stopPropagation();var N=me(F.calcPoint),U=fe(N);U!==!1&&(e.events.snap||tp(o,e.cssClasses.tap,e.animationDuration),tt(U,N,!0,!0),Qe(),se("slide",U,!0),se("update",U,!0),e.events.snap?k(F,{handleNumbers:[U]}):(se("change",U,!0),se("set",U,!0)))}function G(F){var N=me(F.calcPoint),U=f.getStep(N),ee=f.fromStepping(U);Object.keys(_).forEach(function(ve){ve.split(".")[0]==="hover"&&_[ve].forEach(function(ge){ge.call(ra,ee)})})}function Q(F,N){if($()||H(N))return!1;var U=["Left","Right"],ee=["Down","Up"],ve=["PageDown","PageUp"],ge=["Home","End"];e.dir&&!e.ort?U.reverse():e.ort&&!e.dir&&(ee.reverse(),ve.reverse());var je=F.key.replace("Arrow",""),Ae=je===ve[0],St=je===ve[1],xt=je===ee[0]||je===U[0]||Ae,At=je===ee[1]||je===U[1]||St,kt=je===ge[0],ft=je===ge[1];if(!xt&&!At&&!kt&&!ft)return!0;F.preventDefault();var Mt;if(At||xt){var as=xt?0:1,jt=os(N),Qt=jt[as];if(Qt===null)return!1;Qt===!1&&(Qt=f.getDefaultStep(p[N],xt,e.keyboardDefaultStep)),St||Ae?Qt*=e.keyboardPageMultiplier:Qt*=e.keyboardMultiplier,Qt=Math.max(Qt,1e-7),Qt=(xt?-1:1)*Qt,Mt=h[N]+Qt}else ft?Mt=e.spectrum.xVal[e.spectrum.xVal.length-1]:Mt=e.spectrum.xVal[0];return tt(N,f.toStepping(Mt),!0,!0),se("slide",N),se("update",N),se("change",N),se("set",N),!1}function Y(F){F.fixed||l.forEach(function(N,U){Ue(n.start,N.children[0],k,{handleNumbers:[U]})}),F.tap&&Ue(n.start,a,O,{}),F.hover&&Ue(n.move,a,G,{hover:!0}),F.drag&&c.forEach(function(N,U){if(!(N===!1||U===0||U===c.length-1)){var ee=l[U-1],ve=l[U],ge=[N],je=[ee,ve],Ae=[U-1,U];ls(N,e.cssClasses.draggable),F.fixed&&(ge.push(ee.children[0]),ge.push(ve.children[0])),F.dragAll&&(je=l,Ae=g),ge.forEach(function(St){Ue(n.start,St,k,{handles:je,handleNumbers:Ae,connect:N})})}})}function ce(F,N){_[F]=_[F]||[],_[F].push(N),F.split(".")[0]==="update"&&l.forEach(function(U,ee){se("update",ee)})}function ye(F){return F===Jn.aria||F===Jn.tooltips}function oe(F){var N=F&&F.split(".")[0],U=N?F.substring(N.length):F;Object.keys(_).forEach(function(ee){var ve=ee.split(".")[0],ge=ee.substring(ve.length);(!N||N===ve)&&(!U||U===ge)&&(!ye(ge)||U===ge)&&delete _[ee]})}function se(F,N,U){Object.keys(_).forEach(function(ee){var ve=ee.split(".")[0];F===ve&&_[ee].forEach(function(ge){ge.call(ra,h.map(e.format.to),N,h.slice(),U||!1,p.slice(),ra)})})}function ne(F,N,U,ee,ve,ge,je){var Ae;return l.length>1&&!e.events.unconstrained&&(ee&&N>0&&(Ae=f.getAbsoluteDistance(F[N-1],e.margin,!1),U=Math.max(U,Ae)),ve&&N<l.length-1&&(Ae=f.getAbsoluteDistance(F[N+1],e.margin,!0),U=Math.min(U,Ae))),l.length>1&&e.limit&&(ee&&N>0&&(Ae=f.getAbsoluteDistance(F[N-1],e.limit,!1),U=Math.min(U,Ae)),ve&&N<l.length-1&&(Ae=f.getAbsoluteDistance(F[N+1],e.limit,!0),U=Math.max(U,Ae))),e.padding&&(N===0&&(Ae=f.getAbsoluteDistance(0,e.padding[0],!1),U=Math.max(U,Ae)),N===l.length-1&&(Ae=f.getAbsoluteDistance(100,e.padding[1],!0),U=Math.min(U,Ae))),je||(U=f.getStep(U)),U=sp(U),U===F[N]&&!ge?!1:U}function we(F,N){var U=e.ort;return(U?N:F)+", "+(U?F:N)}function Pe(F,N,U,ee,ve){var ge=U.slice(),je=ee[0],Ae=e.events.smoothSteps,St=[!F,F],xt=[F,!F];ee=ee.slice(),F&&ee.reverse(),ee.length>1?ee.forEach(function(kt,ft){var Mt=ne(ge,kt,ge[kt]+N,St[ft],xt[ft],!1,Ae);Mt===!1?N=0:(N=Mt-ge[kt],ge[kt]=Mt)}):St=xt=[!0];var At=!1;ee.forEach(function(kt,ft){At=tt(kt,U[kt]+N,St[ft],xt[ft],!1,Ae)||At}),At&&(ee.forEach(function(kt){se("update",kt),se("slide",kt)}),ve!=null&&se("drag",je))}function ke(F,N){return e.dir?100-F-N:F}function Ke(F,N){p[F]=N,h[F]=f.fromStepping(N);var U=ke(N,0)-E,ee="translate("+we(U+"%","0")+")";l[F].style[e.transformRule]=ee,yt(F),yt(F+1)}function Qe(){g.forEach(function(F){var N=p[F]>50?-1:1,U=3+(l.length+N*F);l[F].style.zIndex=String(U)})}function tt(F,N,U,ee,ve,ge){return ve||(N=ne(p,F,N,U,ee,!1,ge)),N===!1?!1:(Ke(F,N),!0)}function yt(F){if(!!c[F]){var N=0,U=100;F!==0&&(N=p[F-1]),F!==c.length-1&&(U=p[F]);var ee=U-N,ve="translate("+we(ke(N,ee)+"%","0")+")",ge="scale("+we(ee/100,"1")+")";c[F].style[e.transformRule]=ve+" "+ge}}function Ft(F,N){return F===null||F===!1||F===void 0||(typeof F=="number"&&(F=String(F)),F=e.format.from(F),F!==!1&&(F=f.toStepping(F)),F===!1||isNaN(F))?p[N]:F}function rs(F,N,U){var ee=gc(F),ve=p[0]===void 0;N=N===void 0?!0:N,e.animate&&!ve&&tp(o,e.cssClasses.tap,e.animationDuration),g.forEach(function(Ae){tt(Ae,Ft(ee[Ae],Ae),!0,!1,U)});var ge=g.length===1?0:1;if(ve&&f.hasNoSize()&&(U=!0,p[0]=0,g.length>1)){var je=100/(g.length-1);g.forEach(function(Ae){p[Ae]=Ae*je})}for(;ge<g.length;++ge)g.forEach(function(Ae){tt(Ae,p[Ae],!0,!0,U)});Qe(),g.forEach(function(Ae){se("update",Ae),ee[Ae]!==null&&N&&se("set",Ae)})}function Kn(F){rs(e.start,F)}function sa(F,N,U,ee){if(F=Number(F),!(F>=0&&F<g.length))throw new Error("noUiSlider: invalid handle number, got: "+F);tt(F,Ft(N,F),!0,!0,ee),se("update",F),U&&se("set",F)}function Wn(F){if(F===void 0&&(F=!1),F)return h.length===1?h[0]:h.slice(0);var N=h.map(e.format.to);return N.length===1?N[0]:N}function na(){for(oe(Jn.aria),oe(Jn.tooltips),Object.keys(e.cssClasses).forEach(function(F){Ya(o,e.cssClasses[F])});o.firstChild;)o.removeChild(o.firstChild);delete o.noUiSlider}function os(F){var N=p[F],U=f.getNearbySteps(N),ee=h[F],ve=U.thisStep.step,ge=null;if(e.snap)return[ee-U.stepBefore.startValue||null,U.stepAfter.startValue-ee||null];ve!==!1&&ee+ve>U.stepAfter.startValue&&(ve=U.stepAfter.startValue-ee),ee>U.thisStep.startValue?ge=U.thisStep.step:U.stepBefore.step===!1?ge=!1:ge=ee-U.stepBefore.highestStep,N===100?ve=null:N===0&&(ge=null);var je=f.countStepDecimals();return ve!==null&&ve!==!1&&(ve=Number(ve.toFixed(je))),ge!==null&&ge!==!1&&(ge=Number(ge.toFixed(je))),[ge,ve]}function Fs(){return g.map(os)}function ia(F,N){var U=Wn(),ee=["margin","limit","padding","range","animate","snap","step","format","pips","tooltips"];ee.forEach(function(ge){F[ge]!==void 0&&(t[ge]=F[ge])});var ve=tv(t);ee.forEach(function(ge){F[ge]!==void 0&&(e[ge]=ve[ge])}),f=ve.spectrum,e.margin=ve.margin,e.limit=ve.limit,e.padding=ve.padding,e.pips?We(e.pips):Fe(),e.tooltips?de():X(),p=[],rs(ad(F.start)?F.start:U,N)}function D_(){a=L(o),D(e.connect,a),Y(e.events),rs(e.start),e.pips&&We(e.pips),e.tooltips&&de(),xe()}D_();var ra={destroy:na,steps:Fs,on:ce,off:oe,get:Wn,set:rs,setHandle:sa,reset:Kn,disable:ie,enable:te,__moveHandles:function(F,N,U){Pe(F,N,p,U)},options:t,updateOptions:ia,target:o,removePips:Fe,removeTooltips:X,getPositions:function(){return p.slice()},getTooltips:function(){return d},getOrigins:function(){return l},pips:We};return ra}function E4(s,e){if(!s||!s.nodeName)throw new Error("noUiSlider: create requires a single element, got: "+s);if(s.noUiSlider)throw new Error("noUiSlider: Slider was already initialized.");var t=tv(e),n=S4(s,t,e);return s.noUiSlider=n,n}const T4={__spectrum:Qm,cssClasses:Jm,create:E4},dr=De({__name:"Slider",props:{modelValue:{},min:{},max:{},tooltips:{type:Boolean,default:!1},values:{},suffix:{}},emits:["update:modelValue"],setup(s,{emit:e}){const t=ue(),n=s,i=e;let r;return Xt(()=>{r=T4.create(t.value,{start:n.modelValue,connect:typeof n.modelValue=="number"?"lower":!0,behaviour:"snap",range:{min:n.min,max:n.max},format:{to:o=>`${o.toFixed(0)}${n.suffix||""}`,from:o=>parseInt(parseInt(o).toFixed(0))},step:1,tooltips:n.tooltips,cssPrefix:"slider-",pips:{mode:Mn.Values,values:n.values}}),r.on("change",(o,a,l)=>{l.length===1?i("update:modelValue",Math.round(l[0])):i("update:modelValue",l)}),t.value.addEventListener("click",o=>{const a=o.target;if(a&&a.classList.contains("slider-value")){const l=parseInt(a.getAttribute("data-value"));if(typeof n.modelValue=="number")i("update:modelValue",l);else{const c=Object.assign([],n.modelValue);Math.abs(c[0]-l)<Math.abs(c[1]-l)?c[0]=l:c[1]=l,i("update:modelValue",c)}}})}),dt(()=>n.modelValue,o=>r.set(o)),(o,a)=>(x(),T("div",{ref_key:"slider",ref:t},null,512))}});const C4={class:"flex-1"},A4={class:"bg-zinc-800"},ba=De({__name:"SettingsPopupCollapse",props:{title:{}},setup(s){const e=s,t=ue(!1);return(n,i)=>(x(),T("div",null,[v("div",{onClick:i[0]||(i[0]=r=>t.value=!t.value),class:"flex py-1.5 md:py-1.5 px-3 items-center gap-3 hover:bg-blue-500 cursor-pointer text-lg md:text-base hover:bg-blue-500"},[P(Re,{name:"cog",class:"h-6 w-6 md:h-6 md:w-5"}),v("span",C4,Z(e.title),1),P(Re,{name:"chevron-right",class:Je(["h-5 w-5 transition-transform",t.value?"-rotate-90":"rotate-90"])},null,8,["class"])]),ht(v("div",A4,[nr(n.$slots,"default")],512),[[Kt,t.value]])]))}}),wa=De({__name:"Toggle",props:{modelValue:{type:Boolean,default:!0}},emits:["update:modelValue","change"],setup(s,{emit:e}){const t=e,n=s;return(i,r)=>(x(),T("button",{onClick:r[0]||(r[0]=o=>{t("update:modelValue",!n.modelValue),t("change")}),type:"button",class:Je([n.modelValue?"bg-blue-500":"bg-zinc-400","relative inline-flex flex-shrink-0 h-5 w-10 border-2 border-transparent rounded-full cursor-pointer transition-colors ease-in-out duration-200 focus:outline-none"]),role:"switch","aria-checked":"false"},[v("span",{"aria-hidden":"true",class:Je([n.modelValue?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-4 w-4 rounded-full bg-white transform ring-0 transition ease-in-out duration-200"])},null,2)],2))}}),k4={class:"text-white"},L4={key:0,class:"lg:w-80"},R4={class:"flex items-center justify-between"},I4={key:0,class:"rounded py-1 px-2.5 bg-green-500 text-xs text-green-50 font-semibold"},D4={class:"flex items-center justify-between"},P4={key:0,class:"rounded- py-1 px-2.5 bg-green-500 text-xs text-green-50 font-semibold"},F4={class:"flex items-center justify-between"},O4={key:0,class:"rounded py-1 px-2.5 bg-green-500 text-xs text-green-50 font-semibold"},M4={class:"flex items-center justify-between"},$4={key:0,class:"rounded py-1 px-2.5 bg-green-500 text-xs text-green-50 font-semibold"},N4={class:"flex items-center justify-between"},V4={key:0,class:"rounded py-1 px-2.5 bg-green-500 text-xs text-green-50 font-semibold"},B4={key:1,class:"lg:max-w-3xl"},U4={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 lg:max-w-3xl items-center p-3"},H4=v("hr",{class:"mt-2 mb-0 border-zinc-700 lg:hidden"},null,-1),G4={key:0,"data-ph-capture-attribute-connector-handy":"1",href:"https://www.thehandy.com/?ref=faptap&utm_source=faptap&utm_medium=affiliate&utm_campaign=The+Handy+Affiliate+program&tap_s=3539267-2a196b&tm_subid1=connector",target:"_blank",class:"leading-normal flex flex-col gap-2"},z4=v("div",{class:"bg-white rounded-lg w-full aspect-video overflow-hidden"},[v("video",{muted:"",autoplay:"",loop:"",src:V3,class:"w-full h-full"})],-1),j4=v("span",{class:"lg:text-sm text-zinc-300 flex-1 text-center lg:text-left"},[W("Feel what you see with "),v("span",{class:"font-medium text-white"},"The Handy"),W(" - the interactive, automatic stroker that syncs up with any "),v("span",{class:"font-medium text-white"},"FapTap"),W(" video.")],-1),q4=v("div",{class:"lg:flex-1"},null,-1),K4=v("div",{class:"text-center font-medium"},[W(" 10% OFF WITH CODE "),v("span",{class:"font-bold text-blue-400"},"FAPTAP")],-1),W4={key:1,class:"px-4 py-2"},Y4={class:"flex items-center justify-between"},Z4={class:"font-medium"},X4={class:"text-sm text-zinc-500 ml-1"},Q4=v("label",{class:"text-zinc-300 text-sm"},"If your sync is off, you can try to adjust this offset value.",-1),J4={class:"mt-4"},eR={class:"font-medium"},tR={class:"text-sm text-zinc-500 ml-1"},sR=v("span",{class:"text-zinc-300 text-sm"},"You can adjust the stroke length to adjust the intensity of the script.",-1),nR={class:"flex items-center justify-between"},iR=v("p",{class:"font-medium"},"Invert",-1),rR=v("span",{class:"text-zinc-300 text-sm"},"With this setting you can invert all script actions in a video. A page reload is required.",-1),oR={class:"flex flex-col items-center text-center text-white gap-y-3 mt-4 md:mt-0 h-full !order-first lg:!order-last"},aR={class:"flex items-center flex-1"},lR=v("h2",{class:"text-2xl font-bold"},"TheHandy",-1),cR=v("p",{class:"text-sm text-zinc-400"},[W("To connect your Handy, please enter your connection key ("),v("a",{class:"text-blue-400",target:"_blank",href:"https://www.handysetup.com/en/docs/getting-started/connect-handy-to-wifi-fw3/"},"I need help"),W("). ")],-1),uR={class:"text-red-500 font-medium my-2"},dR={key:0},fR={key:1,class:"text-green-500"},hR={key:2,class:"lg:w-80"},pR={class:"flex flex-col items-center text-center text-white gap-y-3 mt-4 md:mt-0 px-3 py-2"},gR={class:"flex items-center"},mR=v("h2",{class:"text-2xl font-bold"},"Bluetooth",-1),vR=v("p",{class:"text-sm text-zinc-400 my-4"},[W("FapTap supports over 250 different toys, from vibrators to strokers ("),v("a",{class:"text-blue-400",href:"https://iostindex.com/?filter0Availability=Available,DIY&filter1ButtplugSupport=4",target:"_blank"},"supported devices"),W("). ")],-1),_R={key:0,class:"my-3 rounded-md border border-zinc-700 overflow-hidden divide-y divide-zinc-700 w-full"},yR={class:"px-3 py-3 flex items-center justify-between"},xR={class:"font-medium"},bR={key:0,class:"flex flex items-center text-zinc-300"},wR={class:"ml-1"},SR={key:1,class:"font-medium text-red-500"},ER={class:"px-4 py-2"},TR={class:"mt-4"},CR={class:"flex items-center justify-between"},AR={class:"font-medium"},kR={class:"text-sm text-zinc-500 ml-1"},LR=v("span",{class:"text-zinc-300 text-sm"},"You can adjust the stroke length to adjust the intensity of the script.",-1),RR={class:"flex items-center justify-between"},IR=v("p",{class:"font-medium"},"Invert",-1),DR=v("span",{class:"text-zinc-300 text-sm"},"With this setting you can invert all script actions in a video",-1),PR={key:3,class:"lg:w-80"},FR={class:"flex flex-col items-center text-center text-white gap-y-3 mt-4 md:mt-0 px-3 py-2"},OR={class:"flex items-center"},MR=v("h2",{class:"text-2xl font-bold"},"OSR",-1),$R=v("p",{class:"text-sm text-zinc-400 my-4"},'Simply plug in your OSR to any USB port on your PC/Laptop and click on "Connect".',-1),NR={key:1,class:"font-medium text-red-500"},VR=v("a",{target:"_blank",class:"text-blue-500",href:"https://www.google.com/chrome/"},"Chrome",-1),BR={class:"px-4 py-2"},UR={class:"mt-4"},HR={class:"flex items-center justify-between"},GR={class:"font-medium"},zR={class:"text-sm text-zinc-500 ml-1"},jR=v("span",{class:"text-zinc-300 text-sm"},"You can adjust the stroke length to adjust the intensity of the script.",-1),qR={class:"flex items-center justify-between"},KR=v("p",{class:"font-medium"},"Invert",-1),WR=v("span",{class:"text-zinc-300 text-sm"},"With this setting you can invert all script actions in a video",-1),YR={key:4,class:"lg:w-80"},ZR={class:"flex flex-col items-center text-center text-white gap-y-3 mt-4 md:mt-0 px-3 py-2"},XR={class:"flex items-center"},QR=v("h2",{class:"text-2xl font-bold"},"Intiface",-1),JR=v("p",{class:"text-sm text-zinc-400"},[W("Connect to "),v("a",{class:"font-medium text-blue-400",target:"_blank",href:"https://intiface.com/"},"Intiface"),W(" by entering the address below. ")],-1),e8={class:"text-red-500 font-medium my-2"},t8={key:0},s8={key:1,class:"text-green-500"},n8={class:"px-4 py-2"},i8={class:"mt-4"},r8={class:"flex items-center justify-between"},o8={class:"font-medium"},a8={class:"text-sm text-zinc-500 ml-1"},l8=v("span",{class:"text-zinc-300 text-sm"},"You can adjust the stroke length to adjust the intensity of the script.",-1),c8={class:"flex items-center justify-between"},u8=v("p",{class:"font-medium"},"Invert",-1),d8=v("span",{class:"text-zinc-300 text-sm"},"With this setting you can invert all script actions in a video",-1),f8={key:5,class:"lg:w-80"},h8={class:"flex flex-col items-center text-center text-white gap-y-3 mt-4 md:mt-0 px-3 py-2"},p8={class:"flex items-center"},g8=v("p",{class:"text-sm text-zinc-400"},[W(" Connect to your "),v("a",{class:"font-medium text-blue-400",target:"_blank",href:"https://www.joyloob.com/"},"LOOB")],-1),m8={class:"text-red-500 font-medium my-2"},v8={key:0},_8={key:1,class:"text-green-500"},y8={class:"px-4 py-2"},x8={class:"flex items-center justify-between"},b8={class:"font-medium"},w8={class:"text-sm text-zinc-500 ml-1"},S8=v("span",{class:"text-zinc-300 text-sm"},"You can adjust the stroke length to adjust the intensity of the script.",-1),E8=De({__name:"DeviceConnector",setup(s){const e=or();return(t,n)=>(x(),T("div",k4,[P(Zo,{mode:"out-in"},{default:z(()=>[w(e).ui.page===w(Jt).Start?(x(),T("div",L4,[P(Xe,{icon:"thehandy",arrow:!0,onClick:n[0]||(n[0]=i=>w(e).ui.page=w(Jt).Handy)},{default:z(()=>[v("div",R4,[W(" TheHandy "),w(e).handy.connected?(x(),T("span",I4,"Connected")):pe("",!0)])]),_:1}),P(Xe,{icon:"bluetooth",arrow:!0,onClick:n[1]||(n[1]=i=>w(e).ui.page=w(Jt).Bluetooth)},{default:z(()=>[v("div",D4,[W(" Bluetooth "),w(e).bluetooth.connected?(x(),T("span",P4,"Connected")):pe("",!0)])]),_:1}),P(Xe,{icon:"loob",arrow:!0,onClick:n[2]||(n[2]=i=>w(e).ui.page=w(Jt).Loob)},{default:z(()=>[v("div",F4,[W(" LOOB "),w(e).loob.connected?(x(),T("span",O4,"Connected")):pe("",!0)])]),_:1}),P(Xe,{icon:"intiface",arrow:!0,onClick:n[3]||(n[3]=i=>w(e).ui.page=w(Jt).Intiface)},{default:z(()=>[v("div",M4,[W(" Intiface "),w(e).intiface.connected?(x(),T("span",$4,"Connected")):pe("",!0)])]),_:1}),P(Xe,{icon:"usb-port",arrow:!0,onClick:n[4]||(n[4]=i=>w(e).ui.page=w(Jt).Osr)},{default:z(()=>[v("div",N4,[W(" OSR "),w(e).osr.connected?(x(),T("span",V4,"Connected")):pe("",!0)])]),_:1})])):w(e).ui.page===w(Jt).Handy?(x(),T("div",B4,[v("div",U4,[H4,w(e).handy.connected?(x(),T("div",W4,[v("div",null,[v("div",Y4,[v("p",Z4,[W(" Sync "),v("span",X4,Z(w(e).handy.settings.offset)+"ms",1)]),ht(v("button",{onClick:n[5]||(n[5]=i=>w(e).handy.settings.offset=0),class:"text-zinc-500 text-sm hover:text-white"},"Reset ",512),[[Kt,w(e).handy.settings.offset!==0]])]),P(dr,{min:-250,max:250,tooltips:!0,values:[-250,-125,0,125,250],suffix:"ms",modelValue:w(e).handy.settings.offset,"onUpdate:modelValue":n[6]||(n[6]=i=>w(e).handy.settings.offset=i),class:"mt-1.5 mb-8"},null,8,["modelValue"]),Q4]),v("div",J4,[v("p",eR,[W(" Stroke "),v("span",tR,Z(w(e).handy.settings.limits[0])+"-"+Z(w(e).handy.settings.limits[1]),1)]),P(dr,{modelValue:w(e).handy.settings.limits,"onUpdate:modelValue":n[7]||(n[7]=i=>w(e).handy.settings.limits=i),min:0,max:100,tooltips:!0,values:[0,25,50,75,100],class:"mt-1.5 mb-8"},null,8,["modelValue"]),sR]),v("div",{class:"mt-4 cursor-pointer",onClick:n[9]||(n[9]=i=>w(e).handy.settings.invert=!w(e).handy.settings.invert)},[v("div",nR,[iR,P(wa,{class:"pointer-events-none",modelValue:w(e).handy.settings.invert,"onUpdate:modelValue":n[8]||(n[8]=i=>w(e).handy.settings.invert=i)},null,8,["modelValue"])]),rR])])):(x(),T("a",G4,[z4,j4,q4,K4,P(Me,{class:"w-full",theme:"green"},{default:z(()=>[W("Buy Now")]),_:1})])),v("div",oR,[P(Me,{theme:"light",class:"block w-full hover:opacity-100 border border-zinc-600",onClick:n[10]||(n[10]=i=>w(e).ui.page=w(Jt).Start)},{default:z(()=>[W(" Connect another device ")]),_:1}),v("div",aR,[P(Re,{name:"thehandy",class:"h-16 w-16"}),lR]),cR,v("div",uR,[w(e).handy.error?(x(),T("p",dR,Z(w(e).handy.error),1)):w(e).handy.connected?(x(),T("p",fR,"Connected")):pe("",!0)]),P(hs,{type:"text",modelValue:w(e).handy.settings.key,"onUpdate:modelValue":n[11]||(n[11]=i=>w(e).handy.settings.key=i),disabled:w(e).handy.connected,class:"text-center w-full",placeholder:"Enter connection key"},null,8,["modelValue","disabled"]),w(e).handy.connected?(x(),ae(Me,{key:1,onClick:n[13]||(n[13]=Is(i=>w(e).handy.disconnect(),["stop"])),class:"w-full"},{default:z(()=>[W("Disconnect")]),_:1})):(x(),ae(Me,{key:0,onClick:n[12]||(n[12]=i=>w(e).handy.connect()),theme:"blue",loading:w(e).handy.scanning,disabled:w(e).handy.settings.key.length<5||w(e).handy.scanning,class:"w-full"},{default:z(()=>[W("Connect ")]),_:1},8,["loading","disabled"]))])])])):w(e).ui.page===w(Jt).Bluetooth?(x(),T("div",hR,[P(Xe,{icon:"chevron-left",onClick:n[14]||(n[14]=i=>w(e).ui.page=w(Jt).Start)}),v("div",pR,[v("div",gR,[P(Re,{name:"bluetooth",class:"h-16 w-16"}),mR]),vR,w(e).bluetooth.devices.length>0?(x(),T("div",_R,[(x(!0),T(_e,null,st(w(e).bluetooth.devices,i=>(x(),T("div",yR,[v("span",xR,Z(i.Name),1),i.batteryLevel&&!isNaN(i.batteryLevel)?(x(),T("span",bR,[P(Re,{name:"energy",class:"h-5 w-5"}),v("span",wR,Z(i.batteryLevel*100)+"%",1)])):pe("",!0)]))),256))])):pe("",!0),w(e).bluetooth.error?(x(),T("div",SR,[v("p",null,Z(w(e).bluetooth.error),1)])):(x(),ae(Me,{key:2,loading:w(e).bluetooth.scanning,class:"w-full",theme:"blue",onClick:n[15]||(n[15]=i=>w(e).bluetooth.connect())},{default:z(()=>[W(" Connect ")]),_:1},8,["loading"]))]),ht(P(ba,{title:"Settings",icon:"cog"},{default:z(()=>[v("div",ER,[v("div",TR,[v("div",CR,[v("p",AR,[W(" Stroke "),v("span",kR,Z(w(e).bluetooth.settings.limits[0])+"-"+Z(w(e).bluetooth.settings.limits[1]),1)]),ht(v("button",{onClick:n[16]||(n[16]=i=>w(e).bluetooth.settings.limits=[0,100]),class:"text-zinc-500 text-sm hover:text-white"},"Reset ",512),[[Kt,w(e).bluetooth.settings.limits[0]!==0||w(e).bluetooth.settings.limits[1]!==100]])]),P(dr,{modelValue:w(e).bluetooth.settings.limits,"onUpdate:modelValue":n[17]||(n[17]=i=>w(e).bluetooth.settings.limits=i),min:0,max:100,tooltips:!0,values:[0,25,50,75,100],class:"mt-1.5 mb-8"},null,8,["modelValue"]),LR]),v("div",{class:"mt-4 cursor-pointer",onClick:n[19]||(n[19]=i=>w(e).bluetooth.settings.invert=!w(e).bluetooth.settings.invert)},[v("div",RR,[IR,P(wa,{class:"pointer-events-none",modelValue:w(e).bluetooth.settings.invert,"onUpdate:modelValue":n[18]||(n[18]=i=>w(e).bluetooth.settings.invert=i)},null,8,["modelValue"])]),DR])])]),_:1},512),[[Kt,w(e).bluetooth.connected]])])):w(e).ui.page===w(Jt).Osr?(x(),T("div",PR,[P(Xe,{icon:"chevron-left",onClick:n[20]||(n[20]=i=>w(e).ui.page=w(Jt).Start)}),v("div",FR,[v("div",OR,[P(Re,{name:"usb-port",class:"h-16 w-16"}),MR]),$R,w(e).osr.error?(x(),T("div",NR,[W(" Your browser does not support Web Serial, please use "),VR])):(x(),T(_e,{key:0},[w(e).osr.connected?(x(),ae(Me,{key:1,class:"w-full",onClick:n[22]||(n[22]=i=>w(e).osr.disconnect())},{default:z(()=>[W("Disconnect")]),_:1})):(x(),ae(Me,{key:0,loading:w(e).osr.scanning,class:"w-full",theme:"blue",onClick:n[21]||(n[21]=i=>w(e).osr.connect())},{default:z(()=>[W(" Connect ")]),_:1},8,["loading"]))],64))]),ht(P(ba,{title:"Settings",icon:"cog"},{default:z(()=>[v("div",BR,[v("div",UR,[v("div",HR,[v("p",GR,[W(" Stroke "),v("span",zR,Z(w(e).osr.settings.limits[0])+"-"+Z(w(e).osr.settings.limits[1]),1)]),ht(v("button",{onClick:n[23]||(n[23]=i=>w(e).osr.settings.limits=[0,100]),class:"text-zinc-500 text-sm hover:text-white"},"Reset ",512),[[Kt,w(e).osr.settings.limits[0]!==0||w(e).osr.settings.limits[1]!==100]])]),P(dr,{modelValue:w(e).osr.settings.limits,"onUpdate:modelValue":n[24]||(n[24]=i=>w(e).osr.settings.limits=i),min:0,max:100,tooltips:!0,values:[0,25,50,75,100],class:"mt-1.5 mb-8"},null,8,["modelValue"]),jR]),v("div",{class:"mt-4 cursor-pointer",onClick:n[26]||(n[26]=i=>w(e).osr.settings.invert=!w(e).osr.settings.invert)},[v("div",qR,[KR,P(wa,{class:"pointer-events-none",modelValue:w(e).osr.settings.invert,"onUpdate:modelValue":n[25]||(n[25]=i=>w(e).osr.settings.invert=i)},null,8,["modelValue"])]),WR])])]),_:1},512),[[Kt,w(e).osr.connected]])])):w(e).ui.page===w(Jt).Intiface?(x(),T("div",YR,[P(Xe,{icon:"chevron-left",onClick:n[27]||(n[27]=i=>w(e).ui.page=w(Jt).Start)}),v("div",ZR,[v("div",XR,[P(Re,{name:"intiface",class:"h-16 w-16"}),QR]),JR,v("div",e8,[w(e).intiface.error?(x(),T("p",t8,Z(w(e).intiface.error),1)):w(e).intiface.connected?(x(),T("p",s8,"Connected")):pe("",!0)]),P(hs,{type:"text",modelValue:w(e).intiface.address,"onUpdate:modelValue":n[28]||(n[28]=i=>w(e).intiface.address=i),disabled:w(e).intiface.connected,class:"text-center w-full",placeholder:"Enter Intiface address"},null,8,["modelValue","disabled"]),w(e).intiface.connected?(x(),ae(Me,{key:1,onClick:n[30]||(n[30]=i=>w(e).intiface.disconnect()),class:"w-full"},{default:z(()=>[W("Disconnect")]),_:1})):(x(),ae(Me,{key:0,onClick:n[29]||(n[29]=i=>w(e).intiface.connect()),theme:"blue",loading:w(e).intiface.scanning,disabled:w(e).intiface.address.length<1||w(e).intiface.scanning,class:"w-full"},{default:z(()=>[W("Connect ")]),_:1},8,["loading","disabled"]))]),ht(P(ba,{title:"Settings",icon:"cog"},{default:z(()=>[v("div",n8,[v("div",i8,[v("div",r8,[v("p",o8,[W(" Stroke "),v("span",a8,Z(w(e).intiface.settings.limits[0])+"-"+Z(w(e).intiface.settings.limits[1]),1)]),ht(v("button",{onClick:n[31]||(n[31]=i=>w(e).intiface.settings.limits=[0,100]),class:"text-zinc-500 text-sm hover:text-white"},"Reset ",512),[[Kt,w(e).intiface.settings.limits[0]!==0||w(e).intiface.settings.limits[1]!==100]])]),P(dr,{modelValue:w(e).intiface.settings.limits,"onUpdate:modelValue":n[32]||(n[32]=i=>w(e).intiface.settings.limits=i),min:0,max:100,tooltips:!0,values:[0,25,50,75,100],class:"mt-1.5 mb-8"},null,8,["modelValue"]),l8]),v("div",{class:"mt-4 cursor-pointer",onClick:n[34]||(n[34]=i=>w(e).intiface.settings.invert=!w(e).intiface.settings.invert)},[v("div",c8,[u8,P(wa,{class:"pointer-events-none",modelValue:w(e).intiface.settings.invert,"onUpdate:modelValue":n[33]||(n[33]=i=>w(e).intiface.settings.invert=i)},null,8,["modelValue"])]),d8])])]),_:1},512),[[Kt,w(e).intiface.connected]])])):w(e).ui.page===w(Jt).Loob?(x(),T("div",f8,[P(Xe,{icon:"chevron-left",onClick:n[35]||(n[35]=i=>w(e).ui.page=w(Jt).Start)}),v("div",h8,[v("div",p8,[P(Re,{name:"loob",class:"h-16"})]),g8,v("div",m8,[w(e).loob.error?(x(),T("p",v8,Z(w(e).loob.error),1)):w(e).loob.connected?(x(),T("p",_8,"Connected")):pe("",!0)]),w(e).loob.connected?(x(),ae(Me,{key:1,onClick:n[37]||(n[37]=i=>w(e).loob.disconnect()),class:"w-full"},{default:z(()=>[W("Disconnect")]),_:1})):(x(),ae(Me,{key:0,onClick:n[36]||(n[36]=i=>w(e).loob.connect()),theme:"blue",loading:w(e).loob.scanning,disabled:w(e).loob.scanning,class:"w-full"},{default:z(()=>[W("Connect ")]),_:1},8,["loading","disabled"]))]),ht(P(ba,{title:"Settings",icon:"cog"},{default:z(()=>[v("div",y8,[v("div",null,[v("div",x8,[v("p",b8,[W(" Stroke "),v("span",w8,Z(w(e).loob.settings.limits[0])+"-"+Z(w(e).loob.settings.limits[1]),1)]),ht(v("button",{onClick:n[38]||(n[38]=i=>w(e).loob.settings.limits=[0,100]),class:"text-zinc-500 text-sm hover:text-white"},"Reset ",512),[[Kt,w(e).loob.settings.limits[0]!==0||w(e).loob.settings.limits[1]!==100]])]),P(dr,{modelValue:w(e).loob.settings.limits,"onUpdate:modelValue":n[39]||(n[39]=i=>w(e).loob.settings.limits=i),min:0,max:100,tooltips:!0,values:[0,25,50,75,100],class:"mt-1.5 mb-8"},null,8,["modelValue"]),S8])])]),_:1},512),[[Kt,w(e).loob.connected]])])):pe("",!0)]),_:1})]))}});var ip;const ea=typeof window<"u",rp=s=>typeof s=="function",sv=s=>typeof s=="string",nv=()=>{},T8=ea&&((ip=window==null?void 0:window.navigator)==null?void 0:ip.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function iv(s){return typeof s=="function"?s():w(s)}function C8(s){return s}function rv(s){return Od()?(U1(s),!0):!1}function A8(s){return typeof s=="function"?ut(s):ue(s)}function k8(s,e=!0){Ql()?Xt(s):e?s():so(s)}function Tr(s){var e;const t=iv(s);return(e=t==null?void 0:t.$el)!=null?e:t}const kf=ea?window:void 0,L8=ea?window.document:void 0;ea&&window.navigator;ea&&window.location;function jc(...s){let e,t,n,i;if(sv(s[0])||Array.isArray(s[0])?([t,n,i]=s,e=kf):[e,t,n,i]=s,!e)return nv;Array.isArray(t)||(t=[t]),Array.isArray(n)||(n=[n]);const r=[],o=()=>{r.forEach(u=>u()),r.length=0},a=(u,d,f,h)=>(u.addEventListener(d,f,h),()=>u.removeEventListener(d,f,h)),l=dt(()=>[Tr(e),iv(i)],([u,d])=>{o(),u&&r.push(...t.flatMap(f=>n.map(h=>a(u,f,h,d))))},{immediate:!0,flush:"post"}),c=()=>{l(),o()};return rv(c),c}let op=!1;function R8(s,e,t={}){const{window:n=kf,ignore:i=[],capture:r=!0,detectIframe:o=!1}=t;if(!n)return;T8&&!op&&(op=!0,Array.from(n.document.body.children).forEach(f=>f.addEventListener("click",nv)));let a=!0;const l=f=>i.some(h=>{if(typeof h=="string")return Array.from(n.document.querySelectorAll(h)).some(p=>p===f.target||f.composedPath().includes(p));{const p=Tr(h);return p&&(f.target===p||f.composedPath().includes(p))}}),u=[jc(n,"click",f=>{const h=Tr(s);if(!(!h||h===f.target||f.composedPath().includes(h))){if(f.detail===0&&(a=!l(f)),!a){a=!0;return}e(f)}},{passive:!0,capture:r}),jc(n,"pointerdown",f=>{const h=Tr(s);h&&(a=!f.composedPath().includes(h)&&!l(f))},{passive:!0}),o&&jc(n,"blur",f=>{var h;const p=Tr(s);((h=n.document.activeElement)==null?void 0:h.tagName)==="IFRAME"&&!(p!=null&&p.contains(n.document.activeElement))&&e(f)})].filter(Boolean);return()=>u.forEach(f=>f())}function I8(s,e=!1){const t=ue(),n=()=>t.value=Boolean(s());return n(),k8(n,e),t}const cd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ud="__vueuse_ssr_handlers__";cd[ud]=cd[ud]||{};cd[ud];var ap=Object.getOwnPropertySymbols,D8=Object.prototype.hasOwnProperty,P8=Object.prototype.propertyIsEnumerable,F8=(s,e)=>{var t={};for(var n in s)D8.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&ap)for(var n of ap(s))e.indexOf(n)<0&&P8.call(s,n)&&(t[n]=s[n]);return t};function O8(s,e,t={}){const n=t,{window:i=kf}=n,r=F8(n,["window"]);let o;const a=I8(()=>i&&"MutationObserver"in i),l=()=>{o&&(o.disconnect(),o=void 0)},c=dt(()=>Tr(s),d=>{l(),a.value&&i&&d&&(o=new MutationObserver(e),o.observe(d,r))},{immediate:!0}),u=()=>{l(),c()};return rv(u),{isSupported:a,stop:u}}var lp;(function(s){s.UP="UP",s.RIGHT="RIGHT",s.DOWN="DOWN",s.LEFT="LEFT",s.NONE="NONE"})(lp||(lp={}));function Ds(s=null,e={}){var t,n;const{document:i=L8}=e,r=A8((t=s!=null?s:i==null?void 0:i.title)!=null?t:null),o=s&&rp(s);function a(l){if(!("titleTemplate"in e))return l;const c=e.titleTemplate||"%s";return rp(c)?c(l):w(c).replace(/%s/g,l)}return dt(r,(l,c)=>{l!==c&&i&&(i.title=a(sv(l)?l:""))},{immediate:!0}),e.observe&&!e.titleTemplate&&i&&!o&&O8((n=i.head)==null?void 0:n.querySelector("title"),()=>{i&&i.title!==r.value&&(r.value=a(i.title))},{childList:!0}),r}var M8=Object.defineProperty,cp=Object.getOwnPropertySymbols,$8=Object.prototype.hasOwnProperty,N8=Object.prototype.propertyIsEnumerable,up=(s,e,t)=>e in s?M8(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,V8=(s,e)=>{for(var t in e||(e={}))$8.call(e,t)&&up(s,t,e[t]);if(cp)for(var t of cp(e))N8.call(e,t)&&up(s,t,e[t]);return s};const B8={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};V8({linear:C8},B8);const U8=De({__name:"Search",setup(s){const e=kn(),t=ue(!1),n=ue(""),i=ue(null),r=ue();R8(i,()=>t.value=!1);const o=()=>{var a;!n.value.length||(t.value=!1,e.push({path:"/videos",query:{q:n.value}}),(a=r.value)==null||a.blur())};return dt(()=>t.value,()=>{t.value&&requestAnimationFrame(()=>{var a;return(a=r.value)==null?void 0:a.focus()})}),dt(()=>e.currentRoute.value,a=>{a.name!=="videos"&&(n.value="")}),(a,l)=>(x(),T("form",{ref_key:"el",ref:i,onSubmit:Is(o,["prevent"]),onClick:l[1]||(l[1]=c=>t.value=!0),class:Je(["flex gap-3 p-1 rounded-md border-2 border-transparent bg-zinc-800",{"!border-blue-500":t.value}])},[P(Re,{name:"search",class:"h-6 w-6 text-zinc-300"}),ht(v("input",{ref_key:"input",ref:r,type:"search","onUpdate:modelValue":l[0]||(l[0]=c=>n.value=c),placeholder:"Find thousands of videos...",class:"flex-1 bg-transparent focus-visible:outline-none"},null,512),[[sf,n.value]])],34))}}),H8={class:"flex justify-between"},G8=v("img",{src:um,class:"h-6"},null,-1),z8={class:"flex flex-col gap-2.5 mt-3"},j8=v("hr",{class:"my-2 border-zinc-800"},null,-1),q8=v("hr",{class:"my-2 border-zinc-800"},null,-1),K8=v("p",null,"Orientation",-1),W8=De({__name:"Sidebar",setup(s){const e=ue(!1),t=kn(),n=[{name:"Home",path:"/",routes:[]},{name:"Videos",path:"/videos",routes:["videos","watch"]},{name:"Creators",path:"/creators",routes:["creators","user"]},{name:"Performers",path:"/performers",routes:["performers","performer"]},{name:"Tags",path:"/tags",routes:["tags","tag"]}];dt(()=>e.value,o=>{const a="overflow-hidden",l=document.querySelector("html");o?l.classList.add(a):l.classList.remove(a)}),dt(()=>t.currentRoute.value.path,()=>{e.value=!1});const i=vs(),{authDialog:r}=Gt(jn());return(o,a)=>{const l=Es("router-link");return x(),T("div",null,[v("button",{class:"p-2",onClick:a[0]||(a[0]=c=>e.value=!0)},[P(Re,{name:"burger",class:"h-8 w-8"})]),e.value?(x(),T("div",{key:0,class:"fixed inset-0 bg-black/60 z-40",onClick:a[1]||(a[1]=c=>e.value=!1)})):pe("",!0),v("div",{class:Je(["w-[85vw] h-screen bg-zinc-900 fixed inset-0 z-50 p-4 transition-transform",{"translate-x-[-85vw]":!e.value}])},[v("div",H8,[G8,v("button",{onClick:a[2]||(a[2]=c=>e.value=!1)},[P(Re,{name:"close",class:"h-7 w-7"})])]),v("div",z8,[(x(),T(_e,null,st(n,c=>P(l,{to:c.path,onClick:a[3]||(a[3]=u=>e.value=!1),class:"bg-zinc-800/50 rounded-lg p-3"},{default:z(()=>[W(Z(c.name),1)]),_:2},1032,["to"])),64)),w(i).isAuthorized?pe("",!0):(x(),T(_e,{key:0},[j8,v("button",{class:"bg-blue-500 rounded-lg p-3",onClick:a[4]||(a[4]=c=>r.value=!0)}," Sign Up / Log In "),q8,K8,v("button",{onClick:a[5]||(a[5]=c=>w(i).setOrientation(w(pt).Straight)),class:Je(["bg-zinc-800 rounded-lg p-3",{"bg-blue-500":w(i).getOrientation()===w(pt).Straight}])}," Straight ",2),v("button",{onClick:a[6]||(a[6]=c=>w(i).setOrientation(w(pt).Transgender)),class:Je(["bg-zinc-800 rounded-lg p-3",{"bg-blue-500":w(i).getOrientation()===w(pt).Transgender}])}," Transgender ",2),v("button",{onClick:a[7]||(a[7]=c=>w(i).setOrientation(w(pt).Gay)),class:Je(["bg-zinc-800 rounded-lg p-3",{"bg-blue-500":w(i).getOrientation()===w(pt).Gay}])}," Gay ",2),v("button",{onClick:a[8]||(a[8]=c=>w(i).setOrientation(null)),class:Je(["bg-zinc-800 rounded-lg p-3",{"bg-blue-500":w(i).getOrientation()===void 0}])}," None ",2)],64)),w(i).isAuthorized?(x(),ae(Zm,{key:1})):pe("",!0)])],2)])}}}),Y8={class:"bg-zinc-700 h-8 rounded flex items-center px-3 flex-1 mr-3 gap-3"},Z8={key:0,class:"text-white"},X8=De({__name:"MobileSearch",setup(s){const e=ue(""),t=ue(!1),n=kn(),i=ue(),r=()=>{!e.value.length||(n.push({path:"/videos",query:{q:e.value}}),t.value=!1)};return dt(()=>t.value,o=>{const a="overflow-hidden",l=document.querySelector("html");o?(l.classList.add(a),requestAnimationFrame(()=>{var c;return(c=i.value)==null?void 0:c.focus()})):l.classList.remove(a)}),(o,a)=>(x(),T("div",null,[v("button",{class:"p-1",onClick:a[0]||(a[0]=l=>t.value=!0)},[P(Re,{name:"search",class:"h-7 w-7"})]),t.value?(x(),T("div",{key:0,class:"fixed inset-0 flex flex-col bg-black/50 z-50 text-white",onClick:a[5]||(a[5]=l=>t.value=!1)},[v("div",{class:"bg-zinc-850 flex items-center bg-zinc-900 py-0.5",onClick:a[4]||(a[4]=Is(()=>{},["stop"]))},[v("button",{class:"p-3",onClick:a[1]||(a[1]=l=>t.value=!1)},[P(Re,{name:"arrow-left",class:"h-6 w-6"})]),v("div",Y8,[v("form",{onSubmit:Is(r,["prevent"]),class:"flex-1"},[ht(v("input",{"onUpdate:modelValue":a[2]||(a[2]=l=>e.value=l),ref_key:"input",ref:i,placeholder:"Search FapTap",type:"search",class:"focus-visible:outline-none bg-transparent w-full text-lg"},null,512),[[sf,e.value]])],32),e.value.length?(x(),T("button",Z8,[P(Re,{onClick:a[3]||(a[3]=l=>{e.value="",i.value.focus()}),name:"close",class:"h-6 w-6"})])):pe("",!0)])])])):pe("",!0)]))}}),Si=De({__name:"Scroller",props:{gap:{}},setup(s){const e=ue(),t=ue(),n=ue({left:!1,right:!1}),i=()=>{if(!t.value||!e.value)return;const o=e.value.offsetWidth,a=t.value.scrollWidth,l=t.value.scrollLeft;n.value.right=a>o&&t.value.offsetWidth+l<a,n.value.left=l>0},r=o=>{let a=t.value.offsetWidth;o==="left"&&(a*=-1),t.value.scroll({left:t.value.scrollLeft+a,behavior:"smooth"})};return Xt(()=>{t.value.addEventListener("scroll",i),new ResizeObserver(i).observe(t.value),new MutationObserver(i).observe(t.value,{childList:!0,subtree:!0})}),(o,a)=>(x(),T("div",{class:"relative",ref_key:"root",ref:e},[ht(v("button",{onClick:a[0]||(a[0]=l=>r("left")),class:"hidden lg:block absolute p-1 rounded-full bg-zinc-800 z-20 -left-5 top-1/2 -translate-y-1/2 shadow-lg active:scale-[0.98] transition-transform hover:bg-zinc-700"},[P(Re,{name:"chevron-left",class:"h-8 w-8"})],512),[[Kt,n.value.left]]),v("div",{class:"scroller",ref_key:"container",ref:t},[v("div",{class:Je(["scroller-content flex min-w-min shrink-0",o.gap])},[nr(o.$slots,"default")],2)],512),ht(v("button",{onClick:a[1]||(a[1]=l=>r("right")),class:"hidden lg:block absolute p-1 rounded-full bg-zinc-800 z-20 -right-5 top-1/2 -translate-y-1/2 shadow-lg active:scale-[0.98] transition-transform hover:bg-zinc-700"},[P(Re,{name:"chevron-right",class:"h-8 w-8"})],512),[[Kt,n.value.right]])],512))}});const Q8={viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},J8={fill:"currentColor"},e6=v("animate",{attributeName:"d",dur:"1s",values:"M12 5.5C12 3.567 10.433 2 8.5 2C6.567 2 5 3.567 5 5.5H12ZM5 18.5C5 20.433 6.567 22 8.5 22C10.433 22 12 20.433 12 18.5H5ZM20 13.5C20 11.567 18.433 10 16.5 10C14.567 10 13 11.567 13 13.5H20ZM13 18.5V22H20V18.5H13ZM5 5.5V18.5H12V5.5H5ZM13 13.5V18.5H20V13.5H13Z; M12 13.5C12 11.567 10.433 10 8.5 10C6.567 10 5 11.567 5 13.5H12ZM5 18.5C5 20.433 6.567 22 8.5 22C10.433 22 12 20.433 12 18.5H5ZM20 5.5C20 3.567 18.433 2 16.5 2C14.567 2 13 3.567 13 5.5H20ZM13 18.5V22H20V18.5H13ZM5 13.5V18.5H12V13.5H5ZM13 5.5V18.5H20V5.5H13Z; M12 5.5C12 3.567 10.433 2 8.5 2C6.567 2 5 3.567 5 5.5H12ZM5 18.5C5 20.433 6.567 22 8.5 22C10.433 22 12 20.433 12 18.5H5ZM20 13.5C20 11.567 18.433 10 16.5 10C14.567 10 13 11.567 13 13.5H20ZM13 18.5V22H20V18.5H13ZM5 5.5V18.5H12V5.5H5ZM13 13.5V18.5H20V13.5H13Z",repeatCount:"indefinite",calcMode:"spline",keySplines:"0.65 0.05 0.03 1;0.65 0.05 0.03 1"},null,-1),t6=[e6],s6={fill:"currentColor",d:"M12 5.5C12 3.567 10.433 2 8.5 2C6.567 2 5 3.567 5 5.5H12ZM5 18.5C5 20.433 6.567 22 8.5 22C10.433 22 12 20.433 12 18.5H5ZM20 13.5C20 11.567 18.433 10 16.5 10C14.567 10 13 11.567 13 13.5H20ZM13 18.5V22H20V18.5H13ZM5 5.5V18.5H12V5.5H5ZM13 13.5V18.5H20V13.5H13Z"},Za=De({__name:"HandyLogo",props:{loading:{type:Boolean}},setup(s){return(e,t)=>(x(),T("svg",Q8,[ht(v("path",J8,t6,512),[[Kt,e.loading]]),ht(v("path",s6,null,512),[[Kt,!e.loading]])]))}}),n6={class:"flex items-center lg:gap-8 border-b border-zinc-800 px-2 lg:px-8 py-0.5 lg:py-0"},i6={class:"flex items-center"},r6=v("img",{src:um,class:"h-7"},null,-1),o6={class:"absolute w-full bottom-0 left-0 h-[3px] bg-blue-500"},a6={class:"flex justify-end gap-x-2 items-center z-10 flex-1"},l6={class:"hidden lg:block"},c6={class:"py-1.5"},u6={class:"hidden md:flex gap-x-2"},d6={href:"https://discord.gg/rTk6ehTnRT"},f6={href:"https://twitter.com/faptapnet"},h6={key:1,class:"hidden lg:block"},p6=De({__name:"Header",setup(s){const{isMobile:e}=Ai(),{authDialog:t}=Gt(jn()),{devices:n,ui:i,connecting:r}=Gt(or()),{user:o,isAuthorized:a}=Gt(vs());kn();const l=Xi(),c=vs();ue(!1);const u=ue(!1),d=[{name:"Home",path:"/",routes:[]},{name:"Videos",path:"/videos",routes:["videos","watch"]},{name:"Tags",path:"/tags",routes:["tags","tag"]},{name:"Creators",path:"/creators",routes:["creators","user"]}],f=ut(()=>{const h=d.find(p=>p.routes.includes(l.name));return h||d.find(p=>!p.routes.length)});return(h,p)=>{var m,_;const g=Es("router-link");return x(),T("div",n6,[P(W8,{class:"lg:hidden -ml-2"}),v("div",i6,[P(g,{to:"/",class:"items-center inline-block shrink-0"},{default:z(()=>[r6]),_:1})]),P(U8,{class:"hidden lg:flex lg:w-80"}),P(Si,{gap:"gap-8",class:"text-zinc-300 hidden lg:flex"},{default:z(()=>[(x(),T(_e,null,st(d,y=>P(g,{to:y.path,class:"h-16 block relative flex items-center justify-center group"},{default:z(()=>[v("span",{class:Je(["group-hover:text-blue-500",f.value===y?"text-white":"text-zinc-400"])},Z(y.name),3),ht(v("div",o6,null,512),[[Kt,f.value===y]])]),_:2},1032,["to"])),64))]),_:1}),v("div",a6,[w(a)?(x(),T("div",h6,[P(Zm)])):(x(),T(_e,{key:0},[v("div",l6,[P(Me,{ref:"orientation",onClick:p[0]||(p[0]=y=>u.value=!u.value),theme:"transparent",class:"flex gap-1.5 items-center"},{default:z(()=>[P(Re,{class:"h-5 w-5",name:w(c).getOrientationIcon()},null,8,["name"]),v("span",null,Z(w(c).getOrientation()>=0?w(pt)[w(c).getOrientation()]:"None"),1)]),_:1},512),P(on,{modelValue:u.value,"onUpdate:modelValue":p[5]||(p[5]=y=>u.value=y),target:(m=h.$refs.orientation)==null?void 0:m.$el,offset:8},{default:z(()=>[v("div",c6,[P(Xe,{active:w(c).getOrientation()===void 0,icon:"close",onClick:p[1]||(p[1]=y=>w(c).setOrientation(null))},{default:z(()=>[W(" All Videos ")]),_:1},8,["active"]),P(Xe,{active:w(c).getOrientation()===w(pt).Straight,icon:"orientation-straight",onClick:p[2]||(p[2]=y=>w(c).setOrientation(w(pt).Straight))},{default:z(()=>[W(" Straight ")]),_:1},8,["active"]),P(Xe,{active:w(c).getOrientation()===w(pt).Transgender,icon:"orientation-transgender",onClick:p[3]||(p[3]=y=>w(c).setOrientation(w(pt).Transgender))},{default:z(()=>[W(" Transgender ")]),_:1},8,["active"]),P(Xe,{active:w(c).getOrientation()===w(pt).Gay,icon:"orientation-gay",onClick:p[4]||(p[4]=y=>w(c).setOrientation(w(pt).Gay))},{default:z(()=>[W(" Gay ")]),_:1},8,["active"])])]),_:1},8,["modelValue","target"])]),v("div",u6,[v("a",d6,[P(Re,{class:"h-5 w-5",name:"discord"})]),v("a",f6,[P(Re,{class:"h-5 w-5",name:"twitter"})])]),P(Me,{class:"hidden md:block shrink-0",onClick:p[6]||(p[6]=y=>t.value=!0)},{default:z(()=>[W(" Log In ")]),_:1})],64)),P(X8,{class:"lg:hidden"}),P(Me,{ref:"el",class:"flex items-center gap-x-1.5 shrink-0",theme:w(n).length?"green":"blue",onClick:p[7]||(p[7]=y=>w(i).open=!w(i).open)},{default:z(()=>[P(Za,{loading:w(r),class:"h-5 w-5 text-white mx-auto"},null,8,["loading"]),v("span",null,Z(w(n).length?"Connected":"Connect"),1)]),_:1},8,["theme"]),(x(),ae(vn(w(e)?$n:on),{placement:"bottom-end",modelValue:w(i).open,"onUpdate:modelValue":p[8]||(p[8]=y=>w(i).open=y),target:(_=h.$refs.el)==null?void 0:_.$el,offset:8,class:"py-1"},{default:z(()=>[P(E8)]),_:1},8,["modelValue","target"]))])])}}}),g6=["data-ph-capture-attribute-affiliate"],m6={class:"h-full w-full transition-all group-hover:scale-[1.01] group-hover:brightness-[1.15]"},ov=De({__name:"Affiliate",props:{affiliate:{}},setup(s){const e=s,t=n=>{Object.assign(document.createElement("a"),{target:"_blank",rel:"noopener noreferrer",href:n}).click()};return(n,i)=>{const r=ql("lazy");return x(),T("div",{onClick:i[0]||(i[0]=o=>t(e.affiliate.url)),class:"group block bg-zinc-800 cursor-pointer",rel:"nofollow","data-ph-capture-attribute-affiliate":e.affiliate.image},[ht(v("img",m6,null,512),[[r,e.affiliate.image]])],8,g6)}}}),qc=[{url:"https://www.sexlikereal.com/tags/sex-toy-scripts-vr?a=63e4b20bb7a0b71d6e675d47",image:"/affiliates/sexlikereal.4.jpg"},{url:"https://www.g2fame.com/adulttime/go.php?pr=8&su=1&si=247&ad=280096&cl=/toys&ar=&campaign=457485&buffer=",image:"/affiliates/adulttime.3.jpg"},{url:"https://www.thehandy.com/store/?ref=faptap&utm_source=faptap&utm_medium=affiliate&utm_campaign=The+Handy+Affiliate+program",image:"/affiliates/handy.1.jpg"},{url:"https://natour.naughtyamerica.com/track/MTIyOTQ4LjEwMDM2LjguMzgyLjAuMC4wLjAuMA/dream-lover/theHandy",image:"/affiliates/naughtyamerica.2.jpg"},{url:"https://enter.tonightsgirlfriend.com/track/MTIyOTQ4LjEwMDM2LjU4LjgwLjAuMC4wLjAuMA/scenes/handy/?apc=MTk5NTI5OTU",image:"/affiliates/tonights.girlfriend.1.jpg"},{url:"https://affiliate.segpay.com/epb4l.php/?inact=70988&inoid=jog50:70762&intrk=subtracking",image:"/affiliates/thejerkoffmembers.1.jpg"}];function av(){return{random:()=>qc[Math.floor(Math.random()*qc.length)],affiliates:qc}}const v6={class:"bg-zinc-900 max-w-[1570px] mx-auto flex flex-col min-h-screen relative"},_6={class:"py-2 lg:py-8 lg:px-8 flex-1 flex flex-col relative"},y6={class:"flex-1"},x6={key:0,class:"mb-8"},b6={class:"absolute inset-0 flex justify-center items-center"},w6={key:0},S6={key:1},E6={class:"px-2 lg:px-0 flex-col lg:flex-row items-center lg:items-start gap-4 mt-8 text-sm leading-none text-zinc-500 flex justify-between"},T6=Yo('<div class="flex gap-3"><a href="https://discord.gg/rTk6ehTnRT" rel="nofollow" class="hover:text-blue-500">Discord</a><a href="https://theporndude.com/" rel="nofollow" class="hover:text-blue-500">ThePornDude</a><a href="mailto:dmca@faptap.net" class="hover:text-blue-500">DMCA</a><a href="mailto:contact@faptap.net" class="hover:text-blue-500">Contact</a></div>',1),C6=De({__name:"App",setup(s){const{authDialog:e}=Gt(jn());vs();const{isMobile:t}=Ai(),n=kn(),{affiliates:i}=av(),r=ut(()=>t?n.currentRoute.value.name==="home":!0);return(o,a)=>{const l=Es("RouterView");return x(),T(_e,null,[v("div",v6,[P(p6,{class:"z-50 sticky top-0 bg-zinc-900"}),v("div",_6,[v("div",y6,[r.value?(x(),T("div",x6,[P(Si,{gap:"gap-2 lg:gap-4"},{default:z(()=>[(x(!0),T(_e,null,st(w(i),c=>(x(),ae(ov,{class:"aspect-video rounded-md overflow-hidden h-40 group flex items-center justify-center bg-zinc-800 shadow",affiliate:c},null,8,["affiliate"]))),256))]),_:1})])):pe("",!0),P(l,null,{default:z(({Component:c})=>[c?(x(),ae(Wy,{key:0,max:"3",exclude:"watch"},[(x(),ae(Fy,{timeout:"0"},{fallback:z(()=>[v("div",b6,[P(Re,{name:"loading",class:"h-10 w-10 text-blue-500 animate-spin"})])]),default:z(()=>[(x(),ae(vn(c),{key:w(n).currentRoute.value.path}))]),_:2},1024))],1024)):pe("",!0)]),_:1})]),w(t)?(x(),T("div",w6)):(x(),T("div",S6)),v("div",E6,[v("span",null,"\xA9 "+Z(new Date().getFullYear())+" FapTap",1),T6])])]),w(t)?(x(),ae($n,{key:0,modelValue:w(e),"onUpdate:modelValue":a[0]||(a[0]=c=>It(e)?e.value=c:null)},{default:z(()=>[P(h0)]),_:1},8,["modelValue"])):(x(),ae(oc,{key:1,modelValue:w(e),"onUpdate:modelValue":a[1]||(a[1]=c=>It(e)?e.value=c:null)},{default:z(()=>[P(h0,{class:"-m-4 -mt-12"})]),_:1},8,["modelValue"]))],64)}}}),A6="modulepreload",k6=function(s){return"/"+s},dp={},ta=function(e,t,n){if(!t||t.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(t.map(r=>{if(r=k6(r),r in dp)return;dp[r]=!0;const o=r.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!n)for(let u=i.length-1;u>=0;u--){const d=i[u];if(d.href===r&&(!o||d.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${a}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":A6,o||(c.as="script",c.crossOrigin=""),c.href=r,document.head.appendChild(c),o)return new Promise((u,d)=>{c.addEventListener("load",u),c.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>e())},Cr=s=>new Date(s*1e3).toISOString().slice(s<3600?14:11,19),lv=s=>{const e=new Date,t=Math.floor((e.getTime()-s.getTime())/1e3);let n=t/31536e3;if(n>1){const i=Math.floor(n);return`${i} year${i>1?"s":""}`}if(n=t/2592e3,n>1){const i=Math.floor(n);return`${i} month${i>1?"s":""}`}if(n=t/86400,n>1){const i=Math.floor(n);return`${i} day${i>1?"s":""}`}if(n=t/3600,n>1){const i=Math.floor(n);return`${i} hour${i>1?"s":""}`}if(n=t/60,n>1){const i=Math.floor(n);return`${i} minute${i>1?"s":""}`}return"a few seconds"},L6=lc("preview",()=>{const s=ue(),e=kn();return dt(()=>e.currentRoute.value,()=>s.value=void 0),{activeItem:s}}),_i=(s,e=1)=>{const t=[{value:1,symbol:""},{value:1e3,symbol:"k"},{value:1e6,symbol:"M"}],n=/\.0+$|(\.[0-9]*[1-9])0+$/,i=t.slice().reverse().find(function(r){return s>=r.value});return i?(s/i.value).toFixed(e).replace(n,"$1")+i.symbol:"0"},R6=["poster","src"],I6={class:"h-full w-full object-cover"},D6={class:"absolute bottom-1.5 right-1.5 flex gap-1.5"},P6={key:0,class:"bg-black/90 rounded px-2 backdrop-blur py-0.5 font-medium text-sm lg:text-xs"},F6=v("span",null,"VR",-1),O6=[F6],M6={class:"bg-black/90 rounded px-2 backdrop-blur py-0.5 font-medium text-sm lg:text-xs"},$6={class:"py-1 px-2 md:px-0"},N6={class:"flex gap-1.5 text-zinc-400 md:text-sm"},V6={class:"flex-1 justify-end shrink-0 flex gap-1.5"},B6={class:"flex gap-x-0.5 items-center"},U6={class:"flex gap-x-0.5 items-center"},H6={class:"flex gap-x-0.5 items-center"},dd=De({__name:"VideosItem",props:{video:{},rounded:{type:Boolean}},setup(s){const{activeItem:e}=Gt(L6()),t=s,n=Math.random();let i;const r=()=>{i=window.setTimeout(()=>{e.value=t.video.id+n},100)},o=()=>{window.clearTimeout(i),e.value=void 0},a=ut(()=>e.value===t.video.id+n);return Ci(()=>window.clearTimeout(i)),(l,c)=>{const u=Es("router-link"),d=ql("lazy");return t.video?(x(),T("div",{key:0,onTouchstartPassive:c[1]||(c[1]=f=>e.value=t.video.id+w(n)),class:"text-white overflow-hidden"},[P(u,{to:`/v/${t.video.id}`,onMouseenter:r,onMouseleave:o,class:Je(["block aspect-video w-full bg-zinc-800 relative transition-all overflow-hidden lg:rounded-md",{"!bg-black":a.value,"!rounded-md":t.rounded}])},{default:z(()=>[t.video.preview_url&&a.value?(x(),T("video",{key:0,onCanplay:c[0]||(c[0]=f=>{var h;return(h=f.target)==null?void 0:h.play()}),poster:w(gi)(t.video.thumbnail_url),src:a.value?w(gi)(t.video.preview_url):"",autoplay:"",loop:"",playsinline:"",muted:"",class:"h-full w-full"},null,40,R6)):(x(),T(_e,{key:1},[ht(v("img",I6,null,512),[[d,w(gi)(t.video.thumbnail_url)]]),v("div",D6,[t.video.vr?(x(),T("div",P6,O6)):pe("",!0),v("div",M6,Z(w(Cr)(t.video.duration)),1)])],64))]),_:1},8,["to","class"]),v("div",$6,[v("div",N6,[P(u,{to:`/u/${t.video.user.username}`,class:"underline overflow-hidden overflow-ellipsis"},{default:z(()=>[W(Z(t.video.user.username),1)]),_:1},8,["to"]),v("div",V6,[v("span",B6,[P(Re,{name:"eye",class:"h-4 w-4"}),W(" "+Z(w(_i)(t.video.views)),1)]),v("span",U6,[P(Re,{name:"heart-outline",class:"h-4 w-4"}),W(" "+Z(t.video.rating.likes),1)]),v("span",H6,[P(Re,{name:"speedometer",class:"h-4 w-4"}),W(" "+Z(t.video.script.average_speed),1)])])]),P(u,{to:`/v/${t.video.id}`,class:"break-all line-clamp-1 text-lg md:text-base",title:t.video.name},{default:z(()=>[W(Z(t.video.name),1)]),_:1},8,["to","title"])])],32)):pe("",!0)}}}),cv=s=>s.replace(/\w\S*/g,e=>e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()),G6={key:0,class:"welcome-message"},z6=v("div",null,[v("b",{class:"welcome-message-header"},[W(" \u{1F44B} \xA0 Welcome to Faptap, the "),v("u",null,"biggest interactive porn site"),W(" in the world. ")]),W(" All of the videos here sync with any of 500 different toys, so you can feel porn instead of just watching it. Stop watching caveman porn and insert yourself into the action!"),v("br"),W(" Faptap is free, and the best male masturbators are just $100. That\u2019s two avocado toasts and a parking ticket you weren\u2019t going to pay anyway. Click any video to see how syncing works. ")],-1),j6=[z6],q6={class:"mb-8"},K6={key:0,class:"flex items-center text-white gap-x-2 mb-4"},W6={class:"px-2 lg:px-0 text-xl lg:text-2xl !leading-none font-medium"},Y6={class:"absolute inset-0 opacity-50 group-hover:opacity-25 -z-10"},Z6=v("span",{class:"drop-shadow"},"Random",-1),X6={class:"absolute inset-0 opacity-50 group-hover:opacity-25 -z-10"},Q6={class:"drop-shadow"},J6={key:2,class:"flex flex-wrap gap-1.5 mt-1.5 max-height-2tabs overflow-hidden"},eI={class:"drop-shadow truncate relative px-4 py-2"},tI={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-4"},sI=De({__name:"Home",async setup(s){let e,t;const{getOrientation:n}=vs(),i=([e,t]=js(()=>qe.feed.getFeed(n())),e=await e,t(),e),r=kn(),{isMobile:o}=Ai(),a=ue(!localStorage.getItem("hasVisited"));a.value&&localStorage.setItem("hasVisited","true");const l=async()=>{const c=await qe.videos.getVideo("random");r.push(`/v/${c.id}`)};return Ws(()=>Ds("FapTap | The Interactive Porn Experience")),(c,u)=>{const d=Es("router-link"),f=ql("lazy");return x(),T(_e,null,[a.value?(x(),T("div",G6,j6)):pe("",!0),(x(!0),T(_e,null,st(w(i),h=>(x(),T("div",q6,[h.title&&h.type!=="products"?(x(),T("div",K6,[v("h2",W6,Z(h.title),1)])):pe("",!0),h.type==="categories"?(x(),ae(Si,{key:1,gap:"gap-2 lg:gap-4"},{default:z(()=>[v("button",{onClick:l,class:"aspect-video rounded-md overflow-hidden h-24 group flex items-center justify-center font-bold text-2xl relative z-10 bg-zinc-800"},[ht(v("img",Y6,null,512),[[f,"/categories/random.jpg"]]),Z6]),(x(!0),T(_e,null,st(h.data,p=>(x(),ae(d,{to:`/videos?q=${p.name}`,class:"aspect-video rounded overflow-hidden h-24 group flex items-center justify-center font-bold text-2xl relative z-10 bg-zinc-800"},{default:z(()=>[ht(v("img",X6,null,512),[[f,p.image_url]]),v("span",Q6,Z(p.name),1)]),_:2},1032,["to"]))),256))]),_:2},1024)):pe("",!0),h.type==="tags"?(x(),T("div",J6,[(x(!0),T(_e,null,st(h.data,p=>(x(),ae(d,{to:`/t/${p.slug}`,class:"rounded-lg overflow-hidden group flex items-center justify-center font-bold text-1xl relative z-10 bg-zinc-800"},{default:z(()=>[v("span",eI,Z(w(cv)(p.name)),1)]),_:2},1032,["to"]))),256))])):h.type==="videos"?(x(),T(_e,{key:3},[w(o)?(x(),ae(Si,{key:0,gap:"gap-2 lg:gap-4"},{default:z(()=>[(x(!0),T(_e,null,st(h.data,p=>(x(),ae(dd,{class:"!w-80",rounded:!0,video:p},null,8,["video"]))),256))]),_:2},1024)):(x(),T("div",tI,[(x(!0),T(_e,null,st(h.data,p=>(x(),ae(dd,{video:p},null,8,["video"]))),256))]))],64)):pe("",!0)]))),256))],64)}}}),nI={class:"flex justify-between items-center"},iI={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-4 mt-2 relative"},rI={key:0},oI={class:"py-1 px-2 md:px-0"},aI={class:"flex gap-1.5 text-zinc-400 md:text-sm"},lI=v("span",{class:"underline overflow-hidden overflow-ellipsis"},"FapTap",-1),cI={class:"flex-1 justify-end shrink-0 flex gap-1.5"},uI={class:"flex gap-x-0.5 items-center"},dI={class:"flex gap-x-0.5 items-center"},fI={class:"flex gap-x-0.5 items-center"},hI=v("span",{class:"break-all line-clamp-1 text-lg md:text-base"},"Special Offer",-1),pI={key:0,class:"text-white font-medium px-2 lg:px-0"},gI={key:1,class:"py-12 flex justify-center items-center"},ar=De({__name:"VideosList",props:{user:{},performer:{},tag:{},video:{},subscriptions:{type:Boolean},likes:{type:Boolean},query:{},filters:{type:Boolean,default:!0}},async setup(s){let e,t;const n=s,{random:i}=av(),{isMobile:r}=Ai(),{user:o,getOrientation:a}=vs(),l=ue(!1),c=ue(!1),u=ue(!1),d=ue(!1),f=ue(),h=ue(1),p=ue(!1),g=Ps({ascending:!1,order:Zs.relevance,orderFilters:{Relevance:Zs.relevance,Views:Zs.views,Likes:Zs.likes,Duration:Zs.duration,Speed:Zs.speed,"Upload date":Zs.creation},fromFilters:{Anytime:void 0,"This week":Mi.week,"This month":Mi.month,"This year":Mi.year},sourceViewsFilters:{"Source | This week":Mi.week,"Source | This month":Mi.month,"Source | This year":Mi.year},durationFilters:{All:void 0,"Short videos (1-5min)":Va.short,"Medium videos (5-10min)":Va.medium,"Long videos (+10min)":Va.long},speedFilters:{All:void 0,"Slow (0-150)":po.slow,"Medium (151-300)":po.medium,"Fast (301-500)":po.fast,"Very fast (500+)":po.veryfast},source:!1});let m=!1;const _=async()=>{p.value=!0;const E=await qe.videos.getVideos({page:h.value,limit:40,orderBy:g.order,user:n.user,tag:n.tag,performer:n.performer,asc:g.ascending,likes:n.likes,query:n.query,video:n.video,subscriptions:n.subscriptions,from:g.from,duration:g.duration,speed:g.speed,source:g.source,orientation:a()});f.value||(f.value=[]),f.value=f.value.concat(E),E.length<40&&(m=!0),p.value=!1},y=async()=>{p.value||m||!f.value||window.innerHeight+window.scrollY<document.body.offsetHeight-100||(h.value++,await _())};[e,t]=js(()=>_()),await e,t(),Xt(async()=>{window.addEventListener("scroll",y)}),Ci(()=>{window.removeEventListener("scroll",y)});const S=async()=>{f.value=void 0,h.value=1,p.value=!1,m=!1,await _()},C=E=>{E===Zs.relevance||g.order!==E?g.ascending=!1:g.ascending=!g.ascending,g.order=E};return dt(()=>n,async()=>await S(),{deep:!0}),dt(()=>g,async()=>await S(),{deep:!0}),(E,A)=>(x(),T("div",null,[n.filters?(x(),ae(Si,{key:0,gap:"gap-1.5"},{default:z(()=>{var R,I,D,L;return[P(Me,{ref:"order",onClick:A[0]||(A[0]=M=>c.value=!c.value),theme:g.order!==w(Zs).relevance?"blue":void 0,class:"flex items-center gap-1"},{default:z(()=>[P(Re,{name:g.ascending?"sort-ascending":"sort-descending",class:"h-5 w-5"},null,8,["name"]),W(" "+Z(Object.keys(g.orderFilters).find(M=>g.orderFilters[M]===g.order)),1)]),_:1},8,["theme"]),(x(),ae(vn(w(r)?$n:on),{modelValue:c.value,"onUpdate:modelValue":A[1]||(A[1]=M=>c.value=M),placement:"bottom",target:(R=E.$refs.order)==null?void 0:R.$el,class:"text-white text-sm py-1 w-36",offset:8},{default:z(()=>[(x(!0),T(_e,null,st(g.orderFilters,(M,$)=>(x(),ae(Xe,{active:M===g.order,onClick:H=>C(M)},{default:z(()=>[v("div",nI,[v("span",null,Z($),1),g.order===M&&M!==w(Zs).relevance?(x(),ae(Re,{key:0,name:g.ascending?"sort-ascending":"sort-descending",class:"h-5 w-5"},null,8,["name"])):pe("",!0)])]),_:2},1032,["active","onClick"]))),256))]),_:1},8,["modelValue","target"])),P(Me,{ref:"date",onClick:A[2]||(A[2]=M=>l.value=!l.value),class:"flex items-center gap-1",theme:g.from?"blue":void 0},{default:z(()=>[P(Re,{name:"calendar",class:"h-5 w-5"}),W(" "+Z(g.from?Object.keys(g.fromFilters).find(M=>g.fromFilters[M]===g.from):"Date"),1)]),_:1},8,["theme"]),(x(),ae(vn(w(r)?$n:on),{modelValue:l.value,"onUpdate:modelValue":A[3]||(A[3]=M=>l.value=M),placement:"bottom",target:(I=E.$refs.date)==null?void 0:I.$el,class:"text-white text-sm py-1 w-48",offset:8},{default:z(()=>[(x(!0),T(_e,null,st(g.fromFilters,(M,$)=>(x(),ae(Xe,{active:M===g.from&&g.source!==!0,onClick:H=>(g.from=M,g.source=!1,l.value=!1)},{default:z(()=>[W(Z($),1)]),_:2},1032,["active","onClick"]))),256)),(x(!0),T(_e,null,st(g.sourceViewsFilters,(M,$)=>(x(),ae(Xe,{active:M===g.from&&g.source===!0,onClick:H=>(g.source=!0,g.from=M,l.value=!1)},{default:z(()=>[W(Z($),1)]),_:2},1032,["active","onClick"]))),256))]),_:1},8,["modelValue","target"])),P(Me,{ref:"duration",onClick:A[4]||(A[4]=M=>u.value=!u.value),class:"flex items-center gap-1",theme:g.duration?"blue":void 0},{default:z(()=>[P(Re,{name:"clock",class:"h-5 w-5"}),W(" "+Z(g.duration?Object.keys(g.durationFilters).find(M=>g.durationFilters[M]===g.duration):"Duration"),1)]),_:1},8,["theme"]),(x(),ae(vn(w(r)?$n:on),{modelValue:u.value,"onUpdate:modelValue":A[5]||(A[5]=M=>u.value=M),placement:"bottom",target:(D=E.$refs.duration)==null?void 0:D.$el,class:"text-white text-sm py-1 w-52",offset:8},{default:z(()=>[(x(!0),T(_e,null,st(g.durationFilters,(M,$)=>(x(),ae(Xe,{active:M===g.duration,onClick:H=>(g.duration=M,u.value=!1)},{default:z(()=>[W(Z($),1)]),_:2},1032,["active","onClick"]))),256))]),_:1},8,["modelValue","target"])),P(Me,{ref:"speed",onClick:A[6]||(A[6]=M=>d.value=!d.value),class:"flex items-center gap-1",theme:g.speed?"blue":void 0},{default:z(()=>[P(Re,{name:"speedometer",class:"h-5 w-5"}),W(" "+Z(g.speed?Object.keys(g.speedFilters).find(M=>g.speedFilters[M]===g.speed):"Speed"),1)]),_:1},8,["theme"]),(x(),ae(vn(w(r)?$n:on),{modelValue:d.value,"onUpdate:modelValue":A[7]||(A[7]=M=>d.value=M),placement:"bottom",target:(L=E.$refs.speed)==null?void 0:L.$el,class:"text-white text-sm py-1 w-40",offset:8},{default:z(()=>[(x(!0),T(_e,null,st(g.speedFilters,(M,$)=>(x(),ae(Xe,{active:M===g.speed,onClick:H=>(g.speed=M,d.value=!1)},{default:z(()=>[W(Z($),1)]),_:2},1032,["active","onClick"]))),256))]),_:1},8,["modelValue","target"]))]}),_:1})):pe("",!0),v("div",iI,[f.value?(x(),T(_e,{key:0},[(x(!0),T(_e,null,st(f.value,(R,I)=>(x(),T(_e,null,[I%16===0?(x(),T("div",rI,[P(ov,{affiliate:w(i)(),class:"aspect-video rounded overflow-hidden"},null,8,["affiliate"]),v("div",oI,[v("div",aI,[lI,v("div",cI,[v("span",uI,[P(Re,{name:"eye",class:"h-4 w-4"}),W("173")]),v("span",dI,[P(Re,{name:"heart-outline",class:"h-4 w-4"}),W("47")]),v("span",fI,[P(Re,{name:"speedometer",class:"h-4 w-4"}),W("376")])])]),hI])])):pe("",!0),P(dd,{video:R},null,8,["video"])],64))),256)),f.value.length?pe("",!0):(x(),T("p",pI,"Sorry, no videos found."))],64)):p.value?(x(),T("div",gI,[P(Re,{name:"loading",class:"h-10 w-10 text-blue-500 animate-spin"})])):pe("",!0)])]))}}),Lf=De({__name:"SubscriptionButton",props:{user:{}},setup(s){const{authDialog:e}=Gt(jn()),{isAuthorized:t,user:n,subscriptions:i}=Gt(vs()),r=s,o=ue(!1),a=ut(()=>i.value.findIndex(c=>c.id===r.user.id)!==-1),l=()=>{o.value=!0,a.value?qe.user.unsubscribe(r.user).then(async()=>{const c=i.value.findIndex(u=>u.id===r.user.id);i.value.splice(c,1),await new Promise(u=>setTimeout(u,1e3))}).finally(()=>o.value=!1):qe.user.subscribe(r.user).then(async()=>{i.value.unshift(r.user),await new Promise(c=>setTimeout(c,1e3))}).finally(()=>o.value=!1)};return(c,u)=>w(t)&&w(n).id!==r.user.id?(x(),ae(Me,{key:0,loading:o.value,onClick:l,theme:a.value?"":"blue"},{default:z(()=>[W(Z(a.value?"Unsubscribe":"Subscribe"),1)]),_:1},8,["loading","theme"])):w(t)?pe("",!0):(x(),ae(Me,{key:1,theme:"blue",onClick:u[0]||(u[0]=d=>e.value=!0)},{default:z(()=>[W("Subscribe ")]),_:1}))}});function uv(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}let lr=uv();function mI(s){lr=s}const dv=/[&<>"']/,vI=new RegExp(dv.source,"g"),fv=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,_I=new RegExp(fv.source,"g"),yI={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},fp=s=>yI[s];function us(s,e){if(e){if(dv.test(s))return s.replace(vI,fp)}else if(fv.test(s))return s.replace(_I,fp);return s}const xI=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function hv(s){return s.replace(xI,(e,t)=>(t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const bI=/(^|[^\[])\^/g;function bt(s,e){s=typeof s=="string"?s:s.source,e=e||"";const t={replace:(n,i)=>(i=i.source||i,i=i.replace(bI,"$1"),s=s.replace(n,i),t),getRegex:()=>new RegExp(s,e)};return t}const wI=/[^\w:]/g,SI=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function hp(s,e,t){if(s){let n;try{n=decodeURIComponent(hv(t)).replace(wI,"").toLowerCase()}catch{return null}if(n.indexOf("javascript:")===0||n.indexOf("vbscript:")===0||n.indexOf("data:")===0)return null}e&&!SI.test(t)&&(t=AI(e,t));try{t=encodeURI(t).replace(/%25/g,"%")}catch{return null}return t}const Sa={},EI=/^[^:]+:\/*[^/]*$/,TI=/^([^:]+:)[\s\S]*$/,CI=/^([^:]+:\/*[^/]*)[\s\S]*$/;function AI(s,e){Sa[" "+s]||(EI.test(s)?Sa[" "+s]=s+"/":Sa[" "+s]=Xa(s,"/",!0)),s=Sa[" "+s];const t=s.indexOf(":")===-1;return e.substring(0,2)==="//"?t?e:s.replace(TI,"$1")+e:e.charAt(0)==="/"?t?e:s.replace(CI,"$1")+e:s+e}const kl={exec:function(){}};function pp(s,e){const t=s.replace(/\|/g,(r,o,a)=>{let l=!1,c=o;for(;--c>=0&&a[c]==="\\";)l=!l;return l?"|":" |"}),n=t.split(/ \|/);let i=0;if(n[0].trim()||n.shift(),n.length>0&&!n[n.length-1].trim()&&n.pop(),n.length>e)n.splice(e);else for(;n.length<e;)n.push("");for(;i<n.length;i++)n[i]=n[i].trim().replace(/\\\|/g,"|");return n}function Xa(s,e,t){const n=s.length;if(n===0)return"";let i=0;for(;i<n;){const r=s.charAt(n-i-1);if(r===e&&!t)i++;else if(r!==e&&t)i++;else break}return s.slice(0,n-i)}function kI(s,e){if(s.indexOf(e[1])===-1)return-1;const t=s.length;let n=0,i=0;for(;i<t;i++)if(s[i]==="\\")i++;else if(s[i]===e[0])n++;else if(s[i]===e[1]&&(n--,n<0))return i;return-1}function LI(s){s&&s.sanitize&&!s.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function gp(s,e){if(e<1)return"";let t="";for(;e>1;)e&1&&(t+=s),e>>=1,s+=s;return t+s}function mp(s,e,t,n){const i=e.href,r=e.title?us(e.title):null,o=s[1].replace(/\\([\[\]])/g,"$1");if(s[0].charAt(0)!=="!"){n.state.inLink=!0;const a={type:"link",raw:t,href:i,title:r,text:o,tokens:n.inlineTokens(o)};return n.state.inLink=!1,a}return{type:"image",raw:t,href:i,title:r,text:us(o)}}function RI(s,e){const t=s.match(/^(\s+)(?:```)/);if(t===null)return e;const n=t[1];return e.split(`
`).map(i=>{const r=i.match(/^\s+/);if(r===null)return i;const[o]=r;return o.length>=n.length?i.slice(n.length):i}).join(`
`)}class Rf{constructor(e){this.options=e||lr}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const n=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:Xa(n,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const n=t[0],i=RI(n,t[3]||"");return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline._escapes,"$1"):t[2],text:i}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(/#$/.test(n)){const i=Xa(n,"#");(this.options.pedantic||!i||/ $/.test(i))&&(n=i.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){const n=t[0].replace(/^ *>[ \t]?/gm,""),i=this.lexer.state.top;this.lexer.state.top=!0;const r=this.lexer.blockTokens(n);return this.lexer.state.top=i,{type:"blockquote",raw:t[0],tokens:r,text:n}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n,i,r,o,a,l,c,u,d,f,h,p,g=t[1].trim();const m=g.length>1,_={type:"list",raw:"",ordered:m,start:m?+g.slice(0,-1):"",loose:!1,items:[]};g=m?`\\d{1,9}\\${g.slice(-1)}`:`\\${g}`,this.options.pedantic&&(g=m?g:"[*+-]");const y=new RegExp(`^( {0,3}${g})((?:[	 ][^\\n]*)?(?:\\n|$))`);for(;e&&(p=!1,!(!(t=y.exec(e))||this.rules.block.hr.test(e)));){if(n=t[0],e=e.substring(n.length),u=t[2].split(`
`,1)[0].replace(/^\t+/,C=>" ".repeat(3*C.length)),d=e.split(`
`,1)[0],this.options.pedantic?(o=2,h=u.trimLeft()):(o=t[2].search(/[^ ]/),o=o>4?1:o,h=u.slice(o),o+=t[1].length),l=!1,!u&&/^ *$/.test(d)&&(n+=d+`
`,e=e.substring(d.length+1),p=!0),!p){const C=new RegExp(`^ {0,${Math.min(3,o-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),E=new RegExp(`^ {0,${Math.min(3,o-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),A=new RegExp(`^ {0,${Math.min(3,o-1)}}(?:\`\`\`|~~~)`),R=new RegExp(`^ {0,${Math.min(3,o-1)}}#`);for(;e&&(f=e.split(`
`,1)[0],d=f,this.options.pedantic&&(d=d.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!(A.test(d)||R.test(d)||C.test(d)||E.test(e)));){if(d.search(/[^ ]/)>=o||!d.trim())h+=`
`+d.slice(o);else{if(l||u.search(/[^ ]/)>=4||A.test(u)||R.test(u)||E.test(u))break;h+=`
`+d}!l&&!d.trim()&&(l=!0),n+=f+`
`,e=e.substring(f.length+1),u=d.slice(o)}}_.loose||(c?_.loose=!0:/\n *\n *$/.test(n)&&(c=!0)),this.options.gfm&&(i=/^\[[ xX]\] /.exec(h),i&&(r=i[0]!=="[ ] ",h=h.replace(/^\[[ xX]\] +/,""))),_.items.push({type:"list_item",raw:n,task:!!i,checked:r,loose:!1,text:h}),_.raw+=n}_.items[_.items.length-1].raw=n.trimRight(),_.items[_.items.length-1].text=h.trimRight(),_.raw=_.raw.trimRight();const S=_.items.length;for(a=0;a<S;a++)if(this.lexer.state.top=!1,_.items[a].tokens=this.lexer.blockTokens(_.items[a].text,[]),!_.loose){const C=_.items[a].tokens.filter(A=>A.type==="space"),E=C.length>0&&C.some(A=>/\n.*\n/.test(A.raw));_.loose=E}if(_.loose)for(a=0;a<S;a++)_.items[a].loose=!0;return _}}html(e){const t=this.rules.block.html.exec(e);if(t){const n={type:"html",raw:t[0],pre:!this.options.sanitizer&&(t[1]==="pre"||t[1]==="script"||t[1]==="style"),text:t[0]};if(this.options.sanitize){const i=this.options.sanitizer?this.options.sanitizer(t[0]):us(t[0]);n.type="paragraph",n.text=i,n.tokens=this.lexer.inline(i)}return n}}def(e){const t=this.rules.block.def.exec(e);if(t){const n=t[1].toLowerCase().replace(/\s+/g," "),i=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"",r=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline._escapes,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:i,title:r}}}table(e){const t=this.rules.block.table.exec(e);if(t){const n={type:"table",header:pp(t[1]).map(i=>({text:i})),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(n.header.length===n.align.length){n.raw=t[0];let i=n.align.length,r,o,a,l;for(r=0;r<i;r++)/^ *-+: *$/.test(n.align[r])?n.align[r]="right":/^ *:-+: *$/.test(n.align[r])?n.align[r]="center":/^ *:-+ *$/.test(n.align[r])?n.align[r]="left":n.align[r]=null;for(i=n.rows.length,r=0;r<i;r++)n.rows[r]=pp(n.rows[r],n.header.length).map(c=>({text:c}));for(i=n.header.length,o=0;o<i;o++)n.header[o].tokens=this.lexer.inline(n.header[o].text);for(i=n.rows.length,o=0;o<i;o++)for(l=n.rows[o],a=0;a<l.length;a++)l[a].tokens=this.lexer.inline(l[a].text);return n}}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:us(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):us(t[0]):t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const n=t[2].trim();if(!this.options.pedantic&&/^</.test(n)){if(!/>$/.test(n))return;const o=Xa(n.slice(0,-1),"\\");if((n.length-o.length)%2===0)return}else{const o=kI(t[2],"()");if(o>-1){const l=(t[0].indexOf("!")===0?5:4)+t[1].length+o;t[2]=t[2].substring(0,o),t[0]=t[0].substring(0,l).trim(),t[3]=""}}let i=t[2],r="";if(this.options.pedantic){const o=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(i);o&&(i=o[1],r=o[3])}else r=t[3]?t[3].slice(1,-1):"";return i=i.trim(),/^</.test(i)&&(this.options.pedantic&&!/>$/.test(n)?i=i.slice(1):i=i.slice(1,-1)),mp(t,{href:i&&i.replace(this.rules.inline._escapes,"$1"),title:r&&r.replace(this.rules.inline._escapes,"$1")},t[0],this.lexer)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let i=(n[2]||n[1]).replace(/\s+/g," ");if(i=t[i.toLowerCase()],!i){const r=n[0].charAt(0);return{type:"text",raw:r,text:r}}return mp(n,i,n[0],this.lexer)}}emStrong(e,t,n=""){let i=this.rules.inline.emStrong.lDelim.exec(e);if(!i||i[3]&&n.match(/[\p{L}\p{N}]/u))return;const r=i[1]||i[2]||"";if(!r||r&&(n===""||this.rules.inline.punctuation.exec(n))){const o=i[0].length-1;let a,l,c=o,u=0;const d=i[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(d.lastIndex=0,t=t.slice(-1*e.length+o);(i=d.exec(t))!=null;){if(a=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!a)continue;if(l=a.length,i[3]||i[4]){c+=l;continue}else if((i[5]||i[6])&&o%3&&!((o+l)%3)){u+=l;continue}if(c-=l,c>0)continue;l=Math.min(l,l+c+u);const f=e.slice(0,o+i.index+(i[0].length-a.length)+l);if(Math.min(o,l)%2){const p=f.slice(1,-1);return{type:"em",raw:f,text:p,tokens:this.lexer.inlineTokens(p)}}const h=f.slice(2,-2);return{type:"strong",raw:f,text:h,tokens:this.lexer.inlineTokens(h)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(/\n/g," ");const i=/[^ ]/.test(n),r=/^ /.test(n)&&/ $/.test(n);return i&&r&&(n=n.substring(1,n.length-1)),n=us(n,!0),{type:"codespan",raw:t[0],text:n}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e,t){const n=this.rules.inline.autolink.exec(e);if(n){let i,r;return n[2]==="@"?(i=us(this.options.mangle?t(n[1]):n[1]),r="mailto:"+i):(i=us(n[1]),r=i),{type:"link",raw:n[0],text:i,href:r,tokens:[{type:"text",raw:i,text:i}]}}}url(e,t){let n;if(n=this.rules.inline.url.exec(e)){let i,r;if(n[2]==="@")i=us(this.options.mangle?t(n[0]):n[0]),r="mailto:"+i;else{let o;do o=n[0],n[0]=this.rules.inline._backpedal.exec(n[0])[0];while(o!==n[0]);i=us(n[0]),n[1]==="www."?r="http://"+n[0]:r=n[0]}return{type:"link",raw:n[0],text:i,href:r,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(e,t){const n=this.rules.inline.text.exec(e);if(n){let i;return this.lexer.state.inRawBlock?i=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(n[0]):us(n[0]):n[0]:i=us(this.options.smartypants?t(n[0]):n[0]),{type:"text",raw:n[0],text:i}}}}const Ve={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:kl,lheading:/^((?:.|\n(?!\n))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};Ve._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;Ve._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;Ve.def=bt(Ve.def).replace("label",Ve._label).replace("title",Ve._title).getRegex();Ve.bullet=/(?:[*+-]|\d{1,9}[.)])/;Ve.listItemStart=bt(/^( *)(bull) */).replace("bull",Ve.bullet).getRegex();Ve.list=bt(Ve.list).replace(/bull/g,Ve.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+Ve.def.source+")").getRegex();Ve._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";Ve._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;Ve.html=bt(Ve.html,"i").replace("comment",Ve._comment).replace("tag",Ve._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();Ve.paragraph=bt(Ve._paragraph).replace("hr",Ve.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ve._tag).getRegex();Ve.blockquote=bt(Ve.blockquote).replace("paragraph",Ve.paragraph).getRegex();Ve.normal={...Ve};Ve.gfm={...Ve.normal,table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"};Ve.gfm.table=bt(Ve.gfm.table).replace("hr",Ve.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ve._tag).getRegex();Ve.gfm.paragraph=bt(Ve._paragraph).replace("hr",Ve.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",Ve.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ve._tag).getRegex();Ve.pedantic={...Ve.normal,html:bt(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Ve._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:kl,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:bt(Ve.normal._paragraph).replace("hr",Ve.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Ve.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()};const Te={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:kl,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^(?:[^_*\\]|\\.)*?\_\_(?:[^_*\\]|\\.)*?\*(?:[^_*\\]|\\.)*?(?=\_\_)|(?:[^*\\]|\\.)+(?=[^*])|[punct_](\*+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|(?:[^punct*_\s\\]|\\.)(\*+)(?=[^punct*_\s])/,rDelimUnd:/^(?:[^_*\\]|\\.)*?\*\*(?:[^_*\\]|\\.)*?\_(?:[^_*\\]|\\.)*?(?=\*\*)|(?:[^_\\]|\\.)+(?=[^_])|[punct*](\_+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:kl,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};Te._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~";Te.punctuation=bt(Te.punctuation).replace(/punctuation/g,Te._punctuation).getRegex();Te.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g;Te.escapedEmSt=/(?:^|[^\\])(?:\\\\)*\\[*_]/g;Te._comment=bt(Ve._comment).replace("(?:-->|$)","-->").getRegex();Te.emStrong.lDelim=bt(Te.emStrong.lDelim).replace(/punct/g,Te._punctuation).getRegex();Te.emStrong.rDelimAst=bt(Te.emStrong.rDelimAst,"g").replace(/punct/g,Te._punctuation).getRegex();Te.emStrong.rDelimUnd=bt(Te.emStrong.rDelimUnd,"g").replace(/punct/g,Te._punctuation).getRegex();Te._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g;Te._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;Te._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;Te.autolink=bt(Te.autolink).replace("scheme",Te._scheme).replace("email",Te._email).getRegex();Te._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;Te.tag=bt(Te.tag).replace("comment",Te._comment).replace("attribute",Te._attribute).getRegex();Te._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;Te._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;Te._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;Te.link=bt(Te.link).replace("label",Te._label).replace("href",Te._href).replace("title",Te._title).getRegex();Te.reflink=bt(Te.reflink).replace("label",Te._label).replace("ref",Ve._label).getRegex();Te.nolink=bt(Te.nolink).replace("ref",Ve._label).getRegex();Te.reflinkSearch=bt(Te.reflinkSearch,"g").replace("reflink",Te.reflink).replace("nolink",Te.nolink).getRegex();Te.normal={...Te};Te.pedantic={...Te.normal,strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:bt(/^!?\[(label)\]\((.*?)\)/).replace("label",Te._label).getRegex(),reflink:bt(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Te._label).getRegex()};Te.gfm={...Te.normal,escape:bt(Te.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/};Te.gfm.url=bt(Te.gfm.url,"i").replace("email",Te.gfm._extended_email).getRegex();Te.breaks={...Te.gfm,br:bt(Te.br).replace("{2,}","*").getRegex(),text:bt(Te.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()};function II(s){return s.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201C").replace(/"/g,"\u201D").replace(/\.{3}/g,"\u2026")}function vp(s){let e="",t,n;const i=s.length;for(t=0;t<i;t++)n=s.charCodeAt(t),Math.random()>.5&&(n="x"+n.toString(16)),e+="&#"+n+";";return e}class Ei{constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||lr,this.options.tokenizer=this.options.tokenizer||new Rf,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:Ve.normal,inline:Te.normal};this.options.pedantic?(t.block=Ve.pedantic,t.inline=Te.pedantic):this.options.gfm&&(t.block=Ve.gfm,this.options.breaks?t.inline=Te.breaks:t.inline=Te.gfm),this.tokenizer.rules=t}static get rules(){return{block:Ve,inline:Te}}static lex(e,t){return new Ei(t).lex(e)}static lexInline(e,t){return new Ei(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);let t;for(;t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens}blockTokens(e,t=[]){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(a,l,c)=>l+"    ".repeat(c.length));let n,i,r,o;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(n=a.call({lexer:this},e,t))?(e=e.substring(n.raw.length),t.push(n),!0):!1))){if(n=this.tokenizer.space(e)){e=e.substring(n.raw.length),n.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(n);continue}if(n=this.tokenizer.code(e)){e=e.substring(n.raw.length),i=t[t.length-1],i&&(i.type==="paragraph"||i.type==="text")?(i.raw+=`
`+n.raw,i.text+=`
`+n.text,this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(n);continue}if(n=this.tokenizer.fences(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.heading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.hr(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.blockquote(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.list(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.html(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.def(e)){e=e.substring(n.raw.length),i=t[t.length-1],i&&(i.type==="paragraph"||i.type==="text")?(i.raw+=`
`+n.raw,i.text+=`
`+n.raw,this.inlineQueue[this.inlineQueue.length-1].src=i.text):this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title});continue}if(n=this.tokenizer.table(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.lheading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(r=e,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const l=e.slice(1);let c;this.options.extensions.startBlock.forEach(function(u){c=u.call({lexer:this},l),typeof c=="number"&&c>=0&&(a=Math.min(a,c))}),a<1/0&&a>=0&&(r=e.substring(0,a+1))}if(this.state.top&&(n=this.tokenizer.paragraph(r))){i=t[t.length-1],o&&i.type==="paragraph"?(i.raw+=`
`+n.raw,i.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(n),o=r.length!==e.length,e=e.substring(n.raw.length);continue}if(n=this.tokenizer.text(e)){e=e.substring(n.raw.length),i=t[t.length-1],i&&i.type==="text"?(i.raw+=`
`+n.raw,i.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(n);continue}if(e){const a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let n,i,r,o=e,a,l,c;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)u.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,a.index)+"["+gp("a",a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,a.index)+"["+gp("a",a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.escapedEmSt.exec(o))!=null;)o=o.slice(0,a.index+a[0].length-2)+"++"+o.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex),this.tokenizer.rules.inline.escapedEmSt.lastIndex--;for(;e;)if(l||(c=""),l=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(u=>(n=u.call({lexer:this},e,t))?(e=e.substring(n.raw.length),t.push(n),!0):!1))){if(n=this.tokenizer.escape(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.tag(e)){e=e.substring(n.raw.length),i=t[t.length-1],i&&n.type==="text"&&i.type==="text"?(i.raw+=n.raw,i.text+=n.text):t.push(n);continue}if(n=this.tokenizer.link(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(n.raw.length),i=t[t.length-1],i&&n.type==="text"&&i.type==="text"?(i.raw+=n.raw,i.text+=n.text):t.push(n);continue}if(n=this.tokenizer.emStrong(e,o,c)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.codespan(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.br(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.del(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.autolink(e,vp)){e=e.substring(n.raw.length),t.push(n);continue}if(!this.state.inLink&&(n=this.tokenizer.url(e,vp))){e=e.substring(n.raw.length),t.push(n);continue}if(r=e,this.options.extensions&&this.options.extensions.startInline){let u=1/0;const d=e.slice(1);let f;this.options.extensions.startInline.forEach(function(h){f=h.call({lexer:this},d),typeof f=="number"&&f>=0&&(u=Math.min(u,f))}),u<1/0&&u>=0&&(r=e.substring(0,u+1))}if(n=this.tokenizer.inlineText(r,II)){e=e.substring(n.raw.length),n.raw.slice(-1)!=="_"&&(c=n.raw.slice(-1)),l=!0,i=t[t.length-1],i&&i.type==="text"?(i.raw+=n.raw,i.text+=n.text):t.push(n);continue}if(e){const u="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return t}}class If{constructor(e){this.options=e||lr}code(e,t,n){const i=(t||"").match(/\S*/)[0];if(this.options.highlight){const r=this.options.highlight(e,i);r!=null&&r!==e&&(n=!0,e=r)}return e=e.replace(/\n$/,"")+`
`,i?'<pre><code class="'+this.options.langPrefix+us(i)+'">'+(n?e:us(e,!0))+`</code></pre>
`:"<pre><code>"+(n?e:us(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
${e}</blockquote>
`}html(e){return e}heading(e,t,n,i){if(this.options.headerIds){const r=this.options.headerPrefix+i.slug(n);return`<h${t} id="${r}">${e}</h${t}>
`}return`<h${t}>${e}</h${t}>
`}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(e,t,n){const i=t?"ol":"ul",r=t&&n!==1?' start="'+n+'"':"";return"<"+i+r+`>
`+e+"</"+i+`>
`}listitem(e){return`<li>${e}</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(e){return`<p>${e}</p>
`}table(e,t){return t&&(t=`<tbody>${t}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+t+`</table>
`}tablerow(e){return`<tr>
${e}</tr>
`}tablecell(e,t){const n=t.header?"th":"td";return(t.align?`<${n} align="${t.align}">`:`<${n}>`)+e+`</${n}>
`}strong(e){return`<strong>${e}</strong>`}em(e){return`<em>${e}</em>`}codespan(e){return`<code>${e}</code>`}br(){return this.options.xhtml?"<br/>":"<br>"}del(e){return`<del>${e}</del>`}link(e,t,n){if(e=hp(this.options.sanitize,this.options.baseUrl,e),e===null)return n;let i='<a href="'+e+'"';return t&&(i+=' title="'+t+'"'),i+=">"+n+"</a>",i}image(e,t,n){if(e=hp(this.options.sanitize,this.options.baseUrl,e),e===null)return n;let i=`<img src="${e}" alt="${n}"`;return t&&(i+=` title="${t}"`),i+=this.options.xhtml?"/>":">",i}text(e){return e}}class pv{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,n){return""+n}image(e,t,n){return""+n}br(){return""}}class gv{constructor(){this.seen={}}serialize(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(e,t){let n=e,i=0;if(this.seen.hasOwnProperty(n)){i=this.seen[e];do i++,n=e+"-"+i;while(this.seen.hasOwnProperty(n))}return t||(this.seen[e]=i,this.seen[n]=0),n}slug(e,t={}){const n=this.serialize(e);return this.getNextSafeSlug(n,t.dryrun)}}class Ti{constructor(e){this.options=e||lr,this.options.renderer=this.options.renderer||new If,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new pv,this.slugger=new gv}static parse(e,t){return new Ti(t).parse(e)}static parseInline(e,t){return new Ti(t).parseInline(e)}parse(e,t=!0){let n="",i,r,o,a,l,c,u,d,f,h,p,g,m,_,y,S,C,E,A;const R=e.length;for(i=0;i<R;i++){if(h=e[i],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[h.type]&&(A=this.options.extensions.renderers[h.type].call({parser:this},h),A!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(h.type))){n+=A||"";continue}switch(h.type){case"space":continue;case"hr":{n+=this.renderer.hr();continue}case"heading":{n+=this.renderer.heading(this.parseInline(h.tokens),h.depth,hv(this.parseInline(h.tokens,this.textRenderer)),this.slugger);continue}case"code":{n+=this.renderer.code(h.text,h.lang,h.escaped);continue}case"table":{for(d="",u="",a=h.header.length,r=0;r<a;r++)u+=this.renderer.tablecell(this.parseInline(h.header[r].tokens),{header:!0,align:h.align[r]});for(d+=this.renderer.tablerow(u),f="",a=h.rows.length,r=0;r<a;r++){for(c=h.rows[r],u="",l=c.length,o=0;o<l;o++)u+=this.renderer.tablecell(this.parseInline(c[o].tokens),{header:!1,align:h.align[o]});f+=this.renderer.tablerow(u)}n+=this.renderer.table(d,f);continue}case"blockquote":{f=this.parse(h.tokens),n+=this.renderer.blockquote(f);continue}case"list":{for(p=h.ordered,g=h.start,m=h.loose,a=h.items.length,f="",r=0;r<a;r++)y=h.items[r],S=y.checked,C=y.task,_="",y.task&&(E=this.renderer.checkbox(S),m?y.tokens.length>0&&y.tokens[0].type==="paragraph"?(y.tokens[0].text=E+" "+y.tokens[0].text,y.tokens[0].tokens&&y.tokens[0].tokens.length>0&&y.tokens[0].tokens[0].type==="text"&&(y.tokens[0].tokens[0].text=E+" "+y.tokens[0].tokens[0].text)):y.tokens.unshift({type:"text",text:E}):_+=E),_+=this.parse(y.tokens,m),f+=this.renderer.listitem(_,C,S);n+=this.renderer.list(f,p,g);continue}case"html":{n+=this.renderer.html(h.text);continue}case"paragraph":{n+=this.renderer.paragraph(this.parseInline(h.tokens));continue}case"text":{for(f=h.tokens?this.parseInline(h.tokens):h.text;i+1<R&&e[i+1].type==="text";)h=e[++i],f+=`
`+(h.tokens?this.parseInline(h.tokens):h.text);n+=t?this.renderer.paragraph(f):f;continue}default:{const I='Token with "'+h.type+'" type was not found.';if(this.options.silent){console.error(I);return}else throw new Error(I)}}}return n}parseInline(e,t){t=t||this.renderer;let n="",i,r,o;const a=e.length;for(i=0;i<a;i++){if(r=e[i],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[r.type]&&(o=this.options.extensions.renderers[r.type].call({parser:this},r),o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(r.type))){n+=o||"";continue}switch(r.type){case"escape":{n+=t.text(r.text);break}case"html":{n+=t.html(r.text);break}case"link":{n+=t.link(r.href,r.title,this.parseInline(r.tokens,t));break}case"image":{n+=t.image(r.href,r.title,r.text);break}case"strong":{n+=t.strong(this.parseInline(r.tokens,t));break}case"em":{n+=t.em(this.parseInline(r.tokens,t));break}case"codespan":{n+=t.codespan(r.text);break}case"br":{n+=t.br();break}case"del":{n+=t.del(this.parseInline(r.tokens,t));break}case"text":{n+=t.text(r.text);break}default:{const l='Token with "'+r.type+'" type was not found.';if(this.options.silent){console.error(l);return}else throw new Error(l)}}}return n}}class Ll{constructor(e){this.options=e||lr}preprocess(e){return e}postprocess(e){return e}}ze(Ll,"passThroughHooks",new Set(["preprocess","postprocess"]));function DI(s,e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,s){const i="<p>An error occurred:</p><pre>"+us(n.message+"",!0)+"</pre>";if(e)return Promise.resolve(i);if(t){t(null,i);return}return i}if(e)return Promise.reject(n);if(t){t(n);return}throw n}}function mv(s,e){return(t,n,i)=>{typeof n=="function"&&(i=n,n=null);const r={...n};n={...$e.defaults,...r};const o=DI(n.silent,n.async,i);if(typeof t>"u"||t===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));if(LI(n),n.hooks&&(n.hooks.options=n),i){const a=n.highlight;let l;try{n.hooks&&(t=n.hooks.preprocess(t)),l=s(t,n)}catch(d){return o(d)}const c=function(d){let f;if(!d)try{n.walkTokens&&$e.walkTokens(l,n.walkTokens),f=e(l,n),n.hooks&&(f=n.hooks.postprocess(f))}catch(h){d=h}return n.highlight=a,d?o(d):i(null,f)};if(!a||a.length<3||(delete n.highlight,!l.length))return c();let u=0;$e.walkTokens(l,function(d){d.type==="code"&&(u++,setTimeout(()=>{a(d.text,d.lang,function(f,h){if(f)return c(f);h!=null&&h!==d.text&&(d.text=h,d.escaped=!0),u--,u===0&&c()})},0))}),u===0&&c();return}if(n.async)return Promise.resolve(n.hooks?n.hooks.preprocess(t):t).then(a=>s(a,n)).then(a=>n.walkTokens?Promise.all($e.walkTokens(a,n.walkTokens)).then(()=>a):a).then(a=>e(a,n)).then(a=>n.hooks?n.hooks.postprocess(a):a).catch(o);try{n.hooks&&(t=n.hooks.preprocess(t));const a=s(t,n);n.walkTokens&&$e.walkTokens(a,n.walkTokens);let l=e(a,n);return n.hooks&&(l=n.hooks.postprocess(l)),l}catch(a){return o(a)}}}function $e(s,e,t){return mv(Ei.lex,Ti.parse)(s,e,t)}$e.options=$e.setOptions=function(s){return $e.defaults={...$e.defaults,...s},mI($e.defaults),$e};$e.getDefaults=uv;$e.defaults=lr;$e.use=function(...s){const e=$e.defaults.extensions||{renderers:{},childTokens:{}};s.forEach(t=>{const n={...t};if(n.async=$e.defaults.async||n.async||!1,t.extensions&&(t.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if(i.renderer){const r=e.renderers[i.name];r?e.renderers[i.name]=function(...o){let a=i.renderer.apply(this,o);return a===!1&&(a=r.apply(this,o)),a}:e.renderers[i.name]=i.renderer}if(i.tokenizer){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");e[i.level]?e[i.level].unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&(i.level==="block"?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:i.level==="inline"&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),n.extensions=e),t.renderer){const i=$e.defaults.renderer||new If;for(const r in t.renderer){const o=i[r];i[r]=(...a)=>{let l=t.renderer[r].apply(i,a);return l===!1&&(l=o.apply(i,a)),l}}n.renderer=i}if(t.tokenizer){const i=$e.defaults.tokenizer||new Rf;for(const r in t.tokenizer){const o=i[r];i[r]=(...a)=>{let l=t.tokenizer[r].apply(i,a);return l===!1&&(l=o.apply(i,a)),l}}n.tokenizer=i}if(t.hooks){const i=$e.defaults.hooks||new Ll;for(const r in t.hooks){const o=i[r];Ll.passThroughHooks.has(r)?i[r]=a=>{if($e.defaults.async)return Promise.resolve(t.hooks[r].call(i,a)).then(c=>o.call(i,c));const l=t.hooks[r].call(i,a);return o.call(i,l)}:i[r]=(...a)=>{let l=t.hooks[r].apply(i,a);return l===!1&&(l=o.apply(i,a)),l}}n.hooks=i}if(t.walkTokens){const i=$e.defaults.walkTokens;n.walkTokens=function(r){let o=[];return o.push(t.walkTokens.call(this,r)),i&&(o=o.concat(i.call(this,r))),o}}$e.setOptions(n)})};$e.walkTokens=function(s,e){let t=[];for(const n of s)switch(t=t.concat(e.call($e,n)),n.type){case"table":{for(const i of n.header)t=t.concat($e.walkTokens(i.tokens,e));for(const i of n.rows)for(const r of i)t=t.concat($e.walkTokens(r.tokens,e));break}case"list":{t=t.concat($e.walkTokens(n.items,e));break}default:$e.defaults.extensions&&$e.defaults.extensions.childTokens&&$e.defaults.extensions.childTokens[n.type]?$e.defaults.extensions.childTokens[n.type].forEach(function(i){t=t.concat($e.walkTokens(n[i],e))}):n.tokens&&(t=t.concat($e.walkTokens(n.tokens,e)))}return t};$e.parseInline=mv(Ei.lexInline,Ti.parseInline);$e.Parser=Ti;$e.parser=Ti.parse;$e.Renderer=If;$e.TextRenderer=pv;$e.Lexer=Ei;$e.lexer=Ei.lex;$e.Tokenizer=Rf;$e.Slugger=gv;$e.Hooks=Ll;$e.parse=$e;$e.options;$e.setOptions;$e.use;$e.walkTokens;$e.parseInline;Ti.parse;Ei.lex;const PI=["innerHTML"],FI=v("div",{class:"h-6"},null,-1),OI={class:"cursor-pointer bg-zinc-900"},vv=De({__name:"ExpandableText",props:{text:{},height:{default:100}},setup(s){const e=ue(!1),t=s,n=ue(!1),i=ue();Yd(()=>{$e.setOptions({gfm:!0,breaks:!0,xhtml:!1})});const r=()=>{!e.value||n.value||(n.value=!0)};return Xt(()=>{e.value=i.value.offsetHeight!==i.value.scrollHeight}),(o,a)=>(x(),T("div",{class:Je([{"cursor-pointer":e.value&&!n.value},"select-text prose prose-invert max-w-none expandable-text overflow-hidden relative"]),onClick:r},[v("div",{ref_key:"el",ref:i,class:Je({"mb-10":n.value}),style:Vs(n.value?"":`max-height: ${t.height}px`),innerHTML:w($e).parse(t.text)},null,14,PI),e.value?(x(),T("div",{key:0,class:"text-white font-medium bt-1 block absolute left-0 bottom-0 w-full",onClick:a[0]||(a[0]=Is(l=>n.value=!n.value,["stop"]))},[FI,v("div",OI,Z(n.value?"Show less":"...more"),1)])):pe("",!0)],2))}});const MI={class:"rounded-full bg-zinc-800 overflow-hidden relative flex items-center justify-center text-zinc-400"},$I={key:0,class:"h-full w-full"},ki=De({__name:"Avatar",props:{image:{},icon:{}},setup(s){return(e,t)=>{const n=ql("lazy");return x(),T("div",MI,[e.image?ht((x(),T("img",$I,null,512)),[[n,w(gi)(e.image)]]):(x(),ae(Re,{key:1,name:e.icon,class:"h-[50%] w-[50%]"},null,8,["name"]))])}}}),NI={class:"p-4 lg:p-0 text-center lg:text-left"},VI={class:"flex flex-col items-center lg:items-start lg:flex-row gap-8"},BI={class:"h-48 w-48 bg-zinc-500 rounded-full relative"},UI={key:0,class:"absolute h-8 w-8 rounded-full bg-zinc-700 shadow bottom-2.5 right-2.5"},HI={class:"h-full w-full relative flex items-center justify-center"},GI={class:"flex flex-col"},zI=v("p",{class:"uppercase text-sm text-zinc-300"},"User",-1),jI={class:"text-5xl font-bold"},qI={class:"text-zinc-400 mt-3 text-lg"},KI={class:"font-medium text-white"},WI={class:"font-medium text-white"},YI={class:"font-medium text-white"},ZI=v("div",{class:"flex-1"},null,-1),XI={class:"flex gap-3"},QI={key:0,class:"text-zinc-100 w-full text-left mt-4 rounded-md"},JI=v("hr",{class:"border-zinc-800 my-2"},null,-1),e7=De({__name:"User",async setup(s){let e,t;Yd(()=>{$e.setOptions({gfm:!0,breaks:!0})});const n=Ps({loading:!1,editing:!1,fields:{bio:"",support_url:""}}),i=ue();i.value=([e,t]=js(()=>qe.users.getUser(Xi().params.username)),e=await e,t(),e);const r=vs();Xt(async()=>{n.fields.bio=i.value.bio,n.fields.support_url=i.value.profile.support_url?i.value.profile.support_url:""});const o=ut(()=>i&&r.user&&i.value.id===r.user.id),a=async c=>{const u=c.target;if(!u.files||u.files.length===0)return;const d=new FormData;d.append("file",u.files[0]),i.value.avatar_url=await qe.user.updateAvatar(d)},l=async()=>{n.loading=!0;try{await qe.user.updateBio(n.fields.bio),i.value.bio=n.fields.bio,await qe.user.updateProfile({support_url:n.fields.support_url}),i.value.profile.support_url=n.fields.support_url,n.editing=!1}catch(c){window.alert(c)}finally{n.loading=!1}};return Ws(()=>{var c;return Ds(`${(c=i.value)==null?void 0:c.username} | FapTap`)}),(c,u)=>(x(),T(_e,null,[v("div",NI,[v("div",VI,[v("div",BI,[P(ki,{icon:"account",image:i.value.avatar_url,class:"h-full w-full"},null,8,["image"]),o.value?(x(),T("div",UI,[v("div",HI,[v("input",{onChange:Is(a,["prevent"]),type:"file",class:"opacity-0 absolute inset-0 w-full h-full"},null,32),P(Re,{name:"pencil",class:"h-4 w-4 text-white"})])])):pe("",!0)]),v("div",GI,[zI,v("h1",jI,Z(i.value.username),1),v("p",qI,[v("span",KI,Z(w(_i)(i.value.subscribers)),1),W(" subscribers "),v("span",WI,Z(w(_i)(i.value.views)),1),W(" views "),v("span",YI,Z(w(_i)(i.value.videos)),1),W(" videos ")]),ZI,v("div",XI,[o.value&&(w(r).isCreator||w(r).isAdmin)?(x(),ae(Me,{key:0,onClick:u[0]||(u[0]=d=>n.editing=!0),class:"w-full"},{default:z(()=>[W(" Edit Profile ")]),_:1})):pe("",!0),P(Lf,{class:"w-full",user:i.value},null,8,["user"]),i.value.profile.support_url&&i.value.profile.support_url.length?(x(),ae(Me,{key:1,href:i.value.profile.support_url,class:"w-full",theme:"green"},{default:z(()=>[W(" Support ")]),_:1},8,["href"])):pe("",!0)])])]),i.value&&i.value.bio&&i.value.bio.length?(x(),T("div",QI,[P(vv,{class:"lg:!text-sm",text:i.value.bio},null,8,["text"])])):pe("",!0)]),JI,i.value?(x(),ae(ar,{key:0,user:i.value.id},null,8,["user"])):pe("",!0),P(oc,{modelValue:n.editing,"onUpdate:modelValue":u[3]||(u[3]=d=>n.editing=d),title:"Edit"},{default:z(()=>[v("form",{onSubmit:Is(l,["prevent"]),class:"mt-4 flex flex-col gap-y-3"},[P(hs,{modelValue:n.fields.bio,"onUpdate:modelValue":u[1]||(u[1]=d=>n.fields.bio=d),rows:"8",placeholder:"Bio...",textarea:!0,required:"",min:"3",max:"250"},null,8,["modelValue"]),P(hs,{modelValue:n.fields.support_url,"onUpdate:modelValue":u[2]||(u[2]=d=>n.fields.support_url=d),placeholder:"Link to Patreon, Gumroad, Boosty, ...",max:"250"},null,8,["modelValue"]),P(Me,{theme:"blue"},{default:z(()=>[W("Edit")]),_:1})],32)]),_:1},8,["modelValue"])],64))}}),t7={class:"flex gap-8 text-white flex flex-col items-center lg:items-start lg:flex-row text-center lg:text-left"},s7={class:"flex flex-col"},n7=v("p",{class:"uppercase text-sm text-zinc-300"},"Performer",-1),i7={class:"text-5xl font-bold"},r7={class:"text-zinc-400 mt-3 text-lg"},o7={class:"font-medium text-white"},a7={class:"font-medium text-white"},l7=v("div",{class:"flex-1"},null,-1),c7=De({__name:"Performer",async setup(s){let e,t;const n=([e,t]=js(()=>qe.performers.getPerformer(Xi().params.slug)),e=await e,t(),e);return Ws(()=>Ds(`${n.name} Interactive Porn Videos | FapTap`)),(i,r)=>(x(),T(_e,null,[v("div",t7,[P(ki,{icon:"woman-face-shimmer",image:w(n).avatar_url,class:"h-48 w-48"},null,8,["image"]),v("div",s7,[n7,v("h1",i7,Z(w(n).name),1),v("p",r7,[v("span",o7,Z(w(_i)(w(n).videos)),1),W(" videos "),v("span",a7,Z(w(_i)(w(n).views)),1),W(" views ")]),l7])]),w(n)?(x(),ae(ar,{key:0,class:"mt-4",performer:w(n).id},null,8,["performer"])):pe("",!0)],64))}}),u7=v("a",{href:"mailto:contact@faptap.net?subject=Creator%20Access&body=Hi%2C%0D%0AI%20would%20like%20to%20become%20a%20creator%20on%20FapTap.%20My%20username%20is%3A%20%3Cusername%3E",class:"bg-blue-500 text-white py-2.5 px-5 rounded-md mb-4 lg:mb-8 mx-2 lg:mx-0 text-center lg:text-left block"},[v("span",{class:"text-blue-100"},"Are you a creator and want to share your script with others?"),v("span",{class:"font-medium"}," Get Access Now")],-1),d7={class:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-10 gap-2 px-2 lg:px-0"},f7={class:"p-2 text-center"},h7={class:"line-clamp-1 font-medium text-xl md:text-base"},p7={class:"md:text-sm text-zinc-500"},g7={class:"md:text-sm text-zinc-500"},m7=De({__name:"Creators",async setup(s){let e,t;const n=([e,t]=js(()=>qe.users.getUsers()),e=await e,t(),e);return Ws(()=>Ds("Creators | FapTap")),(i,r)=>{const o=Es("router-link");return x(),T(_e,null,[u7,v("div",d7,[(x(!0),T(_e,null,st(w(n),a=>(x(),ae(o,{to:`/u/${a.username}`,class:"p-2 rounded hover:bg-zinc-800"},{default:z(()=>[P(ki,{icon:"account",image:a.avatar_url,class:"w-full aspect-square"},null,8,["image"]),v("div",f7,[v("p",h7,Z(a.username),1),v("div",p7,Z(a.subscribers)+" subscribers",1),v("div",g7,Z(a.videos)+" videos",1)])]),_:2},1032,["to"]))),256))])],64)}}}),v7={class:"px-2 lg:px-0 max-w-lg mx-auto"},_7=v("div",{class:"text-center"},[v("h2",{class:"font-medium text-2xl font-medium text-white"},"Security"),v("p",{class:"text-zinc-300"},"Manage access to your FapTap account")],-1),y7=v("p",{class:"font-medium text-white"},"Update Password",-1),x7=v("div",{class:"flex-1"},null,-1),b7=De({__name:"Preferences",setup(s){const e=ue(!1),t=Ps({fields:{currentPassword:"",newPassword:""},loading:!1}),n=()=>{t.loading=!0,qe.user.updatePassword(t.fields.currentPassword,t.fields.newPassword).then(()=>{t.loading=!1,t.fields.newPassword="",t.fields.currentPassword=""})};return Ws(()=>Ds("Preferences | FapTap")),(i,r)=>(x(),T(_e,null,[v("div",v7,[_7,v("button",{onClick:r[0]||(r[0]=o=>e.value=!0),class:"bg-zinc-800 rounded-md p-3 mt-3 flex items-center gap-3 w-full hover:bg-zinc-700/50 transition-all"},[P(Re,{name:"lock-reset",class:"h-8 w-8 text-zinc-400"}),y7,x7,P(Re,{name:"chevron-right",class:"h-6 w-6 text-zinc-400"})])]),P(oc,{title:"Update Password",modelValue:e.value,"onUpdate:modelValue":r[3]||(r[3]=o=>e.value=o)},{default:z(()=>[v("form",{onSubmit:Is(n,["prevent"]),class:"mt-3"},[P(hs,{required:"",modelValue:t.fields.currentPassword,"onUpdate:modelValue":r[1]||(r[1]=o=>t.fields.currentPassword=o),light:!0,placeholder:"Current password",type:"password",class:"w-full"},null,8,["modelValue"]),P(hs,{required:"",modelValue:t.fields.newPassword,"onUpdate:modelValue":r[2]||(r[2]=o=>t.fields.newPassword=o),light:!0,placeholder:"New password",type:"password",class:"w-full mt-2"},null,8,["modelValue"]),P(Me,{onLoading:t.loading,theme:"blue",class:"mt-4 w-full"},{default:z(()=>[W("Update")]),_:1},8,["onLoading"])],32)]),_:1},8,["modelValue"])],64))}}),w7={class:"px-2 md:px-0"},S7={class:"mb-3"},E7={class:"font-medium text-xl"},T7={class:"grid grid-cols-1 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8 gap-1.5 mt-1.5"},C7={class:"-m-1.5 py-1.5 px-3 font-medium bg-zinc-700"},A7=De({__name:"Tags",async setup(s){let e,t;const n=([e,t]=js(async()=>new Promise(async i=>{const r=await qe.tags.getTags({orderBy:"videos"});return i(r.reduce((o,a)=>{let l=a.name.charAt(0).toUpperCase();return l===l.toLowerCase()&&(l="#"),o[l]=o[l]||[],o[l].push(a),o},{}))})),e=await e,t(),e);return Ws(()=>Ds("Categories for Interactive Porn Videos | FapTap")),(i,r)=>{const o=Es("router-link");return x(),T("div",w7,[(x(!0),T(_e,null,st(w(n),(a,l)=>(x(),T("div",S7,[v("h2",E7,Z(l),1),v("div",T7,[(x(!0),T(_e,null,st(a,c=>(x(),ae(o,{to:`/t/${c.slug}`,class:"flex bg-zinc-800 rounded-md hover:bg-zinc-700 p-1.5 justify-between overflow-hidden"},{default:z(()=>[v("span",null,Z(c.name),1),v("div",C7,Z(c.videos),1)]),_:2},1032,["to"]))),256))])]))),256))])}}}),k7={class:"flex flex-wrap gap-1.5 mt-1.5 mb-8 max-height-2tabs overflow-hidden"},L7=["onClick"],R7={class:"drop-shadow truncate relative px-4 py-2"},I7={class:"text-xl lg:text-2xl !leading-none text-white mb-4 px-2 lg:px-0"},D7=De({__name:"Tag",async setup(s){let e,t;const n=g=>Array.isArray(g)&&g.length===1&&(g[0].includes("%2F")||g[0].includes("/")),i=g=>{switch(typeof g){case"string":return g.split("/").filter(Boolean);case"object":if(n(g))return decodeURI(g[0]).split("/").filter(Boolean);if(Array.isArray(g))return g;default:return[]}},r=Xi().params.slug,o=i(r);console.log({tagSlugs:o});const a=kn(),l=([e,t]=js(()=>Promise.all(o.map(g=>qe.tags.getTag(g)))),e=await e,t(),e),c=([e,t]=js(()=>qe.tags.getTopTags()),e=await e,t(),e),u=l.map(g=>g.id).join(","),d=l.map(g=>g.name).join(", "),f=g=>i(Xi().params.slug).includes(g.slug),h=g=>{const m=a.currentRoute.value,_=o.indexOf(g);_>-1?o.splice(_,1):o.push(g);const y=o.join("/");m.name&&a.push({name:m.name,params:{slug:y}})},p=[...c].sort((g,m)=>{const _=f(g),y=f(m);return _&&!y?-1:!_&&y?1:0});return Ws(()=>{const g=`Interactive ${d} Porn Videos | FapTap`;Ds(g)}),(g,m)=>(x(),T(_e,null,[v("div",k7,[(x(!0),T(_e,null,st(w(p),_=>(x(),T("div",{key:_.id,class:Je(["rounded-lg overflow-hidden group flex items-center justify-center font-bold text-1xl relative z-10 bg-zinc-800 cursor-pointer",{"selected-tag-white-bg":f(_)}]),onClick:y=>h(_.slug)},[v("span",R7,Z(w(cv)(_.name)),1)],10,L7))),128))]),v("h2",I7,Z(w(d)),1),w(u)?(x(),ae(ar,{key:0,class:"mt-2",tag:w(u)},null,8,["tag"])):pe("",!0)],64))}}),P7=v("h2",{class:"text-xl lg:text-2xl !leading-none text-white mb-4 px-2 md:px-0"},"Subscriptions",-1),F7={key:0,class:"grid grid-cols-1 md:grid-cols-6 gap-3"},O7={class:"col-span-1 flex flex-col gap-3"},M7={class:"flex items-center"},$7={class:"line-clamp-1"},N7={class:"col-span-5"},V7={key:1,class:"flex flex-col gap-3 items-center justify-center h-80"},B7=v("h2",{class:"text-white font-medium text-2xl"},"You are not subscribed to any creators yet",-1),U7={key:1,class:"flex justify-center items-center flex-col h-80 text-center"},H7=v("h2",{class:"text-white font-medium text-2xl"},"Log In to get your personalized feed",-1),G7=De({__name:"Feed",setup(s){const e=kn(),{isAuthorized:t,user:n,subscriptions:i}=Gt(vs()),{authDialog:r}=Gt(jn());return Ws(()=>Ds("My Feed | FapTap")),(o,a)=>{const l=Es("router-link");return w(t)?(x(),T(_e,{key:0},[P7,w(i).length?(x(),T("div",F7,[v("div",O7,[(x(!0),T(_e,null,st(w(i),c=>(x(),T("div",M7,[P(l,{to:`/u/${c.username}`,class:"flex items-center gap-2 text-white font-medium flex-1"},{default:z(()=>[P(ki,{image:c.avatar_url,icon:"account",class:"h-7 w-7"},null,8,["image"]),v("span",$7,Z(c.username),1)]),_:2},1032,["to"]),P(Lf,{user:c},null,8,["user"])]))),256))]),v("div",N7,[w(i).length?(x(),ae(ar,{key:0,subscriptions:!0,"with-tags":!1,"with-menu":!1})):pe("",!0)])])):(x(),T("div",V7,[B7,P(Me,{theme:"blue",onClick:a[0]||(a[0]=c=>w(e).push("/creators"))},{default:z(()=>[W("Find Creators")]),_:1})]))],64)):(x(),T("div",U7,[H7,P(Me,{onClick:a[1]||(a[1]=c=>r.value=!0),class:"mt-3"},{default:z(()=>[W("Log In")]),_:1})]))}}}),z7=v("h2",{class:"text-xl lg:text-2xl !leading-none text-white mb-4 px-2 md:px-0"},"My Liked Videos",-1),j7=De({__name:"Likes",setup(s){return Gt(vs()),Ws(()=>Ds("My Likes | FapTap")),(e,t)=>(x(),T(_e,null,[z7,P(ar,{likes:!0})],64))}}),q7={class:"grid grid grid-cols-2 md:grid-cols-4 lg:grid-cols-10 gap-2"},K7={class:"p-2 text-center"},W7={class:"line-clamp-1 font-medium text-xl md:text-base"},Y7={class:"md:text-sm text-zinc-500"},Z7=De({__name:"Performers",async setup(s){let e,t;const n=([e,t]=js(()=>qe.performers.getPerformers({})),e=await e,t(),e);return Ws(()=>Ds("Top Pornstars for Interactive Porn Videos | FapTap")),(i,r)=>{const o=Es("router-link");return x(),T("div",q7,[(x(!0),T(_e,null,st(w(n),a=>(x(),ae(o,{to:`/p/${a.slug}`,class:"p-2 group hover:bg-zinc-800 rounded"},{default:z(()=>[P(ki,{icon:"woman-face-shimmer",image:a.avatar_url,class:"w-full aspect-square"},null,8,["image"]),v("div",K7,[v("p",W7,Z(a.name),1),v("div",Y7,Z(a.videos)+" videos",1)])]),_:2},1032,["to"]))),256))])}}}),X7={class:"text-xl lg:text-2xl !leading-none text-white mb-4 px-2 lg:px-0"},Q7=De({__name:"Videos",setup(s){const e=Xi(),t=ut(()=>{const n=e.query.q;return n?`${n} Videos`:"All Videos"});return dt(()=>t.value,()=>Ds(`${t.value} | FapTap`),{immediate:!0}),Ws(()=>Ds(`${t.value} | FapTap`)),(n,i)=>(x(),T(_e,null,[v("h2",X7,Z(t.value),1),P(ar,{query:w(e).query.q},null,8,["query"])],64))}}),_v=De({__name:"Rating",props:{thingId:{},thingType:{},liked:{type:Boolean},likes:{}},setup(s){const{authDialog:e}=Gt(jn()),t=vs(),n=s,i=ue(!1),r=ue(!1),o=ue(!1),a=ue(0);Xt(()=>{o.value=n.liked,a.value=n.likes});const l=async()=>{if(!r.value){if(!t.isAuthorized){e.value=!0;return}i.value=!0,await qe.rating.setRating(n.thingId,n.thingType),i.value=!1,a.value+=o.value?-1:1,o.value=!o.value,r.value=!0,setTimeout(()=>{r.value=!1},1e3)}};return(c,u)=>(x(),ae(Me,{disabled:i.value,onClick:l,theme:o.value?"blue":void 0,class:"flex gap-2 items-center"},{default:z(()=>[P(Re,{name:o.value?"heart":"heart-outline",class:Je([{"!text-white":o.value},"h-5 w-5 text-zinc-400 group-hover:text-white"])},null,8,["name","class"]),v("span",null,Z(a.value),1)]),_:1},8,["disabled","theme"]))}}),J7={key:0,class:"flex gap-3 items-start"},e9=["disabled"],t9={class:"flex flex-wrap gap-1.5 p-2"},s9=["onClick"],n9={key:1},i9={class:"text-center text-white"},fd=De({__name:"CommentsForm",props:{thingId:{},thingType:{},parentId:{}},emits:["add-comment"],setup(s,{emit:e}){const t=s,n=e,{user:i,isAuthorized:r}=Gt(vs()),{authDialog:o}=Gt(jn()),a=ue(!1),l=ue(""),c=ue(!1),u=f=>{const h=f.target;h.style.height="0",h.style.height=h.scrollHeight+"px"},d=async()=>{c.value=!0;try{const f=await qe.comments.createComment(t.thingId,t.thingType,l.value,t.parentId);n("add-comment",f),l.value=""}catch(f){alert(f)}};return(f,h)=>w(r)?(x(),T("div",J7,[P(ki,{image:w(i).avatar_url,icon:"account",class:"h-9 w-9 grow-0 shrink-0"},null,8,["image"]),P(hs,{textarea:!0,rows:1,onInput:u,modelValue:l.value,"onUpdate:modelValue":h[0]||(h[0]=p=>l.value=p),placeholder:"Your comment",ref:"input",class:"flex-1 !resize-none"},null,8,["modelValue"]),v("button",{onClick:h[1]||(h[1]=Is(p=>a.value=!0,["stop"])),ref:"el"},[P(Re,{name:"smiley",class:"h-6 w-6 text-zinc-300 mt-1.5"})],512),v("button",{onClick:Is(d,["stop"]),disabled:l.value.length<3,class:"disabled:opacity-25"},[P(Re,{name:"send",class:"h-6 w-6 text-zinc-300 mt-1.5"})],8,e9),P(on,{target:f.$refs.el,modelValue:a.value,"onUpdate:modelValue":h[2]||(h[2]=p=>a.value=p),placement:"top-end",offset:8},{default:z(()=>[v("div",t9,[(x(),T(_e,null,st(["\u2764\uFE0F","\u{1F60A}","\u{1F975}","\u{1F924}","\u{1F44D}","\u{1F351}","\u{1F346}","\u{1F4A6}"],p=>v("button",{onClick:g=>{var m;return l.value+=p,a.value=!1,(m=f.$refs.input)==null?void 0:m.$el.focus()},class:"p-1.5 rounded-md hover:bg-zinc-600"},Z(p),9,s9)),64))])]),_:1},8,["target","modelValue"])])):(x(),T("div",n9,[v("p",i9,[v("span",{class:"text-blue-400 font-medium cursor-pointer",onClick:h[3]||(h[3]=p=>o.value=!0)},"Sign In"),W(" to write your comment ")])]))}}),r9={class:"flex gap-x-3"},o9={class:"flex-1"},a9={class:"text-sm"},l9={class:"text-zinc-400 ml-2 text-xs"},c9={class:"whitespace-pre-line text-zinc-300 mt-0.5 font-normal select-text"},u9={class:"flex gap-1.5 mt-1"},_p=De({__name:"Comment",props:{comment:{},thingId:{},thingType:{}},setup(s){const e=i=>{n.value=!1,t.comment.comments||(t.comment.comments=[]),t.comment.comments.push(i)},t=s,n=ue(!1);return(i,r)=>{const o=Es("router-link"),a=Es("Comment",!0);return x(),T("div",r9,[P(o,{to:`/u/${i.comment.user.username}`,class:"grow-0 shrink-0"},{default:z(()=>[P(ki,{image:i.comment.user.avatar_url,icon:"account",class:"h-9 w-9"},null,8,["image"])]),_:1},8,["to"]),v("div",o9,[v("div",a9,[P(o,{to:`/u/${i.comment.user.username}`,class:"text-zinc-100 font-medium"},{default:z(()=>[W(Z(i.comment.user.username),1)]),_:1},8,["to"]),v("span",l9,Z(w(lv)(new Date(i.comment.created_at)))+" ago",1)]),v("p",c9,Z(i.comment.comment),1),v("div",u9,[P(_v,{liked:i.comment.liked,likes:i.comment.likes,"thing-id":i.comment.id,"thing-type":w(hl).Comment},null,8,["liked","likes","thing-id","thing-type"]),P(Me,{onClick:r[0]||(r[0]=l=>n.value=!n.value),dense:!0,class:"!text-xs"},{default:z(()=>[W(Z(n.value?"Cancel":"Reply"),1)]),_:1})]),n.value?(x(),ae(fd,{key:0,"parent-id":i.comment.id,"thing-id":t.thingId,"thing-type":t.thingType,class:"mt-2",onAddComment:e},null,8,["parent-id","thing-id","thing-type"])):pe("",!0),v("div",null,[(x(!0),T(_e,null,st(i.comment.comments,l=>(x(),ae(a,{class:"mt-2",comment:l,"thing-type":t.thingType,"thing-id":t.thingId},null,8,["comment","thing-type","thing-id"]))),256))])])])}}}),d9={key:0},f9={class:"font-medium"},h9={key:1},p9=De({__name:"Comments",props:{thingId:{},thingType:{}},async setup(s){let e,t;const{isMobile:n}=Ai(),i=s,r=ue(!1),o=ue([]),a=async l=>{o.value.unshift(l)};return o.value=([e,t]=js(()=>qe.comments.getComments(i.thingId)),e=await e,t(),e),(l,c)=>w(n)?(x(),T("div",d9,[v("div",{class:"border-t border-b py-3 border-zinc-800 flex items-center justify-between px-2",onClick:c[0]||(c[0]=u=>r.value=!0)},[v("span",f9,Z(o.value.length)+" comments",1),P(Re,{name:"unfold",class:"h-6 w-6"})]),P($n,{modelValue:r.value,"onUpdate:modelValue":c[1]||(c[1]=u=>r.value=u)},{default:z(()=>[P(fd,{"thing-id":i.thingId,"thing-type":i.thingType,class:"mb-6 px-2",onAddComment:a},null,8,["thing-id","thing-type"]),(x(!0),T(_e,null,st(o.value,u=>(x(),ae(_p,{class:"my-4 px-2","thing-type":i.thingType,"thing-id":i.thingId,comment:u},null,8,["thing-type","thing-id","comment"]))),256))]),_:1},8,["modelValue"])])):(x(),T("div",h9,[P(fd,{"thing-id":i.thingId,"thing-type":i.thingType,class:"mb-3",onAddComment:a},null,8,["thing-id","thing-type"]),(x(!0),T(_e,null,st(o.value,u=>(x(),ae(_p,{class:"my-2",comment:u,"thing-type":i.thingType,"thing-id":i.thingId},null,8,["comment","thing-type","thing-id"]))),256))]))}}),g9={class:"bg-zinc-700 rounded text-sm px-2.5 py-0.5 flex items-center gap-x-1 grow-0 shrink-0"},m9=["placeholder"],yp=De({__name:"SelectInput",props:{max:{default:-1},create:{type:Boolean,default:!1},options:{},modelValue:{},placeholder:{}},emits:["update:modelValue","search"],setup(s,{emit:e}){const t=e,n=s,i=ue(!1),r=ue(""),o=ue(),a=ue(),l=ue(!1),c=p=>{n.modelValue.splice(p,1),t("update:modelValue",n.modelValue)},u=p=>{p===""||!n.create||n.modelValue.findIndex(g=>g.toLowerCase()===p.toLowerCase())===-1&&(n.max!==-1&&n.modelValue.length==n.max||(n.modelValue.push(p),t("update:modelValue",n.modelValue),r.value="",o.value.focus()))},d=p=>{switch(p.code){case"Enter":p.preventDefault(),u(r.value);break;case"Backspace":if(r.value!=="")return;p.preventDefault(),n.modelValue.length>0&&n.modelValue.splice(n.modelValue.length-1,1);break}},f=ut(()=>{let p=n.options.filter(g=>!n.modelValue.includes(g));return p=p.filter(g=>g.toLowerCase().includes(r.value.toLowerCase())),p});let h=-1;return dt(()=>r.value,p=>{clearTimeout(h),i.value=p.length>0,h=setTimeout(()=>t("search",p),200)}),(p,g)=>(x(),T("div",{ref_key:"referenceElement",ref:a,onClick:g[5]||(g[5]=m=>p.$refs.inputElement.focus()),class:Je(["w-full py-1.5 px-2 focus-visible:outline-none bg-zinc-800 focus:ring-2 ring-blue-500 disabled:opacity-70 rounded flex gap-1.5 flex-wrap",{"ring-2 ring-blue-500":l.value}])},[(x(!0),T(_e,null,st(n.modelValue,(m,_)=>(x(),T("div",g9,[v("span",null,Z(m),1),P(Re,{onClick:y=>{var S;return c(_),(S=o.value)==null?void 0:S.focus()},name:"close",class:"text-zinc-400 h-4 w-4 -mr-1.5 hover:text-white cursor-pointer"},null,8,["onClick"])]))),256)),ht(v("input",{ref_key:"inputElement",ref:o,placeholder:n.modelValue.length?void 0:n.placeholder,"onUpdate:modelValue":g[0]||(g[0]=m=>r.value=m),onFocus:g[1]||(g[1]=m=>l.value=!0),onFocusout:g[2]||(g[2]=m=>l.value=!1),onKeydown:d,class:"bg-transparent focus-visible:outline-none text-white",type:"text"},null,40,m9),[[sf,r.value]]),P(on,{modelValue:i.value,"onUpdate:modelValue":g[4]||(g[4]=m=>i.value=m),target:p.$refs.referenceElement,placement:"bottom",offset:8,class:"py-1.5 text-white"},{default:z(()=>[P(Xe,{onClick:g[3]||(g[3]=m=>u(r.value))},{default:z(()=>[W(' Press Enter to add "'+Z(r.value)+'" ',1)]),_:1}),(x(!0),T(_e,null,st(f.value,m=>(x(),ae(Xe,{onClick:_=>u(m)},{default:z(()=>[W(Z(m),1)]),_:2},1032,["onClick"]))),256))]),_:1},8,["modelValue","target"])],2))}}),v9={key:0,class:"bg-red-600 rounded-md p-2 text-sm"},_9={class:"flex flex-col gap-y-1"},y9={class:"flex flex-col gap-y-1"},x9={class:"flex flex-col gap-y-1"},b9={class:"flex"},w9={ref:"el",class:"flex items-center"},S9={class:"w-64 p-3"},E9=v("p",{class:"text-white font-medium"},"Supported sites",-1),T9={class:"text-zinc-300 mt-3 text-sm"},C9=["href"],A9={class:"mt-1"},k9=v("option",{value:0},"Straight",-1),L9=v("option",{value:1},"Transgender",-1),R9=v("option",{value:2},"Gay",-1),I9=[k9,L9,R9],D9={class:"flex gap-3"},P9=v("span",{class:"font-medium text-sm text-zinc-400"},"VR",-1),F9={class:"mt-1"},O9=["value"],M9={class:"flex flex-col gap-y-1"},$9={class:"flex justify-center items-center"},N9={key:0,class:"flex items-center gap-1.5 text-zinc-300"},V9=v("p",null,"Select Funscript",-1),B9={key:1},U9=["required"],H9={class:"flex gap-3"},G9=v("span",{class:"font-medium text-sm text-zinc-400"},"Script Download",-1),z9={class:"flex gap-3"},j9=De({__name:"VideoForm",props:{video:{}},emits:["submit-video"],setup(s,{emit:e}){const t=s,n=e,i=ue(!1),r=Ps({loading:!1,performers:[],tags:[],providers:[],projections:["MONO_FLAT","MONO_360","STEREO_FLAT_LR","STEREO_FLAT_LR_SQUARE","STEREO_FLAT_TB","STEREO_FLAT_TB_SQUARE","STEREO_180_LR","STEREO_180_LR_SPHERICAL","STEREO_180_TB","STEREO_180_TB_SPHERICAL","STEREO_360_LR","STEREO_360_TB","STEREO_FISHEYE_200_LR"],fields:{name:"",description:"",stream_url:"",downloadable:!0,performers:[],tags:[],orientation:0,vr:!1,projection:"MONO_FLAT"}});Xt(()=>{t.video&&(r.fields.id=t.video.id,r.fields.name=t.video.name,r.fields.downloadable=t.video.downloadable,r.fields.description=t.video.description,r.fields.stream_url=t.video.stream_url,r.fields.orientation=t.video.orientation,r.fields.vr=t.video.vr,r.fields.projection=t.video.projection,t.video.tags&&(r.fields.tags=t.video.tags.map(d=>d.name)),t.video.performers&&(r.fields.performers=t.video.performers.map(d=>d.name))),qe.providers.getProviders().then(d=>r.providers=d)});const o=async()=>{try{r.loading=!0,r.error=void 0;let d;r.fields.id?(d=await qe.videos.updateVideo(r.fields),r.fields.script&&await qe.videos.updateScript(r.fields.id,r.fields.script)):d=await qe.videos.createVideo(r.fields),n("submit-video",d)}catch(d){r.error=d}finally{r.loading=!1}},a=d=>{const f=d.target.files;if(!f.length){r.fields.script=void 0;return}const h=new FileReader;h.onload=()=>{r.fields.script=JSON.parse(h.result).actions.map(p=>[p.at,p.pos]),r.filename=f[0].name},h.readAsText(f[0])},l=async d=>{if(d.length<2){r.tags=[];return}const f=await qe.tags.getTags({query:d,orderBy:"videos"});r.tags=f.map(h=>h.name)},c=async d=>{if(d.length<2){r.tags=[];return}const f=await qe.performers.getPerformers({page:1,limit:10,query:d});r.performers=f.map(h=>h.name)},u=async()=>{if(!!r.fields.id){r.loading=!0;try{await qe.videos.deleteVideo(r.fields.id),window.location.href="/videos"}catch(d){r.error=d}finally{r.loading=!1}}};return(d,f)=>(x(),T("form",{onSubmit:Is(o,["prevent"]),class:"flex flex-col gap-y-3 mt-4"},[r.error?(x(),T("div",v9,Z(r.error),1)):pe("",!0),v("div",_9,[P(hs,{required:"",modelValue:r.fields.name,"onUpdate:modelValue":f[0]||(f[0]=h=>r.fields.name=h),placeholder:"Title"},null,8,["modelValue"])]),v("div",y9,[P(hs,{rows:"3",textarea:!0,modelValue:r.fields.description,"onUpdate:modelValue":f[1]||(f[1]=h=>r.fields.description=h),placeholder:"Description"},null,8,["modelValue"])]),v("div",x9,[v("div",b9,[P(hs,{class:"flex-1",required:"",modelValue:r.fields.stream_url,"onUpdate:modelValue":f[2]||(f[2]=h=>r.fields.stream_url=h),placeholder:"Stream URL"},null,8,["modelValue"]),v("div",w9,[P(Me,{onClick:f[3]||(f[3]=h=>i.value=!0),type:"button",theme:"transparent",class:"!pr-0"},{default:z(()=>[P(Re,{name:"help-outline",class:"h-6 w-6 text-zinc-400"})]),_:1})],512),P(on,{modelValue:i.value,"onUpdate:modelValue":f[4]||(f[4]=h=>i.value=h),target:d.$refs.el,placement:"right",offset:8},{default:z(()=>[v("div",S9,[E9,v("ul",T9,[(x(!0),T(_e,null,st(r.providers,h=>(x(),T("li",null,[v("a",{href:`https://${h}`,target:"_blank",class:"hover:text-white"},"https://"+Z(h),9,C9)]))),256))])])]),_:1},8,["modelValue","target"])])]),v("div",null,[P(yp,{class:"mt-1",onSearch:l,modelValue:r.fields.tags,"onUpdate:modelValue":f[5]||(f[5]=h=>r.fields.tags=h),options:r.tags,max:20,placeholder:"Tags",create:!0},null,8,["modelValue","options"])]),v("div",null,[P(yp,{class:"mt-1",onSearch:c,modelValue:r.fields.performers,"onUpdate:modelValue":f[6]||(f[6]=h=>r.fields.performers=h),options:r.performers,max:10,placeholder:"Performers",create:!0},null,8,["modelValue","options"])]),v("div",A9,[ht(v("select",{"onUpdate:modelValue":f[7]||(f[7]=h=>r.fields.orientation=h),class:"w-full bg-zinc-800 rounded px-2 py-2 focus-visible:outline-none focus:ring-2 ring-blue-500"},I9,512),[[Bh,r.fields.orientation]])]),v("div",D9,[P9,ht(v("input",{type:"checkbox","onUpdate:modelValue":f[8]||(f[8]=h=>r.fields.vr=h)},null,512),[[Nh,r.fields.vr]])]),ht(v("div",F9,[ht(v("select",{"onUpdate:modelValue":f[9]||(f[9]=h=>r.fields.projection=h),class:"w-full bg-zinc-800 rounded px-2 py-2 focus-visible:outline-none focus:ring-2 ring-blue-500"},[(x(!0),T(_e,null,st(r.projections,h=>(x(),T("option",{value:h},Z(h),9,O9))),256))],512),[[Bh,r.fields.projection]])],512),[[Kt,r.fields.vr]]),v("div",M9,[P(Me,{type:"button",class:"mt-1"},{default:z(()=>[v("label",$9,[r.fields.script?(x(),T("div",B9,[v("p",null,Z(r.filename)+" - "+Z(r.fields.script.length)+" actions",1)])):(x(),T("div",N9,[V9,P(Re,{name:"upload",class:"h-6 w-6"})])),v("input",{class:"hidden",required:!r.fields.id,onChange:a,type:"file"},null,40,U9)])]),_:1})]),v("div",H9,[G9,ht(v("input",{type:"checkbox","onUpdate:modelValue":f[10]||(f[10]=h=>r.fields.downloadable=h)},null,512),[[Nh,r.fields.downloadable]])]),v("div",z9,[r.fields.id?(x(),ae(Me,{key:0,loading:r.loading,theme:"red",onClick:u,class:"shrink-0"},{default:z(()=>[W("Delete")]),_:1},8,["loading"])):pe("",!0),P(Me,{loading:r.loading,theme:"blue",class:"flex-1"},{default:z(()=>[W(Z(r.fields.id?"Edit":"Create"),1)]),_:1},8,["loading"])])],32))}});var q9="M11,15H13V17H11V15M11,7H13V13H11V7M12,2C6.47,2 2,6.5 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20Z",K9="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z",W9="M10,12V22H8V14H6V12H10M18,14V20C18,21.11 17.11,22 16,22H14A2,2 0 0,1 12,20V14A2,2 0 0,1 14,12H16C17.11,12 18,12.9 18,14M14,14V20H16V14H14M11.5,3C14.15,3 16.55,4 18.4,5.6L21,3V10H14L16.62,7.38C15.23,6.22 13.46,5.5 11.5,5.5C7.96,5.5 4.95,7.81 3.9,11L1.53,10.22C2.92,6.03 6.85,3 11.5,3Z",xp="M5,5H10V7H7V10H5V5M14,5H19V10H17V7H14V5M17,14H19V19H14V17H17V14M10,17V19H5V14H7V17H10Z",bp="M14,14H19V16H16V19H14V14M5,14H10V19H8V16H5V14M8,5H10V10H5V8H8V5M19,8V10H14V5H16V8H19Z",wp="M14,19H18V5H14M6,19H10V5H6V19Z",Sp="M8,5.14V19.14L19,12.14L8,5.14Z",Y9="M14.5,13.5H16.5V10.5H14.5M18,14A1,1 0 0,1 17,15H16.25V16.5H14.75V15H14A1,1 0 0,1 13,14V10A1,1 0 0,1 14,9H17A1,1 0 0,1 18,10M11,15H9.5V13H7.5V15H6V9H7.5V11.5H9.5V9H11M19,4H5C3.89,4 3,4.89 3,6V18A2,2 0 0,0 5,20H19A2,2 0 0,0 21,18V6C21,4.89 20.1,4 19,4Z",Z9="M12.5,3C17.15,3 21.08,6.03 22.47,10.22L20.1,11C19.05,7.81 16.04,5.5 12.5,5.5C10.54,5.5 8.77,6.22 7.38,7.38L10,10H3V3L5.6,5.6C7.45,4 9.85,3 12.5,3M10,12V22H8V14H6V12H10M18,14V20C18,21.11 17.11,22 16,22H14A2,2 0 0,1 12,20V14A2,2 0 0,1 14,12H16C17.11,12 18,12.9 18,14M14,14V20H16V14H14Z",X9="M14,3.23V5.29C16.89,6.15 19,8.83 19,12C19,15.17 16.89,17.84 14,18.7V20.77C18,19.86 21,16.28 21,12C21,7.72 18,4.14 14,3.23M16.5,12C16.5,10.23 15.5,8.71 14,7.97V16C15.5,15.29 16.5,13.76 16.5,12M3,9V15H7L12,20V4L7,9H3Z",Q9="M12,4L9.91,6.09L12,8.18M4.27,3L3,4.27L7.73,9H3V15H7L12,20V13.27L16.25,17.53C15.58,18.04 14.83,18.46 14,18.7V20.77C15.38,20.45 16.63,19.82 17.68,18.96L19.73,21L21,19.73L12,10.73M19,12C19,12.94 18.8,13.82 18.46,14.64L19.97,16.15C20.62,14.91 21,13.5 21,12C21,7.72 18,4.14 14,3.23V5.29C16.89,6.15 19,8.83 19,12M16.5,12C16.5,10.23 15.5,8.71 14,7.97V10.18L16.45,12.63C16.5,12.43 16.5,12.21 16.5,12Z";function J9(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var yv={exports:{}};(function(s,e){(function(t){var n=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,i=/^(?=([^\/?#]*))\1([^]*)$/,r=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,a={buildAbsoluteURL:function(l,c,u){if(u=u||{},l=l.trim(),c=c.trim(),!c){if(!u.alwaysNormalize)return l;var d=a.parseURL(l);if(!d)throw new Error("Error trying to parse base URL.");return d.path=a.normalizePath(d.path),a.buildURLFromParts(d)}var f=a.parseURL(c);if(!f)throw new Error("Error trying to parse relative URL.");if(f.scheme)return u.alwaysNormalize?(f.path=a.normalizePath(f.path),a.buildURLFromParts(f)):c;var h=a.parseURL(l);if(!h)throw new Error("Error trying to parse base URL.");if(!h.netLoc&&h.path&&h.path[0]!=="/"){var p=i.exec(h.path);h.netLoc=p[1],h.path=p[2]}h.netLoc&&!h.path&&(h.path="/");var g={scheme:h.scheme,netLoc:f.netLoc,path:null,params:f.params,query:f.query,fragment:f.fragment};if(!f.netLoc&&(g.netLoc=h.netLoc,f.path[0]!=="/"))if(!f.path)g.path=h.path,f.params||(g.params=h.params,f.query||(g.query=h.query));else{var m=h.path,_=m.substring(0,m.lastIndexOf("/")+1)+f.path;g.path=a.normalizePath(_)}return g.path===null&&(g.path=u.alwaysNormalize?a.normalizePath(f.path):f.path),a.buildURLFromParts(g)},parseURL:function(l){var c=n.exec(l);return c?{scheme:c[1]||"",netLoc:c[2]||"",path:c[3]||"",params:c[4]||"",query:c[5]||"",fragment:c[6]||""}:null},normalizePath:function(l){for(l=l.split("").reverse().join("").replace(r,"");l.length!==(l=l.replace(o,"")).length;);return l.split("").reverse().join("")},buildURLFromParts:function(l){return l.scheme+l.netLoc+l.path+l.params+l.query+l.fragment}};s.exports=a})()})(yv);var Df=yv.exports;function Ep(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(s,i).enumerable})),t.push.apply(t,n)}return t}function Zt(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ep(Object(t),!0).forEach(function(n){sD(s,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):Ep(Object(t)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(t,n))})}return s}function eD(s,e){if(typeof s!="object"||!s)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function tD(s){var e=eD(s,"string");return typeof e=="symbol"?e:String(e)}function sD(s,e,t){return e=tD(e),e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function Vt(){return Vt=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(s[n]=t[n])}return s},Vt.apply(this,arguments)}const Ee=Number.isFinite||function(s){return typeof s=="number"&&isFinite(s)},nD=Number.isSafeInteger||function(s){return typeof s=="number"&&Math.abs(s)<=iD},iD=Number.MAX_SAFE_INTEGER||9007199254740991;let b=function(s){return s.MEDIA_ATTACHING="hlsMediaAttaching",s.MEDIA_ATTACHED="hlsMediaAttached",s.MEDIA_DETACHING="hlsMediaDetaching",s.MEDIA_DETACHED="hlsMediaDetached",s.BUFFER_RESET="hlsBufferReset",s.BUFFER_CODECS="hlsBufferCodecs",s.BUFFER_CREATED="hlsBufferCreated",s.BUFFER_APPENDING="hlsBufferAppending",s.BUFFER_APPENDED="hlsBufferAppended",s.BUFFER_EOS="hlsBufferEos",s.BUFFER_FLUSHING="hlsBufferFlushing",s.BUFFER_FLUSHED="hlsBufferFlushed",s.MANIFEST_LOADING="hlsManifestLoading",s.MANIFEST_LOADED="hlsManifestLoaded",s.MANIFEST_PARSED="hlsManifestParsed",s.LEVEL_SWITCHING="hlsLevelSwitching",s.LEVEL_SWITCHED="hlsLevelSwitched",s.LEVEL_LOADING="hlsLevelLoading",s.LEVEL_LOADED="hlsLevelLoaded",s.LEVEL_UPDATED="hlsLevelUpdated",s.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",s.LEVELS_UPDATED="hlsLevelsUpdated",s.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",s.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",s.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",s.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",s.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",s.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",s.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",s.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",s.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",s.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",s.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",s.CUES_PARSED="hlsCuesParsed",s.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",s.INIT_PTS_FOUND="hlsInitPtsFound",s.FRAG_LOADING="hlsFragLoading",s.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",s.FRAG_LOADED="hlsFragLoaded",s.FRAG_DECRYPTED="hlsFragDecrypted",s.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",s.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",s.FRAG_PARSING_METADATA="hlsFragParsingMetadata",s.FRAG_PARSED="hlsFragParsed",s.FRAG_BUFFERED="hlsFragBuffered",s.FRAG_CHANGED="hlsFragChanged",s.FPS_DROP="hlsFpsDrop",s.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",s.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",s.ERROR="hlsError",s.DESTROYING="hlsDestroying",s.KEY_LOADING="hlsKeyLoading",s.KEY_LOADED="hlsKeyLoaded",s.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",s.BACK_BUFFER_REACHED="hlsBackBufferReached",s.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",s}({}),Ge=function(s){return s.NETWORK_ERROR="networkError",s.MEDIA_ERROR="mediaError",s.KEY_SYSTEM_ERROR="keySystemError",s.MUX_ERROR="muxError",s.OTHER_ERROR="otherError",s}({}),j=function(s){return s.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",s.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",s.KEY_SYSTEM_NO_SESSION="keySystemNoSession",s.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",s.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",s.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",s.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",s.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",s.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",s.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",s.MANIFEST_LOAD_ERROR="manifestLoadError",s.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",s.MANIFEST_PARSING_ERROR="manifestParsingError",s.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",s.LEVEL_EMPTY_ERROR="levelEmptyError",s.LEVEL_LOAD_ERROR="levelLoadError",s.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",s.LEVEL_PARSING_ERROR="levelParsingError",s.LEVEL_SWITCH_ERROR="levelSwitchError",s.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",s.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",s.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",s.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",s.FRAG_LOAD_ERROR="fragLoadError",s.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",s.FRAG_DECRYPT_ERROR="fragDecryptError",s.FRAG_PARSING_ERROR="fragParsingError",s.FRAG_GAP="fragGap",s.REMUX_ALLOC_ERROR="remuxAllocError",s.KEY_LOAD_ERROR="keyLoadError",s.KEY_LOAD_TIMEOUT="keyLoadTimeOut",s.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",s.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",s.BUFFER_APPEND_ERROR="bufferAppendError",s.BUFFER_APPENDING_ERROR="bufferAppendingError",s.BUFFER_STALLED_ERROR="bufferStalledError",s.BUFFER_FULL_ERROR="bufferFullError",s.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",s.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",s.INTERNAL_EXCEPTION="internalException",s.INTERNAL_ABORTED="aborted",s.UNKNOWN="unknown",s}({});const $i=function(){},hd={trace:$i,debug:$i,log:$i,warn:$i,info:$i,error:$i};let ko=hd;function rD(s){const e=self.console[s];return e?e.bind(self.console,`[${s}] >`):$i}function oD(s,...e){e.forEach(function(t){ko[t]=s[t]?s[t].bind(s):rD(t)})}function aD(s,e){if(typeof console=="object"&&s===!0||typeof s=="object"){oD(s,"debug","log","info","warn","error");try{ko.log(`Debug logs enabled for "${e}" in hls.js version 1.5.4`)}catch{ko=hd}}else ko=hd}const V=ko,lD=/^(\d+)x(\d+)$/,Tp=/(.+?)=(".*?"|.*?)(?:,|$)/g;class Lt{constructor(e){typeof e=="string"&&(e=Lt.parseAttrList(e)),Vt(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const n=new Uint8Array(t.length/2);for(let i=0;i<t.length/2;i++)n[i]=parseInt(t.slice(i*2,i*2+2),16);return n}else return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}bool(e){return this[e]==="YES"}decimalResolution(e){const t=lD.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t;const n={},i='"';for(Tp.lastIndex=0;(t=Tp.exec(e))!==null;){let r=t[2];r.indexOf(i)===0&&r.lastIndexOf(i)===r.length-1&&(r=r.slice(1,-1));const o=t[1].trim();n[o]=r}return n}}function cD(s){return s!=="ID"&&s!=="CLASS"&&s!=="START-DATE"&&s!=="DURATION"&&s!=="END-DATE"&&s!=="END-ON-NEXT"}function uD(s){return s==="SCTE35-OUT"||s==="SCTE35-IN"}class xv{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){const n=t.attr;for(const i in n)if(Object.prototype.hasOwnProperty.call(e,i)&&e[i]!==n[i]){V.warn(`DATERANGE tag attribute: "${i}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=i;break}e=Vt(new Lt({}),n,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const n=new Date(this.attr["END-DATE"]);Ee(n.getTime())&&(this._endDate=n)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const e=this.duration;return e!==null?new Date(this._startDate.getTime()+e*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(Ee(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&Ee(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class mc{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var mt={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class bv{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[mt.AUDIO]:null,[mt.VIDEO]:null,[mt.AUDIOVIDEO]:null},this.baseurl=e}setByteRange(e,t){const n=e.split("@",2);let i;n.length===1?i=(t==null?void 0:t.byteRangeEndOffset)||0:i=parseInt(n[1]),this._byteRange=[i,parseInt(n[0])+i]}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Df.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}}class Kc extends bv{constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new mc,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const n=Object.keys(this.levelkeys);if(n.length===1)return this._decryptdata=this.levelkeys[n[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null||!Ee(this.programDateTime))return null;const e=Ee(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),n=t.length;if(n>1||n===1&&this.levelkeys[t[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,n,i,r,o=!1){const{elementaryStreams:a}=this,l=a[e];if(!l){a[e]={startPTS:t,endPTS:n,startDTS:i,endDTS:r,partial:o};return}l.startPTS=Math.min(l.startPTS,t),l.endPTS=Math.max(l.endPTS,n),l.startDTS=Math.min(l.startDTS,i),l.endDTS=Math.max(l.endDTS,r)}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[mt.AUDIO]=null,e[mt.VIDEO]=null,e[mt.AUDIOVIDEO]=null}}class dD extends bv{constructor(e,t,n,i,r){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new mc,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=i;const o=e.enumeratedString("BYTERANGE");o&&this.setByteRange(o,r),r&&(this.fragOffset=r.fragOffset+r.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}const fD=10;class hD{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&n>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return this.fragments.length?Ee(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||fD}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function Pf(s){return Uint8Array.from(atob(s),e=>e.charCodeAt(0))}function pD(s){const e=pd(s).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function gD(s){const e=function(n,i,r){const o=n[i];n[i]=n[r],n[r]=o};e(s,0,3),e(s,1,2),e(s,4,5),e(s,6,7)}function mD(s){const e=s.split(":");let t=null;if(e[0]==="data"&&e.length===2){const n=e[1].split(";"),i=n[n.length-1].split(",");if(i.length===2){const r=i[0]==="base64",o=i[1];r?(n.splice(-1,1),t=Pf(o)):t=pD(o)}}return t}function pd(s){return Uint8Array.from(unescape(encodeURIComponent(s)),e=>e.charCodeAt(0))}const Yr=typeof self<"u"?self:void 0;var Ct={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},bs={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function Cp(s){switch(s){case bs.FAIRPLAY:return Ct.FAIRPLAY;case bs.PLAYREADY:return Ct.PLAYREADY;case bs.WIDEVINE:return Ct.WIDEVINE;case bs.CLEARKEY:return Ct.CLEARKEY}}var wv={WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function vD(s){if(s===wv.WIDEVINE)return Ct.WIDEVINE}function Ap(s){switch(s){case Ct.FAIRPLAY:return bs.FAIRPLAY;case Ct.PLAYREADY:return bs.PLAYREADY;case Ct.WIDEVINE:return bs.WIDEVINE;case Ct.CLEARKEY:return bs.CLEARKEY}}function Wc(s){const{drmSystems:e,widevineLicenseUrl:t}=s,n=e?[Ct.FAIRPLAY,Ct.WIDEVINE,Ct.PLAYREADY,Ct.CLEARKEY].filter(i=>!!e[i]):[];return!n[Ct.WIDEVINE]&&t&&n.push(Ct.WIDEVINE),n}const Sv=function(s){return Yr!=null&&(s=Yr.navigator)!=null&&s.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function _D(s,e,t,n){let i;switch(s){case Ct.FAIRPLAY:i=["cenc","sinf"];break;case Ct.WIDEVINE:case Ct.PLAYREADY:i=["cenc"];break;case Ct.CLEARKEY:i=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${s}`)}return yD(i,e,t,n)}function yD(s,e,t,n){return[{initDataTypes:s,persistentState:n.persistentState||"optional",distinctiveIdentifier:n.distinctiveIdentifier||"optional",sessionTypes:n.sessionTypes||[n.sessionType||"temporary"],audioCapabilities:e.map(r=>({contentType:`audio/mp4; codecs="${r}"`,robustness:n.audioRobustness||"",encryptionScheme:n.audioEncryptionScheme||null})),videoCapabilities:t.map(r=>({contentType:`video/mp4; codecs="${r}"`,robustness:n.videoRobustness||"",encryptionScheme:n.videoEncryptionScheme||null}))}]}function Yi(s,e,t){return Uint8Array.prototype.slice?s.slice(e,t):new Uint8Array(Array.prototype.slice.call(s,e,t))}const Ff=(s,e)=>e+10<=s.length&&s[e]===73&&s[e+1]===68&&s[e+2]===51&&s[e+3]<255&&s[e+4]<255&&s[e+6]<128&&s[e+7]<128&&s[e+8]<128&&s[e+9]<128,Ev=(s,e)=>e+10<=s.length&&s[e]===51&&s[e+1]===68&&s[e+2]===73&&s[e+3]<255&&s[e+4]<255&&s[e+6]<128&&s[e+7]<128&&s[e+8]<128&&s[e+9]<128,zo=(s,e)=>{const t=e;let n=0;for(;Ff(s,e);){n+=10;const i=vc(s,e+6);n+=i,Ev(s,e+10)&&(n+=10),e+=n}if(n>0)return s.subarray(t,t+n)},vc=(s,e)=>{let t=0;return t=(s[e]&127)<<21,t|=(s[e+1]&127)<<14,t|=(s[e+2]&127)<<7,t|=s[e+3]&127,t},xD=(s,e)=>Ff(s,e)&&vc(s,e+6)+10<=s.length-e,Of=s=>{const e=Cv(s);for(let t=0;t<e.length;t++){const n=e[t];if(Tv(n))return CD(n)}},Tv=s=>s&&s.key==="PRIV"&&s.info==="com.apple.streaming.transportStreamTimestamp",bD=s=>{const e=String.fromCharCode(s[0],s[1],s[2],s[3]),t=vc(s,4),n=10;return{type:e,size:t,data:s.subarray(n,n+t)}},Cv=s=>{let e=0;const t=[];for(;Ff(s,e);){const n=vc(s,e+6);e+=10;const i=e+n;for(;e+8<i;){const r=bD(s.subarray(e)),o=wD(r);o&&t.push(o),e+=r.size+10}Ev(s,e)&&(e+=10)}return t},wD=s=>s.type==="PRIV"?SD(s):s.type[0]==="W"?TD(s):ED(s),SD=s=>{if(s.size<2)return;const e=bn(s.data,!0),t=new Uint8Array(s.data.subarray(e.length+1));return{key:s.type,info:e,data:t.buffer}},ED=s=>{if(s.size<2)return;if(s.type==="TXXX"){let t=1;const n=bn(s.data.subarray(t),!0);t+=n.length+1;const i=bn(s.data.subarray(t));return{key:s.type,info:n,data:i}}const e=bn(s.data.subarray(1));return{key:s.type,data:e}},TD=s=>{if(s.type==="WXXX"){if(s.size<2)return;let t=1;const n=bn(s.data.subarray(t),!0);t+=n.length+1;const i=bn(s.data.subarray(t));return{key:s.type,info:n,data:i}}const e=bn(s.data);return{key:s.type,data:e}},CD=s=>{if(s.data.byteLength===8){const e=new Uint8Array(s.data),t=e[3]&1;let n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,t&&(n+=4772185884e-2),Math.round(n)}},bn=(s,e=!1)=>{const t=AD();if(t){const c=t.decode(s);if(e){const u=c.indexOf("\0");return u!==-1?c.substring(0,u):c}return c.replace(/\0/g,"")}const n=s.length;let i,r,o,a="",l=0;for(;l<n;){if(i=s[l++],i===0&&e)return a;if(i===0||i===3)continue;switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(i);break;case 12:case 13:r=s[l++],a+=String.fromCharCode((i&31)<<6|r&63);break;case 14:r=s[l++],o=s[l++],a+=String.fromCharCode((i&15)<<12|(r&63)<<6|(o&63)<<0);break}}return a};let Yc;function AD(){if(!navigator.userAgent.includes("PlayStation 4"))return!Yc&&typeof self.TextDecoder<"u"&&(Yc=new self.TextDecoder("utf-8")),Yc}const pn={hexDump:function(s){let e="";for(let t=0;t<s.length;t++){let n=s[t].toString(16);n.length<2&&(n="0"+n),e+=n}return e}},Rl=Math.pow(2,32)-1,kD=[].push,Av={video:1,audio:2,id3:3,text:4};function Bt(s){return String.fromCharCode.apply(null,s)}function kv(s,e){const t=s[e]<<8|s[e+1];return t<0?65536+t:t}function Ne(s,e){const t=Lv(s,e);return t<0?4294967296+t:t}function kp(s,e){let t=Ne(s,e);return t*=Math.pow(2,32),t+=Ne(s,e+4),t}function Lv(s,e){return s[e]<<24|s[e+1]<<16|s[e+2]<<8|s[e+3]}function Zc(s,e,t){s[e]=t>>24,s[e+1]=t>>16&255,s[e+2]=t>>8&255,s[e+3]=t&255}function LD(s){const e=s.byteLength;for(let t=0;t<e;){const n=Ne(s,t);if(n>8&&s[t+4]===109&&s[t+5]===111&&s[t+6]===111&&s[t+7]===102)return!0;t=n>1?t+n:e}return!1}function Ze(s,e){const t=[];if(!e.length)return t;const n=s.byteLength;for(let i=0;i<n;){const r=Ne(s,i),o=Bt(s.subarray(i+4,i+8)),a=r>1?i+r:n;if(o===e[0])if(e.length===1)t.push(s.subarray(i+8,a));else{const l=Ze(s.subarray(i+8,a),e.slice(1));l.length&&kD.apply(t,l)}i=a}return t}function RD(s){const e=[],t=s[0];let n=8;const i=Ne(s,n);n+=4;let r=0,o=0;t===0?(r=Ne(s,n+=4),o=Ne(s,n+=4)):(r=kp(s,n+=8),o=kp(s,n+=8)),n+=2;let a=s.length+o;const l=kv(s,n);n+=2;for(let c=0;c<l;c++){let u=n;const d=Ne(s,u);u+=4;const f=d&2147483647;if((d&2147483648)>>>31===1)return V.warn("SIDX has hierarchical references (not supported)"),null;const p=Ne(s,u);u+=4,e.push({referenceSize:f,subsegmentDuration:p,info:{duration:p/i,start:a,end:a+f-1}}),a+=f,u+=4,n=u}return{earliestPresentationTime:r,timescale:i,version:t,referencesCount:l,references:e}}function Rv(s){const e=[],t=Ze(s,["moov","trak"]);for(let i=0;i<t.length;i++){const r=t[i],o=Ze(r,["tkhd"])[0];if(o){let a=o[0];const l=Ne(o,a===0?12:20),c=Ze(r,["mdia","mdhd"])[0];if(c){a=c[0];const u=Ne(c,a===0?12:20),d=Ze(r,["mdia","hdlr"])[0];if(d){const f=Bt(d.subarray(8,12)),h={soun:mt.AUDIO,vide:mt.VIDEO}[f];if(h){const p=Ze(r,["mdia","minf","stbl","stsd"])[0],g=ID(p);e[l]={timescale:u,type:h},e[h]=Zt({timescale:u,id:l},g)}}}}}return Ze(s,["moov","mvex","trex"]).forEach(i=>{const r=Ne(i,4),o=e[r];o&&(o.default={duration:Ne(i,12),flags:Ne(i,20)})}),e}function ID(s){const e=s.subarray(8),t=e.subarray(8+78),n=Bt(e.subarray(4,8));let i=n;const r=n==="enca"||n==="encv";if(r){const a=Ze(e,[n])[0].subarray(n==="enca"?28:78);Ze(a,["sinf"]).forEach(c=>{const u=Ze(c,["schm"])[0];if(u){const d=Bt(u.subarray(4,8));if(d==="cbcs"||d==="cenc"){const f=Ze(c,["frma"])[0];f&&(i=Bt(f))}}})}switch(i){case"avc1":case"avc2":case"avc3":case"avc4":{const o=Ze(t,["avcC"])[0];i+="."+Ea(o[1])+Ea(o[2])+Ea(o[3]);break}case"mp4a":{const o=Ze(e,[n])[0],a=Ze(o.subarray(28),["esds"])[0];if(a&&a.length>12){let l=4;if(a[l++]!==3)break;l=Xc(a,l),l+=2;const c=a[l++];if(c&128&&(l+=2),c&64&&(l+=a[l++]),a[l++]!==4)break;l=Xc(a,l);const u=a[l++];if(u===64)i+="."+Ea(u);else break;if(l+=12,a[l++]!==5)break;l=Xc(a,l);const d=a[l++];let f=(d&248)>>3;f===31&&(f+=1+((d&7)<<3)+((a[l]&224)>>5)),i+="."+f}break}case"hvc1":case"hev1":{const o=Ze(t,["hvcC"])[0],a=o[1],l=["","A","B","C"][a>>6],c=a&31,u=Ne(o,2),d=(a&32)>>5?"H":"L",f=o[12],h=o.subarray(6,12);i+="."+l+c,i+="."+u.toString(16).toUpperCase(),i+="."+d+f;let p="";for(let g=h.length;g--;){const m=h[g];(m||p)&&(p="."+m.toString(16).toUpperCase()+p)}i+=p;break}case"dvh1":case"dvhe":{const o=Ze(t,["dvcC"])[0],a=o[2]>>1&127,l=o[2]<<5&32|o[3]>>3&31;i+="."+un(a)+"."+un(l);break}case"vp09":{const o=Ze(t,["vpcC"])[0],a=o[4],l=o[5],c=o[6]>>4&15;i+="."+un(a)+"."+un(l)+"."+un(c);break}case"av01":{const o=Ze(t,["av1C"])[0],a=o[1]>>>5,l=o[1]&31,c=o[2]>>>7?"H":"M",u=(o[2]&64)>>6,d=(o[2]&32)>>5,f=a===2&&u?d?12:10:u?10:8,h=(o[2]&16)>>4,p=(o[2]&8)>>3,g=(o[2]&4)>>2,m=o[2]&3,_=1,y=1,S=1,C=0;i+="."+a+"."+un(l)+c+"."+un(f)+"."+h+"."+p+g+m+"."+un(_)+"."+un(y)+"."+un(S)+"."+C;break}}return{codec:i,encrypted:r}}function Xc(s,e){const t=e+5;for(;s[e++]&128&&e<t;);return e}function Ea(s){return("0"+s.toString(16).toUpperCase()).slice(-2)}function un(s){return(s<10?"0":"")+s}function DD(s,e){if(!s||!e)return s;const t=e.keyId;return t&&e.isCommonEncryption&&Ze(s,["moov","trak"]).forEach(i=>{const o=Ze(i,["mdia","minf","stbl","stsd"])[0].subarray(8);let a=Ze(o,["enca"]);const l=a.length>0;l||(a=Ze(o,["encv"])),a.forEach(c=>{const u=l?c.subarray(28):c.subarray(78);Ze(u,["sinf"]).forEach(f=>{const h=Iv(f);if(h){const p=h.subarray(8,24);p.some(g=>g!==0)||(V.log(`[eme] Patching keyId in 'enc${l?"a":"v"}>sinf>>tenc' box: ${pn.hexDump(p)} -> ${pn.hexDump(t)}`),h.set(t,8))}})})}),s}function Iv(s){const e=Ze(s,["schm"])[0];if(e){const t=Bt(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return Ze(s,["schi","tenc"])[0]}return V.error("[eme] missing 'schm' box"),null}function PD(s,e){return Ze(e,["moof","traf"]).reduce((t,n)=>{const i=Ze(n,["tfdt"])[0],r=i[0],o=Ze(n,["tfhd"]).reduce((a,l)=>{const c=Ne(l,4),u=s[c];if(u){let d=Ne(i,4);if(r===1){if(d===Rl)return V.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),a;d*=Rl+1,d+=Ne(i,8)}const f=u.timescale||9e4,h=d/f;if(Ee(h)&&(a===null||h<a))return h}return a},null);return o!==null&&Ee(o)&&(t===null||o<t)?o:t},null)}function FD(s,e){let t=0,n=0,i=0;const r=Ze(s,["moof","traf"]);for(let o=0;o<r.length;o++){const a=r[o],l=Ze(a,["tfhd"])[0],c=Ne(l,4),u=e[c];if(!u)continue;const d=u.default,f=Ne(l,0)|(d==null?void 0:d.flags);let h=d==null?void 0:d.duration;f&8&&(f&2?h=Ne(l,12):h=Ne(l,8));const p=u.timescale||9e4,g=Ze(a,["trun"]);for(let m=0;m<g.length;m++){if(t=OD(g[m]),!t&&h){const _=Ne(g[m],4);t=h*_}u.type===mt.VIDEO?n+=t/p:u.type===mt.AUDIO&&(i+=t/p)}}if(n===0&&i===0){let o=1/0,a=0,l=0;const c=Ze(s,["sidx"]);for(let u=0;u<c.length;u++){const d=RD(c[u]);if(d!=null&&d.references){o=Math.min(o,d.earliestPresentationTime/d.timescale);const f=d.references.reduce((h,p)=>h+p.info.duration||0,0);a=Math.max(a,f+d.earliestPresentationTime/d.timescale),l=a-o}}if(l&&Ee(l))return l}return n||i}function OD(s){const e=Ne(s,0);let t=8;e&1&&(t+=4),e&4&&(t+=4);let n=0;const i=Ne(s,4);for(let r=0;r<i;r++){if(e&256){const o=Ne(s,t);n+=o,t+=4}e&512&&(t+=4),e&1024&&(t+=4),e&2048&&(t+=4)}return n}function MD(s,e,t){Ze(e,["moof","traf"]).forEach(n=>{Ze(n,["tfhd"]).forEach(i=>{const r=Ne(i,4),o=s[r];if(!o)return;const a=o.timescale||9e4;Ze(n,["tfdt"]).forEach(l=>{const c=l[0],u=t*a;if(u){let d=Ne(l,4);if(c===0)d-=u,d=Math.max(d,0),Zc(l,4,d);else{d*=Math.pow(2,32),d+=Ne(l,8),d-=u,d=Math.max(d,0);const f=Math.floor(d/(Rl+1)),h=Math.floor(d%(Rl+1));Zc(l,4,f),Zc(l,8,h)}}})})})}function $D(s){const e={valid:null,remainder:null},t=Ze(s,["moof"]);if(t.length<2)return e.remainder=s,e;const n=t[t.length-1];return e.valid=Yi(s,0,n.byteOffset-8),e.remainder=Yi(s,n.byteOffset-8),e}function Ks(s,e){const t=new Uint8Array(s.length+e.length);return t.set(s),t.set(e,s.length),t}function Lp(s,e){const t=[],n=e.samples,i=e.timescale,r=e.id;let o=!1;return Ze(n,["moof"]).map(l=>{const c=l.byteOffset-8;Ze(l,["traf"]).map(d=>{const f=Ze(d,["tfdt"]).map(h=>{const p=h[0];let g=Ne(h,4);return p===1&&(g*=Math.pow(2,32),g+=Ne(h,8)),g/i})[0];return f!==void 0&&(s=f),Ze(d,["tfhd"]).map(h=>{const p=Ne(h,4),g=Ne(h,0)&16777215,m=(g&1)!==0,_=(g&2)!==0,y=(g&8)!==0;let S=0;const C=(g&16)!==0;let E=0;const A=(g&32)!==0;let R=8;p===r&&(m&&(R+=8),_&&(R+=4),y&&(S=Ne(h,R),R+=4),C&&(E=Ne(h,R),R+=4),A&&(R+=4),e.type==="video"&&(o=ND(e.codec)),Ze(d,["trun"]).map(I=>{const D=I[0],L=Ne(I,0)&16777215,M=(L&1)!==0;let $=0;const H=(L&4)!==0,ie=(L&256)!==0;let te=0;const X=(L&512)!==0;let de=0;const xe=(L&1024)!==0,le=(L&2048)!==0;let re=0;const Be=Ne(I,4);let be=8;M&&($=Ne(I,be),be+=4),H&&(be+=4);let Fe=$+c;for(let We=0;We<Be;We++){if(ie?(te=Ne(I,be),be+=4):te=S,X?(de=Ne(I,be),be+=4):de=E,xe&&(be+=4),le&&(D===0?re=Ne(I,be):re=Lv(I,be),be+=4),e.type===mt.VIDEO){let ot=0;for(;ot<de;){const Ue=Ne(n,Fe);if(Fe+=4,VD(o,n[Fe])){const K=n.subarray(Fe,Fe+Ue);Dv(K,o?2:1,s+re/i,t)}Fe+=Ue,ot+=Ue+4}}s+=te/i}}))})})}),t}function ND(s){if(!s)return!1;const e=s.indexOf("."),t=e<0?s:s.substring(0,e);return t==="hvc1"||t==="hev1"||t==="dvh1"||t==="dvhe"}function VD(s,e){if(s){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function Dv(s,e,t,n){const i=Pv(s);let r=0;r+=e;let o=0,a=0,l=0;for(;r<i.length;){o=0;do{if(r>=i.length)break;l=i[r++],o+=l}while(l===255);a=0;do{if(r>=i.length)break;l=i[r++],a+=l}while(l===255);const c=i.length-r;let u=r;if(a<c)r+=a;else if(a>c){V.error(`Malformed SEI payload. ${a} is too small, only ${c} bytes left to parse.`);break}if(o===4){if(i[u++]===181){const f=kv(i,u);if(u+=2,f===49){const h=Ne(i,u);if(u+=4,h===1195456820){const p=i[u++];if(p===3){const g=i[u++],m=31&g,_=64&g,y=_?2+m*3:0,S=new Uint8Array(y);if(_){S[0]=g;for(let C=1;C<y;C++)S[C]=i[u++]}n.push({type:p,payloadType:o,pts:t,bytes:S})}}}}}else if(o===5&&a>16){const d=[];for(let p=0;p<16;p++){const g=i[u++].toString(16);d.push(g.length==1?"0"+g:g),(p===3||p===5||p===7||p===9)&&d.push("-")}const f=a-16,h=new Uint8Array(f);for(let p=0;p<f;p++)h[p]=i[u++];n.push({payloadType:o,pts:t,uuid:d.join(""),userData:bn(h),userDataBytes:h})}}}function Pv(s){const e=s.byteLength,t=[];let n=1;for(;n<e-2;)s[n]===0&&s[n+1]===0&&s[n+2]===3?(t.push(n+2),n+=2):n++;if(t.length===0)return s;const i=e-t.length,r=new Uint8Array(i);let o=0;for(n=0;n<i;o++,n++)o===t[0]&&(o++,t.shift()),r[n]=s[o];return r}function BD(s){const e=s[0];let t="",n="",i=0,r=0,o=0,a=0,l=0,c=0;if(e===0){for(;Bt(s.subarray(c,c+1))!=="\0";)t+=Bt(s.subarray(c,c+1)),c+=1;for(t+=Bt(s.subarray(c,c+1)),c+=1;Bt(s.subarray(c,c+1))!=="\0";)n+=Bt(s.subarray(c,c+1)),c+=1;n+=Bt(s.subarray(c,c+1)),c+=1,i=Ne(s,12),r=Ne(s,16),a=Ne(s,20),l=Ne(s,24),c=28}else if(e===1){c+=4,i=Ne(s,c),c+=4;const d=Ne(s,c);c+=4;const f=Ne(s,c);for(c+=4,o=2**32*d+f,nD(o)||(o=Number.MAX_SAFE_INTEGER,V.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),a=Ne(s,c),c+=4,l=Ne(s,c),c+=4;Bt(s.subarray(c,c+1))!=="\0";)t+=Bt(s.subarray(c,c+1)),c+=1;for(t+=Bt(s.subarray(c,c+1)),c+=1;Bt(s.subarray(c,c+1))!=="\0";)n+=Bt(s.subarray(c,c+1)),c+=1;n+=Bt(s.subarray(c,c+1)),c+=1}const u=s.subarray(c,s.byteLength);return{schemeIdUri:t,value:n,timeScale:i,presentationTime:o,presentationTimeDelta:r,eventDuration:a,id:l,payload:u}}function UD(s,...e){const t=e.length;let n=8,i=t;for(;i--;)n+=e[i].byteLength;const r=new Uint8Array(n);for(r[0]=n>>24&255,r[1]=n>>16&255,r[2]=n>>8&255,r[3]=n&255,r.set(s,4),i=0,n=8;i<t;i++)r.set(e[i],n),n+=e[i].byteLength;return r}function HD(s,e,t){if(s.byteLength!==16)throw new RangeError("Invalid system id");let n,i;if(e){n=1,i=new Uint8Array(e.length*16);for(let a=0;a<e.length;a++){const l=e[a];if(l.byteLength!==16)throw new RangeError("Invalid key");i.set(l,a*16)}}else n=0,i=new Uint8Array;let r;n>0?(r=new Uint8Array(4),e.length>0&&new DataView(r.buffer).setUint32(0,e.length,!1)):r=new Uint8Array;const o=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(o.buffer).setUint32(0,t.byteLength,!1),UD([112,115,115,104],new Uint8Array([n,0,0,0]),s,r,i,o,t||new Uint8Array)}function GD(s){if(!(s instanceof ArrayBuffer)||s.byteLength<32)return null;const e={version:0,systemId:"",kids:null,data:null},t=new DataView(s),n=t.getUint32(0);if(s.byteLength!==n&&n>44||t.getUint32(4)!==1886614376||(e.version=t.getUint32(8)>>>24,e.version>1))return null;e.systemId=pn.hexDump(new Uint8Array(s,12,16));const r=t.getUint32(28);if(e.version===0){if(n-32<r)return null;e.data=new Uint8Array(s,32,r)}else if(e.version===1){e.kids=[];for(let o=0;o<r;o++)e.kids.push(new Uint8Array(s,32+o*16,16))}return e}let Ta={};class jo{static clearKeyUriToKeyIdMap(){Ta={}}constructor(e,t,n,i=[1],r=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=i,this.iv=r,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&e!=="AES-128"}isSupported(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case bs.FAIRPLAY:case bs.WIDEVINE:case bs.PLAYREADY:case bs.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof e!="number"&&(this.method==="AES-128"&&!this.iv&&V.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const n=zD(e);return new jo(this.method,this.uri,"identity",this.keyFormatVersions,n)}const t=mD(this.uri);if(t)switch(this.keyFormat){case bs.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case bs.PLAYREADY:{const n=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=HD(n,null,t);const i=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),r=String.fromCharCode.apply(null,Array.from(i)),o=r.substring(r.indexOf("<"),r.length),c=new DOMParser().parseFromString(o,"text/xml").getElementsByTagName("KID")[0];if(c){const u=c.childNodes[0]?c.childNodes[0].nodeValue:c.getAttribute("VALUE");if(u){const d=Pf(u).subarray(0,16);gD(d),this.keyId=d}}break}default:{let n=t.subarray(0,16);if(n.length!==16){const i=new Uint8Array(16);i.set(n,16-n.length),n=i}this.keyId=n;break}}if(!this.keyId||this.keyId.byteLength!==16){let n=Ta[this.uri];if(!n){const i=Object.keys(Ta).length%Number.MAX_SAFE_INTEGER;n=new Uint8Array(16),new DataView(n.buffer,12,4).setUint32(0,i),Ta[this.uri]=n}this.keyId=n}return this}}function zD(s){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=s>>8*(15-t)&255;return e}const Fv=/\{\$([a-zA-Z0-9-_]+)\}/g;function Rp(s){return Fv.test(s)}function _s(s,e,t){if(s.variableList!==null||s.hasVariableRefs)for(let n=t.length;n--;){const i=t[n],r=e[i];r&&(e[i]=gd(s,r))}}function gd(s,e){if(s.variableList!==null||s.hasVariableRefs){const t=s.variableList;return e.replace(Fv,n=>{const i=n.substring(2,n.length-1),r=t==null?void 0:t[i];return r===void 0?(s.playlistParsingError||(s.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${i}"`)),n):r})}return e}function Ip(s,e,t){let n=s.variableList;n||(s.variableList=n={});let i,r;if("QUERYPARAM"in e){i=e.QUERYPARAM;try{const o=new self.URL(t).searchParams;if(o.has(i))r=o.get(i);else throw new Error(`"${i}" does not match any query parameter in URI: "${t}"`)}catch(o){s.playlistParsingError||(s.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${o.message}`))}}else i=e.NAME,r=e.VALUE;i in n?s.playlistParsingError||(s.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${i}"`)):n[i]=r||""}function jD(s,e,t){const n=e.IMPORT;if(t&&n in t){let i=s.variableList;i||(s.variableList=i={}),i[n]=t[n]}else s.playlistParsingError||(s.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${n}"`))}function no(s=!0){return typeof self>"u"?void 0:(s||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}const Il={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function qD(s,e){const t=Il[e];return!!t&&!!t[s.slice(0,4)]}function Qc(s,e,t=!0){return!s.split(",").some(n=>!Ov(n,e,t))}function Ov(s,e,t=!0){var n;const i=no(t);return(n=i==null?void 0:i.isTypeSupported(qo(s,e)))!=null?n:!1}function qo(s,e){return`${e}/mp4;codecs="${s}"`}function Dp(s){if(s){const e=s.substring(0,4);return Il.video[e]}return 2}function Dl(s){return s.split(",").reduce((e,t)=>{const n=Il.video[t];return n?(n*2+e)/(e?3:2):(Il.audio[t]+e)/(e?2:1)},0)}const Jc={};function KD(s,e=!0){if(Jc[s])return Jc[s];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"]}[s];for(let n=0;n<t.length;n++)if(Ov(t[n],"audio",e))return Jc[s]=t[n],t[n];return s}const WD=/flac|opus/i;function Pl(s,e=!0){return s.replace(WD,t=>KD(t.toLowerCase(),e))}function Pp(s,e){return s&&s!=="mp4a"?s:e}function YD(s){const e=s.split(".");if(e.length>2){let t=e.shift()+".";return t+=parseInt(e.shift()).toString(16),t+=("000"+parseInt(e.shift()).toString(16)).slice(-4),t}return s}const Fp=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,Op=/#EXT-X-MEDIA:(.*)/g,ZD=/^#EXT(?:INF|-X-TARGETDURATION):/m,Mp=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),XD=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class _n{static findGroup(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(i.id===t)return i}}static resolve(e,t){return Df.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return ZD.test(e)}static parseMasterPlaylist(e,t){const n=Rp(e),i={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:n},r=[];Fp.lastIndex=0;let o;for(;(o=Fp.exec(e))!=null;)if(o[1]){var a;const c=new Lt(o[1]);_s(i,c,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const u=gd(i,o[2]),d={attrs:c,bitrate:c.decimalInteger("BANDWIDTH")||c.decimalInteger("AVERAGE-BANDWIDTH"),name:c.NAME,url:_n.resolve(u,t)},f=c.decimalResolution("RESOLUTION");f&&(d.width=f.width,d.height=f.height),QD(c.CODECS,d),(a=d.unknownCodecs)!=null&&a.length||r.push(d),i.levels.push(d)}else if(o[3]){const c=o[3],u=o[4];switch(c){case"SESSION-DATA":{const d=new Lt(u);_s(i,d,["DATA-ID","LANGUAGE","VALUE","URI"]);const f=d["DATA-ID"];f&&(i.sessionData===null&&(i.sessionData={}),i.sessionData[f]=d);break}case"SESSION-KEY":{const d=$p(u,t,i);d.encrypted&&d.isSupported()?(i.sessionKeys===null&&(i.sessionKeys=[]),i.sessionKeys.push(d)):V.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${u}"`);break}case"DEFINE":{{const d=new Lt(u);_s(i,d,["NAME","VALUE","QUERYPARAM"]),Ip(i,d,t)}break}case"CONTENT-STEERING":{const d=new Lt(u);_s(i,d,["SERVER-URI","PATHWAY-ID"]),i.contentSteering={uri:_n.resolve(d["SERVER-URI"],t),pathwayId:d["PATHWAY-ID"]||"."};break}case"START":{i.startTimeOffset=Np(u);break}}}const l=r.length>0&&r.length<i.levels.length;return i.levels=l?r:i.levels,i.levels.length===0&&(i.playlistParsingError=new Error("no levels found in manifest")),i}static parseMasterPlaylistMedia(e,t,n){let i;const r={},o=n.levels,a={AUDIO:o.map(c=>({id:c.attrs.AUDIO,audioCodec:c.audioCodec})),SUBTITLES:o.map(c=>({id:c.attrs.SUBTITLES,textCodec:c.textCodec})),"CLOSED-CAPTIONS":[]};let l=0;for(Op.lastIndex=0;(i=Op.exec(e))!==null;){const c=new Lt(i[1]),u=c.TYPE;if(u){const d=a[u],f=r[u]||[];r[u]=f,_s(n,c,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const h=c.LANGUAGE,p=c["ASSOC-LANGUAGE"],g=c.CHANNELS,m=c.CHARACTERISTICS,_=c["INSTREAM-ID"],y={attrs:c,bitrate:0,id:l++,groupId:c["GROUP-ID"]||"",name:c.NAME||h||"",type:u,default:c.bool("DEFAULT"),autoselect:c.bool("AUTOSELECT"),forced:c.bool("FORCED"),lang:h,url:c.URI?_n.resolve(c.URI,t):""};if(p&&(y.assocLang=p),g&&(y.channels=g),m&&(y.characteristics=m),_&&(y.instreamId=_),d!=null&&d.length){const S=_n.findGroup(d,y.groupId)||d[0];Vp(y,S,"audioCodec"),Vp(y,S,"textCodec")}f.push(y)}}return r}static parseLevelPlaylist(e,t,n,i,r,o){const a=new hD(t),l=a.fragments;let c=null,u=0,d=0,f=0,h=0,p=null,g=new Kc(i,t),m,_,y,S=-1,C=!1,E=null;for(Mp.lastIndex=0,a.m3u8=e,a.hasVariableRefs=Rp(e);(m=Mp.exec(e))!==null;){C&&(C=!1,g=new Kc(i,t),g.start=f,g.sn=u,g.cc=h,g.level=n,c&&(g.initSegment=c,g.rawProgramDateTime=c.rawProgramDateTime,c.rawProgramDateTime=null,E&&(g.setByteRange(E),E=null)));const D=m[1];if(D){g.duration=parseFloat(D);const L=(" "+m[2]).slice(1);g.title=L||null,g.tagList.push(L?["INF",D,L]:["INF",D])}else if(m[3]){if(Ee(g.duration)){g.start=f,y&&Hp(g,y,a),g.sn=u,g.level=n,g.cc=h,l.push(g);const L=(" "+m[3]).slice(1);g.relurl=gd(a,L),Bp(g,p),p=g,f+=g.duration,u++,d=0,C=!0}}else if(m[4]){const L=(" "+m[4]).slice(1);p?g.setByteRange(L,p):g.setByteRange(L)}else if(m[5])g.rawProgramDateTime=(" "+m[5]).slice(1),g.tagList.push(["PROGRAM-DATE-TIME",g.rawProgramDateTime]),S===-1&&(S=l.length);else{if(m=m[0].match(XD),!m){V.warn("No matches on slow regex match for level playlist!");continue}for(_=1;_<m.length&&!(typeof m[_]<"u");_++);const L=(" "+m[_]).slice(1),M=(" "+m[_+1]).slice(1),$=m[_+2]?(" "+m[_+2]).slice(1):"";switch(L){case"PLAYLIST-TYPE":a.type=M.toUpperCase();break;case"MEDIA-SEQUENCE":u=a.startSN=parseInt(M);break;case"SKIP":{const H=new Lt(M);_s(a,H,["RECENTLY-REMOVED-DATERANGES"]);const ie=H.decimalInteger("SKIPPED-SEGMENTS");if(Ee(ie)){a.skippedSegments=ie;for(let X=ie;X--;)l.unshift(null);u+=ie}const te=H.enumeratedString("RECENTLY-REMOVED-DATERANGES");te&&(a.recentlyRemovedDateranges=te.split("	"));break}case"TARGETDURATION":a.targetduration=Math.max(parseInt(M),1);break;case"VERSION":a.version=parseInt(M);break;case"INDEPENDENT-SEGMENTS":case"EXTM3U":break;case"ENDLIST":a.live=!1;break;case"#":(M||$)&&g.tagList.push($?[M,$]:[M]);break;case"DISCONTINUITY":h++,g.tagList.push(["DIS"]);break;case"GAP":g.gap=!0,g.tagList.push([L]);break;case"BITRATE":g.tagList.push([L,M]);break;case"DATERANGE":{const H=new Lt(M);_s(a,H,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),_s(a,H,H.clientAttrs);const ie=new xv(H,a.dateRanges[H.ID]);ie.isValid||a.skippedSegments?a.dateRanges[ie.id]=ie:V.warn(`Ignoring invalid DATERANGE tag: "${M}"`),g.tagList.push(["EXT-X-DATERANGE",M]);break}case"DEFINE":{{const H=new Lt(M);_s(a,H,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in H?jD(a,H,o):Ip(a,H,t)}break}case"DISCONTINUITY-SEQUENCE":h=parseInt(M);break;case"KEY":{const H=$p(M,t,a);if(H.isSupported()){if(H.method==="NONE"){y=void 0;break}y||(y={}),y[H.keyFormat]&&(y=Vt({},y)),y[H.keyFormat]=H}else V.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${M}"`);break}case"START":a.startTimeOffset=Np(M);break;case"MAP":{const H=new Lt(M);if(_s(a,H,["BYTERANGE","URI"]),g.duration){const ie=new Kc(i,t);Up(ie,H,n,y),c=ie,g.initSegment=c,c.rawProgramDateTime&&!g.rawProgramDateTime&&(g.rawProgramDateTime=c.rawProgramDateTime)}else{const ie=g.byteRangeEndOffset;if(ie){const te=g.byteRangeStartOffset;E=`${ie-te}@${te}`}else E=null;Up(g,H,n,y),c=g,C=!0}break}case"SERVER-CONTROL":{const H=new Lt(M);a.canBlockReload=H.bool("CAN-BLOCK-RELOAD"),a.canSkipUntil=H.optionalFloat("CAN-SKIP-UNTIL",0),a.canSkipDateRanges=a.canSkipUntil>0&&H.bool("CAN-SKIP-DATERANGES"),a.partHoldBack=H.optionalFloat("PART-HOLD-BACK",0),a.holdBack=H.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const H=new Lt(M);a.partTarget=H.decimalFloatingPoint("PART-TARGET");break}case"PART":{let H=a.partList;H||(H=a.partList=[]);const ie=d>0?H[H.length-1]:void 0,te=d++,X=new Lt(M);_s(a,X,["BYTERANGE","URI"]);const de=new dD(X,g,t,te,ie);H.push(de),g.duration+=de.duration;break}case"PRELOAD-HINT":{const H=new Lt(M);_s(a,H,["URI"]),a.preloadHint=H;break}case"RENDITION-REPORT":{const H=new Lt(M);_s(a,H,["URI"]),a.renditionReports=a.renditionReports||[],a.renditionReports.push(H);break}default:V.warn(`line parsed but not handled: ${m}`);break}}}p&&!p.relurl?(l.pop(),f-=p.duration,a.partList&&(a.fragmentHint=p)):a.partList&&(Bp(g,p),g.cc=h,a.fragmentHint=g,y&&Hp(g,y,a));const A=l.length,R=l[0],I=l[A-1];if(f+=a.skippedSegments*a.targetduration,f>0&&A&&I){a.averagetargetduration=f/A;const D=I.sn;a.endSN=D!=="initSegment"?D:0,a.live||(I.endList=!0),R&&(a.startCC=R.cc)}else a.endSN=0,a.startCC=0;return a.fragmentHint&&(f+=a.fragmentHint.duration),a.totalduration=f,a.endCC=h,S>0&&JD(l,S),a}}function $p(s,e,t){var n,i;const r=new Lt(s);_s(t,r,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const o=(n=r.METHOD)!=null?n:"",a=r.URI,l=r.hexadecimalInteger("IV"),c=r.KEYFORMATVERSIONS,u=(i=r.KEYFORMAT)!=null?i:"identity";a&&r.IV&&!l&&V.error(`Invalid IV: ${r.IV}`);const d=a?_n.resolve(a,e):"",f=(c||"1").split("/").map(Number).filter(Number.isFinite);return new jo(o,d,u,f,l)}function Np(s){const t=new Lt(s).decimalFloatingPoint("TIME-OFFSET");return Ee(t)?t:null}function QD(s,e){let t=(s||"").split(/[ ,]+/).filter(n=>n);["video","audio","text"].forEach(n=>{const i=t.filter(r=>qD(r,n));i.length&&(e[`${n}Codec`]=i.join(","),t=t.filter(r=>i.indexOf(r)===-1))}),e.unknownCodecs=t}function Vp(s,e,t){const n=e[t];n&&(s[t]=n)}function JD(s,e){let t=s[e];for(let n=e;n--;){const i=s[n];if(!i)return;i.programDateTime=t.programDateTime-i.duration*1e3,t=i}}function Bp(s,e){s.rawProgramDateTime?s.programDateTime=Date.parse(s.rawProgramDateTime):e!=null&&e.programDateTime&&(s.programDateTime=e.endProgramDateTime),Ee(s.programDateTime)||(s.programDateTime=null,s.rawProgramDateTime=null)}function Up(s,e,t,n){s.relurl=e.URI,e.BYTERANGE&&s.setByteRange(e.BYTERANGE),s.level=t,s.sn="initSegment",n&&(s.levelkeys=n),s.initSegment=null}function Hp(s,e,t){s.levelkeys=e;const{encryptedFragments:n}=t;(!n.length||n[n.length-1].levelkeys!==e)&&Object.keys(e).some(i=>e[i].isCommonEncryption)&&n.push(s)}var rt={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},He={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function Gp(s){const{type:e}=s;switch(e){case rt.AUDIO_TRACK:return He.AUDIO;case rt.SUBTITLE_TRACK:return He.SUBTITLE;default:return He.MAIN}}function eu(s,e){let t=s.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class eP{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.LEVEL_LOADING,this.onLevelLoading,this),e.on(b.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(b.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:e}=this;e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.LEVEL_LOADING,this.onLevelLoading,this),e.off(b.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(b.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){const t=this.hls.config,n=t.pLoader,i=t.loader,r=n||i,o=new r(t);return this.loaders[e.type]=o,o}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:rt.MANIFEST,url:n,deliveryDirectives:null})}onLevelLoading(e,t){const{id:n,level:i,pathwayId:r,url:o,deliveryDirectives:a}=t;this.load({id:n,level:i,pathwayId:r,responseType:"text",type:rt.LEVEL,url:o,deliveryDirectives:a})}onAudioTrackLoading(e,t){const{id:n,groupId:i,url:r,deliveryDirectives:o}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:rt.AUDIO_TRACK,url:r,deliveryDirectives:o})}onSubtitleTrackLoading(e,t){const{id:n,groupId:i,url:r,deliveryDirectives:o}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:rt.SUBTITLE_TRACK,url:r,deliveryDirectives:o})}load(e){var t;const n=this.hls.config;let i=this.getInternalLoader(e);if(i){const c=i.context;if(c&&c.url===e.url&&c.level===e.level){V.trace("[playlist-loader]: playlist request ongoing");return}V.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),i.abort()}let r;if(e.type===rt.MANIFEST?r=n.manifestLoadPolicy.default:r=Vt({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),i=this.createInternalLoader(e),Ee((t=e.deliveryDirectives)==null?void 0:t.part)){let c;if(e.type===rt.LEVEL&&e.level!==null?c=this.hls.levels[e.level].details:e.type===rt.AUDIO_TRACK&&e.id!==null?c=this.hls.audioTracks[e.id].details:e.type===rt.SUBTITLE_TRACK&&e.id!==null&&(c=this.hls.subtitleTracks[e.id].details),c){const u=c.partTarget,d=c.targetduration;if(u&&d){const f=Math.max(u*3,d*.8)*1e3;r=Vt({},r,{maxTimeToFirstByteMs:Math.min(f,r.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(f,r.maxTimeToFirstByteMs)})}}}const o=r.errorRetry||r.timeoutRetry||{},a={loadPolicy:r,timeout:r.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},l={onSuccess:(c,u,d,f)=>{const h=this.getInternalLoader(d);this.resetInternalLoader(d.type);const p=c.data;if(p.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(c,d,new Error("no EXTM3U delimiter"),f||null,u);return}u.parsing.start=performance.now(),_n.isMediaPlaylist(p)?this.handleTrackOrLevelPlaylist(c,u,d,f||null,h):this.handleMasterPlaylist(c,u,d,f)},onError:(c,u,d,f)=>{this.handleNetworkError(u,d,!1,c,f)},onTimeout:(c,u,d)=>{this.handleNetworkError(u,d,!0,void 0,c)}};i.load(e,a,l)}handleMasterPlaylist(e,t,n,i){const r=this.hls,o=e.data,a=eu(e,n),l=_n.parseMasterPlaylist(o,a);if(l.playlistParsingError){this.handleManifestParsingError(e,n,l.playlistParsingError,i,t);return}const{contentSteering:c,levels:u,sessionData:d,sessionKeys:f,startTimeOffset:h,variableList:p}=l;this.variableList=p;const{AUDIO:g=[],SUBTITLES:m,"CLOSED-CAPTIONS":_}=_n.parseMasterPlaylistMedia(o,a,l);g.length&&!g.some(S=>!S.url)&&u[0].audioCodec&&!u[0].attrs.AUDIO&&(V.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),g.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new Lt({}),bitrate:0,url:""})),r.trigger(b.MANIFEST_LOADED,{levels:u,audioTracks:g,subtitles:m,captions:_,contentSteering:c,url:a,stats:t,networkDetails:i,sessionData:d,sessionKeys:f,startTimeOffset:h,variableList:p})}handleTrackOrLevelPlaylist(e,t,n,i,r){const o=this.hls,{id:a,level:l,type:c}=n,u=eu(e,n),d=0,f=Ee(l)?l:Ee(a)?a:0,h=Gp(n),p=_n.parseLevelPlaylist(e.data,u,f,h,d,this.variableList);if(c===rt.MANIFEST){const g={attrs:new Lt({}),bitrate:0,details:p,name:"",url:u};o.trigger(b.MANIFEST_LOADED,{levels:[g],audioTracks:[],url:u,stats:t,networkDetails:i,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=p,this.handlePlaylistLoaded(p,e,t,n,i,r)}handleManifestParsingError(e,t,n,i,r){this.hls.trigger(b.ERROR,{type:Ge.NETWORK_ERROR,details:j.MANIFEST_PARSING_ERROR,fatal:t.type===rt.MANIFEST,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:i,stats:r})}handleNetworkError(e,t,n=!1,i,r){let o=`A network ${n?"timeout":"error"+(i?" (status "+i.code+")":"")} occurred while loading ${e.type}`;e.type===rt.LEVEL?o+=`: ${e.level} id: ${e.id}`:(e.type===rt.AUDIO_TRACK||e.type===rt.SUBTITLE_TRACK)&&(o+=` id: ${e.id} group-id: "${e.groupId}"`);const a=new Error(o);V.warn(`[playlist-loader]: ${o}`);let l=j.UNKNOWN,c=!1;const u=this.getInternalLoader(e);switch(e.type){case rt.MANIFEST:l=n?j.MANIFEST_LOAD_TIMEOUT:j.MANIFEST_LOAD_ERROR,c=!0;break;case rt.LEVEL:l=n?j.LEVEL_LOAD_TIMEOUT:j.LEVEL_LOAD_ERROR,c=!1;break;case rt.AUDIO_TRACK:l=n?j.AUDIO_TRACK_LOAD_TIMEOUT:j.AUDIO_TRACK_LOAD_ERROR,c=!1;break;case rt.SUBTITLE_TRACK:l=n?j.SUBTITLE_TRACK_LOAD_TIMEOUT:j.SUBTITLE_LOAD_ERROR,c=!1;break}u&&this.resetInternalLoader(e.type);const d={type:Ge.NETWORK_ERROR,details:l,fatal:c,url:e.url,loader:u,context:e,error:a,networkDetails:t,stats:r};if(i){const f=(t==null?void 0:t.url)||e.url;d.response=Zt({url:f,data:void 0},i)}this.hls.trigger(b.ERROR,d)}handlePlaylistLoaded(e,t,n,i,r,o){const a=this.hls,{type:l,level:c,id:u,groupId:d,deliveryDirectives:f}=i,h=eu(t,i),p=Gp(i),g=typeof i.level=="number"&&p===He.MAIN?c:void 0;if(!e.fragments.length){const _=new Error("No Segments found in Playlist");a.trigger(b.ERROR,{type:Ge.NETWORK_ERROR,details:j.LEVEL_EMPTY_ERROR,fatal:!1,url:h,error:_,reason:_.message,response:t,context:i,level:g,parent:p,networkDetails:r,stats:n});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const m=e.playlistParsingError;if(m){a.trigger(b.ERROR,{type:Ge.NETWORK_ERROR,details:j.LEVEL_PARSING_ERROR,fatal:!1,url:h,error:m,reason:m.message,response:t,context:i,level:g,parent:p,networkDetails:r,stats:n});return}switch(e.live&&o&&(o.getCacheAge&&(e.ageHeader=o.getCacheAge()||0),(!o.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),l){case rt.MANIFEST:case rt.LEVEL:a.trigger(b.LEVEL_LOADED,{details:e,level:g||0,id:u||0,stats:n,networkDetails:r,deliveryDirectives:f});break;case rt.AUDIO_TRACK:a.trigger(b.AUDIO_TRACK_LOADED,{details:e,id:u||0,groupId:d||"",stats:n,networkDetails:r,deliveryDirectives:f});break;case rt.SUBTITLE_TRACK:a.trigger(b.SUBTITLE_TRACK_LOADED,{details:e,id:u||0,groupId:d||"",stats:n,networkDetails:r,deliveryDirectives:f});break}}}function Mv(s,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=s,e.dispatchEvent(t)}function $v(s,e){const t=s.mode;if(t==="disabled"&&(s.mode="hidden"),s.cues&&!s.cues.getCueById(e.id))try{if(s.addCue(e),!s.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(n){V.debug(`[texttrack-utils]: ${n}`);try{const i=new self.TextTrackCue(e.startTime,e.endTime,e.text);i.id=e.id,s.addCue(i)}catch(i){V.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${i}`)}}t==="disabled"&&(s.mode=t)}function Ar(s){const e=s.mode;if(e==="disabled"&&(s.mode="hidden"),s.cues)for(let t=s.cues.length;t--;)s.removeCue(s.cues[t]);e==="disabled"&&(s.mode=e)}function md(s,e,t,n){const i=s.mode;if(i==="disabled"&&(s.mode="hidden"),s.cues&&s.cues.length>0){const r=sP(s.cues,e,t);for(let o=0;o<r.length;o++)(!n||n(r[o]))&&s.removeCue(r[o])}i==="disabled"&&(s.mode=i)}function tP(s,e){if(e<s[0].startTime)return 0;const t=s.length-1;if(e>s[t].endTime)return-1;let n=0,i=t;for(;n<=i;){const r=Math.floor((i+n)/2);if(e<s[r].startTime)i=r-1;else if(e>s[r].startTime&&n<t)n=r+1;else return r}return s[n].startTime-e<e-s[i].startTime?n:i}function sP(s,e,t){const n=[],i=tP(s,e);if(i>-1)for(let r=i,o=s.length;r<o;r++){const a=s[r];if(a.startTime>=e&&a.endTime<=t)n.push(a);else if(a.startTime>t)return n}return n}function Qa(s){const e=[];for(let t=0;t<s.length;t++){const n=s[t];(n.kind==="subtitles"||n.kind==="captions")&&n.label&&e.push(s[t])}return e}var sn={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"};const nP=.25;function vd(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function zp(s,e,t,n,i){let r=new s(e,t,"");try{r.value=n,i&&(r.type=i)}catch{r=new s(e,t,JSON.stringify(i?Zt({type:i},n):n))}return r}const Ca=(()=>{const s=vd();try{s&&new s(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function tu(s,e){return s.getTime()/1e3-e}function iP(s){return Uint8Array.from(s.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class rP{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:e}=this;e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(b.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(b.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){!this.id3Track||(Ar(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(!!this.media){for(let t=0;t<e.length;t++){const n=e[t];if(n.kind==="metadata"&&n.label==="id3")return Mv(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:n,enableID3MetadataCues:i}}}=this;if(!n&&!i)return;const{samples:r}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const o=vd();if(!!o)for(let a=0;a<r.length;a++){const l=r[a].type;if(l===sn.emsg&&!n||!i)continue;const c=Cv(r[a].data);if(c){const u=r[a].pts;let d=u+r[a].duration;d>Ca&&(d=Ca),d-u<=0&&(d=u+nP);for(let h=0;h<c.length;h++){const p=c[h];if(!Tv(p)){this.updateId3CueEnds(u,l);const g=zp(o,u,d,p,l);g&&this.id3Track.addCue(g)}}}}}updateId3CueEnds(e,t){var n;const i=(n=this.id3Track)==null?void 0:n.cues;if(i)for(let r=i.length;r--;){const o=i[r];o.type===t&&o.startTime<e&&o.endTime===Ca&&(o.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:i}){const{id3Track:r,hls:o}=this;if(!o)return;const{config:{enableEmsgMetadataCues:a,enableID3MetadataCues:l}}=o;if(r&&(a||l)){let c;i==="audio"?c=u=>u.type===sn.audioId3&&l:i==="video"?c=u=>u.type===sn.emsg&&a:c=u=>u.type===sn.audioId3&&l||u.type===sn.emsg&&a,md(r,t,n,c)}}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:n,id3Track:i}=this,{dateRanges:r}=t,o=Object.keys(r);if(i){const u=Object.keys(n).filter(d=>!o.includes(d));for(let d=u.length;d--;){const f=u[d];Object.keys(n[f].cues).forEach(h=>{i.removeCue(n[f].cues[h])}),delete n[f]}}const a=t.fragments[t.fragments.length-1];if(o.length===0||!Ee(a==null?void 0:a.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const l=a.programDateTime/1e3-a.start,c=vd();for(let u=0;u<o.length;u++){const d=o[u],f=r[d],h=tu(f.startDate,l),p=n[d],g=(p==null?void 0:p.cues)||{};let m=(p==null?void 0:p.durationKnown)||!1,_=Ca;const y=f.endDate;if(y)_=tu(y,l),m=!0;else if(f.endOnNext&&!m){const C=o.reduce((E,A)=>{if(A!==f.id){const R=r[A];if(R.class===f.class&&R.startDate>f.startDate&&(!E||f.startDate<E.startDate))return R}return E},null);C&&(_=tu(C.startDate,l),m=!0)}const S=Object.keys(f.attr);for(let C=0;C<S.length;C++){const E=S[C];if(!cD(E))continue;const A=g[E];if(A)m&&!p.durationKnown&&(A.endTime=_);else if(c){let R=f.attr[E];uD(E)&&(R=iP(R));const I=zp(c,h,_,{key:E,data:R},sn.dateRange);I&&(I.id=d,this.id3Track.addCue(I),g[E]=I)}}n[d]={cues:g,dateRange:f,durationKnown:m}}}}class oP{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:e,levelDetails:t}=this;return e.liveMaxLatencyDuration!==void 0?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const{levelDetails:e}=this;if(e===null)return null;const{holdBack:t,partHoldBack:n,targetduration:i}=e,{liveSyncDuration:r,liveSyncDurationCount:o,lowLatencyMode:a}=this.config,l=this.hls.userConfig;let c=a&&n||t;(l.liveSyncDuration||l.liveSyncDurationCount||c===0)&&(c=r!==void 0?r:o*i);const u=i,d=1;return c+Math.min(this.stallCount*d,u)}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency,n=this.levelDetails;if(e===null||t===null||n===null)return null;const i=n.edge,r=e-t-this.edgeStalled,o=i-n.totalduration,a=i-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(o,r),a)}get drift(){const{levelDetails:e}=this;return e===null?1:e.drift}get edgeStalled(){const{levelDetails:e}=this;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e,levelDetails:t}=this;if(!e||!t)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(b.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(b.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(b.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(b.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(b.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(b.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var n;t.details===j.BUFFER_STALLED_ERROR&&(this.stallCount++,(n=this.levelDetails)!=null&&n.live&&V.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;const n=this.computeLatency();if(n===null)return;this._latency=n;const{lowLatencyMode:i,maxLiveSyncPlaybackRate:r}=this.config;if(!i||r===1||!t.live)return;const o=this.targetLatency;if(o===null)return;const a=n-o,l=Math.min(this.maxLatency,o+t.targetduration);if(a<l&&a>.05&&this.forwardBufferLength>1){const u=Math.min(2,Math.max(1,r)),d=Math.round(2/(1+Math.exp(-.75*a-this.edgeStalled))*20)/20;e.playbackRate=Math.min(u,Math.max(1,d))}else e.playbackRate!==1&&e.playbackRate!==0&&(e.playbackRate=1)}estimateLiveEdge(){const{levelDetails:e}=this;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}const _d=["NONE","TYPE-0","TYPE-1",null];function aP(s){return _d.indexOf(s)>-1}const Fl=["SDR","PQ","HLG"];function lP(s){return!!s&&Fl.indexOf(s)>-1}var Lo={No:"",Yes:"YES",v2:"v2"};function cP(s,e){const{canSkipUntil:t,canSkipDateRanges:n,endSN:i}=s,r=e!==void 0?e-i:0;return t&&r<t?n?Lo.v2:Lo.Yes:Lo.No}class jp{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class Zr{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(t=>!!t).map(t=>t.substring(0,4)).join(","),this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return qp(this._audioGroups,e)}hasSubtitleGroup(e){return qp(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(!!t){if(e==="audio"){let n=this._audioGroups;n||(n=this._audioGroups=[]),n.indexOf(t)===-1&&n.push(t)}else if(e==="text"){let n=this._subtitleGroups;n||(n=this._subtitleGroups=[]),n.indexOf(t)===-1&&n.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function qp(s,e){return!e||!s?!1:s.indexOf(e)!==-1}function su(s,e){const t=e.startPTS;if(Ee(t)){let n=0,i;e.sn>s.sn?(n=t-s.start,i=s):(n=s.start-t,i=e),i.duration!==n&&(i.duration=n)}else e.sn>s.sn?s.cc===e.cc&&s.minEndPTS?e.start=s.start+(s.minEndPTS-s.start):e.start=s.start+s.duration:e.start=Math.max(s.start-e.duration,0)}function Nv(s,e,t,n,i,r){n-t<=0&&(V.warn("Fragment should have a positive duration",e),n=t+e.duration,r=i+e.duration);let a=t,l=n;const c=e.startPTS,u=e.endPTS;if(Ee(c)){const m=Math.abs(c-t);Ee(e.deltaPTS)?e.deltaPTS=Math.max(m,e.deltaPTS):e.deltaPTS=m,a=Math.max(t,c),t=Math.min(t,c),i=Math.min(i,e.startDTS),l=Math.min(n,u),n=Math.max(n,u),r=Math.max(r,e.endDTS)}const d=t-e.start;e.start!==0&&(e.start=t),e.duration=n-e.start,e.startPTS=t,e.maxStartPTS=a,e.startDTS=i,e.endPTS=n,e.minEndPTS=l,e.endDTS=r;const f=e.sn;if(!s||f<s.startSN||f>s.endSN)return 0;let h;const p=f-s.startSN,g=s.fragments;for(g[p]=e,h=p;h>0;h--)su(g[h],g[h-1]);for(h=p;h<g.length-1;h++)su(g[h],g[h+1]);return s.fragmentHint&&su(g[g.length-1],s.fragmentHint),s.PTSKnown=s.alignedSliding=!0,d}function uP(s,e){let t=null;const n=s.fragments;for(let l=n.length-1;l>=0;l--){const c=n[l].initSegment;if(c){t=c;break}}s.fragmentHint&&delete s.fragmentHint.endPTS;let i=0,r;if(hP(s,e,(l,c)=>{l.relurl&&(i=l.cc-c.cc),Ee(l.startPTS)&&Ee(l.endPTS)&&(c.start=c.startPTS=l.startPTS,c.startDTS=l.startDTS,c.maxStartPTS=l.maxStartPTS,c.endPTS=l.endPTS,c.endDTS=l.endDTS,c.minEndPTS=l.minEndPTS,c.duration=l.endPTS-l.startPTS,c.duration&&(r=c),e.PTSKnown=e.alignedSliding=!0),c.elementaryStreams=l.elementaryStreams,c.loader=l.loader,c.stats=l.stats,l.initSegment&&(c.initSegment=l.initSegment,t=l.initSegment)}),t&&(e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments).forEach(c=>{var u;c&&(!c.initSegment||c.initSegment.relurl===((u=t)==null?void 0:u.relurl))&&(c.initSegment=t)}),e.skippedSegments)if(e.deltaUpdateFailed=e.fragments.some(l=>!l),e.deltaUpdateFailed){V.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let l=e.skippedSegments;l--;)e.fragments.shift();e.startSN=e.fragments[0].sn,e.startCC=e.fragments[0].cc}else e.canSkipDateRanges&&(e.dateRanges=dP(s.dateRanges,e.dateRanges,e.recentlyRemovedDateranges));const o=e.fragments;if(i){V.warn("discontinuity sliding from playlist, take drift into account");for(let l=0;l<o.length;l++)o[l].cc+=i}e.skippedSegments&&(e.startCC=e.fragments[0].cc),fP(s.partList,e.partList,(l,c)=>{c.elementaryStreams=l.elementaryStreams,c.stats=l.stats}),r?Nv(e,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS):Vv(s,e),o.length&&(e.totalduration=e.edge-o[0].start),e.driftStartTime=s.driftStartTime,e.driftStart=s.driftStart;const a=e.advancedDateTime;if(e.advanced&&a){const l=e.edge;e.driftStart||(e.driftStartTime=a,e.driftStart=l),e.driftEndTime=a,e.driftEnd=l}else e.driftEndTime=s.driftEndTime,e.driftEnd=s.driftEnd,e.advancedDateTime=s.advancedDateTime}function dP(s,e,t){const n=Vt({},s);return t&&t.forEach(i=>{delete n[i]}),Object.keys(e).forEach(i=>{const r=new xv(e[i].attr,n[i]);r.isValid?n[i]=r:V.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(e[i].attr)}"`)}),n}function fP(s,e,t){if(s&&e){let n=0;for(let i=0,r=s.length;i<=r;i++){const o=s[i],a=e[i+n];o&&a&&o.index===a.index&&o.fragment.sn===a.fragment.sn?t(o,a):n--}}}function hP(s,e,t){const n=e.skippedSegments,i=Math.max(s.startSN,e.startSN)-e.startSN,r=(s.fragmentHint?1:0)+(n?e.endSN:Math.min(s.endSN,e.endSN))-e.startSN,o=e.startSN-s.startSN,a=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,l=s.fragmentHint?s.fragments.concat(s.fragmentHint):s.fragments;for(let c=i;c<=r;c++){const u=l[o+c];let d=a[c];n&&!d&&c<n&&(d=e.fragments[c]=u),u&&d&&t(u,d)}}function Vv(s,e){const t=e.startSN+e.skippedSegments-s.startSN,n=s.fragments;t<0||t>=n.length||yd(e,n[t].start)}function yd(s,e){if(e){const t=s.fragments;for(let n=s.skippedSegments;n<t.length;n++)t[n].start+=e;s.fragmentHint&&(s.fragmentHint.start+=e)}}function pP(s,e=1/0){let t=1e3*s.targetduration;if(s.updated){const n=s.fragments,i=4;if(n.length&&t*i>e){const r=n[n.length-1].duration*1e3;r<t&&(t=r)}}else t/=2;return Math.round(t)}function gP(s,e,t){if(!(s!=null&&s.details))return null;const n=s.details;let i=n.fragments[e-n.startSN];return i||(i=n.fragmentHint,i&&i.sn===e)?i:e<n.startSN&&t&&t.sn===e?t:null}function Kp(s,e,t){var n;return s!=null&&s.details?Bv((n=s.details)==null?void 0:n.partList,e,t):null}function Bv(s,e,t){if(s)for(let n=s.length;n--;){const i=s[n];if(i.index===t&&i.fragment.sn===e)return i}return null}function Uv(s){s.forEach((e,t)=>{const{details:n}=e;n!=null&&n.fragments&&n.fragments.forEach(i=>{i.level=t})})}function Ol(s){switch(s.details){case j.FRAG_LOAD_TIMEOUT:case j.KEY_LOAD_TIMEOUT:case j.LEVEL_LOAD_TIMEOUT:case j.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function Wp(s,e){const t=Ol(e);return s.default[`${t?"timeout":"error"}Retry`]}function Mf(s,e){const t=s.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*s.retryDelayMs,s.maxRetryDelayMs)}function Yp(s){return Zt(Zt({},s),{errorRetry:null,timeoutRetry:null})}function Ml(s,e,t,n){if(!s)return!1;const i=n==null?void 0:n.code,r=e<s.maxNumRetry&&(mP(i)||!!t);return s.shouldRetry?s.shouldRetry(s,e,t,n,r):r}function mP(s){return s===0&&navigator.onLine===!1||!!s&&(s<400||s>499)}const Hv={search:function(s,e){let t=0,n=s.length-1,i=null,r=null;for(;t<=n;){i=(t+n)/2|0,r=s[i];const o=e(r);if(o>0)t=i+1;else if(o<0)n=i-1;else return r}return null}};function vP(s,e,t){if(e===null||!Array.isArray(s)||!s.length||!Ee(e))return null;const n=s[0].programDateTime;if(e<(n||0))return null;const i=s[s.length-1].endProgramDateTime;if(e>=(i||0))return null;t=t||0;for(let r=0;r<s.length;++r){const o=s[r];if(_P(e,t,o))return o}return null}function $l(s,e,t=0,n=0){let i=null;if(s){i=e[s.sn-e[0].sn+1]||null;const o=s.endDTS-t;o>0&&o<15e-7&&(t+=15e-7)}else t===0&&e[0].start===0&&(i=e[0]);if(i&&(!s||s.level===i.level)&&xd(t,n,i)===0)return i;const r=Hv.search(e,xd.bind(null,t,n));return r&&(r!==s||!i)?r:i}function xd(s=0,e=0,t){if(t.start<=s&&t.start+t.duration>s)return 0;const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-n<=s?1:t.start-n>s&&t.start?-1:0}function _P(s,e,t){const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-n>s}function yP(s,e){return Hv.search(s,t=>t.cc<e?1:t.cc>e?-1:0)}var ts={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},Qs={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4};class xP{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=V.log.bind(V,"[info]:"),this.warn=V.warn.bind(V,"[warning]:"),this.error=V.error.bind(V,"[error]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(b.ERROR,this.onError,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;!e||(e.off(b.ERROR,this.onError,this),e.off(b.ERROR,this.onErrorOut,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===He.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var n,i;if(t.fatal)return;const r=this.hls,o=t.context;switch(t.details){case j.FRAG_LOAD_ERROR:case j.FRAG_LOAD_TIMEOUT:case j.KEY_LOAD_ERROR:case j.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case j.FRAG_PARSING_ERROR:if((n=t.frag)!=null&&n.gap){t.errorAction={action:ts.DoNothing,flags:Qs.None};return}case j.FRAG_GAP:case j.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=ts.SendAlternateToPenaltyBox;return}case j.LEVEL_EMPTY_ERROR:case j.LEVEL_PARSING_ERROR:{var a,l;const c=t.parent===He.MAIN?t.level:r.loadLevel;t.details===j.LEVEL_EMPTY_ERROR&&!!((a=t.context)!=null&&(l=a.levelDetails)!=null&&l.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,c):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,c))}return;case j.LEVEL_LOAD_ERROR:case j.LEVEL_LOAD_TIMEOUT:typeof(o==null?void 0:o.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,o.level));return;case j.AUDIO_TRACK_LOAD_ERROR:case j.AUDIO_TRACK_LOAD_TIMEOUT:case j.SUBTITLE_LOAD_ERROR:case j.SUBTITLE_TRACK_LOAD_TIMEOUT:if(o){const c=r.levels[r.loadLevel];if(c&&(o.type===rt.AUDIO_TRACK&&c.hasAudioGroup(o.groupId)||o.type===rt.SUBTITLE_TRACK&&c.hasSubtitleGroup(o.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,r.loadLevel),t.errorAction.action=ts.SendAlternateToPenaltyBox,t.errorAction.flags=Qs.MoveAllAlternatesMatchingHost;return}}return;case j.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const c=r.levels[r.loadLevel],u=c==null?void 0:c.attrs["HDCP-LEVEL"];u?t.errorAction={action:ts.SendAlternateToPenaltyBox,flags:Qs.MoveAllAlternatesMatchingHDCP,hdcpLevel:u}:this.keySystemError(t)}return;case j.BUFFER_ADD_CODEC_ERROR:case j.REMUX_ALLOC_ERROR:case j.BUFFER_APPEND_ERROR:t.errorAction=this.getLevelSwitchAction(t,(i=t.level)!=null?i:r.loadLevel);return;case j.INTERNAL_EXCEPTION:case j.BUFFER_APPENDING_ERROR:case j.BUFFER_FULL_ERROR:case j.LEVEL_SWITCH_ERROR:case j.BUFFER_STALLED_ERROR:case j.BUFFER_SEEK_OVER_HOLE:case j.BUFFER_NUDGE_ON_STALL:t.errorAction={action:ts.DoNothing,flags:Qs.None};return}t.type===Ge.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){const t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){const n=this.hls,i=Wp(n.config.playlistLoadPolicy,e),r=this.playlistError++;if(Ml(i,r,Ol(e),e.response))return{action:ts.RetryRequest,flags:Qs.None,retryConfig:i,retryCount:r};const a=this.getLevelSwitchAction(e,t);return i&&(a.retryConfig=i,a.retryCount=r),a}getFragRetryOrSwitchAction(e){const t=this.hls,n=this.getVariantLevelIndex(e.frag),i=t.levels[n],{fragLoadPolicy:r,keyLoadPolicy:o}=t.config,a=Wp(e.details.startsWith("key")?o:r,e),l=t.levels.reduce((u,d)=>u+d.fragmentError,0);if(i&&(e.details!==j.FRAG_GAP&&i.fragmentError++,Ml(a,l,Ol(e),e.response)))return{action:ts.RetryRequest,flags:Qs.None,retryConfig:a,retryCount:l};const c=this.getLevelSwitchAction(e,n);return a&&(c.retryConfig=a,c.retryCount=l),c}getLevelSwitchAction(e,t){const n=this.hls;t==null&&(t=n.loadLevel);const i=this.hls.levels[t];if(i){var r,o;const c=e.details;i.loadError++,c===j.BUFFER_APPEND_ERROR&&i.fragmentError++;let u=-1;const{levels:d,loadLevel:f,minAutoLevel:h,maxAutoLevel:p}=n;n.autoLevelEnabled||(n.loadLevel=-1);const g=(r=e.frag)==null?void 0:r.type,_=(g===He.AUDIO&&c===j.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(c===j.BUFFER_ADD_CODEC_ERROR||c===j.BUFFER_APPEND_ERROR))&&d.some(({audioCodec:A})=>i.audioCodec!==A),S=e.sourceBufferName==="video"&&(c===j.BUFFER_ADD_CODEC_ERROR||c===j.BUFFER_APPEND_ERROR)&&d.some(({codecSet:A,audioCodec:R})=>i.codecSet!==A&&i.audioCodec===R),{type:C,groupId:E}=(o=e.context)!=null?o:{};for(let A=d.length;A--;){const R=(A+f)%d.length;if(R!==f&&R>=h&&R<=p&&d[R].loadError===0){var a,l;const I=d[R];if(c===j.FRAG_GAP&&e.frag){const D=d[R].details;if(D){const L=$l(e.frag,D.fragments,e.frag.start);if(L!=null&&L.gap)continue}}else{if(C===rt.AUDIO_TRACK&&I.hasAudioGroup(E)||C===rt.SUBTITLE_TRACK&&I.hasSubtitleGroup(E))continue;if(g===He.AUDIO&&(a=i.audioGroups)!=null&&a.some(D=>I.hasAudioGroup(D))||g===He.SUBTITLE&&(l=i.subtitleGroups)!=null&&l.some(D=>I.hasSubtitleGroup(D))||_&&i.audioCodec===I.audioCodec||!_&&i.audioCodec!==I.audioCodec||S&&i.codecSet===I.codecSet)continue}u=R;break}}if(u>-1&&n.loadLevel!==u)return e.levelRetry=!0,this.playlistError=0,{action:ts.SendAlternateToPenaltyBox,flags:Qs.None,nextAutoLevel:u}}return{action:ts.SendAlternateToPenaltyBox,flags:Qs.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var n;switch((n=t.errorAction)==null?void 0:n.action){case ts.DoNothing:break;case ts.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==j.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,n=e.errorAction;if(!n)return;const{flags:i,hdcpLevel:r,nextAutoLevel:o}=n;switch(i){case Qs.None:this.switchLevel(e,o);break;case Qs.MoveAllAlternatesMatchingHDCP:r&&(t.maxHdcpLevel=_d[_d.indexOf(r)-1],n.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}n.resolved||this.switchLevel(e,o)}switchLevel(e,t){t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}}class $f{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=V.log.bind(V,`${t}:`),this.warn=V.warn.bind(V,`${t}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t){const n=t==null?void 0:t.renditionReports;if(n){let i=-1;for(let r=0;r<n.length;r++){const o=n[r];let a;try{a=new self.URL(o.URI,t.url).href}catch(l){V.warn(`Could not construct new URL for Rendition Report: ${l}`),a=o.URI||""}if(a===e){i=r;break}else a===e.substring(0,a.length)&&(i=r)}if(i!==-1){const r=n[i],o=parseInt(r["LAST-MSN"])||(t==null?void 0:t.lastPartSn);let a=parseInt(r["LAST-PART"])||(t==null?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const l=Math.min(t.age-t.partTarget,t.targetduration);a>=0&&l>t.partTarget&&(a+=1)}return new jp(o,a>=0?a:void 0,Lo.No)}}}loadPlaylist(e){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return this.timer===-1&&this.requestScheduled===-1&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,n){const{details:i,stats:r}=t,o=self.performance.now(),a=r.loading.first?Math.max(0,o-r.loading.first):0;if(i.advancedDateTime=Date.now()-a,i.live||n!=null&&n.live){if(i.reloaded(n),n&&this.log(`live playlist ${e} ${i.advanced?"REFRESHED "+i.lastPartSn+"-"+i.lastPartIndex:i.updated?"UPDATED":"MISSED"}`),n&&i.fragments.length>0&&uP(n,i),!this.canLoad||!i.live)return;let l,c,u;if(i.canBlockReload&&i.endSN&&i.advanced){const m=this.hls.config.lowLatencyMode,_=i.lastPartSn,y=i.endSN,S=i.lastPartIndex,C=S!==-1,E=_===y,A=m?0:S;C?(c=E?y+1:_,u=E?A:S+1):c=y+1;const R=i.age,I=R+i.ageHeader;let D=Math.min(I-i.partTarget,i.targetduration*1.5);if(D>0){if(n&&D>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${D} with playlist age: ${i.age}`),D=0;else{const L=Math.floor(D/i.targetduration);if(c+=L,u!==void 0){const M=Math.round(D%i.targetduration/i.partTarget);u+=M}this.log(`CDN Tune-in age: ${i.ageHeader}s last advanced ${R.toFixed(2)}s goal: ${D} skip sn ${L} to part ${u}`)}i.tuneInGoal=D}if(l=this.getDeliveryDirectives(i,t.deliveryDirectives,c,u),m||!E){this.loadPlaylist(l);return}}else(i.canBlockReload||i.canSkipUntil)&&(l=this.getDeliveryDirectives(i,t.deliveryDirectives,c,u));const d=this.hls.mainForwardBufferInfo,f=d?d.end-d.len:0,h=(i.edge-f)*1e3,p=pP(i,h);i.updated&&o>this.requestScheduled+p&&(this.requestScheduled=r.loading.start),c!==void 0&&i.canBlockReload?this.requestScheduled=r.loading.first+p-(i.partTarget*1e3||1e3):this.requestScheduled===-1||this.requestScheduled+p<o?this.requestScheduled=o:this.requestScheduled-o<=0&&(this.requestScheduled+=p);let g=this.requestScheduled-o;g=Math.max(0,g),this.log(`reload live playlist ${e} in ${Math.round(g)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(l),g)}else this.clearTimer()}getDeliveryDirectives(e,t,n,i){let r=cP(e,n);return t!=null&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,i=t.part,r=Lo.No),new jp(n,i,r)}checkRetry(e){const t=e.details,n=Ol(e),i=e.errorAction,{action:r,retryCount:o=0,retryConfig:a}=i||{},l=!!i&&!!a&&(r===ts.RetryRequest||!i.resolved&&r===ts.SendAlternateToPenaltyBox);if(l){var c;if(this.requestScheduled=-1,o>=a.maxNumRetry)return!1;if(n&&(c=e.context)!=null&&c.deliveryDirectives)this.warn(`Retrying playlist loading ${o+1}/${a.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const u=Mf(a,o);this.timer=self.setTimeout(()=>this.loadPlaylist(),u),this.warn(`Retrying playlist loading ${o+1}/${a.maxNumRetry} after "${t}" in ${u}ms`)}e.levelRetry=!0,i.resolved=!0}return l}}class fr{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){const n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class bP{constructor(e,t,n,i=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new fr(e),this.fast_=new fr(t),this.defaultTTFB_=i,this.ttfb_=new fr(e)}update(e,t){const{slow_:n,fast_:i,ttfb_:r}=this;n.halfLife!==e&&(this.slow_=new fr(e,n.getEstimate(),n.getTotalWeight())),i.halfLife!==t&&(this.fast_=new fr(t,i.getEstimate(),i.getTotalWeight())),r.halfLife!==e&&(this.ttfb_=new fr(e,r.getEstimate(),r.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const n=8*t,i=e/1e3,r=n/i;this.fast_.sample(i,r),this.slow_.sample(i,r)}sampleTTFB(e){const t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}const Gv={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]},Zp={};function wP(s,e,t,n,i,r){const o=s.audioCodec?s.audioGroups:null,a=r==null?void 0:r.audioCodec,l=r==null?void 0:r.channels,c=l?parseInt(l):a?1/0:2;let u=null;if(o!=null&&o.length)try{o.length===1&&o[0]?u=e.groups[o[0]].channels:u=o.reduce((d,f)=>{if(f){const h=e.groups[f];if(!h)throw new Error(`Audio track group ${f} not found`);Object.keys(h.channels).forEach(p=>{d[p]=(d[p]||0)+h.channels[p]})}return d},{2:0})}catch{return!0}return s.videoCodec!==void 0&&(s.width>1920&&s.height>1088||s.height>1920&&s.width>1088||s.frameRate>Math.max(n,30)||s.videoRange!=="SDR"&&s.videoRange!==t||s.bitrate>Math.max(i,8e6))||!!u&&Ee(c)&&Object.keys(u).some(d=>parseInt(d)>c)}function SP(s,e,t){const n=s.videoCodec,i=s.audioCodec;if(!n||!i||!t)return Promise.resolve(Gv);const r={width:s.width,height:s.height,bitrate:Math.ceil(Math.max(s.bitrate*.9,s.averageBitrate)),framerate:s.frameRate||30},o=s.videoRange;o!=="SDR"&&(r.transferFunction=o.toLowerCase());const a=n.split(",").map(l=>({type:"media-source",video:Zt(Zt({},r),{},{contentType:qo(l,"video")})}));return i&&s.audioGroups&&s.audioGroups.forEach(l=>{var c;!l||(c=e.groups[l])==null||c.tracks.forEach(u=>{if(u.groupId===l){const d=u.channels||"",f=parseFloat(d);Ee(f)&&f>2&&a.push.apply(a,i.split(",").map(h=>({type:"media-source",audio:{contentType:qo(h,"audio"),channels:""+f}})))}})}),Promise.all(a.map(l=>{const c=EP(l);return Zp[c]||(Zp[c]=t.decodingInfo(l))})).then(l=>({supported:!l.some(c=>!c.supported),configurations:a,decodingInfoResults:l})).catch(l=>({supported:!1,configurations:a,decodingInfoResults:[],error:l}))}function EP(s){const{audio:e,video:t}=s,n=t||e;if(n){const i=n.contentType.split('"')[1];if(t)return`r${t.height}x${t.width}f${Math.ceil(t.framerate)}${t.transferFunction||"sd"}_${i}_${Math.ceil(t.bitrate/1e5)}`;if(e)return`c${e.channels}${e.spatialRendering?"s":"n"}_${i}`}return""}function TP(){if(typeof matchMedia=="function"){const s=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(s.media!==e.media)return s.matches===!0}return!1}function CP(s,e){let t=!1,n=[];return s&&(t=s!=="SDR",n=[s]),e&&(n=e.allowedVideoRanges||Fl.slice(0),t=e.preferHDR!==void 0?e.preferHDR:TP(),t?n=n.filter(i=>i!=="SDR"):n=["SDR"]),{preferHDR:t,allowedVideoRanges:n}}function AP(s,e,t,n,i){const r=Object.keys(s),o=n==null?void 0:n.channels,a=n==null?void 0:n.audioCodec,l=o&&parseInt(o)===2;let c=!0,u=!1,d=1/0,f=1/0,h=1/0,p=0,g=[];const{preferHDR:m,allowedVideoRanges:_}=CP(e,i);for(let E=r.length;E--;){const A=s[r[E]];c=A.channels[2]>0,d=Math.min(d,A.minHeight),f=Math.min(f,A.minFramerate),h=Math.min(h,A.minBitrate);const R=_.filter(I=>A.videoRanges[I]>0);R.length>0&&(u=!0,g=R)}d=Ee(d)?d:0,f=Ee(f)?f:0;const y=Math.max(1080,d),S=Math.max(30,f);return h=Ee(h)?h:t,t=Math.max(h,t),u||(e=void 0,g=[]),{codecSet:r.reduce((E,A)=>{const R=s[A];if(A===E)return E;if(R.minBitrate>t)return Dn(A,`min bitrate of ${R.minBitrate} > current estimate of ${t}`),E;if(!R.hasDefaultAudio)return Dn(A,"no renditions with default or auto-select sound found"),E;if(a&&A.indexOf(a.substring(0,4))%5!==0)return Dn(A,`audio codec preference "${a}" not found`),E;if(o&&!l){if(!R.channels[o])return Dn(A,`no renditions with ${o} channel sound found (channels options: ${Object.keys(R.channels)})`),E}else if((!a||l)&&c&&R.channels[2]===0)return Dn(A,"no renditions with stereo sound found"),E;return R.minHeight>y?(Dn(A,`min resolution of ${R.minHeight} > maximum of ${y}`),E):R.minFramerate>S?(Dn(A,`min framerate of ${R.minFramerate} > maximum of ${S}`),E):g.some(I=>R.videoRanges[I]>0)?R.maxScore<p?(Dn(A,`max score of ${R.maxScore} < selected max of ${p}`),E):E&&(Dl(A)>=Dl(E)||R.fragmentError>s[E].fragmentError)?E:(p=R.maxScore,A):(Dn(A,`no variants with VIDEO-RANGE of ${JSON.stringify(g)} found`),E)},void 0),videoRanges:g,preferHDR:m,minFramerate:f,minBitrate:h}}function Dn(s,e){V.log(`[abr] start candidates with "${s}" ignored because ${e}`)}function kP(s){return s.reduce((e,t)=>{let n=e.groups[t.groupId];n||(n=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),n.tracks.push(t);const i=t.channels||"2";return n.channels[i]=(n.channels[i]||0)+1,n.hasDefault=n.hasDefault||t.default,n.hasAutoSelect=n.hasAutoSelect||t.autoselect,n.hasDefault&&(e.hasDefaultAudio=!0),n.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function LP(s,e,t,n){return s.slice(t,n+1).reduce((i,r)=>{if(!r.codecSet)return i;const o=r.audioGroups;let a=i[r.codecSet];a||(i[r.codecSet]=a={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!o,fragmentError:0}),a.minBitrate=Math.min(a.minBitrate,r.bitrate);const l=Math.min(r.height,r.width);return a.minHeight=Math.min(a.minHeight,l),a.minFramerate=Math.min(a.minFramerate,r.frameRate),a.maxScore=Math.max(a.maxScore,r.score),a.fragmentError+=r.fragmentError,a.videoRanges[r.videoRange]=(a.videoRanges[r.videoRange]||0)+1,o&&o.forEach(c=>{if(!c)return;const u=e.groups[c];a.hasDefaultAudio=a.hasDefaultAudio||e.hasDefaultAudio?u.hasDefault:u.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(u.channels).forEach(d=>{a.channels[d]=(a.channels[d]||0)+u.channels[d]})}),i},{})}function yn(s,e,t){if("attrs"in s){const n=e.indexOf(s);if(n!==-1)return n}for(let n=0;n<e.length;n++){const i=e[n];if(Nr(s,i,t))return n}return-1}function Nr(s,e,t){const{groupId:n,name:i,lang:r,assocLang:o,characteristics:a,default:l}=s,c=s.forced;return(n===void 0||e.groupId===n)&&(i===void 0||e.name===i)&&(r===void 0||e.lang===r)&&(r===void 0||e.assocLang===o)&&(l===void 0||e.default===l)&&(c===void 0||e.forced===c)&&(a===void 0||RP(a,e.characteristics))&&(t===void 0||t(s,e))}function RP(s,e=""){const t=s.split(","),n=e.split(",");return t.length===n.length&&!t.some(i=>n.indexOf(i)===-1)}function hr(s,e){const{audioCodec:t,channels:n}=s;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(n===void 0||n===(e.channels||"2"))}function IP(s,e,t,n,i){const r=e[n],a=e.reduce((f,h,p)=>{const g=h.uri;return(f[g]||(f[g]=[])).push(p),f},{})[r.uri];a.length>1&&(n=Math.max.apply(Math,a));const l=r.videoRange,c=r.frameRate,u=r.codecSet.substring(0,4),d=Xp(e,n,f=>{if(f.videoRange!==l||f.frameRate!==c||f.codecSet.substring(0,4)!==u)return!1;const h=f.audioGroups,p=t.filter(g=>!h||h.indexOf(g.groupId)!==-1);return yn(s,p,i)>-1});return d>-1?d:Xp(e,n,f=>{const h=f.audioGroups,p=t.filter(g=>!h||h.indexOf(g.groupId)!==-1);return yn(s,p,i)>-1})}function Xp(s,e,t){for(let n=e;n;n--)if(t(s[n]))return n;for(let n=e+1;n<s.length;n++)if(t(s[n]))return n;return-1}class DP{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this._abandonRulesCheck=()=>{const{fragCurrent:t,partCurrent:n,hls:i}=this,{autoLevelEnabled:r,media:o}=i;if(!t||!o)return;const a=performance.now(),l=n?n.stats:t.stats,c=n?n.duration:t.duration,u=a-l.loading.start,d=i.minAutoLevel;if(l.aborted||l.loaded&&l.loaded===l.total||t.level<=d){this.clearTimer(),this._nextAutoLevel=-1;return}if(!r||o.paused||!o.playbackRate||!o.readyState)return;const f=i.mainForwardBufferInfo;if(f===null)return;const h=this.bwEstimator.getEstimateTTFB(),p=Math.abs(o.playbackRate);if(u<=Math.max(h,1e3*(c/(p*2))))return;const g=f.len/p,m=l.loading.first?l.loading.first-l.loading.start:-1,_=l.loaded&&m>-1,y=this.getBwEstimate(),S=i.levels,C=S[t.level],E=l.total||Math.max(l.loaded,Math.round(c*C.averageBitrate/8));let A=_?u-m:u;A<1&&_&&(A=Math.min(u,l.loaded*8/y));const R=_?l.loaded*1e3/A:0,I=R?(E-l.loaded)/R:E*8/y+h/1e3;if(I<=g)return;const D=R?R*8:y;let L=Number.POSITIVE_INFINITY,M;for(M=t.level-1;M>d;M--){const H=S[M].maxBitrate;if(L=this.getTimeToLoadFrag(h/1e3,D,c*H,!S[M].details),L<g)break}if(L>=I||L>c*10)return;i.nextLoadLevel=i.nextAutoLevel=M,_?this.bwEstimator.sample(u-Math.min(h,m),l.loaded):this.bwEstimator.sampleTTFB(u);const $=S[M].maxBitrate;this.getBwEstimate()*this.hls.config.abrBandWidthUpFactor>$&&this.resetEstimator($),this.clearTimer(),V.warn(`[abr] Fragment ${t.sn}${n?" part "+n.index:""} of level ${t.level} is loading too slowly;
      Time to underbuffer: ${g.toFixed(3)} s
      Estimated load time for current fragment: ${I.toFixed(3)} s
      Estimated load time for down switch fragment: ${L.toFixed(3)} s
      TTFB estimate: ${m|0} ms
      Current BW estimate: ${Ee(y)?y|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${M} @ ${$|0} bps`),i.trigger(b.FRAG_LOAD_EMERGENCY_ABORTED,{frag:t,part:n,stats:l})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(V.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new bP(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.FRAG_LOADING,this.onFragLoading,this),e.on(b.FRAG_LOADED,this.onFragLoaded,this),e.on(b.FRAG_BUFFERED,this.onFragBuffered,this),e.on(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(b.LEVEL_LOADED,this.onLevelLoaded,this),e.on(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(b.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(b.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;!e||(e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.FRAG_LOADING,this.onFragLoading,this),e.off(b.FRAG_LOADED,this.onFragLoaded,this),e.off(b.FRAG_BUFFERED,this.onFragBuffered,this),e.off(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(b.LEVEL_LOADED,this.onLevelLoaded,this),e.off(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(b.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(b.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const n=t.frag;if(!this.ignoreFragment(n)){if(!n.bitrateTest){var i;this.fragCurrent=n,this.partCurrent=(i=t.part)!=null?i:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case j.BUFFER_ADD_CODEC_ERROR:case j.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case j.FRAG_LOAD_TIMEOUT:{const n=t.frag,{fragCurrent:i,partCurrent:r}=this;if(n&&i&&n.sn===i.sn&&n.level===i.level){const o=performance.now(),a=r?r.stats:n.stats,l=o-a.loading.start,c=a.loading.first?a.loading.first-a.loading.start:-1;if(a.loaded&&c>-1){const d=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(l-Math.min(d,c),a.loaded)}else this.bwEstimator.sampleTTFB(l)}break}}}getTimeToLoadFrag(e,t,n,i){const r=e+n/t,o=i?this.lastLevelLoadSec:0;return r+o}onLevelLoaded(e,t){const n=this.hls.config,{loading:i}=t.stats,r=i.end-i.start;Ee(r)&&(this.lastLevelLoadSec=r/1e3),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD)}onFragLoaded(e,{frag:t,part:n}){const i=n?n.stats:t.stats;if(t.type===He.MAIN&&this.bwEstimator.sampleTTFB(i.loading.first-i.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const r=n?n.duration:t.duration,o=this.hls.levels[t.level],a=(o.loaded?o.loaded.bytes:0)+i.loaded,l=(o.loaded?o.loaded.duration:0)+r;o.loaded={bytes:a,duration:l},o.realBitrate=Math.round(8*a/l)}if(t.bitrateTest){const r={stats:i,frag:t,part:n,id:t.type};this.onFragBuffered(b.FRAG_BUFFERED,r),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:n,part:i}=t,r=i!=null&&i.stats.loaded?i.stats:n.stats;if(r.aborted||this.ignoreFragment(n))return;const o=r.parsing.end-r.loading.start-Math.min(r.loading.first-r.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(o,r.loaded),r.bwEstimate=this.getBwEstimate(),n.bitrateTest?this.bitrateTestDelay=o/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==He.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,n=this.getBwEstimate(),i=this.hls.config.maxStarvationDelay,r=this.findBestLevel(n,t,e,0,i,1,1);if(r>-1)return r;const o=this.hls.firstLevel,a=Math.min(Math.max(o,t),e);return V.warn(`[abr] Could not find best starting auto level. Defaulting to first in playlist ${o} clamped to ${a}`),a}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,n=this.bwEstimator.canEstimate(),i=this.lastLoadedFragLevel>-1;if(e!==-1&&(!n||!i||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const r=n&&i?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const o=this.hls.levels;if(o.length>Math.max(e,r)&&o[e].loadError<=o[r].loadError)return e}return this._nextAutoLevel=r,this.nextAutoLevelKey=this.getAutoLevelKey(),r}getAutoLevelKey(){var e;return`${this.getBwEstimate()}_${(e=this.hls.mainForwardBufferInfo)==null?void 0:e.len}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:n}=this,{maxAutoLevel:i,config:r,minAutoLevel:o,media:a}=n,l=t?t.duration:e?e.duration:0,c=a&&a.playbackRate!==0?Math.abs(a.playbackRate):1,u=this.getBwEstimate(),d=n.mainForwardBufferInfo,f=(d?d.len:0)/c;let h=r.abrBandWidthFactor,p=r.abrBandWidthUpFactor;if(f){const S=this.findBestLevel(u,o,i,f,0,h,p);if(S>=0)return S}let g=l?Math.min(l,r.maxStarvationDelay):r.maxStarvationDelay;if(!f){const S=this.bitrateTestDelay;S&&(g=(l?Math.min(l,r.maxLoadingDelay):r.maxLoadingDelay)-S,V.info(`[abr] bitrate test took ${Math.round(1e3*S)}ms, set first fragment max fetchDuration to ${Math.round(1e3*g)} ms`),h=p=1)}const m=this.findBestLevel(u,o,i,f,g,h,p);if(V.info(`[abr] ${f?"rebuffering expected":"buffer is empty"}, optimal quality level ${m}`),m>-1)return m;const _=n.levels[o],y=n.levels[n.loadLevel];return(_==null?void 0:_.bitrate)<(y==null?void 0:y.bitrate)?o:n.loadLevel}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,n,i,r,o,a){var l;const c=i+r,u=this.lastLoadedFragLevel,d=u===-1?this.hls.firstLevel:u,{fragCurrent:f,partCurrent:h}=this,{levels:p,allAudioTracks:g,loadLevel:m,config:_}=this.hls;if(p.length===1)return 0;const y=p[d],S=!!(y!=null&&(l=y.details)!=null&&l.live),C=m===-1||u===-1;let E,A="SDR",R=(y==null?void 0:y.frameRate)||0;const{audioPreference:I,videoPreference:D}=_,L=this.audioTracksByGroup||(this.audioTracksByGroup=kP(g));if(C){if(this.firstSelection!==-1)return this.firstSelection;const te=this.codecTiers||(this.codecTiers=LP(p,L,t,n)),X=AP(te,A,e,I,D),{codecSet:de,videoRanges:xe,minFramerate:le,minBitrate:re,preferHDR:Be}=X;E=de,A=Be?xe[xe.length-1]:xe[0],R=le,e=Math.max(e,re),V.log(`[abr] picked start tier ${JSON.stringify(X)}`)}else E=y==null?void 0:y.codecSet,A=y==null?void 0:y.videoRange;const M=h?h.duration:f?f.duration:0,$=this.bwEstimator.getEstimateTTFB()/1e3,H=[];for(let te=n;te>=t;te--){var ie;const X=p[te],de=te>d;if(!X)continue;if(_.useMediaCapabilities&&!X.supportedResult&&!X.supportedPromise){const We=navigator.mediaCapabilities;typeof(We==null?void 0:We.decodingInfo)=="function"&&wP(X,L,A,R,e,I)?(X.supportedPromise=SP(X,L,We),X.supportedPromise.then(ot=>{X.supportedResult=ot;const Ue=this.hls.levels,K=Ue.indexOf(X);ot.error?V.warn(`[abr] MediaCapabilities decodingInfo error: "${ot.error}" for level ${K} ${JSON.stringify(ot)}`):ot.supported||(V.warn(`[abr] Unsupported MediaCapabilities decodingInfo result for level ${K} ${JSON.stringify(ot)}`),K>-1&&Ue.length>1&&(V.log(`[abr] Removing unsupported level ${K}`),this.hls.removeLevel(K)))})):X.supportedResult=Gv}if(E&&X.codecSet!==E||A&&X.videoRange!==A||de&&R>X.frameRate||!de&&R>0&&R<X.frameRate||X.supportedResult&&!((ie=X.supportedResult.decodingInfoResults)!=null&&ie[0].smooth)){H.push(te);continue}const xe=X.details,le=(h?xe==null?void 0:xe.partTarget:xe==null?void 0:xe.averagetargetduration)||M;let re;de?re=a*e:re=o*e;const Be=M&&i>=M*2&&r===0?p[te].averageBitrate:p[te].maxBitrate,be=this.getTimeToLoadFrag($,re,Be*le,xe===void 0);if(re>=Be&&(te===u||X.loadError===0&&X.fragmentError===0)&&(be<=$||!Ee(be)||S&&!this.bitrateTestDelay||be<c)){const We=this.forcedAutoLevel;return te!==m&&(We===-1||We!==m)&&(H.length&&V.trace(`[abr] Skipped level(s) ${H.join(",")} of ${n} max with CODECS and VIDEO-RANGE:"${p[H[0]].codecs}" ${p[H[0]].videoRange}; not compatible with "${y.codecs}" ${A}`),V.info(`[abr] switch candidate:${d}->${te} adjustedbw(${Math.round(re)})-bitrate=${Math.round(re-Be)} ttfb:${$.toFixed(1)} avgDuration:${le.toFixed(1)} maxFetchDuration:${c.toFixed(1)} fetchDuration:${be.toFixed(1)} firstSelection:${C} codecSet:${E} videoRange:${A} hls.loadLevel:${m}`)),C&&(this.firstSelection=te),te}}return-1}set nextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:n}=this.hls,i=Math.min(Math.max(e,n),t);this._nextAutoLevel!==i&&(this.nextAutoLevelKey="",this._nextAutoLevel=i)}}class PP{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}var Wt={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class FP{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(b.BUFFER_APPENDED,this.onBufferAppended,this),e.on(b.FRAG_BUFFERED,this.onFragBuffered,this),e.on(b.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(b.BUFFER_APPENDED,this.onBufferAppended,this),e.off(b.FRAG_BUFFERED,this.onFragBuffered,this),e.off(b.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const n=this.activePartLists[t];if(n)for(let i=n.length;i--;){const r=n[i];if(!r)break;const o=r.end;if(r.start<=e&&o!==null&&e<=o)return r}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){const{fragments:n}=this,i=Object.keys(n);for(let r=i.length;r--;){const o=n[i[r]];if((o==null?void 0:o.body.type)===t&&o.buffered){const a=o.body;if(a.start<=e&&e<=a.end)return a}}return null}detectEvictedFragments(e,t,n,i){this.timeRanges&&(this.timeRanges[e]=t);const r=(i==null?void 0:i.fragment.sn)||-1;Object.keys(this.fragments).forEach(o=>{const a=this.fragments[o];if(!a||r>=a.body.sn)return;if(!a.buffered&&!a.loaded){a.body.type===n&&this.removeFragment(a.body);return}const l=a.range[e];!l||l.time.some(c=>{const u=!this.isTimeBuffered(c.startPTS,c.endPTS,t);return u&&this.removeFragment(a.body),u})})}detectPartialFragments(e){const t=this.timeRanges,{frag:n,part:i}=e;if(!t||n.sn==="initSegment")return;const r=pr(n),o=this.fragments[r];if(!o||o.buffered&&n.gap)return;const a=!n.relurl;Object.keys(t).forEach(l=>{const c=n.elementaryStreams[l];if(!c)return;const u=t[l],d=a||c.partial===!0;o.range[l]=this.getBufferedTimes(n,i,d,u)}),o.loaded=null,Object.keys(o.range).length?(o.buffered=!0,(o.body.endList=n.endList||o.body.endList)&&(this.endListFragments[o.body.type]=o),Aa(o)||this.removeParts(n.sn-1,n.type)):this.removeFragment(o.body)}removeParts(e,t){const n=this.activePartLists[t];!n||(this.activePartLists[t]=n.filter(i=>i.fragment.sn>=e))}fragBuffered(e,t){const n=pr(e);let i=this.fragments[n];!i&&t&&(i=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),i&&(i.loaded=null,i.buffered=!0)}getBufferedTimes(e,t,n,i){const r={time:[],partial:n},o=e.start,a=e.end,l=e.minEndPTS||a,c=e.maxStartPTS||o;for(let u=0;u<i.length;u++){const d=i.start(u)-this.bufferPadding,f=i.end(u)+this.bufferPadding;if(c>=d&&l<=f){r.time.push({startPTS:Math.max(o,i.start(u)),endPTS:Math.min(a,i.end(u))});break}else if(o<f&&a>d){const h=Math.max(o,i.start(u)),p=Math.min(a,i.end(u));p>h&&(r.partial=!0,r.time.push({startPTS:h,endPTS:p}))}else if(a<=d)break}return r}getPartialFragment(e){let t=null,n,i,r,o=0;const{bufferPadding:a,fragments:l}=this;return Object.keys(l).forEach(c=>{const u=l[c];!u||Aa(u)&&(i=u.body.start-a,r=u.body.end+a,e>=i&&e<=r&&(n=Math.min(e-i,r-e),o<=n&&(t=u.body,o=n)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||Aa(t))}getState(e){const t=pr(e),n=this.fragments[t];return n?n.buffered?Aa(n)?Wt.PARTIAL:Wt.OK:Wt.APPENDING:Wt.NOT_LOADED}isTimeBuffered(e,t,n){let i,r;for(let o=0;o<n.length;o++){if(i=n.start(o)-this.bufferPadding,r=n.end(o)+this.bufferPadding,e>=i&&t<=r)return!0;if(t<=i)return!1}return!1}onFragLoaded(e,t){const{frag:n,part:i}=t;if(n.sn==="initSegment"||n.bitrateTest)return;const r=i?null:t,o=pr(n);this.fragments[o]={body:n,appendedPTS:null,loaded:r,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:n,part:i,timeRanges:r}=t;if(n.sn==="initSegment")return;const o=n.type;if(i){let a=this.activePartLists[o];a||(this.activePartLists[o]=a=[]),a.push(i)}this.timeRanges=r,Object.keys(r).forEach(a=>{const l=r[a];this.detectEvictedFragments(a,l,o,i)})}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=pr(e);return!!this.fragments[t]}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,n,i,r){i&&!this.hasGaps||Object.keys(this.fragments).forEach(o=>{const a=this.fragments[o];if(!a)return;const l=a.body;l.type!==n||i&&!l.gap||l.start<t&&l.end>e&&(a.buffered||r)&&this.removeFragment(l)})}removeFragment(e){const t=pr(e);e.stats.loaded=0,e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const i=e.sn;this.activePartLists[e.type]=n.filter(r=>r.fragment.sn!==i)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function Aa(s){var e,t,n;return s.buffered&&(s.body.gap||((e=s.range.video)==null?void 0:e.partial)||((t=s.range.audio)==null?void 0:t.partial)||((n=s.range.audiovideo)==null?void 0:n.partial))}function pr(s){return`${s.type}_${s.level}_${s.sn}`}const OP={length:0,start:()=>0,end:()=>0};class wt{static isBuffered(e,t){try{if(e){const n=wt.getBuffered(e);for(let i=0;i<n.length;i++)if(t>=n.start(i)&&t<=n.end(i))return!0}}catch{}return!1}static bufferInfo(e,t,n){try{if(e){const i=wt.getBuffered(e),r=[];let o;for(o=0;o<i.length;o++)r.push({start:i.start(o),end:i.end(o)});return this.bufferedInfo(r,t,n)}}catch{}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.sort(function(c,u){const d=c.start-u.start;return d||u.end-c.end});let i=[];if(n)for(let c=0;c<e.length;c++){const u=i.length;if(u){const d=i[u-1].end;e[c].start-d<n?e[c].end>d&&(i[u-1].end=e[c].end):i.push(e[c])}else i.push(e[c])}else i=e;let r=0,o,a=t,l=t;for(let c=0;c<i.length;c++){const u=i[c].start,d=i[c].end;if(t+n>=u&&t<d)a=u,l=d,r=l-t;else if(t+n<u){o=u;break}}return{len:r,start:a||0,end:l||0,nextStart:o}}static getBuffered(e){try{return e.buffered}catch(t){return V.log("failed to get media.buffered",t),OP}}}class Nf{constructor(e,t,n,i=0,r=-1,o=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=ka(),this.buffering={audio:ka(),video:ka(),audiovideo:ka()},this.level=e,this.sn=t,this.id=n,this.size=i,this.part=r,this.partial=o}}function ka(){return{start:0,executeStart:0,executeEnd:0,end:0}}function Ja(s,e){for(let n=0,i=s.length;n<i;n++){var t;if(((t=s[n])==null?void 0:t.cc)===e)return s[n]}return null}function MP(s,e,t){return!!(e&&(t.endCC>t.startCC||s&&s.cc<t.startCC))}function $P(s,e){const t=s.fragments,n=e.fragments;if(!n.length||!t.length){V.log("No fragments to align");return}const i=Ja(t,n[0].cc);if(!i||i&&!i.startPTS){V.log("No frag in previous level to align on");return}return i}function Qp(s,e){if(s){const t=s.start+e;s.start=s.startPTS=t,s.endPTS=t+s.duration}}function zv(s,e){const t=e.fragments;for(let n=0,i=t.length;n<i;n++)Qp(t[n],s);e.fragmentHint&&Qp(e.fragmentHint,s),e.alignedSliding=!0}function NP(s,e,t){!e||(VP(s,t,e),!t.alignedSliding&&e&&Nl(t,e),!t.alignedSliding&&e&&!t.skippedSegments&&Vv(e,t))}function VP(s,e,t){if(MP(s,t,e)){const n=$P(t,e);n&&Ee(n.start)&&(V.log(`Adjusting PTS using last level due to CC increase within current level ${e.url}`),zv(n.start,e))}}function Nl(s,e){if(!s.hasProgramDateTime||!e.hasProgramDateTime)return;const t=s.fragments,n=e.fragments;if(!t.length||!n.length)return;let i,r;const o=Math.min(e.endCC,s.endCC);e.startCC<o&&s.startCC<o&&(i=Ja(n,o),r=Ja(t,o)),(!i||!r)&&(i=n[Math.floor(n.length/2)],r=Ja(t,i.cc)||t[Math.floor(t.length/2)]);const a=i.programDateTime,l=r.programDateTime;if(!a||!l)return;const c=(l-a)/1e3-(r.start-i.start);zv(c,s)}const Jp=Math.pow(2,17);class BP{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const n=e.url;if(!n)return Promise.reject(new Fn({type:Ge.NETWORK_ERROR,details:j.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${n?"part list":"url"}`),networkDetails:null}));this.abort();const i=this.config,r=i.fLoader,o=i.loader;return new Promise((a,l)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(h=>h[0]==="GAP")){l(t1(e));return}else e.gap=!1;const c=this.loader=e.loader=r?new r(i):new o(i),u=e1(e),d=Yp(i.fragLoadPolicy.default),f={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:Jp};e.stats=c.stats,c.load(u,f,{onSuccess:(h,p,g,m)=>{this.resetLoader(e,c);let _=h.data;g.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(_.slice(0,16)),_=_.slice(16)),a({frag:e,part:null,payload:_,networkDetails:m})},onError:(h,p,g,m)=>{this.resetLoader(e,c),l(new Fn({type:Ge.NETWORK_ERROR,details:j.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:Zt({url:n,data:void 0},h),error:new Error(`HTTP Error ${h.code} ${h.text}`),networkDetails:g,stats:m}))},onAbort:(h,p,g)=>{this.resetLoader(e,c),l(new Fn({type:Ge.NETWORK_ERROR,details:j.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:g,stats:h}))},onTimeout:(h,p,g)=>{this.resetLoader(e,c),l(new Fn({type:Ge.NETWORK_ERROR,details:j.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${f.timeout}ms`),networkDetails:g,stats:h}))},onProgress:(h,p,g,m)=>{t&&t({frag:e,part:null,payload:g,networkDetails:m})}})})}loadPart(e,t,n){this.abort();const i=this.config,r=i.fLoader,o=i.loader;return new Promise((a,l)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){l(t1(e,t));return}const c=this.loader=e.loader=r?new r(i):new o(i),u=e1(e,t),d=Yp(i.fragLoadPolicy.default),f={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:Jp};t.stats=c.stats,c.load(u,f,{onSuccess:(h,p,g,m)=>{this.resetLoader(e,c),this.updateStatsFromPart(e,t);const _={frag:e,part:t,payload:h.data,networkDetails:m};n(_),a(_)},onError:(h,p,g,m)=>{this.resetLoader(e,c),l(new Fn({type:Ge.NETWORK_ERROR,details:j.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:Zt({url:u.url,data:void 0},h),error:new Error(`HTTP Error ${h.code} ${h.text}`),networkDetails:g,stats:m}))},onAbort:(h,p,g)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,c),l(new Fn({type:Ge.NETWORK_ERROR,details:j.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:g,stats:h}))},onTimeout:(h,p,g)=>{this.resetLoader(e,c),l(new Fn({type:Ge.NETWORK_ERROR,details:j.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${f.timeout}ms`),networkDetails:g,stats:h}))}})})}updateStatsFromPart(e,t){const n=e.stats,i=t.stats,r=i.total;if(n.loaded+=i.loaded,r){const l=Math.round(e.duration/t.duration),c=Math.min(Math.round(n.loaded/r),l),d=(l-c)*Math.round(n.loaded/c);n.total=n.loaded+d}else n.total=Math.max(n.loaded,n.total);const o=n.loading,a=i.loading;o.start?o.first+=a.first-a.start:(o.start=a.start,o.first=a.first),o.end=a.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function e1(s,e=null){const t=e||s,n={frag:s,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},i=t.byteRangeStartOffset,r=t.byteRangeEndOffset;if(Ee(i)&&Ee(r)){var o;let a=i,l=r;if(s.sn==="initSegment"&&((o=s.decryptdata)==null?void 0:o.method)==="AES-128"){const c=r-i;c%16&&(l=r+(16-c%16)),i!==0&&(n.resetIV=!0,a=i-16)}n.rangeStart=a,n.rangeEnd=l}return n}function t1(s,e){const t=new Error(`GAP ${s.gap?"tag":"attribute"} found`),n={type:Ge.MEDIA_ERROR,details:j.FRAG_GAP,fatal:!1,frag:s,error:t,networkDetails:null};return e&&(n.part=e),(e||s).stats.aborted=!0,new Fn(n)}class Fn extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class UP{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}class HP{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}function GP(s){const e=s.byteLength,t=e&&new DataView(s.buffer).getUint8(e-1);return t?Yi(s,0,e-t):s}class zP{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),n=new Uint32Array(4);for(let i=0;i<4;i++)n[i]=t.getUint32(i*4);return n}initTable(){const e=this.sBox,t=this.invSBox,n=this.subMix,i=n[0],r=n[1],o=n[2],a=n[3],l=this.invSubMix,c=l[0],u=l[1],d=l[2],f=l[3],h=new Uint32Array(256);let p=0,g=0,m=0;for(m=0;m<256;m++)m<128?h[m]=m<<1:h[m]=m<<1^283;for(m=0;m<256;m++){let _=g^g<<1^g<<2^g<<3^g<<4;_=_>>>8^_&255^99,e[p]=_,t[_]=p;const y=h[p],S=h[y],C=h[S];let E=h[_]*257^_*16843008;i[p]=E<<24|E>>>8,r[p]=E<<16|E>>>16,o[p]=E<<8|E>>>24,a[p]=E,E=C*16843009^S*65537^y*257^p*16843008,c[_]=E<<24|E>>>8,u[_]=E<<16|E>>>16,d[_]=E<<8|E>>>24,f[_]=E,p?(p=y^h[h[h[C^y]]],g^=h[h[g]]):p=g=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let n=!0,i=0;for(;i<t.length&&n;)n=t[i]===this.key[i],i++;if(n)return;this.key=t;const r=this.keySize=t.length;if(r!==4&&r!==6&&r!==8)throw new Error("Invalid aes key size="+r);const o=this.ksRows=(r+6+1)*4;let a,l;const c=this.keySchedule=new Uint32Array(o),u=this.invKeySchedule=new Uint32Array(o),d=this.sBox,f=this.rcon,h=this.invSubMix,p=h[0],g=h[1],m=h[2],_=h[3];let y,S;for(a=0;a<o;a++){if(a<r){y=c[a]=t[a];continue}S=y,a%r===0?(S=S<<8|S>>>24,S=d[S>>>24]<<24|d[S>>>16&255]<<16|d[S>>>8&255]<<8|d[S&255],S^=f[a/r|0]<<24):r>6&&a%r===4&&(S=d[S>>>24]<<24|d[S>>>16&255]<<16|d[S>>>8&255]<<8|d[S&255]),c[a]=y=(c[a-r]^S)>>>0}for(l=0;l<o;l++)a=o-l,l&3?S=c[a]:S=c[a-4],l<4||a<=4?u[l]=S:u[l]=p[d[S>>>24]]^g[d[S>>>16&255]]^m[d[S>>>8&255]]^_[d[S&255]],u[l]=u[l]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,n){const i=this.keySize+6,r=this.invKeySchedule,o=this.invSBox,a=this.invSubMix,l=a[0],c=a[1],u=a[2],d=a[3],f=this.uint8ArrayToUint32Array_(n);let h=f[0],p=f[1],g=f[2],m=f[3];const _=new Int32Array(e),y=new Int32Array(_.length);let S,C,E,A,R,I,D,L,M,$,H,ie,te,X;const de=this.networkToHostOrderSwap;for(;t<_.length;){for(M=de(_[t]),$=de(_[t+1]),H=de(_[t+2]),ie=de(_[t+3]),R=M^r[0],I=ie^r[1],D=H^r[2],L=$^r[3],te=4,X=1;X<i;X++)S=l[R>>>24]^c[I>>16&255]^u[D>>8&255]^d[L&255]^r[te],C=l[I>>>24]^c[D>>16&255]^u[L>>8&255]^d[R&255]^r[te+1],E=l[D>>>24]^c[L>>16&255]^u[R>>8&255]^d[I&255]^r[te+2],A=l[L>>>24]^c[R>>16&255]^u[I>>8&255]^d[D&255]^r[te+3],R=S,I=C,D=E,L=A,te=te+4;S=o[R>>>24]<<24^o[I>>16&255]<<16^o[D>>8&255]<<8^o[L&255]^r[te],C=o[I>>>24]<<24^o[D>>16&255]<<16^o[L>>8&255]<<8^o[R&255]^r[te+1],E=o[D>>>24]<<24^o[L>>16&255]<<16^o[R>>8&255]<<8^o[I&255]^r[te+2],A=o[L>>>24]<<24^o[R>>16&255]<<16^o[I>>8&255]<<8^o[D&255]^r[te+3],y[t]=de(S^h),y[t+1]=de(A^p),y[t+2]=de(E^g),y[t+3]=de(C^m),h=M,p=$,g=H,m=ie,t=t+4}return y.buffer}}const jP=16;class Vf{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const n=self.crypto;n&&(this.subtle=n.subtle||n.webkitSubtle)}catch{}this.subtle===null&&(this.useSoftware=!0)}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?GP(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n){return this.useSoftware?new Promise((i,r)=>{this.softwareDecrypt(new Uint8Array(e),t,n);const o=this.flush();o?i(o.buffer):r(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,n)}softwareDecrypt(e,t,n){const{currentIV:i,currentResult:r,remainderData:o}=this;this.logOnce("JS AES decrypt"),o&&(e=Ks(o,e),this.remainderData=null);const a=this.getValidChunk(e);if(!a.length)return null;i&&(n=i);let l=this.softwareDecrypter;l||(l=this.softwareDecrypter=new zP),l.expandKey(t);const c=r;return this.currentResult=l.decrypt(a.buffer,0,n),this.currentIV=Yi(a,-16).buffer,c||null}webCryptoDecrypt(e,t,n){const i=this.subtle;return(this.key!==t||!this.fastAesKey)&&(this.key=t,this.fastAesKey=new HP(i,t)),this.fastAesKey.expandKey().then(r=>i?(this.logOnce("WebCrypto AES decrypt"),new UP(i,new Uint8Array(n)).decrypt(e.buffer,r)):Promise.reject(new Error("web crypto not initialized"))).catch(r=>(V.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${r.name}: ${r.message}`),this.onWebCryptoError(e,t,n)))}onWebCryptoError(e,t,n){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n);const i=this.flush();if(i)return i.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e;const n=e.length-e.length%jP;return n!==e.length&&(t=Yi(e,0,n),this.remainderData=Yi(e,n)),t}logOnce(e){!this.logEnabled||(V.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const qP={toString:function(s){let e="";const t=s.length;for(let n=0;n<t;n++)e+=`[${s.start(n).toFixed(3)}-${s.end(n).toFixed(3)}]`;return e}},J={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Bf extends PP{constructor(e,t,n,i,r){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=J.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=r,this.logPrefix=i,this.log=V.log.bind(V,`${i}:`),this.warn=V.warn.bind(V,`${i}:`),this.hls=e,this.fragmentLoader=new BP(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new Vf(e.config),e.on(b.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=J.STOPPED}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;const n=t.partList;if(n!=null&&n.length){const r=n[n.length-1];return wt.isBuffered(this.media,r.start+r.duration/2)}const i=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(i)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levelLastLoaded)==null?void 0:e.details}}onMediaAttached(e,t){const n=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),n.addEventListener("seeking",this.onvseeking),n.addEventListener("ended",this.onvended);const i=this.config;this.levels&&i.autoStartLoad&&this.state===J.STOPPED&&this.startLoad(i.startPosition)}onMediaDetaching(){const e=this.media;e!=null&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:e,fragCurrent:t,media:n,mediaBuffer:i,state:r}=this,o=n?n.currentTime:0,a=wt.bufferInfo(i||n,o,e.maxBufferHole);if(this.log(`media seeking to ${Ee(o)?o.toFixed(3):o}, state: ${r}`),this.state===J.ENDED)this.resetLoadingState();else if(t){const l=e.maxFragLookUpTolerance,c=t.start-l,u=t.start+t.duration+l;if(!a.len||u<a.start||c>a.end){const d=o>u;(o<c||d)&&(d&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}n&&(this.fragmentTracker.removeFragmentsInRange(o,1/0,this.playlistType,!0),this.lastCurrentTime=o),!this.loadedmetadata&&!a.len&&(this.nextLoadPosition=this.startPosition=o),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.hls.off(b.MANIFEST_LOADED,this.onManifestLoaded,this),this.stopLoad(),super.onHandlerDestroying(),this.hls=null}onHandlerDestroyed(){this.state=J.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){const i=r=>{if(this.fragContextChanged(e)){this.warn(`Fragment ${e.sn}${r.part?" p: "+r.part.index:""} of level ${e.level} was dropped during download.`),this.fragmentTracker.removeFragment(e);return}e.stats.chunkCount++,this._handleFragmentLoadProgress(r)};this._doFragLoad(e,t,n,i).then(r=>{if(!r)return;const o=this.state;if(this.fragContextChanged(e)){(o===J.FRAG_LOADING||!this.fragCurrent&&o===J.PARSING)&&(this.fragmentTracker.removeFragment(e),this.state=J.IDLE);return}"payload"in r&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(b.FRAG_LOADED,r)),this._handleFragmentLoadComplete(r)}).catch(r=>{this.state===J.STOPPED||this.state===J.ERROR||(this.warn(r),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:n}=this;if(n.getState(e)===Wt.APPENDING){const r=e.type,o=this.getFwdBufferInfo(this.mediaBuffer,r),a=Math.max(e.duration,o?o.len:this.config.maxBufferLength);this.reduceMaxBufferLength(a)&&n.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===Wt.PARTIAL&&n.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}flushMainBuffer(e,t,n=null){if(!(e-t))return;const i={startOffset:e,endOffset:t,type:n};this.hls.trigger(b.BUFFER_FLUSHING,i)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(n=>{if(!n||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return n}).then(n=>{const{hls:i}=this,{payload:r}=n,o=e.decryptdata;if(r&&r.byteLength>0&&o!=null&&o.key&&o.iv&&o.method==="AES-128"){const a=self.performance.now();return this.decrypter.decrypt(new Uint8Array(r),o.key.buffer,o.iv.buffer).catch(l=>{throw i.trigger(b.ERROR,{type:Ge.MEDIA_ERROR,details:j.FRAG_DECRYPT_ERROR,fatal:!1,error:l,reason:l.message,frag:e}),l}).then(l=>{const c=self.performance.now();return i.trigger(b.FRAG_DECRYPTED,{frag:e,payload:l,stats:{tstart:a,tdecrypt:c}}),n.payload=l,this.completeInitSegmentLoad(n)})}return this.completeInitSegmentLoad(n)}).catch(n=>{this.state===J.STOPPED||this.state===J.ERROR||(this.warn(n),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const n=e.frag.stats;this.state=J.IDLE,e.frag.data=new Uint8Array(e.payload),n.parsing.start=n.buffering.start=self.performance.now(),n.parsing.end=n.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){var n,i,r,o;const a=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.playlistType===He.MAIN?"level":"track"} ${e.level} (frag:[${((n=e.startPTS)!=null?n:NaN).toFixed(3)}-${((i=e.endPTS)!=null?i:NaN).toFixed(3)}] > buffer:${a?qP.toString(wt.getBuffered(a)):"(detached)"})`),e.sn!=="initSegment"){var l;if(e.type!==He.SUBTITLE){const u=e.elementaryStreams;if(!Object.keys(u).some(d=>!!u[d])){this.state=J.IDLE;return}}const c=(l=this.levels)==null?void 0:l[e.level];c!=null&&c.fragmentError&&(this.log(`Resetting level fragment error count of ${c.fragmentError} on frag buffered`),c.fragmentError=0)}this.state=J.IDLE,a&&(!this.loadedmetadata&&e.type==He.MAIN&&a.buffered.length&&((r=this.fragCurrent)==null?void 0:r.sn)===((o=this.fragPrevious)==null?void 0:o.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:n,part:i,partsLoaded:r}=e,o=!r||r.length===0||r.some(l=>!l),a=new Nf(n.level,n.sn,n.stats.chunkCount+1,0,i?i.index:-1,!o);t.flush(a)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,i){var r;const o=t==null?void 0:t.details;if(!this.levels||!o)throw new Error(`frag load aborted, missing level${o?"":" detail"}s`);let a=null;if(e.encrypted&&!((r=e.decryptdata)!=null&&r.key)?(this.log(`Loading key for ${e.sn} of [${o.startSN}-${o.endSN}], ${this.logPrefix==="[stream-controller]"?"level":"track"} ${e.level}`),this.state=J.KEY_LOADING,this.fragCurrent=e,a=this.keyLoader.load(e).then(u=>{if(!this.fragContextChanged(u.frag))return this.hls.trigger(b.KEY_LOADED,u),this.state===J.KEY_LOADING&&(this.state=J.IDLE),u}),this.hls.trigger(b.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(a=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!e.encrypted&&o.encryptedFragments.length&&this.keyLoader.loadClear(e,o.encryptedFragments),n=Math.max(e.start,n||0),this.config.lowLatencyMode&&e.sn!=="initSegment"){const u=o.partList;if(u&&i){n>e.end&&o.fragmentHint&&(e=o.fragmentHint);const d=this.getNextPart(u,e,n);if(d>-1){const f=u[d];this.log(`Loading part sn: ${e.sn} p: ${f.index} cc: ${e.cc} of playlist [${o.startSN}-${o.endSN}] parts [0-${d}-${u.length-1}] ${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=f.start+f.duration,this.state=J.FRAG_LOADING;let h;return a?h=a.then(p=>!p||this.fragContextChanged(p.frag)?null:this.doFragPartsLoad(e,f,t,i)).catch(p=>this.handleFragLoadError(p)):h=this.doFragPartsLoad(e,f,t,i).catch(p=>this.handleFragLoadError(p)),this.hls.trigger(b.FRAG_LOADING,{frag:e,part:f,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):h}else if(!e.url||this.loadedEndOfParts(u,n))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${o?"of ["+o.startSN+"-"+o.endSN+"] ":""}${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),Ee(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=J.FRAG_LOADING;const l=this.config.progressive;let c;return l&&a?c=a.then(u=>!u||this.fragContextChanged(u==null?void 0:u.frag)?null:this.fragmentLoader.load(e,i)).catch(u=>this.handleFragLoadError(u)):c=Promise.all([this.fragmentLoader.load(e,l?i:void 0),a]).then(([u])=>(!l&&u&&i&&i(u),u)).catch(u=>this.handleFragLoadError(u)),this.hls.trigger(b.FRAG_LOADING,{frag:e,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):c}doFragPartsLoad(e,t,n,i){return new Promise((r,o)=>{var a;const l=[],c=(a=n.details)==null?void 0:a.partList,u=d=>{this.fragmentLoader.loadPart(e,d,i).then(f=>{l[d.index]=f;const h=f.part;this.hls.trigger(b.FRAG_LOADED,f);const p=Kp(n,e.sn,d.index+1)||Bv(c,e.sn,d.index+1);if(p)u(p);else return r({frag:e,part:h,partsLoaded:l})}).catch(o)};u(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===j.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(b.ERROR,t)}else this.hls.trigger(b.ERROR,{type:Ge.OTHER_ERROR,details:j.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==J.PARSING){!this.fragCurrent&&this.state!==J.STOPPED&&this.state!==J.ERROR&&(this.state=J.IDLE);return}const{frag:n,part:i,level:r}=t,o=self.performance.now();n.stats.parsing.end=o,i&&(i.stats.parsing.end=o),this.updateLevelTiming(n,i,r,e.partial)}getCurrentContext(e){const{levels:t,fragCurrent:n}=this,{level:i,sn:r,part:o}=e;if(!(t!=null&&t[i]))return this.warn(`Levels object was unset while buffering fragment ${r} of level ${i}. The current chunk will not be buffered.`),null;const a=t[i],l=o>-1?Kp(a,r,o):null,c=l?l.fragment:gP(a,r,n);return c?(n&&n!==c&&(c.stats=n.stats),{frag:c,part:l,level:a}):null}bufferFragmentData(e,t,n,i,r){var o;if(!e||this.state!==J.PARSING)return;const{data1:a,data2:l}=e;let c=a;if(a&&l&&(c=Ks(a,l)),!((o=c)!=null&&o.length))return;const u={type:e.type,frag:t,part:n,chunkMeta:i,parent:t.type,data:c};if(this.hls.trigger(b.BUFFER_APPENDING,u),e.dropped&&e.independent&&!n){if(r)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!wt.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const n=t.currentTime,i=wt.bufferInfo(t,n,0),r=e.duration,o=Math.min(this.config.maxFragLookUpTolerance*2,r*.25),a=Math.max(Math.min(e.start-o,i.end-o),n+o);e.start-a>o&&this.flushMainBuffer(a,e.start)}getFwdBufferInfo(e,t){const n=this.getLoadPosition();return Ee(n)?this.getFwdBufferInfoAtPos(e,n,t):null}getFwdBufferInfoAtPos(e,t,n){const{config:{maxBufferHole:i}}=this,r=wt.bufferInfo(e,t,i);if(r.len===0&&r.nextStart!==void 0){const o=this.fragmentTracker.getBufferedFrag(t,n);if(o&&r.nextStart<o.end)return wt.bufferInfo(e,t,Math.max(r.nextStart,i))}return r}getMaxBufferLength(e){const{config:t}=this;let n;return e?n=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):n=t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e){const t=this.config,n=e||t.maxBufferLength;return t.maxMaxBufferLength>=n?(t.maxMaxBufferLength/=2,this.warn(`Reduce max buffer length to ${t.maxMaxBufferLength}s`),!0):!1}getAppendedFrag(e,t=He.MAIN){const n=this.fragmentTracker.getAppendedFrag(e,He.MAIN);return n&&"fragment"in n?n.fragment:n}getNextFragment(e,t){const n=t.fragments,i=n.length;if(!i)return null;const{config:r}=this,o=n[0].start;let a;if(t.live){const l=r.initialLiveManifestSize;if(i<l)return this.warn(`Not enough fragments to start playback (have: ${i}, need: ${l})`),null;(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<o)&&(a=this.getInitialLiveFragment(t,n),this.startPosition=this.nextLoadPosition=a?this.hls.liveSyncPosition||a.start:e)}else e<=o&&(a=n[0]);if(!a){const l=r.lowLatencyMode?t.partEnd:t.fragmentEnd;a=this.getFragmentAtPosition(e,l,t)}return this.mapToInitFragWhenRequired(a)}isLoopLoading(e,t){const n=this.fragmentTracker.getState(e);return(n===Wt.OK||n===Wt.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,i,r){const o=e.gap,a=this.getNextFragment(this.nextLoadPosition,t);if(a===null)return a;if(e=a,o&&e&&!e.gap&&n.nextStart){const l=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,i);if(l!==null&&n.len+l.len>=r)return this.log(`buffer full after gaps in "${i}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,n){let i=-1,r=!1,o=!0;for(let a=0,l=e.length;a<l;a++){const c=e[a];if(o=o&&!c.independent,i>-1&&n<c.start)break;const u=c.loaded;u?i=-1:(r||c.independent||o)&&c.fragment===t&&(i=a),r=u}return i}loadedEndOfParts(e,t){const n=e[e.length-1];return n&&t>n.start&&n.loaded}getInitialLiveFragment(e,t){const n=this.fragPrevious;let i=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),i=vP(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!i){const r=n.sn+1;if(r>=e.startSN&&r<=e.endSN){const o=t[r-e.startSN];n.cc===o.cc&&(i=o,this.log(`Live playlist, switching playlist, load frag with next SN: ${i.sn}`))}i||(i=yP(t,n.cc),i&&this.log(`Live playlist, switching playlist, load frag with same CC: ${i.sn}`))}}else{const r=this.hls.liveSyncPosition;r!==null&&(i=this.getFragmentAtPosition(r,this.bitrateTest?e.fragmentEnd:e.edge,e))}return i}getFragmentAtPosition(e,t,n){const{config:i}=this;let{fragPrevious:r}=this,{fragments:o,endSN:a}=n;const{fragmentHint:l}=n,c=i.maxFragLookUpTolerance,u=n.partList,d=!!(i.lowLatencyMode&&u!=null&&u.length&&l);d&&l&&!this.bitrateTest&&(o=o.concat(l),a=l.sn);let f;if(e<t){const h=e>t-c?0:c;f=$l(r,o,e,h)}else f=o[o.length-1];if(f){const h=f.sn-n.startSN,p=this.fragmentTracker.getState(f);if((p===Wt.OK||p===Wt.PARTIAL&&f.gap)&&(r=f),r&&f.sn===r.sn&&(!d||u[0].fragment.sn>f.sn)&&r&&f.level===r.level){const m=o[h+1];f.sn<a&&this.fragmentTracker.getState(m)!==Wt.OK?f=m:f=null}}return f}synchronizeToLiveEdge(e){const{config:t,media:n}=this;if(!n)return;const i=this.hls.liveSyncPosition,r=n.currentTime,o=e.fragments[0].start,a=e.edge,l=r>=o-t.maxFragLookUpTolerance&&r<=a;if(i!==null&&n.duration>i&&(r<i||!l)){const c=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!l&&n.readyState<4||r<a-c)&&(this.loadedmetadata||(this.nextLoadPosition=i),n.readyState&&(this.warn(`Playback: ${r.toFixed(3)} is located too far from the end of live sliding playlist: ${a}, reset currentTime to : ${i.toFixed(3)}`),n.currentTime=i))}}alignPlaylists(e,t,n){const i=e.fragments.length;if(!i)return this.warn("No fragments in live playlist"),0;const r=e.fragments[0].start,o=!t,a=e.alignedSliding&&Ee(r);if(o||!a&&!r){const{fragPrevious:l}=this;NP(l,n,e);const c=e.fragments[0].start;return this.log(`Live playlist sliding: ${c.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${l?l.sn:"na"} fragments: ${i}`),c}return r}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let n=this.startPosition;if(n<t&&(n=-1),n===-1||this.lastCurrentTime===-1){const i=this.startTimeOffset!==null,r=i?this.startTimeOffset:e.startTimeOffset;r!==null&&Ee(r)?(n=t+r,r<0&&(n+=e.totalduration),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Start time offset ${r} found in ${i?"multivariant":"media"} playlist, adjust startPosition to ${n}`),this.startPosition=n):e.live?n=this.hls.liveSyncPosition||t:this.startPosition=n=0,this.lastCurrentTime=n}this.nextLoadPosition=n}getLoadPosition(){const{media:e}=this;let t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&e.sn!=="initSegment"&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==J.FRAG_LOADING_WAITING_RETRY)&&(this.state=J.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const u=this.getCurrentContext(t.chunkMeta);u&&(t.frag=u.frag)}const n=t.frag;if(!n||n.type!==e||!this.levels)return;if(this.fragContextChanged(n)){var i;this.warn(`Frag load error must match current frag to retry ${n.url} > ${(i=this.fragCurrent)==null?void 0:i.url}`);return}const r=t.details===j.FRAG_GAP;r&&this.fragmentTracker.fragBuffered(n,!0);const o=t.errorAction,{action:a,retryCount:l=0,retryConfig:c}=o||{};if(o&&a===ts.RetryRequest&&c){this.resetStartWhenNotLoaded(this.levelLastLoaded);const u=Mf(c,l);this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${t.details}, retrying loading ${l+1}/${c.maxNumRetry} in ${u}ms`),o.resolved=!0,this.retryDate=self.performance.now()+u,this.state=J.FRAG_LOADING_WAITING_RETRY}else if(c&&o)if(this.resetFragmentErrors(e),l<c.maxNumRetry)!r&&a!==ts.RemoveAlternatePermanently&&(o.resolved=!0);else{V.warn(`${t.details} reached or exceeded max retry (${l})`);return}else(o==null?void 0:o.action)===ts.SendAlternateToPenaltyBox?this.state=J.WAITING_LEVEL:this.state=J.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===J.PARSING||this.state===J.PARSED){const t=e.parent,n=this.getFwdBufferInfo(this.mediaBuffer,t),i=n&&n.len>.5;i&&this.reduceMaxBufferLength(n.len);const r=!i;return r&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${t} buffer`),e.frag&&(this.fragmentTracker.removeFragment(e.frag),this.nextLoadPosition=e.frag.start),this.resetLoadingState(),r}return!1}resetFragmentErrors(e){e===He.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==J.STOPPED&&(this.state=J.IDLE)}afterBufferFlushed(e,t,n){if(!e)return;const i=wt.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,i,n),this.state===J.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=J.IDLE}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;const t=e?e.details:null;t!=null&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,i){var r;const o=n.details;if(!o){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((l,c)=>{const u=e.elementaryStreams[c];if(u){const d=u.endPTS-u.startPTS;if(d<=0)return this.warn(`Could not parse fragment ${e.sn} ${c} duration reliably (${d})`),l||!1;const f=i?0:Nv(o,e,u.startPTS,u.endPTS,u.startDTS,u.endDTS);return this.hls.trigger(b.LEVEL_PTS_UPDATED,{details:o,level:n,drift:f,type:c,frag:e,start:u.startPTS,end:u.endPTS}),!0}return l},!1)&&((r=this.transmuxer)==null?void 0:r.error)===null){const l=new Error(`Found no media in fragment ${e.sn} of level ${e.level} resetting transmuxer to fallback to playlist timing`);if(n.fragmentError===0&&(n.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(l.message),this.hls.trigger(b.ERROR,{type:Ge.MEDIA_ERROR,details:j.FRAG_PARSING_ERROR,fatal:!1,error:l,frag:e,reason:`Found no media in msn ${e.sn} of level "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=J.PARSED,this.hls.trigger(b.FRAG_PARSED,{frag:e,part:t})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}class jv{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let n;if(e.length)e.length===1?n=e[0]:n=KP(e,t);else return new Uint8Array(0);return this.reset(),n}reset(){this.chunks.length=0,this.dataLength=0}}function KP(s,e){const t=new Uint8Array(e);let n=0;for(let i=0;i<s.length;i++){const r=s[i];t.set(r,n),n+=r.length}return t}function WP(){return typeof __HLS_WORKER_BUNDLE__=="function"}function YP(){const s=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),e=self.URL.createObjectURL(s);return{worker:new self.Worker(e),objectURL:e}}function ZP(s){const e=new self.URL(s,self.location.href).href;return{worker:new self.Worker(e),scriptURL:e}}function gn(s="",e=9e4){return{type:s,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class Uf{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,i){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=Ks(this.cachedData,e),this.cachedData=null);let n=zo(e,0),i=n?n.length:0,r;const o=this._audioTrack,a=this._id3Track,l=n?Of(n):void 0,c=e.length;for((this.basePTS===null||this.frameIndex===0&&Ee(l))&&(this.basePTS=XP(l,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),n&&n.length>0&&a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:sn.audioId3,duration:Number.POSITIVE_INFINITY});i<c;){if(this.canParse(e,i)){const u=this.appendFrame(o,e,i);u?(this.frameIndex++,this.lastPTS=u.sample.pts,i+=u.length,r=i):i=c}else xD(e,i)?(n=zo(e,i),a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:sn.audioId3,duration:Number.POSITIVE_INFINITY}),i+=n.length,r=i):i++;if(i===c&&r!==c){const u=Yi(e,r);this.cachedData?this.cachedData=Ks(this.cachedData,u):this.cachedData=u}}return{audioTrack:o,videoTrack:gn(),id3Track:a,textTrack:gn()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:gn(),id3Track:this._id3Track,textTrack:gn()}}destroy(){}}const XP=(s,e,t)=>{if(Ee(s))return s*90;const n=t?t.baseTime*9e4/t.timescale:0;return e*9e4+n};function QP(s,e,t,n){let i,r,o,a;const l=navigator.userAgent.toLowerCase(),c=n,u=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];i=((e[t+2]&192)>>>6)+1;const d=(e[t+2]&60)>>>2;if(d>u.length-1){const f=new Error(`invalid ADTS sampling index:${d}`);s.emit(b.ERROR,b.ERROR,{type:Ge.MEDIA_ERROR,details:j.FRAG_PARSING_ERROR,fatal:!0,error:f,reason:f.message});return}return o=(e[t+2]&1)<<2,o|=(e[t+3]&192)>>>6,V.log(`manifest codec:${n}, ADTS type:${i}, samplingIndex:${d}`),/firefox/i.test(l)?d>=6?(i=5,a=new Array(4),r=d-3):(i=2,a=new Array(2),r=d):l.indexOf("android")!==-1?(i=2,a=new Array(2),r=d):(i=5,a=new Array(4),n&&(n.indexOf("mp4a.40.29")!==-1||n.indexOf("mp4a.40.5")!==-1)||!n&&d>=6?r=d-3:((n&&n.indexOf("mp4a.40.2")!==-1&&(d>=6&&o===1||/vivaldi/i.test(l))||!n&&o===1)&&(i=2,a=new Array(2)),r=d)),a[0]=i<<3,a[0]|=(d&14)>>1,a[1]|=(d&1)<<7,a[1]|=o<<3,i===5&&(a[1]|=(r&14)>>1,a[2]=(r&1)<<7,a[2]|=2<<2,a[3]=0),{config:a,samplerate:u[d],channelCount:o,codec:"mp4a.40."+i,manifestCodec:c}}function qv(s,e){return s[e]===255&&(s[e+1]&246)===240}function Kv(s,e){return s[e+1]&1?7:9}function Hf(s,e){return(s[e+3]&3)<<11|s[e+4]<<3|(s[e+5]&224)>>>5}function JP(s,e){return e+5<s.length}function Vl(s,e){return e+1<s.length&&qv(s,e)}function eF(s,e){return JP(s,e)&&qv(s,e)&&Hf(s,e)<=s.length-e}function tF(s,e){if(Vl(s,e)){const t=Kv(s,e);if(e+t>=s.length)return!1;const n=Hf(s,e);if(n<=t)return!1;const i=e+n;return i===s.length||Vl(s,i)}return!1}function Wv(s,e,t,n,i){if(!s.samplerate){const r=QP(e,t,n,i);if(!r)return;s.config=r.config,s.samplerate=r.samplerate,s.channelCount=r.channelCount,s.codec=r.codec,s.manifestCodec=r.manifestCodec,V.log(`parsed codec:${s.codec}, rate:${r.samplerate}, channels:${r.channelCount}`)}}function Yv(s){return 1024*9e4/s}function sF(s,e){const t=Kv(s,e);if(e+t<=s.length){const n=Hf(s,e)-t;if(n>0)return{headerLength:t,frameLength:n}}}function Zv(s,e,t,n,i){const r=Yv(s.samplerate),o=n+i*r,a=sF(e,t);let l;if(a){const{frameLength:d,headerLength:f}=a,h=f+d,p=Math.max(0,t+h-e.length);p?(l=new Uint8Array(h-f),l.set(e.subarray(t+f,e.length),0)):l=e.subarray(t+f,t+h);const g={unit:l,pts:o};return p||s.samples.push(g),{sample:g,length:h,missing:p}}const c=e.length-t;return l=new Uint8Array(c),l.set(e.subarray(t,e.length),0),{sample:{unit:l,pts:o},length:c,missing:-1}}let La=null;const nF=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],iF=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],rF=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],oF=[0,1,1,4];function Xv(s,e,t,n,i){if(t+24>e.length)return;const r=Qv(e,t);if(r&&t+r.frameLength<=e.length){const o=r.samplesPerFrame*9e4/r.sampleRate,a=n+i*o,l={unit:e.subarray(t,t+r.frameLength),pts:a,dts:a};return s.config=[],s.channelCount=r.channelCount,s.samplerate=r.sampleRate,s.samples.push(l),{sample:l,length:r.frameLength,missing:0}}}function Qv(s,e){const t=s[e+1]>>3&3,n=s[e+1]>>1&3,i=s[e+2]>>4&15,r=s[e+2]>>2&3;if(t!==1&&i!==0&&i!==15&&r!==3){const o=s[e+2]>>1&1,a=s[e+3]>>6,l=t===3?3-n:n===3?3:4,c=nF[l*14+i-1]*1e3,d=iF[(t===3?0:t===2?1:2)*3+r],f=a===3?1:2,h=rF[t][n],p=oF[n],g=h*8*p,m=Math.floor(h*c/d+o)*p;if(La===null){const S=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);La=S?parseInt(S[1]):0}return!!La&&La<=87&&n===2&&c>=224e3&&a===0&&(s[e+3]=s[e+3]|128),{sampleRate:d,channelCount:f,frameLength:m,samplesPerFrame:g}}}function Gf(s,e){return s[e]===255&&(s[e+1]&224)===224&&(s[e+1]&6)!==0}function Jv(s,e){return e+1<s.length&&Gf(s,e)}function aF(s,e){return Gf(s,e)&&4<=s.length-e}function e_(s,e){if(e+1<s.length&&Gf(s,e)){const n=Qv(s,e);let i=4;n!=null&&n.frameLength&&(i=n.frameLength);const r=e+i;return r===s.length||Jv(s,r)}return!1}class lF extends Uf{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=zo(e,0);let n=(t==null?void 0:t.length)||0;if(e_(e,n))return!1;for(let i=e.length;n<i;n++)if(tF(e,n))return V.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return eF(e,t)}appendFrame(e,t,n){Wv(e,this.observer,t,n,e.manifestCodec);const i=Zv(e,t,n,this.basePTS,this.frameIndex);if(i&&i.missing===0)return i}}const cF=/\/emsg[-/]ID3/i;class uF{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,i){const r=this.videoTrack=gn("video",1),o=this.audioTrack=gn("audio",1),a=this.txtTrack=gn("text",1);if(this.id3Track=gn("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const l=Rv(e);if(l.video){const{id:c,timescale:u,codec:d}=l.video;r.id=c,r.timescale=a.timescale=u,r.codec=d}if(l.audio){const{id:c,timescale:u,codec:d}=l.audio;o.id=c,o.timescale=u,o.codec=d}a.id=Av.text,r.sampleDuration=0,r.duration=o.duration=i}resetContiguity(){this.remainderData=null}static probe(e){return LD(e)}demux(e,t){this.timeOffset=t;let n=e;const i=this.videoTrack,r=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=Ks(this.remainderData,e));const a=$D(n);this.remainderData=a.remainder,i.samples=a.valid||new Uint8Array}else i.samples=n;const o=this.extractID3Track(i,t);return r.samples=Lp(t,i),{videoTrack:i,audioTrack:this.audioTrack,id3Track:o,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const i=this.extractID3Track(t,this.timeOffset);return n.samples=Lp(e,t),{videoTrack:t,audioTrack:gn(),id3Track:i,textTrack:gn()}}extractID3Track(e,t){const n=this.id3Track;if(e.samples.length){const i=Ze(e.samples,["emsg"]);i&&i.forEach(r=>{const o=BD(r);if(cF.test(o.schemeIdUri)){const a=Ee(o.presentationTime)?o.presentationTime/o.timeScale:t+o.presentationTimeDelta/o.timeScale;let l=o.eventDuration===4294967295?Number.POSITIVE_INFINITY:o.eventDuration/o.timeScale;l<=.001&&(l=Number.POSITIVE_INFINITY);const c=o.payload;n.samples.push({data:c,len:c.byteLength,dts:a,pts:a,type:sn.emsg,duration:l})}})}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}}const t_=(s,e)=>{let t=0,n=5;e+=n;const i=new Uint32Array(1),r=new Uint32Array(1),o=new Uint8Array(1);for(;n>0;){o[0]=s[e];const a=Math.min(n,8),l=8-a;r[0]=4278190080>>>24+l<<l,i[0]=(o[0]&r[0])>>l,t=t?t<<a|i[0]:i[0],e+=1,n-=a}return t};class dF extends Uf{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,n){const i=s_(e,t,n,this.basePTS,this.frameIndex);if(i!==-1)return{sample:e.samples[e.samples.length-1],length:i,missing:0}}static probe(e){if(!e)return!1;const t=zo(e,0);if(!t)return!1;const n=t.length;return e[n]===11&&e[n+1]===119&&Of(t)!==void 0&&t_(e,n)<16}}function s_(s,e,t,n,i){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const r=e[t+4]>>6;if(r>=3)return-1;const a=[48e3,44100,32e3][r],l=e[t+4]&63,u=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][l*3+r]*2;if(t+u>e.length)return-1;const d=e[t+6]>>5;let f=0;d===2?f+=2:(d&1&&d!==1&&(f+=2),d&4&&(f+=2));const h=(e[t+6]<<8|e[t+7])>>12-f&1,g=[2,1,2,3,3,4,4,5][d]+h,m=e[t+5]>>3,_=e[t+5]&7,y=new Uint8Array([r<<6|m<<1|_>>2,(_&3)<<6|d<<3|h<<2|l>>4,l<<4&224]),S=1536/a*9e4,C=n+i*S,E=e.subarray(t,t+u);return s.config=y,s.channelCount=g,s.samplerate=a,s.samples.push({unit:E,pts:C}),u}class fF{constructor(){this.VideoSample=null}createVideoSample(e,t,n,i){return{key:e,frame:!1,pts:t,dts:n,units:[],debug:i,length:0}}getLastNalUnit(e){var t;let n=this.VideoSample,i;if((!n||n.units.length===0)&&(n=e[e.length-1]),(t=n)!=null&&t.units){const r=n.units;i=r[r.length-1]}return i}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const n=t.samples,i=n.length;if(i){const r=n[i-1];e.pts=r.pts,e.dts=r.dts}else{t.dropped++;return}}t.samples.push(e)}e.debug.length&&V.log(e.pts+"/"+e.dts+":"+e.debug)}}class s1{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,n=e.byteLength-t,i=new Uint8Array(4),r=Math.min(4,t);if(r===0)throw new Error("no bytes available");i.set(e.subarray(n,n+r)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=r*8,this.bytesAvailable-=r}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const n=this.word>>>32-t;if(e>32&&V.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!==0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let t=8,n=8,i;for(let r=0;r<e;r++)n!==0&&(i=this.readEG(),n=(t+i+256)%256),t=n===0?t:n}readSPS(){let e=0,t=0,n=0,i=0,r,o,a;const l=this.readUByte.bind(this),c=this.readBits.bind(this),u=this.readUEG.bind(this),d=this.readBoolean.bind(this),f=this.skipBits.bind(this),h=this.skipEG.bind(this),p=this.skipUEG.bind(this),g=this.skipScalingList.bind(this);l();const m=l();if(c(5),f(3),l(),p(),m===100||m===110||m===122||m===244||m===44||m===83||m===86||m===118||m===128){const A=u();if(A===3&&f(1),p(),p(),f(1),d())for(o=A!==3?8:12,a=0;a<o;a++)d()&&(a<6?g(16):g(64))}p();const _=u();if(_===0)u();else if(_===1)for(f(1),h(),h(),r=u(),a=0;a<r;a++)h();p(),f(1);const y=u(),S=u(),C=c(1);C===0&&f(1),f(1),d()&&(e=u(),t=u(),n=u(),i=u());let E=[1,1];if(d()&&d())switch(l()){case 1:E=[1,1];break;case 2:E=[12,11];break;case 3:E=[10,11];break;case 4:E=[16,11];break;case 5:E=[40,33];break;case 6:E=[24,11];break;case 7:E=[20,11];break;case 8:E=[32,11];break;case 9:E=[80,33];break;case 10:E=[18,11];break;case 11:E=[15,11];break;case 12:E=[64,33];break;case 13:E=[160,99];break;case 14:E=[4,3];break;case 15:E=[3,2];break;case 16:E=[2,1];break;case 255:{E=[l()<<8|l(),l()<<8|l()];break}}return{width:Math.ceil((y+1)*16-e*2-t*2),height:(2-C)*(S+1)*16-(C?2:4)*(n+i),pixelRatio:E}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class hF extends fF{parseAVCPES(e,t,n,i,r){const o=this.parseAVCNALu(e,n.data);let a=this.VideoSample,l,c=!1;n.data=null,a&&o.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts,"")),o.forEach(u=>{var d;switch(u.type){case 1:{let g=!1;l=!0;const m=u.data;if(c&&m.length>4){const _=new s1(m).readSliceType();(_===2||_===4||_===7||_===9)&&(g=!0)}if(g){var f;(f=a)!=null&&f.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null)}a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts,"")),a.frame=!0,a.key=g;break}case 5:l=!0,(d=a)!=null&&d.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts,"")),a.key=!0,a.frame=!0;break;case 6:{l=!0,Dv(u.data,1,n.pts,t.samples);break}case 7:{var h,p;l=!0,c=!0;const g=u.data,_=new s1(g).readSPS();if(!e.sps||e.width!==_.width||e.height!==_.height||((h=e.pixelRatio)==null?void 0:h[0])!==_.pixelRatio[0]||((p=e.pixelRatio)==null?void 0:p[1])!==_.pixelRatio[1]){e.width=_.width,e.height=_.height,e.pixelRatio=_.pixelRatio,e.sps=[g],e.duration=r;const y=g.subarray(1,4);let S="avc1.";for(let C=0;C<3;C++){let E=y[C].toString(16);E.length<2&&(E="0"+E),S+=E}e.codec=S}break}case 8:l=!0,e.pps=[u.data];break;case 9:l=!0,e.audFound=!0,a&&this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts,"");break;case 12:l=!0;break;default:l=!1,a&&(a.debug+="unknown NAL "+u.type+" ");break}a&&l&&a.units.push(u)}),i&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}parseAVCNALu(e,t){const n=t.byteLength;let i=e.naluState||0;const r=i,o=[];let a=0,l,c,u,d=-1,f=0;for(i===-1&&(d=0,f=t[0]&31,i=0,a=1);a<n;){if(l=t[a++],!i){i=l?0:1;continue}if(i===1){i=l?0:2;continue}if(!l)i=3;else if(l===1){if(c=a-i-1,d>=0){const h={data:t.subarray(d,c),type:f};o.push(h)}else{const h=this.getLastNalUnit(e.samples);h&&(r&&a<=4-r&&h.state&&(h.data=h.data.subarray(0,h.data.byteLength-r)),c>0&&(h.data=Ks(h.data,t.subarray(0,c)),h.state=0))}a<n?(u=t[a]&31,d=a,f=u,i=0):i=-1}else i=0}if(d>=0&&i>=0){const h={data:t.subarray(d,n),type:f,state:i};o.push(h)}if(o.length===0){const h=this.getLastNalUnit(e.samples);h&&(h.data=Ks(h.data,t))}return e.naluState=i,o}}class pF{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new Vf(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,n){const i=e[t].unit;if(i.length<=16)return;const r=i.subarray(16,i.length-i.length%16),o=r.buffer.slice(r.byteOffset,r.byteOffset+r.length);this.decryptBuffer(o).then(a=>{const l=new Uint8Array(a);i.set(l,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)})}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length){n();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,n=new Int8Array(t);let i=0;for(let r=32;r<e.length-16;r+=160,i+=16)n.set(e.subarray(r,r+16),i);return n}getAvcDecryptedUnit(e,t){const n=new Uint8Array(t);let i=0;for(let r=32;r<e.length-16;r+=160,i+=16)e.set(n.subarray(i,i+16),r);return e}decryptAvcSample(e,t,n,i,r){const o=Pv(r.data),a=this.getAvcEncryptedData(o);this.decryptBuffer(a.buffer).then(l=>{r.data=this.getAvcDecryptedUnit(o,l),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,i)})}decryptAvcSamples(e,t,n,i){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length){i();return}const r=e[t].units;for(;!(n>=r.length);n++){const o=r[n];if(!(o.data.length<=48||o.type!==1&&o.type!==5)&&(this.decryptAvcSample(e,t,n,i,o),!this.decrypter.isSync()))return}}}}const qt=188;class ui{constructor(e,t,n){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.videoParser=new hF}static probe(e){const t=ui.syncOffset(e);return t>0&&V.warn(`MPEG2-TS detected but first sync word found @ offset ${t}`),t!==-1}static syncOffset(e){const t=e.length;let n=Math.min(qt*5,t-qt)+1,i=0;for(;i<n;){let r=!1,o=-1,a=0;for(let l=i;l<t;l+=qt)if(e[l]===71&&(t-l===qt||e[l+qt]===71)){if(a++,o===-1&&(o=l,o!==0&&(n=Math.min(o+qt*99,e.length-qt)+1)),r||(r=bd(e,l)===0),r&&a>1&&(o===0&&a>2||l+qt>n))return o}else{if(a)return-1;break}i++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:Av[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,n,i){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=ui.createTrack("video"),this._audioTrack=ui.createTrack("audio",i),this._id3Track=ui.createTrack("id3"),this._txtTrack=ui.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n,this._duration=i}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,n=!1,i=!1){n||(this.sampleAes=null);let r;const o=this._videoTrack,a=this._audioTrack,l=this._id3Track,c=this._txtTrack;let u=o.pid,d=o.pesData,f=a.pid,h=l.pid,p=a.pesData,g=l.pesData,m=null,_=this.pmtParsed,y=this._pmtId,S=e.length;if(this.remainderData&&(e=Ks(this.remainderData,e),S=e.length,this.remainderData=null),S<qt&&!i)return this.remainderData=e,{audioTrack:a,videoTrack:o,id3Track:l,textTrack:c};const C=Math.max(0,ui.syncOffset(e));S-=(S-C)%qt,S<e.byteLength&&!i&&(this.remainderData=new Uint8Array(e.buffer,S,e.buffer.byteLength-S));let E=0;for(let R=C;R<S;R+=qt)if(e[R]===71){const I=!!(e[R+1]&64),D=bd(e,R),L=(e[R+3]&48)>>4;let M;if(L>1){if(M=R+5+e[R+4],M===R+qt)continue}else M=R+4;switch(D){case u:I&&(d&&(r=gr(d))&&this.videoParser.parseAVCPES(o,c,r,!1,this._duration),d={data:[],size:0}),d&&(d.data.push(e.subarray(M,R+qt)),d.size+=R+qt-M);break;case f:if(I){if(p&&(r=gr(p)))switch(a.segmentCodec){case"aac":this.parseAACPES(a,r);break;case"mp3":this.parseMPEGPES(a,r);break;case"ac3":this.parseAC3PES(a,r);break}p={data:[],size:0}}p&&(p.data.push(e.subarray(M,R+qt)),p.size+=R+qt-M);break;case h:I&&(g&&(r=gr(g))&&this.parseID3PES(l,r),g={data:[],size:0}),g&&(g.data.push(e.subarray(M,R+qt)),g.size+=R+qt-M);break;case 0:I&&(M+=e[M]+1),y=this._pmtId=gF(e,M);break;case y:{I&&(M+=e[M]+1);const $=mF(e,M,this.typeSupported,n);u=$.videoPid,u>0&&(o.pid=u,o.segmentCodec=$.segmentVideoCodec),f=$.audioPid,f>0&&(a.pid=f,a.segmentCodec=$.segmentAudioCodec),h=$.id3Pid,h>0&&(l.pid=h),m!==null&&!_&&(V.warn(`MPEG-TS PMT found at ${R} after unknown PID '${m}'. Backtracking to sync byte @${C} to parse all TS packets.`),m=null,R=C-188),_=this.pmtParsed=!0;break}case 17:case 8191:break;default:m=D;break}}else E++;if(E>0){const R=new Error(`Found ${E} TS packet/s that do not start with 0x47`);this.observer.emit(b.ERROR,b.ERROR,{type:Ge.MEDIA_ERROR,details:j.FRAG_PARSING_ERROR,fatal:!1,error:R,reason:R.message})}o.pesData=d,a.pesData=p,l.pesData=g;const A={audioTrack:a,videoTrack:o,id3Track:l,textTrack:c};return i&&this.extractRemainingSamples(A),A}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:n,id3Track:i,textTrack:r}=e,o=n.pesData,a=t.pesData,l=i.pesData;let c;if(o&&(c=gr(o))?(this.videoParser.parseAVCPES(n,r,c,!0,this._duration),n.pesData=null):n.pesData=o,a&&(c=gr(a))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,c);break;case"mp3":this.parseMPEGPES(t,c);break;case"ac3":this.parseAC3PES(t,c);break}t.pesData=null}else a!=null&&a.size&&V.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=a;l&&(c=gr(l))?(this.parseID3PES(i,c),i.pesData=null):i.pesData=l}demuxSampleAes(e,t,n){const i=this.demux(e,n,!0,!this.config.progressive),r=this.sampleAes=new pF(this.observer,this.config,t);return this.decrypt(i,r)}decrypt(e,t){return new Promise(n=>{const{audioTrack:i,videoTrack:r}=e;i.samples&&i.segmentCodec==="aac"?t.decryptAacSamples(i.samples,0,()=>{r.samples?t.decryptAvcSamples(r.samples,0,0,()=>{n(e)}):n(e)}):r.samples&&t.decryptAvcSamples(r.samples,0,0,()=>{n(e)})})}destroy(){this._duration=0}parseAACPES(e,t){let n=0;const i=this.aacOverFlow;let r=t.data;if(i){this.aacOverFlow=null;const d=i.missing,f=i.sample.unit.byteLength;if(d===-1)r=Ks(i.sample.unit,r);else{const h=f-d;i.sample.unit.set(r.subarray(0,d),h),e.samples.push(i.sample),n=i.missing}}let o,a;for(o=n,a=r.length;o<a-1&&!Vl(r,o);o++);if(o!==n){let d;const f=o<a-1;f?d=`AAC PES did not start with ADTS header,offset:${o}`:d="No ADTS header found in AAC PES";const h=new Error(d);if(V.warn(`parsing error: ${d}`),this.observer.emit(b.ERROR,b.ERROR,{type:Ge.MEDIA_ERROR,details:j.FRAG_PARSING_ERROR,fatal:!1,levelRetry:f,error:h,reason:d}),!f)return}Wv(e,this.observer,r,o,this.audioCodec);let l;if(t.pts!==void 0)l=t.pts;else if(i){const d=Yv(e.samplerate);l=i.sample.pts+d}else{V.warn("[tsdemuxer]: AAC PES unknown PTS");return}let c=0,u;for(;o<a;)if(u=Zv(e,r,o,l,c),o+=u.length,u.missing){this.aacOverFlow=u;break}else for(c++;o<a-1&&!Vl(r,o);o++);}parseMPEGPES(e,t){const n=t.data,i=n.length;let r=0,o=0;const a=t.pts;if(a===void 0){V.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;o<i;)if(Jv(n,o)){const l=Xv(e,n,o,a,r);if(l)o+=l.length,r++;else break}else o++}parseAC3PES(e,t){{const n=t.data,i=t.pts;if(i===void 0){V.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const r=n.length;let o=0,a=0,l;for(;a<r&&(l=s_(e,n,a,i,o++))>0;)a+=l}}parseID3PES(e,t){if(t.pts===void 0){V.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const n=Vt({},t,{type:this._videoTrack?sn.emsg:sn.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function bd(s,e){return((s[e+1]&31)<<8)+s[e+2]}function gF(s,e){return(s[e+10]&31)<<8|s[e+11]}function mF(s,e,t,n){const i={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},r=(s[e+1]&15)<<8|s[e+2],o=e+3+r-4,a=(s[e+10]&15)<<8|s[e+11];for(e+=12+a;e<o;){const l=bd(s,e),c=(s[e+3]&15)<<8|s[e+4];switch(s[e]){case 207:if(!n){nu("ADTS AAC");break}case 15:i.audioPid===-1&&(i.audioPid=l);break;case 21:i.id3Pid===-1&&(i.id3Pid=l);break;case 219:if(!n){nu("H.264");break}case 27:i.videoPid===-1&&(i.videoPid=l,i.segmentVideoCodec="avc");break;case 3:case 4:!t.mpeg&&!t.mp3?V.log("MPEG audio found, not supported in this browser"):i.audioPid===-1&&(i.audioPid=l,i.segmentAudioCodec="mp3");break;case 193:if(!n){nu("AC-3");break}case 129:t.ac3?i.audioPid===-1&&(i.audioPid=l,i.segmentAudioCodec="ac3"):V.log("AC-3 audio found, not supported in this browser");break;case 6:if(i.audioPid===-1&&c>0){let u=e+5,d=c;for(;d>2;){switch(s[u]){case 106:t.ac3!==!0?V.log("AC-3 audio found, not supported in this browser for now"):(i.audioPid=l,i.segmentAudioCodec="ac3");break}const h=s[u+1]+2;u+=h,d-=h}}break;case 194:case 135:V.warn("Unsupported EC-3 in M2TS found");break;case 36:V.warn("Unsupported HEVC in M2TS found");break}e+=c+5}return i}function nu(s){V.log(`${s} with AES-128-CBC encryption found in unencrypted stream`)}function gr(s){let e=0,t,n,i,r,o;const a=s.data;if(!s||s.size===0)return null;for(;a[0].length<19&&a.length>1;)a[0]=Ks(a[0],a[1]),a.splice(1,1);if(t=a[0],(t[0]<<16)+(t[1]<<8)+t[2]===1){if(n=(t[4]<<8)+t[5],n&&n>s.size-6)return null;const c=t[7];c&192&&(r=(t[9]&14)*536870912+(t[10]&255)*4194304+(t[11]&254)*16384+(t[12]&255)*128+(t[13]&254)/2,c&64?(o=(t[14]&14)*536870912+(t[15]&255)*4194304+(t[16]&254)*16384+(t[17]&255)*128+(t[18]&254)/2,r-o>60*9e4&&(V.warn(`${Math.round((r-o)/9e4)}s delta between PTS and DTS, align them`),r=o)):o=r),i=t[8];let u=i+9;if(s.size<=u)return null;s.size-=u;const d=new Uint8Array(s.size);for(let f=0,h=a.length;f<h;f++){t=a[f];let p=t.byteLength;if(u)if(u>p){u-=p;continue}else t=t.subarray(u),p-=u,u=0;d.set(t,e),e+=p}return n&&(n-=i+3),{data:d,pts:r,dts:o,len:n}}return null}class vF extends Uf{resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=zo(e,0);let n=(t==null?void 0:t.length)||0;if(t&&e[n]===11&&e[n+1]===119&&Of(t)!==void 0&&t_(e,n)<=16)return!1;for(let i=e.length;n<i;n++)if(e_(e,n))return V.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return aF(e,t)}appendFrame(e,t,n){if(this.basePTS!==null)return Xv(e,t,n,this.basePTS,this.frameIndex)}}class n1{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const ei=Math.pow(2,32)-1;class B{static init(){B.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in B.types)B.types.hasOwnProperty(e)&&(B.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);B.HDLR_TYPES={video:t,audio:n};const i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r=new Uint8Array([0,0,0,0,0,0,0,0]);B.STTS=B.STSC=B.STCO=r,B.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),B.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),B.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),B.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const o=new Uint8Array([105,115,111,109]),a=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);B.FTYP=B.box(B.types.ftyp,o,l,o,a),B.DINF=B.box(B.types.dinf,B.box(B.types.dref,i))}static box(e,...t){let n=8,i=t.length;const r=i;for(;i--;)n+=t[i].byteLength;const o=new Uint8Array(n);for(o[0]=n>>24&255,o[1]=n>>16&255,o[2]=n>>8&255,o[3]=n&255,o.set(e,4),i=0,n=8;i<r;i++)o.set(t[i],n),n+=t[i].byteLength;return o}static hdlr(e){return B.box(B.types.hdlr,B.HDLR_TYPES[e])}static mdat(e){return B.box(B.types.mdat,e)}static mdhd(e,t){t*=e;const n=Math.floor(t/(ei+1)),i=Math.floor(t%(ei+1));return B.box(B.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,i>>24,i>>16&255,i>>8&255,i&255,85,196,0,0]))}static mdia(e){return B.box(B.types.mdia,B.mdhd(e.timescale,e.duration),B.hdlr(e.type),B.minf(e))}static mfhd(e){return B.box(B.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?B.box(B.types.minf,B.box(B.types.smhd,B.SMHD),B.DINF,B.stbl(e)):B.box(B.types.minf,B.box(B.types.vmhd,B.VMHD),B.DINF,B.stbl(e))}static moof(e,t,n){return B.box(B.types.moof,B.mfhd(e),B.traf(n,t))}static moov(e){let t=e.length;const n=[];for(;t--;)n[t]=B.trak(e[t]);return B.box.apply(null,[B.types.moov,B.mvhd(e[0].timescale,e[0].duration)].concat(n).concat(B.mvex(e)))}static mvex(e){let t=e.length;const n=[];for(;t--;)n[t]=B.trex(e[t]);return B.box.apply(null,[B.types.mvex,...n])}static mvhd(e,t){t*=e;const n=Math.floor(t/(ei+1)),i=Math.floor(t%(ei+1)),r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,i>>24,i>>16&255,i>>8&255,i&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return B.box(B.types.mvhd,r)}static sdtp(e){const t=e.samples||[],n=new Uint8Array(4+t.length);let i,r;for(i=0;i<t.length;i++)r=t[i].flags,n[i+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return B.box(B.types.sdtp,n)}static stbl(e){return B.box(B.types.stbl,B.stsd(e),B.box(B.types.stts,B.STTS),B.box(B.types.stsc,B.STSC),B.box(B.types.stsz,B.STSZ),B.box(B.types.stco,B.STCO))}static avc1(e){let t=[],n=[],i,r,o;for(i=0;i<e.sps.length;i++)r=e.sps[i],o=r.byteLength,t.push(o>>>8&255),t.push(o&255),t=t.concat(Array.prototype.slice.call(r));for(i=0;i<e.pps.length;i++)r=e.pps[i],o=r.byteLength,n.push(o>>>8&255),n.push(o&255),n=n.concat(Array.prototype.slice.call(r));const a=B.box(B.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(n))),l=e.width,c=e.height,u=e.pixelRatio[0],d=e.pixelRatio[1];return B.box(B.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,l&255,c>>8&255,c&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,B.box(B.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),B.box(B.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,u&255,d>>24,d>>16&255,d>>8&255,d&255])))}static esds(e){const t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static audioStsd(e){const t=e.samplerate;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return B.box(B.types.mp4a,B.audioStsd(e),B.box(B.types.esds,B.esds(e)))}static mp3(e){return B.box(B.types[".mp3"],B.audioStsd(e))}static ac3(e){return B.box(B.types["ac-3"],B.audioStsd(e),B.box(B.types.dac3,e.config))}static stsd(e){return e.type==="audio"?e.segmentCodec==="mp3"&&e.codec==="mp3"?B.box(B.types.stsd,B.STSD,B.mp3(e)):e.segmentCodec==="ac3"?B.box(B.types.stsd,B.STSD,B.ac3(e)):B.box(B.types.stsd,B.STSD,B.mp4a(e)):B.box(B.types.stsd,B.STSD,B.avc1(e))}static tkhd(e){const t=e.id,n=e.duration*e.timescale,i=e.width,r=e.height,o=Math.floor(n/(ei+1)),a=Math.floor(n%(ei+1));return B.box(B.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,o>>24,o>>16&255,o>>8&255,o&255,a>>24,a>>16&255,a>>8&255,a&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,i&255,0,0,r>>8&255,r&255,0,0]))}static traf(e,t){const n=B.sdtp(e),i=e.id,r=Math.floor(t/(ei+1)),o=Math.floor(t%(ei+1));return B.box(B.types.traf,B.box(B.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255])),B.box(B.types.tfdt,new Uint8Array([1,0,0,0,r>>24,r>>16&255,r>>8&255,r&255,o>>24,o>>16&255,o>>8&255,o&255])),B.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,B.box(B.types.trak,B.tkhd(e),B.mdia(e))}static trex(e){const t=e.id;return B.box(B.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const n=e.samples||[],i=n.length,r=12+16*i,o=new Uint8Array(r);let a,l,c,u,d,f;for(t+=8+r,o.set([e.type==="video"?1:0,0,15,1,i>>>24&255,i>>>16&255,i>>>8&255,i&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),a=0;a<i;a++)l=n[a],c=l.duration,u=l.size,d=l.flags,f=l.cts,o.set([c>>>24&255,c>>>16&255,c>>>8&255,c&255,u>>>24&255,u>>>16&255,u>>>8&255,u&255,d.isLeading<<2|d.dependsOn,d.isDependedOn<<6|d.hasRedundancy<<4|d.paddingValue<<1|d.isNonSync,d.degradPrio&240<<8,d.degradPrio&15,f>>>24&255,f>>>16&255,f>>>8&255,f&255],12+16*a);return B.box(B.types.trun,o)}static initSegment(e){B.types||B.init();const t=B.moov(e);return Ks(B.FTYP,t)}}B.types=void 0;B.HDLR_TYPES=void 0;B.STTS=void 0;B.STSC=void 0;B.STCO=void 0;B.STSZ=void 0;B.VMHD=void 0;B.SMHD=void 0;B.STSD=void 0;B.FTYP=void 0;B.DINF=void 0;const n_=9e4;function zf(s,e,t=1,n=!1){const i=s*e*t;return n?Math.round(i):i}function _F(s,e,t=1,n=!1){return zf(s,e,1/t,n)}function uo(s,e=!1){return zf(s,1e3,1/n_,e)}function yF(s,e=1){return zf(s,n_,1/e)}const xF=10*1e3,i1=1024,bF=1152,wF=1536;let mr=null,iu=null;class el{constructor(e,t,n,i=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,mr===null){const o=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);mr=o?parseInt(o[1]):0}if(iu===null){const r=navigator.userAgent.match(/Safari\/(\d+)/i);iu=r?parseInt(r[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){V.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){V.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){V.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const n=e.reduce((i,r)=>{const o=r.pts-i;return o<-4294967296?(t=!0,Ns(i,r.pts)):o>0?i:r.pts},e[0].pts);return t&&V.debug("PTS rollover detected"),n}remux(e,t,n,i,r,o,a,l){let c,u,d,f,h,p,g=r,m=r;const _=e.pid>-1,y=t.pid>-1,S=t.samples.length,C=e.samples.length>0,E=a&&S>0||S>1;if((!_||C)&&(!y||E)||this.ISGenerated||a){if(this.ISGenerated){var R,I,D,L;const ie=this.videoTrackConfig;ie&&(t.width!==ie.width||t.height!==ie.height||((R=t.pixelRatio)==null?void 0:R[0])!==((I=ie.pixelRatio)==null?void 0:I[0])||((D=t.pixelRatio)==null?void 0:D[1])!==((L=ie.pixelRatio)==null?void 0:L[1]))&&this.resetInitSegment()}else d=this.generateIS(e,t,r,o);const M=this.isVideoContiguous;let $=-1,H;if(E&&($=SF(t.samples),!M&&this.config.forceKeyFrameOnDiscontinuity))if(p=!0,$>0){V.warn(`[mp4-remuxer]: Dropped ${$} out of ${S} video samples due to a missing keyframe`);const ie=this.getVideoStartPts(t.samples);t.samples=t.samples.slice($),t.dropped+=$,m+=(t.samples[0].pts-ie)/t.inputTimeScale,H=m}else $===-1&&(V.warn(`[mp4-remuxer]: No keyframe found out of ${S} video samples`),p=!1);if(this.ISGenerated){if(C&&E){const ie=this.getVideoStartPts(t.samples),X=(Ns(e.samples[0].pts,ie)-ie)/t.inputTimeScale;g+=Math.max(0,X),m+=Math.max(0,-X)}if(C){if(e.samplerate||(V.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),d=this.generateIS(e,t,r,o)),u=this.remuxAudio(e,g,this.isAudioContiguous,o,y||E||l===He.AUDIO?m:void 0),E){const ie=u?u.endPTS-u.startPTS:0;t.inputTimeScale||(V.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),d=this.generateIS(e,t,r,o)),c=this.remuxVideo(t,m,M,ie)}}else E&&(c=this.remuxVideo(t,m,M,0));c&&(c.firstKeyFrame=$,c.independent=$!==-1,c.firstKeyFramePTS=H)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(h=i_(n,r,this._initPTS,this._initDTS)),i.samples.length&&(f=r_(i,r,this._initPTS))),{audio:u,video:c,initSegment:d,independent:p,text:f,id3:h}}generateIS(e,t,n,i){const r=e.samples,o=t.samples,a=this.typeSupported,l={},c=this._initPTS;let u=!c||i,d="audio/mp4",f,h,p;if(u&&(f=h=1/0),e.config&&r.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":a.mpeg?(d="audio/mpeg",e.codec=""):a.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}l.audio={id:"audio",container:d,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&a.mpeg?new Uint8Array(0):B.initSegment([e]),metadata:{channelCount:e.channelCount}},u&&(p=e.inputTimeScale,!c||p!==c.timescale?f=h=r[0].pts-Math.round(p*n):u=!1)}if(t.sps&&t.pps&&o.length){if(t.timescale=t.inputTimeScale,l.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:B.initSegment([t]),metadata:{width:t.width,height:t.height}},u)if(p=t.inputTimeScale,!c||p!==c.timescale){const g=this.getVideoStartPts(o),m=Math.round(p*n);h=Math.min(h,Ns(o[0].dts,g)-m),f=Math.min(f,g-m)}else u=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(l).length)return this.ISGenerated=!0,u?(this._initPTS={baseTime:f,timescale:p},this._initDTS={baseTime:h,timescale:p}):f=p=void 0,{tracks:l,initPTS:f,timescale:p}}remuxVideo(e,t,n,i){const r=e.inputTimeScale,o=e.samples,a=[],l=o.length,c=this._initPTS;let u=this.nextAvcDts,d=8,f=this.videoSampleDuration,h,p,g=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY,_=!1;if(!n||u===null){const le=t*r,re=o[0].pts-Ns(o[0].dts,o[0].pts);mr&&u!==null&&Math.abs(le-re-u)<15e3?n=!0:u=le-re}const y=c.baseTime*r/c.timescale;for(let le=0;le<l;le++){const re=o[le];re.pts=Ns(re.pts-y,u),re.dts=Ns(re.dts-y,u),re.dts<o[le>0?le-1:le].dts&&(_=!0)}_&&o.sort(function(le,re){const Be=le.dts-re.dts,be=le.pts-re.pts;return Be||be}),h=o[0].dts,p=o[o.length-1].dts;const S=p-h,C=S?Math.round(S/(l-1)):f||e.inputTimeScale/30;if(n){const le=h-u,re=le>C,Be=le<-1;if((re||Be)&&(re?V.warn(`AVC: ${uo(le,!0)} ms (${le}dts) hole between fragments detected at ${t.toFixed(3)}`):V.warn(`AVC: ${uo(-le,!0)} ms (${le}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!Be||u>=o[0].pts||mr)){h=u;const be=o[0].pts-le;if(re)o[0].dts=h,o[0].pts=be;else for(let Fe=0;Fe<o.length&&!(o[Fe].dts>be);Fe++)o[Fe].dts-=le,o[Fe].pts-=le;V.log(`Video: Initial PTS/DTS adjusted: ${uo(be,!0)}/${uo(h,!0)}, delta: ${uo(le,!0)} ms`)}}h=Math.max(0,h);let E=0,A=0,R=h;for(let le=0;le<l;le++){const re=o[le],Be=re.units,be=Be.length;let Fe=0;for(let We=0;We<be;We++)Fe+=Be[We].data.length;A+=Fe,E+=be,re.length=Fe,re.dts<R?(re.dts=R,R+=C/4|0||1):R=re.dts,g=Math.min(re.pts,g),m=Math.max(re.pts,m)}p=o[l-1].dts;const I=A+4*E+8;let D;try{D=new Uint8Array(I)}catch(le){this.observer.emit(b.ERROR,b.ERROR,{type:Ge.MUX_ERROR,details:j.REMUX_ALLOC_ERROR,fatal:!1,error:le,bytes:I,reason:`fail allocating video mdat ${I}`});return}const L=new DataView(D.buffer);L.setUint32(0,I),D.set(B.types.mdat,4);let M=!1,$=Number.POSITIVE_INFINITY,H=Number.POSITIVE_INFINITY,ie=Number.NEGATIVE_INFINITY,te=Number.NEGATIVE_INFINITY;for(let le=0;le<l;le++){const re=o[le],Be=re.units;let be=0;for(let ot=0,Ue=Be.length;ot<Ue;ot++){const K=Be[ot],me=K.data,fe=K.data.byteLength;L.setUint32(d,fe),d+=4,D.set(me,d),d+=fe,be+=4+fe}let Fe;if(le<l-1)f=o[le+1].dts-re.dts,Fe=o[le+1].pts-re.pts;else{const ot=this.config,Ue=le>0?re.dts-o[le-1].dts:C;if(Fe=le>0?re.pts-o[le-1].pts:C,ot.stretchShortVideoTrack&&this.nextAudioPts!==null){const K=Math.floor(ot.maxBufferHole*r),me=(i?g+i*r:this.nextAudioPts)-re.pts;me>K?(f=me-Ue,f<0?f=Ue:M=!0,V.log(`[mp4-remuxer]: It is approximately ${me/90} ms to the next segment; using duration ${f/90} ms for the last video frame.`)):f=Ue}else f=Ue}const We=Math.round(re.pts-re.dts);$=Math.min($,f),ie=Math.max(ie,f),H=Math.min(H,Fe),te=Math.max(te,Fe),a.push(new r1(re.key,f,be,We))}if(a.length){if(mr){if(mr<70){const le=a[0].flags;le.dependsOn=2,le.isNonSync=0}}else if(iu&&te-H<ie-$&&C/ie<.025&&a[0].cts===0){V.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let le=h;for(let re=0,Be=a.length;re<Be;re++){const be=le+a[re].duration,Fe=le+a[re].cts;if(re<Be-1){const We=be+a[re+1].cts;a[re].duration=We-Fe}else a[re].duration=re?a[re-1].duration:C;a[re].cts=0,le=be}}}f=M||!f?C:f,this.nextAvcDts=u=p+f,this.videoSampleDuration=f,this.isVideoContiguous=!0;const X=B.moof(e.sequenceNumber++,h,Vt({},e,{samples:a})),de="video",xe={data1:X,data2:D,startPTS:g/r,endPTS:(m+f)/r,startDTS:h/r,endDTS:u/r,type:de,hasAudio:!1,hasVideo:!0,nb:a.length,dropped:e.dropped};return e.samples=[],e.dropped=0,xe}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return bF;case"ac3":return wF;default:return i1}}remuxAudio(e,t,n,i,r){const o=e.inputTimeScale,a=e.samplerate?e.samplerate:o,l=o/a,c=this.getSamplesPerFrame(e),u=c*l,d=this._initPTS,f=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,h=[],p=r!==void 0;let g=e.samples,m=f?0:8,_=this.nextAudioPts||-1;const y=t*o,S=d.baseTime*o/d.timescale;if(this.isAudioContiguous=n=n||g.length&&_>0&&(i&&Math.abs(y-_)<9e3||Math.abs(Ns(g[0].pts-S,y)-_)<20*u),g.forEach(function(X){X.pts=Ns(X.pts-S,y)}),!n||_<0){if(g=g.filter(X=>X.pts>=0),!g.length)return;r===0?_=0:i&&!p?_=Math.max(0,y):_=g[0].pts}if(e.segmentCodec==="aac"){const X=this.config.maxAudioFramesDrift;for(let de=0,xe=_;de<g.length;de++){const le=g[de],re=le.pts,Be=re-xe,be=Math.abs(1e3*Be/o);if(Be<=-X*u&&p)de===0&&(V.warn(`Audio frame @ ${(re/o).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*Be/o)} ms.`),this.nextAudioPts=_=xe=re);else if(Be>=X*u&&be<xF&&p){let Fe=Math.round(Be/u);xe=re-Fe*u,xe<0&&(Fe--,xe+=u),de===0&&(this.nextAudioPts=_=xe),V.warn(`[mp4-remuxer]: Injecting ${Fe} audio frame @ ${(xe/o).toFixed(3)}s due to ${Math.round(1e3*Be/o)} ms gap.`);for(let We=0;We<Fe;We++){const ot=Math.max(xe,0);let Ue=n1.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);Ue||(V.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),Ue=le.unit.subarray()),g.splice(de,0,{unit:Ue,pts:ot}),xe+=u,de++}}le.pts=xe,xe+=u}}let C=null,E=null,A,R=0,I=g.length;for(;I--;)R+=g[I].unit.byteLength;for(let X=0,de=g.length;X<de;X++){const xe=g[X],le=xe.unit;let re=xe.pts;if(E!==null){const be=h[X-1];be.duration=Math.round((re-E)/l)}else if(n&&e.segmentCodec==="aac"&&(re=_),C=re,R>0){R+=m;try{A=new Uint8Array(R)}catch(be){this.observer.emit(b.ERROR,b.ERROR,{type:Ge.MUX_ERROR,details:j.REMUX_ALLOC_ERROR,fatal:!1,error:be,bytes:R,reason:`fail allocating audio mdat ${R}`});return}f||(new DataView(A.buffer).setUint32(0,R),A.set(B.types.mdat,4))}else return;A.set(le,m);const Be=le.byteLength;m+=Be,h.push(new r1(!0,c,Be,0)),E=re}const D=h.length;if(!D)return;const L=h[h.length-1];this.nextAudioPts=_=E+l*L.duration;const M=f?new Uint8Array(0):B.moof(e.sequenceNumber++,C/l,Vt({},e,{samples:h}));e.samples=[];const $=C/o,H=_/o,te={data1:M,data2:A,startPTS:$,endPTS:H,startDTS:$,endDTS:H,type:"audio",hasAudio:!0,hasVideo:!1,nb:D};return this.isAudioContiguous=!0,te}remuxEmptyAudio(e,t,n,i){const r=e.inputTimeScale,o=e.samplerate?e.samplerate:r,a=r/o,l=this.nextAudioPts,c=this._initDTS,u=c.baseTime*9e4/c.timescale,d=(l!==null?l:i.startDTS*r)+u,f=i.endDTS*r+u,h=a*i1,p=Math.ceil((f-d)/h),g=n1.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(V.warn("[mp4-remuxer]: remux empty Audio"),!g){V.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}const m=[];for(let _=0;_<p;_++){const y=d+_*h;m.push({unit:g,pts:y,dts:y})}return e.samples=m,this.remuxAudio(e,t,n,!1)}}function Ns(s,e){let t;if(e===null)return s;for(e<s?t=-8589934592:t=8589934592;Math.abs(s-e)>4294967296;)s+=t;return s}function SF(s){for(let e=0;e<s.length;e++)if(s[e].key)return e;return-1}function i_(s,e,t,n){const i=s.samples.length;if(!i)return;const r=s.inputTimeScale;for(let a=0;a<i;a++){const l=s.samples[a];l.pts=Ns(l.pts-t.baseTime*r/t.timescale,e*r)/r,l.dts=Ns(l.dts-n.baseTime*r/n.timescale,e*r)/r}const o=s.samples;return s.samples=[],{samples:o}}function r_(s,e,t){const n=s.samples.length;if(!n)return;const i=s.inputTimeScale;for(let o=0;o<n;o++){const a=s.samples[o];a.pts=Ns(a.pts-t.baseTime*i/t.timescale,e*i)/i}s.samples.sort((o,a)=>o.pts-a.pts);const r=s.samples;return s.samples=[],{samples:r}}class r1{constructor(e,t,n,i){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=n,this.cts=i,this.flags={isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e?2:1,isNonSync:e?0:1}}}class EF{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,n,i){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(DD(e,i)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:n}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const i=this.initData=Rv(e);i.audio&&(t=o1(i.audio,mt.AUDIO)),i.video&&(n=o1(i.video,mt.VIDEO));const r={};i.audio&&i.video?r.audiovideo={container:"video/mp4",codec:t+","+n,initSegment:e,id:"main"}:i.audio?r.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:i.video?r.video={container:"video/mp4",codec:n,initSegment:e,id:"main"}:V.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=r}remux(e,t,n,i,r,o){var a,l;let{initPTS:c,lastEndTime:u}=this;const d={audio:void 0,video:void 0,text:i,id3:n,initSegment:void 0};Ee(u)||(u=this.lastEndTime=r||0);const f=t.samples;if(!(f!=null&&f.length))return d;const h={initPTS:void 0,timescale:1};let p=this.initData;if((a=p)!=null&&a.length||(this.generateInitSegment(f),p=this.initData),!((l=p)!=null&&l.length))return V.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),d;this.emitInitSegment&&(h.tracks=this.initTracks,this.emitInitSegment=!1);const g=FD(f,p),m=PD(p,f),_=m===null?r:m;(TF(c,_,r,g)||h.timescale!==c.timescale&&o)&&(h.initPTS=_-r,c&&c.timescale===1&&V.warn(`Adjusting initPTS by ${h.initPTS-c.baseTime}`),this.initPTS=c={baseTime:h.initPTS,timescale:1});const y=e?_-c.baseTime/c.timescale:u,S=y+g;MD(p,f,c.baseTime/c.timescale),g>0?this.lastEndTime=S:(V.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const C=!!p.audio,E=!!p.video;let A="";C&&(A+="audio"),E&&(A+="video");const R={data1:f,startPTS:y,startDTS:y,endPTS:S,endDTS:S,type:A,hasAudio:C,hasVideo:E,nb:1,dropped:0};return d.audio=R.type==="audio"?R:void 0,d.video=R.type!=="audio"?R:void 0,d.initSegment=h,d.id3=i_(n,r,c,c),i.samples.length&&(d.text=r_(i,r,c)),d}}function TF(s,e,t,n){if(s===null)return!0;const i=Math.max(n,1),r=e-s.baseTime/s.timescale;return Math.abs(r-t)>i}function o1(s,e){const t=s==null?void 0:s.codec;if(t&&t.length>4)return t;if(e===mt.AUDIO){if(t==="ec-3"||t==="ac-3"||t==="alac")return t;if(t==="fLaC"||t==="Opus")return Pl(t,!1);const n="mp4a.40.5";return V.info(`Parsed audio codec "${t}" or audio object type not handled. Using "${n}"`),n}return V.warn(`Unhandled video codec "${t}"`),t==="hvc1"||t==="hev1"?"hvc1.1.6.L120.90":t==="av01"?"av01.0.04M.08":"avc1.42e01e"}let On;try{On=self.performance.now.bind(self.performance)}catch{V.debug("Unable to use Performance API on this environment"),On=Yr==null?void 0:Yr.Date.now}const tl=[{demux:uF,remux:EF},{demux:ui,remux:el},{demux:lF,remux:el},{demux:vF,remux:el}];tl.splice(2,0,{demux:dF,remux:el});class a1{constructor(e,t,n,i,r){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.vendor=i,this.id=r}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,i){const r=n.transmuxing;r.executeStart=On();let o=new Uint8Array(e);const{currentTransmuxState:a,transmuxConfig:l}=this;i&&(this.currentTransmuxState=i);const{contiguous:c,discontinuity:u,trackSwitch:d,accurateTimeOffset:f,timeOffset:h,initSegmentChange:p}=i||a,{audioCodec:g,videoCodec:m,defaultInitPts:_,duration:y,initSegmentData:S}=l,C=CF(o,t);if(C&&C.method==="AES-128"){const I=this.getDecrypter();if(I.isSync()){let D=I.softwareDecrypt(o,C.key.buffer,C.iv.buffer);if(n.part>-1&&(D=I.flush()),!D)return r.executeEnd=On(),ru(n);o=new Uint8Array(D)}else return this.decryptionPromise=I.webCryptoDecrypt(o,C.key.buffer,C.iv.buffer).then(D=>{const L=this.push(D,null,n);return this.decryptionPromise=null,L}),this.decryptionPromise}const E=this.needsProbing(u,d);if(E){const I=this.configureTransmuxer(o);if(I)return V.warn(`[transmuxer] ${I.message}`),this.observer.emit(b.ERROR,b.ERROR,{type:Ge.MEDIA_ERROR,details:j.FRAG_PARSING_ERROR,fatal:!1,error:I,reason:I.message}),r.executeEnd=On(),ru(n)}(u||d||p||E)&&this.resetInitSegment(S,g,m,y,t),(u||p||E)&&this.resetInitialTimestamp(_),c||this.resetContiguity();const A=this.transmux(o,C,h,f,n),R=this.currentTransmuxState;return R.contiguous=!0,R.discontinuity=!1,R.trackSwitch=!1,r.executeEnd=On(),A}flush(e){const t=e.transmuxing;t.executeStart=On();const{decrypter:n,currentTransmuxState:i,decryptionPromise:r}=this;if(r)return r.then(()=>this.flush(e));const o=[],{timeOffset:a}=i;if(n){const d=n.flush();d&&o.push(this.push(d,null,e))}const{demuxer:l,remuxer:c}=this;if(!l||!c)return t.executeEnd=On(),[ru(e)];const u=l.flush(a);return sl(u)?u.then(d=>(this.flushRemux(o,d,e),o)):(this.flushRemux(o,u,e),o)}flushRemux(e,t,n){const{audioTrack:i,videoTrack:r,id3Track:o,textTrack:a}=t,{accurateTimeOffset:l,timeOffset:c}=this.currentTransmuxState;V.log(`[transmuxer.ts]: Flushed fragment ${n.sn}${n.part>-1?" p: "+n.part:""} of level ${n.level}`);const u=this.remuxer.remux(i,r,o,a,c,l,!0,this.id);e.push({remuxResult:u,chunkMeta:n}),n.transmuxing.executeEnd=On()}resetInitialTimestamp(e){const{demuxer:t,remuxer:n}=this;!t||!n||(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,i,r){const{demuxer:o,remuxer:a}=this;!o||!a||(o.resetInitSegment(e,t,n,i),a.resetInitSegment(e,t,n,r))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,i,r){let o;return t&&t.method==="SAMPLE-AES"?o=this.transmuxSampleAes(e,t,n,i,r):o=this.transmuxUnencrypted(e,n,i,r),o}transmuxUnencrypted(e,t,n,i){const{audioTrack:r,videoTrack:o,id3Track:a,textTrack:l}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(r,o,a,l,t,n,!1,this.id),chunkMeta:i}}transmuxSampleAes(e,t,n,i,r){return this.demuxer.demuxSampleAes(e,t,n).then(o=>({remuxResult:this.remuxer.remux(o.audioTrack,o.videoTrack,o.id3Track,o.textTrack,n,i,!1,this.id),chunkMeta:r}))}configureTransmuxer(e){const{config:t,observer:n,typeSupported:i,vendor:r}=this;let o;for(let f=0,h=tl.length;f<h;f++){var a;if((a=tl[f].demux)!=null&&a.probe(e)){o=tl[f];break}}if(!o)return new Error("Failed to find demuxer by probing fragment data");const l=this.demuxer,c=this.remuxer,u=o.remux,d=o.demux;(!c||!(c instanceof u))&&(this.remuxer=new u(n,t,i,r)),(!l||!(l instanceof d))&&(this.demuxer=new d(n,t,i),this.probe=d.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new Vf(this.config)),e}}function CF(s,e){let t=null;return s.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const ru=s=>({remuxResult:{},chunkMeta:s});function sl(s){return"then"in s&&s.then instanceof Function}class AF{constructor(e,t,n,i,r){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=i,this.defaultInitPts=r||null}}class kF{constructor(e,t,n,i,r,o){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=i,this.timeOffset=r,this.initSegmentChange=o}}var o_={exports:{}};(function(s){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function i(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function r(l,c,u,d,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var h=new i(u,d||l,f),p=t?t+c:c;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],h]:l._events[p].push(h):(l._events[p]=h,l._eventsCount++),l}function o(l,c){--l._eventsCount===0?l._events=new n:delete l._events[c]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],u,d;if(this._eventsCount===0)return c;for(d in u=this._events)e.call(u,d)&&c.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},a.prototype.listeners=function(c){var u=t?t+c:c,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,h=d.length,p=new Array(h);f<h;f++)p[f]=d[f].fn;return p},a.prototype.listenerCount=function(c){var u=t?t+c:c,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(c,u,d,f,h,p){var g=t?t+c:c;if(!this._events[g])return!1;var m=this._events[g],_=arguments.length,y,S;if(m.fn){switch(m.once&&this.removeListener(c,m.fn,void 0,!0),_){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,u),!0;case 3:return m.fn.call(m.context,u,d),!0;case 4:return m.fn.call(m.context,u,d,f),!0;case 5:return m.fn.call(m.context,u,d,f,h),!0;case 6:return m.fn.call(m.context,u,d,f,h,p),!0}for(S=1,y=new Array(_-1);S<_;S++)y[S-1]=arguments[S];m.fn.apply(m.context,y)}else{var C=m.length,E;for(S=0;S<C;S++)switch(m[S].once&&this.removeListener(c,m[S].fn,void 0,!0),_){case 1:m[S].fn.call(m[S].context);break;case 2:m[S].fn.call(m[S].context,u);break;case 3:m[S].fn.call(m[S].context,u,d);break;case 4:m[S].fn.call(m[S].context,u,d,f);break;default:if(!y)for(E=1,y=new Array(_-1);E<_;E++)y[E-1]=arguments[E];m[S].fn.apply(m[S].context,y)}}return!0},a.prototype.on=function(c,u,d){return r(this,c,u,d,!1)},a.prototype.once=function(c,u,d){return r(this,c,u,d,!0)},a.prototype.removeListener=function(c,u,d,f){var h=t?t+c:c;if(!this._events[h])return this;if(!u)return o(this,h),this;var p=this._events[h];if(p.fn)p.fn===u&&(!f||p.once)&&(!d||p.context===d)&&o(this,h);else{for(var g=0,m=[],_=p.length;g<_;g++)(p[g].fn!==u||f&&!p[g].once||d&&p[g].context!==d)&&m.push(p[g]);m.length?this._events[h]=m.length===1?m[0]:m:o(this,h)}return this},a.prototype.removeAllListeners=function(c){var u;return c?(u=t?t+c:c,this._events[u]&&o(this,u)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,s.exports=a})(o_);var LF=o_.exports,jf=J9(LF);class a_{constructor(e,t,n,i){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const r=e.config;this.hls=e,this.id=t,this.useWorker=!!r.enableWorker,this.onTransmuxComplete=n,this.onFlush=i;const o=(u,d)=>{d=d||{},d.frag=this.frag,d.id=this.id,u===b.ERROR&&(this.error=d.error),this.hls.trigger(u,d)};this.observer=new jf,this.observer.on(b.FRAG_DECRYPTED,o),this.observer.on(b.ERROR,o);const a=no(r.preferManagedMediaSource)||{isTypeSupported:()=>!1},l={mpeg:a.isTypeSupported("audio/mpeg"),mp3:a.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:a.isTypeSupported('audio/mp4; codecs="ac-3"')},c=navigator.vendor;if(this.useWorker&&typeof Worker<"u"&&(r.workerPath||WP())){try{r.workerPath?(V.log(`loading Web Worker ${r.workerPath} for "${t}"`),this.workerContext=ZP(r.workerPath)):(V.log(`injecting Web Worker for "${t}"`),this.workerContext=YP()),this.onwmsg=f=>this.onWorkerMessage(f);const{worker:d}=this.workerContext;d.addEventListener("message",this.onwmsg),d.onerror=f=>{const h=new Error(`${f.message}  (${f.filename}:${f.lineno})`);r.enableWorker=!1,V.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(b.ERROR,{type:Ge.OTHER_ERROR,details:j.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:h})},d.postMessage({cmd:"init",typeSupported:l,vendor:c,id:t,config:JSON.stringify(r)})}catch(d){V.warn(`Error setting up "${t}" Web Worker, fallback to inline`,d),this.resetWorker(),this.error=null,this.transmuxer=new a1(this.observer,l,r,c,t)}return}this.transmuxer=new a1(this.observer,l,r,c,t)}resetWorker(){if(this.workerContext){const{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,n,i,r,o,a,l,c,u){var d,f;c.transmuxing.start=self.performance.now();const{transmuxer:h}=this,p=o?o.start:r.start,g=r.decryptdata,m=this.frag,_=!(m&&r.cc===m.cc),y=!(m&&c.level===m.level),S=m?c.sn-m.sn:-1,C=this.part?c.part-this.part.index:-1,E=S===0&&c.id>1&&c.id===(m==null?void 0:m.stats.chunkCount),A=!y&&(S===1||S===0&&(C===1||E&&C<=0)),R=self.performance.now();(y||S||r.stats.parsing.start===0)&&(r.stats.parsing.start=R),o&&(C||!A)&&(o.stats.parsing.start=R);const I=!(m&&((d=r.initSegment)==null?void 0:d.url)===((f=m.initSegment)==null?void 0:f.url)),D=new kF(_,A,l,y,p,I);if(!A||_||I){V.log(`[transmuxer-interface, ${r.type}]: Starting new transmux session for sn: ${c.sn} p: ${c.part} level: ${c.level} id: ${c.id}
        discontinuity: ${_}
        trackSwitch: ${y}
        contiguous: ${A}
        accurateTimeOffset: ${l}
        timeOffset: ${p}
        initSegmentChange: ${I}`);const L=new AF(n,i,t,a,u);this.configureTransmuxer(L)}if(this.frag=r,this.part=o,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:g,chunkMeta:c,state:D},e instanceof ArrayBuffer?[e]:[]);else if(h){const L=h.push(e,g,c,D);sl(L)?(h.async=!0,L.then(M=>{this.handleTransmuxComplete(M)}).catch(M=>{this.transmuxerError(M,c,"transmuxer-interface push error")})):(h.async=!1,this.handleTransmuxComplete(L))}}flush(e){e.transmuxing.start=self.performance.now();const{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let n=t.flush(e);sl(n)||t.async?(sl(n)||(n=Promise.resolve(n)),n.then(r=>{this.handleFlushResult(r,e)}).catch(r=>{this.transmuxerError(r,e,"transmuxer-interface flush error")})):this.handleFlushResult(n,e)}}transmuxerError(e,t,n){!this.hls||(this.error=e,this.hls.trigger(b.ERROR,{type:Ge.MEDIA_ERROR,details:j.FRAG_PARSING_ERROR,chunkMeta:t,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach(n=>{this.handleTransmuxComplete(n)}),this.onFlush(t)}onWorkerMessage(e){const t=e.data,n=this.hls;switch(t.event){case"init":{var i;const r=(i=this.workerContext)==null?void 0:i.objectURL;r&&self.URL.revokeObjectURL(r);break}case"transmuxComplete":{this.handleTransmuxComplete(t.data);break}case"flush":{this.onFlush(t.data);break}case"workerLog":V[t.data.logType]&&V[t.data.logType](t.data.message);break;default:{t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,n.trigger(t.event,t.data);break}}}configureTransmuxer(e){const{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}function l_(s,e){if(s.length!==e.length)return!1;for(let t=0;t<s.length;t++)if(!Xr(s[t].attrs,e[t].attrs))return!1;return!0}function Xr(s,e,t){const n=s["STABLE-RENDITION-ID"];return n&&!t?n===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(i=>s[i]!==e[i])}function wd(s,e){return e.label.toLowerCase()===s.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(s.lang||"").toLowerCase())}const l1=100;class RF extends Bf{constructor(e,t,n){super(e,t,n,"[audio-stream-controller]",He.AUDIO),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:e}=this;e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.LEVEL_LOADED,this.onLevelLoaded,this),e.on(b.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(b.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(b.ERROR,this.onError,this),e.on(b.BUFFER_RESET,this.onBufferReset,this),e.on(b.BUFFER_CREATED,this.onBufferCreated,this),e.on(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(b.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(b.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(b.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.LEVEL_LOADED,this.onLevelLoaded,this),e.off(b.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(b.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(b.ERROR,this.onError,this),e.off(b.BUFFER_RESET,this.onBufferReset,this),e.off(b.BUFFER_CREATED,this.onBufferCreated,this),e.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(b.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(b.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(b.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:r}){if(n==="main"){const o=t.cc;this.initPTS[t.cc]={baseTime:i,timescale:r},this.log(`InitPTS for cc: ${o} found from main: ${i}`),this.videoTrackCC=o,this.state===J.WAITING_INIT_PTS&&this.tick()}}startLoad(e){if(!this.levels){this.startPosition=e,this.state=J.STOPPED;return}const t=this.lastCurrentTime;this.stopLoad(),this.setInterval(l1),t>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state=J.IDLE):(this.loadedmetadata=!1,this.state=J.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case J.IDLE:this.doTickIdle();break;case J.WAITING_TRACK:{var e;const{levels:n,trackId:i}=this,r=n==null||(e=n[i])==null?void 0:e.details;if(r){if(this.waitForCdnTuneIn(r))break;this.state=J.WAITING_INIT_PTS}break}case J.FRAG_LOADING_WAITING_RETRY:{var t;const n=performance.now(),i=this.retryDate;if(!i||n>=i||(t=this.media)!=null&&t.seeking){const{levels:r,trackId:o}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((r==null?void 0:r[o])||null),this.state=J.IDLE}break}case J.WAITING_INIT_PTS:{const n=this.waitingData;if(n){const{frag:i,part:r,cache:o,complete:a}=n;if(this.initPTS[i.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=J.FRAG_LOADING;const l=o.flush(),c={frag:i,part:r,payload:l,networkDetails:null};this._handleFragmentLoadProgress(c),a&&super._handleFragmentLoadComplete(c)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${i.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const l=this.getLoadPosition(),c=wt.bufferInfo(this.mediaBuffer,l,this.config.maxBufferHole);xd(c.end,this.config.maxFragLookUpTolerance,i)<0&&(this.log(`Waiting fragment cc (${i.cc}) @ ${i.start} cancelled because another fragment at ${c.end} is needed`),this.clearWaitingFragment())}}else this.state=J.IDLE}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=J.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;!(e!=null&&e.readyState)||(this.lastCurrentTime=e.currentTime)}doTickIdle(){const{hls:e,levels:t,media:n,trackId:i}=this,r=e.config;if(!n&&(this.startFragRequested||!r.startFragPrefetch)||!(t!=null&&t[i]))return;const o=t[i],a=o.details;if(!a||a.live&&this.levelLastLoaded!==o||this.waitForCdnTuneIn(a)){this.state=J.WAITING_TRACK;return}const l=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&l&&(this.bufferFlushed=!1,this.afterBufferFlushed(l,mt.AUDIO,He.AUDIO));const c=this.getFwdBufferInfo(l,He.AUDIO);if(c===null)return;const{bufferedTrack:u,switchingTrack:d}=this;if(!d&&this._streamEnded(c,a)){e.trigger(b.BUFFER_EOS,{type:"audio"}),this.state=J.ENDED;return}const f=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,He.MAIN),h=c.len,p=this.getMaxBufferLength(f==null?void 0:f.len),g=a.fragments,m=g[0].start;let _=this.flushing?this.getLoadPosition():c.end;if(d&&n){const E=this.getLoadPosition();u&&!Xr(d.attrs,u.attrs)&&(_=E),a.PTSKnown&&E<m&&(c.end>m||c.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=m+.05)}if(h>=p&&!d&&_<g[g.length-1].start)return;let y=this.getNextFragment(_,a),S=!1;if(y&&this.isLoopLoading(y,_)&&(S=!!y.gap,y=this.getNextFragmentLoopLoading(y,a,c,He.MAIN,p)),!y){this.bufferFlushed=!0;return}const C=f&&y.start>f.end+a.targetduration;if(C||!(f!=null&&f.len)&&c.len){const E=this.getAppendedFrag(y.start,He.MAIN);if(E===null||(S||(S=!!E.gap||!!C&&f.len===0),C&&!S||S&&c.nextStart&&c.nextStart<E.end))return}this.loadFragment(y,o,_)}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,this.bufferFlushed=this.flushing=!1,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(n=>new Zr(n))}onAudioTrackSwitching(e,t){const n=!!t.url;this.trackId=t.id;const{fragCurrent:i}=this;i&&(i.abortRequests(),this.removeUnbufferedFrags(i.start)),this.resetLoadingState(),n?this.setInterval(l1):this.resetTransmuxer(),n?(this.switchingTrack=t,this.state=J.IDLE,this.flushAudioIfNeeded(t)):(this.switchingTrack=null,this.bufferedTrack=t,this.state=J.STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=this.flushing=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,t){this.mainDetails=t.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(b.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var n;if(this.mainDetails==null){this.cachedTrackLoadedData=t;return}const{levels:i}=this,{details:r,id:o}=t;if(!i){this.warn(`Audio tracks were reset while loading level ${o}`);return}this.log(`Audio track ${o} loaded [${r.startSN},${r.endSN}]${r.lastPartSn?`[part-${r.lastPartSn}-${r.lastPartIndex}]`:""},duration:${r.totalduration}`);const a=i[o];let l=0;if(r.live||(n=a.details)!=null&&n.live){this.checkLiveUpdate(r);const u=this.mainDetails;if(r.deltaUpdateFailed||!u)return;if(!a.details&&r.hasProgramDateTime&&u.hasProgramDateTime)Nl(r,u),l=r.fragments[0].start;else{var c;l=this.alignPlaylists(r,a.details,(c=this.levelLastLoaded)==null?void 0:c.details)}}a.details=r,this.levelLastLoaded=a,!this.startFragRequested&&(this.mainDetails||!r.live)&&this.setStartPosition(this.mainDetails||r,l),this.state===J.WAITING_TRACK&&!this.waitForCdnTuneIn(r)&&(this.state=J.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:i,payload:r}=e,{config:o,trackId:a,levels:l}=this;if(!l){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const c=l[a];if(!c){this.warn("Audio track is undefined on fragment load progress");return}const u=c.details;if(!u){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(n.start);return}const d=o.defaultAudioCodec||c.audioCodec||"mp4a.40.2";let f=this.transmuxer;f||(f=this.transmuxer=new a_(this.hls,He.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const h=this.initPTS[n.cc],p=(t=n.initSegment)==null?void 0:t.data;if(h!==void 0){const m=i?i.index:-1,_=m!==-1,y=new Nf(n.level,n.sn,n.stats.chunkCount,r.byteLength,m,_);f.push(r,p,d,"",n,i,u.totalduration,!1,y,h)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${u.startSN} ,${u.endSN}],track ${a}`);const{cache:g}=this.waitingData=this.waitingData||{frag:n,part:i,cache:new jv,complete:!1};g.push(new Uint8Array(r)),this.waitingVideoCC=this.videoTrackCC,this.state=J.WAITING_INIT_PTS}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){const n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){const{frag:n,part:i}=t;if(n.type!==He.AUDIO){if(!this.loadedmetadata&&n.type===He.MAIN){const r=this.videoBuffer||this.media;r&&wt.getBuffered(r).length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(n.sn!=="initSegment"){this.fragPrevious=n;const r=this.switchingTrack;r&&(this.bufferedTrack=r,this.switchingTrack=null,this.hls.trigger(b.AUDIO_TRACK_SWITCHED,Zt({},r)))}this.fragBufferedComplete(n,i)}onError(e,t){var n;if(t.fatal){this.state=J.ERROR;return}switch(t.details){case j.FRAG_GAP:case j.FRAG_PARSING_ERROR:case j.FRAG_DECRYPT_ERROR:case j.FRAG_LOAD_ERROR:case j.FRAG_LOAD_TIMEOUT:case j.KEY_LOAD_ERROR:case j.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(He.AUDIO,t);break;case j.AUDIO_TRACK_LOAD_ERROR:case j.AUDIO_TRACK_LOAD_TIMEOUT:case j.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===J.WAITING_TRACK&&((n=t.context)==null?void 0:n.type)===rt.AUDIO_TRACK&&(this.state=J.IDLE);break;case j.BUFFER_APPEND_ERROR:case j.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="audio")return;if(t.details===j.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case j.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==mt.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==mt.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===J.ENDED&&(this.state=J.IDLE);const n=this.mediaBuffer||this.media;n&&(this.afterBufferFlushed(n,t,He.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const n="audio",{hls:i}=this,{remuxResult:r,chunkMeta:o}=e,a=this.getCurrentContext(o);if(!a){this.resetWhenMissingContext(o);return}const{frag:l,part:c,level:u}=a,{details:d}=u,{audio:f,text:h,id3:p,initSegment:g}=r;if(this.fragContextChanged(l)||!d){this.fragmentTracker.removeFragment(l);return}if(this.state=J.PARSING,this.switchingTrack&&f&&this.completeAudioSwitch(this.switchingTrack),g!=null&&g.tracks){const m=l.initSegment||l;this._bufferInitSegment(u,g.tracks,m,o),i.trigger(b.FRAG_PARSING_INIT_SEGMENT,{frag:m,id:n,tracks:g.tracks})}if(f){const{startPTS:m,endPTS:_,startDTS:y,endDTS:S}=f;c&&(c.elementaryStreams[mt.AUDIO]={startPTS:m,endPTS:_,startDTS:y,endDTS:S}),l.setElementaryStreamInfo(mt.AUDIO,m,_,y,S),this.bufferFragmentData(f,l,c,o)}if(p!=null&&(t=p.samples)!=null&&t.length){const m=Vt({id:n,frag:l,details:d},p);i.trigger(b.FRAG_PARSING_METADATA,m)}if(h){const m=Vt({id:n,frag:l,details:d},h);i.trigger(b.FRAG_PARSING_USERDATA,m)}}_bufferInitSegment(e,t,n,i){if(this.state!==J.PARSING)return;t.video&&delete t.video;const r=t.audio;if(!r)return;r.id="audio";const o=e.audioCodec;this.log(`Init audio buffer, container:${r.container}, codecs[level/parsed]=[${o}/${r.codec}]`),o&&o.split(",").length===1&&(r.levelCodec=o),this.hls.trigger(b.BUFFER_CODECS,t);const a=r.initSegment;if(a!=null&&a.byteLength){const l={type:"audio",frag:n,part:null,chunkMeta:i,parent:n.type,data:a};this.hls.trigger(b.BUFFER_APPENDING,l)}this.tickImmediate()}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);if(this.fragCurrent=e,this.switchingTrack||i===Wt.NOT_LOADED||i===Wt.PARTIAL){var r;if(e.sn==="initSegment")this._loadInitSegment(e,t);else if((r=t.details)!=null&&r.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=J.WAITING_INIT_PTS;const o=this.mainDetails;o&&o.fragments[0].start!==t.details.fragments[0].start&&Nl(t.details,o)}else this.startFragRequested=!0,super.loadFragment(e,t,n)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){const{media:t,bufferedTrack:n}=this,i=n==null?void 0:n.attrs,r=e.attrs;t&&i&&(i.CHANNELS!==r.CHANNELS||n.name!==e.name||n.lang!==e.lang)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null)}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(b.AUDIO_TRACK_SWITCHED,Zt({},e))}}class IF extends $f{constructor(e){super(e,"[audio-track-controller]"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.LEVEL_LOADING,this.onLevelLoading,this),e.on(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(b.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(b.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.LEVEL_LOADING,this.onLevelLoading,this),e.off(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(b.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(b.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:n,groupId:i,details:r}=t,o=this.tracksInGroup[n];if(!o||o.groupId!==i){this.warn(`Audio track with id:${n} and group:${i} not found in active group ${o==null?void 0:o.groupId}`);return}const a=o.details;o.details=t.details,this.log(`Audio track ${n} "${o.name}" lang:${o.lang} group:${i} loaded [${r.startSN}-${r.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.audioGroups||null,i=this.groupIds;let r=this.currentTrack;if(!n||(i==null?void 0:i.length)!==(n==null?void 0:n.length)||n!=null&&n.some(a=>(i==null?void 0:i.indexOf(a))===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const a=this.tracks.filter(f=>!n||n.indexOf(f.groupId)!==-1);if(a.length)this.selectDefaultTrack&&!a.some(f=>f.default)&&(this.selectDefaultTrack=!1),a.forEach((f,h)=>{f.id=h});else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=a;const l=this.hls.config.audioPreference;if(!r&&l){const f=yn(l,a,hr);if(f>-1)r=a[f];else{const h=yn(l,this.tracks);r=this.tracks[h]}}let c=this.findTrackId(r);c===-1&&r&&(c=this.findTrackId(null));const u={audioTracks:a};this.log(`Updating audio tracks, ${a.length} track(s) found in group(s): ${n==null?void 0:n.join(",")}`),this.hls.trigger(b.AUDIO_TRACKS_UPDATED,u);const d=this.trackId;if(c!==-1&&d===-1)this.setAudioTrack(c);else if(a.length&&d===-1){var o;const f=new Error(`No audio track selected for current audio group-ID(s): ${(o=this.groupIds)==null?void 0:o.join(",")} track count: ${a.length}`);this.warn(f.message),this.hls.trigger(b.ERROR,{type:Ge.MEDIA_ERROR,details:j.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:f})}}else this.shouldReloadPlaylist(r)&&this.setAudioTrack(this.trackId)}onError(e,t){t.fatal||!t.context||t.context.type===rt.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&(this.requestScheduled=-1,this.checkRetry(t))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const n=this.allAudioTracks;if(this.selectDefaultTrack=!1,n.length){const i=this.currentTrack;if(i&&Nr(e,i,hr))return i;const r=yn(e,this.tracksInGroup,hr);if(r>-1){const o=this.tracksInGroup[r];return this.setAudioTrack(r),o}else if(i){let o=t.loadLevel;o===-1&&(o=t.firstAutoLevel);const a=IP(e,t.levels,n,o,hr);if(a===-1)return null;t.nextLoadLevel=a}if(e.channels||e.audioCodec){const o=yn(e,n);if(o>-1)return n[o]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const n=this.currentTrack,i=t[e],r=i.details&&!i.details.live;if(e===this.trackId&&i===n&&r||(this.log(`Switching to audio-track ${e} "${i.name}" lang:${i.lang} group:${i.groupId} channels:${i.channels}`),this.trackId=e,this.currentTrack=i,this.hls.trigger(b.AUDIO_TRACK_SWITCHING,Zt({},i)),r))return;const o=this.switchParams(i.url,n==null?void 0:n.details);this.loadPlaylist(o)}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const i=t[n];if(!(this.selectDefaultTrack&&!i.default)&&(!e||Nr(e,i,hr)))return n}if(e){const{name:n,lang:i,assocLang:r,characteristics:o,audioCodec:a,channels:l}=e;for(let c=0;c<t.length;c++){const u=t[c];if(Nr({name:n,lang:i,assocLang:r,characteristics:o,audioCodec:a,channels:l},u,hr))return c}for(let c=0;c<t.length;c++){const u=t[c];if(Xr(e.attrs,u.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return c}for(let c=0;c<t.length;c++){const u=t[c];if(Xr(e.attrs,u.attrs,["LANGUAGE"]))return c}}return-1}loadPlaylist(e){const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){super.loadPlaylist();const n=t.id,i=t.groupId;let r=t.url;if(e)try{r=e.addDirectives(r)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}this.log(`loading audio-track playlist ${n} "${t.name}" lang:${t.lang} group:${i}`),this.clearTimer(),this.hls.trigger(b.AUDIO_TRACK_LOADING,{url:r,id:n,groupId:i,deliveryDirectives:e||null})}}}const c1=500;class DF extends Bf{constructor(e,t,n){super(e,t,n,"[subtitle-stream-controller]",He.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}_registerListeners(){const{hls:e}=this;e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.LEVEL_LOADED,this.onLevelLoaded,this),e.on(b.ERROR,this.onError,this),e.on(b.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(b.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(b.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(b.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(b.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.LEVEL_LOADED,this.onLevelLoaded,this),e.off(b.ERROR,this.onError,this),e.off(b.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(b.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(b.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(b.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(b.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=J.IDLE,this.setInterval(c1),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:n,success:i}=t;if(this.fragPrevious=n,this.state=J.IDLE,!i)return;const r=this.tracksBuffered[this.currentTrackId];if(!r)return;let o;const a=n.start;for(let c=0;c<r.length;c++)if(a>=r[c].start&&a<=r[c].end){o=r[c];break}const l=n.start+n.duration;o?o.end=l:(o={start:a,end:l},r.push(o)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null)}onBufferFlushing(e,t){const{startOffset:n,endOffset:i}=t;if(n===0&&i!==Number.POSITIVE_INFINITY){const r=i-1;if(r<=0)return;t.endOffsetSubtitles=Math.max(0,r),this.tracksBuffered.forEach(o=>{for(let a=0;a<o.length;){if(o[a].end<=r){o.shift();continue}else if(o[a].start<r)o[a].start=r;else break;a++}}),this.fragmentTracker.removeFragmentsInRange(n,r,He.SUBTITLE)}}onFragBuffered(e,t){if(!this.loadedmetadata&&t.frag.type===He.MAIN){var n;(n=this.media)!=null&&n.buffered.length&&(this.loadedmetadata=!0)}}onError(e,t){const n=t.frag;(n==null?void 0:n.type)===He.SUBTITLE&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==J.STOPPED&&(this.state=J.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(!this.levels||l_(this.levels,t)){this.levels=t.map(n=>new Zr(n));return}this.tracksBuffered=[],this.levels=t.map(n=>{const i=new Zr(n);return this.tracksBuffered[i.id]=[],i}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,He.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var n;if(this.currentTrackId=t.id,!((n=this.levels)!=null&&n.length)||this.currentTrackId===-1){this.clearInterval();return}const i=this.levels[this.currentTrackId];i!=null&&i.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,i&&this.setInterval(c1)}onSubtitleTrackLoaded(e,t){var n;const{currentTrackId:i,levels:r}=this,{details:o,id:a}=t;if(!r){this.warn(`Subtitle tracks were reset while loading level ${a}`);return}const l=r[i];if(a>=r.length||a!==i||!l)return;this.log(`Subtitle track ${a} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""},duration:${o.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let c=0;if(o.live||(n=l.details)!=null&&n.live){const d=this.mainDetails;if(o.deltaUpdateFailed||!d)return;const f=d.fragments[0];if(!l.details)o.hasProgramDateTime&&d.hasProgramDateTime?(Nl(o,d),c=o.fragments[0].start):f&&(c=f.start,yd(o,c));else{var u;c=this.alignPlaylists(o,l.details,(u=this.levelLastLoaded)==null?void 0:u.details),c===0&&f&&(c=f.start,yd(o,c))}}l.details=o,this.levelLastLoaded=l,!this.startFragRequested&&(this.mainDetails||!o.live)&&this.setStartPosition(this.mainDetails||o,c),this.tick(),o.live&&!this.fragCurrent&&this.media&&this.state===J.IDLE&&($l(null,o.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),l.details=void 0))}_handleFragmentLoadComplete(e){const{frag:t,payload:n}=e,i=t.decryptdata,r=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&i!=null&&i.key&&i.iv&&i.method==="AES-128"){const o=performance.now();this.decrypter.decrypt(new Uint8Array(n),i.key.buffer,i.iv.buffer).catch(a=>{throw r.trigger(b.ERROR,{type:Ge.MEDIA_ERROR,details:j.FRAG_DECRYPT_ERROR,fatal:!1,error:a,reason:a.message,frag:t}),a}).then(a=>{const l=performance.now();r.trigger(b.FRAG_DECRYPTED,{frag:t,payload:a,stats:{tstart:o,tdecrypt:l}})}).catch(a=>{this.warn(`${a.name}: ${a.message}`),this.state=J.IDLE})}}doTick(){if(!this.media){this.state=J.IDLE;return}if(this.state===J.IDLE){const{currentTrackId:e,levels:t}=this,n=t==null?void 0:t[e];if(!n||!t.length||!n.details)return;const{config:i}=this,r=this.getLoadPosition(),o=wt.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],r,i.maxBufferHole),{end:a,len:l}=o,c=this.getFwdBufferInfo(this.media,He.MAIN),u=n.details,d=this.getMaxBufferLength(c==null?void 0:c.len)+u.levelTargetDuration;if(l>d)return;const f=u.fragments,h=f.length,p=u.edge;let g=null;const m=this.fragPrevious;if(a<p){const _=i.maxFragLookUpTolerance,y=a>p-_?0:_;g=$l(m,f,Math.max(f[0].start,a),y),!g&&m&&m.start<f[0].start&&(g=f[0])}else g=f[h-1];if(!g)return;if(g=this.mapToInitFragWhenRequired(g),g.sn!=="initSegment"){const _=g.sn-u.startSN,y=f[_-1];y&&y.cc===g.cc&&this.fragmentTracker.getState(y)===Wt.NOT_LOADED&&(g=y)}this.fragmentTracker.getState(g)===Wt.NOT_LOADED&&this.loadFragment(g,n,a)}}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,n){this.fragCurrent=e,e.sn==="initSegment"?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,n))}get mediaBufferTimeRanges(){return new PF(this.tracksBuffered[this.currentTrackId]||[])}}class PF{constructor(e){this.buffered=void 0;const t=(n,i,r)=>{if(i=i>>>0,i>r-1)throw new DOMException(`Failed to execute '${n}' on 'TimeRanges': The index provided (${i}) is greater than the maximum bound (${r})`);return e[i][n]};this.buffered={get length(){return e.length},end(n){return t("end",n,e.length)},start(n){return t("start",n,e.length)}}}}class FF extends $f{constructor(e){super(e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const n=Qa(this.media.textTracks);for(let r=0;r<n.length;r++)if(n[r].mode==="hidden")t=n[r];else if(n[r].mode==="showing"){t=n[r];break}const i=this.findTrackForTextTrack(t);this.subtitleTrack!==i&&this.setSubtitleTrack(i)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.LEVEL_LOADING,this.onLevelLoading,this),e.on(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(b.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(b.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.LEVEL_LOADING,this.onLevelLoading,this),e.off(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(b.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(b.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),Qa(this.media.textTracks).forEach(t=>{Ar(t)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:n,groupId:i,details:r}=t,o=this.tracksInGroup[n];if(!o||o.groupId!==i){this.warn(`Subtitle track with id:${n} and group:${i} not found in active group ${o==null?void 0:o.groupId}`);return}const a=o.details;o.details=t.details,this.log(`Subtitle track ${n} "${o.name}" lang:${o.lang} group:${i} loaded [${r.startSN}-${r.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.subtitleGroups||null,i=this.groupIds;let r=this.currentTrack;if(!n||(i==null?void 0:i.length)!==(n==null?void 0:n.length)||n!=null&&n.some(o=>(i==null?void 0:i.indexOf(o))===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const o=this.tracks.filter(u=>!n||n.indexOf(u.groupId)!==-1);if(o.length)this.selectDefaultTrack&&!o.some(u=>u.default)&&(this.selectDefaultTrack=!1),o.forEach((u,d)=>{u.id=d});else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=o;const a=this.hls.config.subtitlePreference;if(!r&&a){this.selectDefaultTrack=!1;const u=yn(a,o);if(u>-1)r=o[u];else{const d=yn(a,this.tracks);r=this.tracks[d]}}let l=this.findTrackId(r);l===-1&&r&&(l=this.findTrackId(null));const c={subtitleTracks:o};this.log(`Updating subtitle tracks, ${o.length} track(s) found in "${n==null?void 0:n.join(",")}" group-id`),this.hls.trigger(b.SUBTITLE_TRACKS_UPDATED,c),l!==-1&&this.trackId===-1&&this.setSubtitleTrack(l)}else this.shouldReloadPlaylist(r)&&this.setSubtitleTrack(this.trackId)}findTrackId(e){const t=this.tracksInGroup,n=this.selectDefaultTrack;for(let i=0;i<t.length;i++){const r=t[i];if(!(n&&!r.default||!n&&!e)&&(!e||Nr(r,e)))return i}if(e){for(let i=0;i<t.length;i++){const r=t[i];if(Xr(e.attrs,r.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return i}for(let i=0;i<t.length;i++){const r=t[i];if(Xr(e.attrs,r.attrs,["LANGUAGE"]))return i}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const i=t[n];if(wd(i,e))return n}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===rt.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const n=this.currentTrack;if(n&&Nr(e,n))return n;const i=yn(e,this.tracksInGroup);if(i>-1){const r=this.tracksInGroup[i];return this.setSubtitleTrack(i),r}else{if(n)return null;{const r=yn(e,t);if(r>-1)return t[r]}}}}return null}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){const n=t.id,i=t.groupId;let r=t.url;if(e)try{r=e.addDirectives(r)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}this.log(`Loading subtitle playlist for id ${n}`),this.hls.trigger(b.SUBTITLE_TRACK_LOADING,{url:r,id:n,groupId:i,deliveryDirectives:e||null})}}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=Qa(e.textTracks),n=this.currentTrack;let i;if(n&&(i=t.filter(r=>wd(n,r))[0],i||this.warn(`Unable to find subtitle TextTrack with name "${n.name}" and language "${n.lang}"`)),[].slice.call(t).forEach(r=>{r.mode!=="disabled"&&r!==i&&(r.mode="disabled")}),i){const r=this.subtitleDisplay?"showing":"hidden";i.mode!==r&&(i.mode=r)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!Ee(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const n=this.currentTrack,i=t[e]||null;if(this.trackId=e,this.currentTrack=i,this.toggleTrackModes(),!i){this.hls.trigger(b.SUBTITLE_TRACK_SWITCH,{id:e});return}const r=!!i.details&&!i.details.live;if(e===this.trackId&&i===n&&r)return;this.log(`Switching to subtitle-track ${e}`+(i?` "${i.name}" lang:${i.lang} group:${i.groupId}`:""));const{id:o,groupId:a="",name:l,type:c,url:u}=i;this.hls.trigger(b.SUBTITLE_TRACK_SWITCH,{id:o,groupId:a,name:l,type:c,url:u});const d=this.switchParams(i.url,n==null?void 0:n.details);this.loadPlaylist(d)}}class OF{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t,n){const i=this.queues[t];i.push(e),i.length===1&&!n&&this.executeNext(t)}insertAbort(e,t){this.queues[t].unshift(e),this.executeNext(t)}appendBlocker(e){let t;const n=new Promise(r=>{t=r}),i={execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(i,e),n}executeNext(e){const t=this.queues[e];if(t.length){const n=t[0];try{n.execute()}catch(i){V.warn(`[buffer-operation-queue]: Exception executing "${e}" SourceBuffer operation: ${i}`),n.onError(i);const r=this.buffers[e];r!=null&&r.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}}const u1=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/;class MF{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendSource=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this.log=void 0,this.warn=void 0,this.error=void 0,this._onEndStreaming=n=>{!this.hls||this.hls.pauseBuffering()},this._onStartStreaming=n=>{!this.hls||this.hls.resumeBuffering()},this._onMediaSourceOpen=()=>{const{media:n,mediaSource:i}=this;this.log("Media source opened"),n&&(n.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(b.MEDIA_ATTACHED,{media:n,mediaSource:i})),i&&i.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:n,_objectUrl:i}=this;n!==i&&V.error(`Media element src was set while attaching MediaSource (${i} > ${n})`)},this.hls=e;const t="[buffer-controller]";this.appendSource=e.config.preferManagedMediaSource,this.log=V.log.bind(V,t),this.warn=V.warn.bind(V,t),this.error=V.error.bind(V,t),this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null,this.hls=null}registerListeners(){const{hls:e}=this;e.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.BUFFER_RESET,this.onBufferReset,this),e.on(b.BUFFER_APPENDING,this.onBufferAppending,this),e.on(b.BUFFER_CODECS,this.onBufferCodecs,this),e.on(b.BUFFER_EOS,this.onBufferEos,this),e.on(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(b.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(b.FRAG_PARSED,this.onFragParsed,this),e.on(b.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:e}=this;e.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.BUFFER_RESET,this.onBufferReset,this),e.off(b.BUFFER_APPENDING,this.onBufferAppending,this),e.off(b.BUFFER_CODECS,this.onBufferCodecs,this),e.off(b.BUFFER_EOS,this.onBufferEos,this),e.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(b.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(b.FRAG_PARSED,this.onFragParsed,this),e.off(b.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new OF(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.appendErrors={audio:0,video:0,audiovideo:0},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){let n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=n,this.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){const n=this.media=t.media,i=no(this.appendSource);if(n&&i){var r;const o=this.mediaSource=new i;this.log(`created media source: ${(r=o.constructor)==null?void 0:r.name}`),o.addEventListener("sourceopen",this._onMediaSourceOpen),o.addEventListener("sourceended",this._onMediaSourceEnded),o.addEventListener("sourceclose",this._onMediaSourceClose),o.addEventListener("startstreaming",this._onStartStreaming),o.addEventListener("endstreaming",this._onEndStreaming);const a=this._objectUrl=self.URL.createObjectURL(o);if(this.appendSource)try{n.removeAttribute("src");const l=self.ManagedMediaSource;n.disableRemotePlayback=n.disableRemotePlayback||l&&o instanceof l,d1(n),$F(n,a),n.load()}catch{n.src=a}else n.src=a;n.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:e,mediaSource:t,_objectUrl:n}=this;if(t){if(this.log("media source detaching"),t.readyState==="open")try{t.endOfStream()}catch(i){this.warn(`onMediaDetaching: ${i.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),t.removeEventListener("startstreaming",this._onStartStreaming),t.removeEventListener("endstreaming",this._onEndStreaming),e&&(e.removeEventListener("emptied",this._onMediaEmptied),n&&self.URL.revokeObjectURL(n),this.mediaSrc===n?(e.removeAttribute("src"),this.appendSource&&d1(e),e.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(b.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(e=>{this.resetBuffer(e)}),this._initSourceBuffer()}resetBuffer(e){const t=this.sourceBuffer[e];try{if(t){var n;this.removeBufferListeners(e),this.sourceBuffer[e]=void 0,(n=this.mediaSource)!=null&&n.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(t)}}catch(i){this.warn(`onBufferReset ${e}`,i)}}onBufferCodecs(e,t){const n=this.getSourceBufferTypes().length,i=Object.keys(t);if(i.forEach(o=>{if(n){const l=this.tracks[o];if(l&&typeof l.buffer.changeType=="function"){var a;const{id:c,codec:u,levelCodec:d,container:f,metadata:h}=t[o],p=Pp(l.codec,l.levelCodec),g=p==null?void 0:p.replace(u1,"$1");let m=Pp(u,d);const _=(a=m)==null?void 0:a.replace(u1,"$1");if(m&&g!==_){o.slice(0,5)==="audio"&&(m=Pl(m,this.hls.config.preferManagedMediaSource));const y=`${f};codecs=${m}`;this.appendChangeType(o,y),this.log(`switching codec ${p} to ${m}`),this.tracks[o]={buffer:l.buffer,codec:u,container:f,levelCodec:d,metadata:h,id:c}}}}else this.pendingTracks[o]=t[o]}),n)return;const r=Math.max(this.bufferCodecEventsExpected-1,0);this.bufferCodecEventsExpected!==r&&(this.log(`${r} bufferCodec event(s) expected ${i.join(",")}`),this.bufferCodecEventsExpected=r),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks()}appendChangeType(e,t){const{operationQueue:n}=this,i={execute:()=>{const r=this.sourceBuffer[e];r&&(this.log(`changing ${e} sourceBuffer type to ${t}`),r.changeType(t)),n.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:r=>{this.warn(`Failed to change ${e} SourceBuffer type`,r)}};n.append(i,e,!!this.pendingTracks[e])}onBufferAppending(e,t){const{hls:n,operationQueue:i,tracks:r}=this,{data:o,type:a,frag:l,part:c,chunkMeta:u}=t,d=u.buffering[a],f=self.performance.now();d.start=f;const h=l.stats.buffering,p=c?c.stats.buffering:null;h.start===0&&(h.start=f),p&&p.start===0&&(p.start=f);const g=r.audio;let m=!1;a==="audio"&&(g==null?void 0:g.container)==="audio/mpeg"&&(m=!this.lastMpegAudioChunk||u.id===1||this.lastMpegAudioChunk.sn!==u.sn,this.lastMpegAudioChunk=u);const _=l.start,y={execute:()=>{if(d.executeStart=self.performance.now(),m){const S=this.sourceBuffer[a];if(S){const C=_-S.timestampOffset;Math.abs(C)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${_} (delta: ${C}) sn: ${l.sn})`),S.timestampOffset=_)}}this.appendExecutor(o,a)},onStart:()=>{},onComplete:()=>{const S=self.performance.now();d.executeEnd=d.end=S,h.first===0&&(h.first=S),p&&p.first===0&&(p.first=S);const{sourceBuffer:C}=this,E={};for(const A in C)E[A]=wt.getBuffered(C[A]);this.appendErrors[a]=0,a==="audio"||a==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(b.BUFFER_APPENDED,{type:a,frag:l,part:c,chunkMeta:u,parent:l.type,timeRanges:E})},onError:S=>{const C={type:Ge.MEDIA_ERROR,parent:l.type,details:j.BUFFER_APPEND_ERROR,sourceBufferName:a,frag:l,part:c,chunkMeta:u,error:S,err:S,fatal:!1};if(S.code===DOMException.QUOTA_EXCEEDED_ERR)C.details=j.BUFFER_FULL_ERROR;else{const E=++this.appendErrors[a];C.details=j.BUFFER_APPEND_ERROR,this.warn(`Failed ${E}/${n.config.appendErrorMaxRetry} times to append segment in "${a}" sourceBuffer`),E>=n.config.appendErrorMaxRetry&&(C.fatal=!0)}n.trigger(b.ERROR,C)}};i.append(y,a,!!this.pendingTracks[a])}onBufferFlushing(e,t){const{operationQueue:n}=this,i=r=>({execute:this.removeExecutor.bind(this,r,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(b.BUFFER_FLUSHED,{type:r})},onError:o=>{this.warn(`Failed to remove from ${r} SourceBuffer`,o)}});t.type?n.append(i(t.type),t.type):this.getSourceBufferTypes().forEach(r=>{n.append(i(r),r)})}onFragParsed(e,t){const{frag:n,part:i}=t,r=[],o=i?i.elementaryStreams:n.elementaryStreams;o[mt.AUDIOVIDEO]?r.push("audiovideo"):(o[mt.AUDIO]&&r.push("audio"),o[mt.VIDEO]&&r.push("video"));const a=()=>{const l=self.performance.now();n.stats.buffering.end=l,i&&(i.stats.buffering.end=l);const c=i?i.stats:n.stats;this.hls.trigger(b.FRAG_BUFFERED,{frag:n,part:i,stats:c,id:n.type})};r.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers(a,r)}onFragChanged(e,t){this.trimBuffers()}onBufferEos(e,t){this.getSourceBufferTypes().reduce((i,r)=>{const o=this.sourceBuffer[r];return o&&(!t.type||t.type===r)&&(o.ending=!0,o.ended||(o.ended=!0,this.log(`${r} sourceBuffer now EOS`))),i&&!!(!o||o.ended)},!0)&&(this.log("Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(r=>{const o=this.sourceBuffer[r];o&&(o.ending=!1)});const{mediaSource:i}=this;if(!i||i.readyState!=="open"){i&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${i.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),i.endOfStream()}))}onLevelUpdated(e,{details:t}){!t.fragments.length||(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}trimBuffers(){const{hls:e,details:t,media:n}=this;if(!n||t===null||!this.getSourceBufferTypes().length)return;const r=e.config,o=n.currentTime,a=t.levelTargetDuration,l=t.live&&r.liveBackBufferLength!==null?r.liveBackBufferLength:r.backBufferLength;if(Ee(l)&&l>0){const c=Math.max(l,a),u=Math.floor(o/a)*a-c;this.flushBackBuffer(o,a,u)}if(Ee(r.frontBufferFlushThreshold)&&r.frontBufferFlushThreshold>0){const c=Math.max(r.maxBufferLength,r.frontBufferFlushThreshold),u=Math.max(c,a),d=Math.floor(o/a)*a+u;this.flushFrontBuffer(o,a,d)}}flushBackBuffer(e,t,n){const{details:i,sourceBuffer:r}=this;this.getSourceBufferTypes().forEach(a=>{const l=r[a];if(l){const c=wt.getBuffered(l);if(c.length>0&&n>c.start(0)){if(this.hls.trigger(b.BACK_BUFFER_REACHED,{bufferEnd:n}),i!=null&&i.live)this.hls.trigger(b.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n});else if(l.ended&&c.end(c.length-1)-e<t*2){this.log(`Cannot flush ${a} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(b.BUFFER_FLUSHING,{startOffset:0,endOffset:n,type:a})}}})}flushFrontBuffer(e,t,n){const{sourceBuffer:i}=this;this.getSourceBufferTypes().forEach(o=>{const a=i[o];if(a){const l=wt.getBuffered(a),c=l.length;if(c<2)return;const u=l.start(c-1),d=l.end(c-1);if(n>u||e>=u&&e<=d)return;if(a.ended&&e-d<2*t){this.log(`Cannot flush ${o} front buffer while SourceBuffer is in ended state`);return}this.hls.trigger(b.BUFFER_FLUSHING,{startOffset:u,endOffset:1/0,type:o})}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")return;const{details:e,hls:t,media:n,mediaSource:i}=this,r=e.fragments[0].start+e.totalduration,o=n.duration,a=Ee(i.duration)?i.duration:0;e.live&&t.config.liveDurationInfinity?(i.duration=1/0,this.updateSeekableRange(e)):(r>a&&r>o||!Ee(o))&&(this.log(`Updating Media Source duration to ${r.toFixed(3)}`),i.duration=r)}updateSeekableRange(e){const t=this.mediaSource,n=e.fragments;if(n.length&&e.live&&t!=null&&t.setLiveSeekableRange){const r=Math.max(0,n[0].start),o=Math.max(r,r+e.totalduration);this.log(`Media Source duration is set to ${t.duration}. Setting seekable range to ${r}-${o}.`),t.setLiveSeekableRange(r,o)}}checkPendingTracks(){const{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:n}=this,i=Object.keys(n).length;if(i&&(!e||i===2||"audiovideo"in n)){this.createSourceBuffers(n),this.pendingTracks={};const r=this.getSourceBufferTypes();if(r.length)this.hls.trigger(b.BUFFER_CREATED,{tracks:this.tracks}),r.forEach(o=>{t.executeNext(o)});else{const o=new Error("could not create source buffer for media codec(s)");this.hls.trigger(b.ERROR,{type:Ge.MEDIA_ERROR,details:j.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:o,reason:o.message})}}}createSourceBuffers(e){const{sourceBuffer:t,mediaSource:n}=this;if(!n)throw Error("createSourceBuffers called when mediaSource was null");for(const i in e)if(!t[i]){const r=e[i];if(!r)throw Error(`source buffer exists for track ${i}, however track does not`);let o=r.levelCodec||r.codec;o&&i.slice(0,5)==="audio"&&(o=Pl(o,this.hls.config.preferManagedMediaSource));const a=`${r.container};codecs=${o}`;this.log(`creating sourceBuffer(${a})`);try{const l=t[i]=n.addSourceBuffer(a),c=i;this.addBufferListener(c,"updatestart",this._onSBUpdateStart),this.addBufferListener(c,"updateend",this._onSBUpdateEnd),this.addBufferListener(c,"error",this._onSBUpdateError),this.addBufferListener(c,"bufferedchange",(u,d)=>{const f=d.removedRanges;f!=null&&f.length&&this.hls.trigger(b.BUFFER_FLUSHED,{type:i})}),this.tracks[i]={buffer:l,codec:o,container:r.container,levelCodec:r.levelCodec,metadata:r.metadata,id:r.id}}catch(l){this.error(`error while trying to add sourceBuffer: ${l.message}`),this.hls.trigger(b.ERROR,{type:Ge.MEDIA_ERROR,details:j.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:l,sourceBufferName:i,mimeType:a})}}}get mediaSrc(){var e;const t=((e=this.media)==null?void 0:e.firstChild)||this.media;return t==null?void 0:t.src}_onSBUpdateStart(e){const{operationQueue:t}=this;t.current(e).onStart()}_onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const{operationQueue:n}=this;n.current(e).onComplete(),n.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){var n;const i=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(n=this.mediaSource)==null?void 0:n.readyState}`);this.error(`${i}`,t),this.hls.trigger(b.ERROR,{type:Ge.MEDIA_ERROR,details:j.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:i,fatal:!1});const r=this.operationQueue.current(e);r&&r.onError(i)}removeExecutor(e,t,n){const{media:i,mediaSource:r,operationQueue:o,sourceBuffer:a}=this,l=a[e];if(!i||!r||!l){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),o.shiftAndExecuteNext(e);return}const c=Ee(i.duration)?i.duration:1/0,u=Ee(r.duration)?r.duration:1/0,d=Math.max(0,t),f=Math.min(n,c,u);f>d&&(!l.ending||l.ended)?(l.ended=!1,this.log(`Removing [${d},${f}] from the ${e} SourceBuffer`),l.remove(d,f)):o.shiftAndExecuteNext(e)}appendExecutor(e,t){const n=this.sourceBuffer[t];if(!n){if(!this.pendingTracks[t])throw new Error(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);return}n.ended=!1,n.appendBuffer(e)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length){this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);return}const{operationQueue:n}=this,i=t.map(r=>n.appendBlocker(r));Promise.all(i).then(()=>{e(),t.forEach(r=>{const o=this.sourceBuffer[r];o!=null&&o.updating||n.shiftAndExecuteNext(r)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,n){const i=this.sourceBuffer[e];if(!i)return;const r=n.bind(this,e);this.listeners[e].push({event:t,listener:r}),i.addEventListener(t,r)}removeBufferListeners(e){const t=this.sourceBuffer[e];!t||this.listeners[e].forEach(n=>{t.removeEventListener(n.event,n.listener)})}}function d1(s){const e=s.querySelectorAll("source");[].slice.call(e).forEach(t=>{s.removeChild(t)})}function $F(s,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,s.appendChild(t)}const f1={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},c_=function(e){let t=e;return f1.hasOwnProperty(e)&&(t=f1[e]),String.fromCharCode(t)},Js=15,Pn=100,NF={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},VF={17:2,18:4,21:6,22:8,23:10,19:13,20:15},BF={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},UF={25:2,26:4,29:6,30:8,31:10,27:13,28:15},HF=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class GF{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const n=typeof t=="function"?t():t;V.log(`${this.time} [${e}] ${n}`)}}}const Oi=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t};class u_{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){const i=t[n];e.hasOwnProperty(i)&&(this[i]=e[i])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class zF{constructor(){this.uchar=" ",this.penState=new u_}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class jF{constructor(e){this.chars=[],this.pos=0,this.currPenState=new u_,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<Pn;t++)this.chars.push(new zF);this.logger=e}equals(e){for(let t=0;t<Pn;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<Pn;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<Pn;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Pn&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Pn)}moveCursor(e){const t=this.pos+e;if(e>1)for(let n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=c_(e);if(this.pos>=Pn){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<Pn;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let n=0;n<Pn;n++){const i=this.chars[n].uchar;i!==" "&&(t=!1),e.push(i)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class ou{constructor(e){this.rows=[],this.currRow=Js-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<Js;t++)this.rows.push(new jF(e));this.logger=e}reset(){for(let e=0;e<Js;e++)this.rows[e].clear();this.currRow=Js-1}equals(e){let t=!0;for(let n=0;n<Js;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<Js;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<Js;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+JSON.stringify(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let a=0;a<Js;a++)this.rows[a].clear();const r=this.currRow+1-this.nrRollUpRows,o=this.lastOutputScreen;if(o){const a=o.rows[r].cueStartTime,l=this.logger.time;if(a!==null&&l!==null&&a<l)for(let c=0;c<this.nrRollUpRows;c++)this.rows[t-this.nrRollUpRows+c+1].copy(o.rows[r+c])}}this.currRow=t;const n=this.rows[this.currRow];if(e.indent!==null){const r=e.indent,o=Math.max(r-1,0);n.setCursor(e.indent),e.color=n.chars[o].penState.foreground}const i={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(i)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let n="",i=-1;for(let r=0;r<Js;r++){const o=this.rows[r].getTextString();o&&(i=r+1,e?t.push("Row "+i+": '"+o+"'"):t.push(o.trim()))}return t.length>0&&(e?n="["+t.join(" | ")+"]":n=t.join(`
`)),n}getTextAndFormat(){return this.rows}}class h1{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new ou(n),this.nonDisplayedMemory=new ou(n),this.lastOutputScreen=new ou(n),this.currRollUpRow=this.displayedMemory.rows[Js-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[Js-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const n=Math.floor(e/2)-16,i=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=i[n]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class p1{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=m1(),this.logger=void 0;const i=this.logger=new GF;this.channels=[null,new h1(e,t,i),new h1(e+1,n,i)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){let n,i,r,o=!1;this.logger.time=e;for(let a=0;a<t.length;a+=2)if(i=t[a]&127,r=t[a+1]&127,!(i===0&&r===0)){if(this.logger.log(3,"["+Oi([t[a],t[a+1]])+"] -> ("+Oi([i,r])+")"),n=this.parseCmd(i,r),n||(n=this.parseMidrow(i,r)),n||(n=this.parsePAC(i,r)),n||(n=this.parseBackgroundAttributes(i,r)),!n&&(o=this.parseChars(i,r),o)){const l=this.currentChannel;l&&l>0?this.channels[l].insertChars(o):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!n&&!o&&this.logger.log(2,"Couldn't parse cleaned data "+Oi([i,r])+" orig: "+Oi([t[a],t[a+1]]))}}parseCmd(e,t){const{cmdHistory:n}=this,i=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,r=(e===23||e===31)&&t>=33&&t<=35;if(!(i||r))return!1;if(g1(e,t,n))return vr(null,null,n),this.logger.log(3,"Repeated command ("+Oi([e,t])+") is dropped"),!0;const o=e===20||e===21||e===23?1:2,a=this.channels[o];return e===20||e===21||e===28||e===29?t===32?a.ccRCL():t===33?a.ccBS():t===34?a.ccAOF():t===35?a.ccAON():t===36?a.ccDER():t===37?a.ccRU(2):t===38?a.ccRU(3):t===39?a.ccRU(4):t===40?a.ccFON():t===41?a.ccRDC():t===42?a.ccTR():t===43?a.ccRTD():t===44?a.ccEDM():t===45?a.ccCR():t===46?a.ccENM():t===47&&a.ccEOC():a.ccTO(t-32),vr(e,t,n),this.currentChannel=o,!0}parseMidrow(e,t){let n=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?n=1:n=2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const i=this.channels[n];return i?(i.ccMIDROW(t),this.logger.log(3,"MIDROW ("+Oi([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let n;const i=this.cmdHistory,r=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,o=(e===16||e===24)&&t>=64&&t<=95;if(!(r||o))return!1;if(g1(e,t,i))return vr(null,null,i),!0;const a=e<=23?1:2;t>=64&&t<=95?n=a===1?NF[e]:BF[e]:n=a===1?VF[e]:UF[e];const l=this.channels[a];return l?(l.setPAC(this.interpretPAC(n,t)),vr(e,t,i),this.currentChannel=a,!0):!1}interpretPAC(e,t){let n;const i={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?n=t-96:n=t-64,i.underline=(n&1)===1,n<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(i.italics=!0,i.color="white"):i.indent=Math.floor((n-16)/2)*4,i}parseChars(e,t){let n,i=null,r=null;if(e>=25?(n=2,r=e-8):(n=1,r=e),r>=17&&r<=19){let o;r===17?o=t+80:r===18?o=t+112:o=t+144,this.logger.log(2,"Special char '"+c_(o)+"' in channel "+n),i=[o]}else e>=32&&e<=127&&(i=t===0?[e]:[e,t]);if(i){const o=Oi(i);this.logger.log(3,"Char codes =  "+o.join(",")),vr(e,t,this.cmdHistory)}return i}parseBackgroundAttributes(e,t){const n=(e===16||e===24)&&t>=32&&t<=47,i=(e===23||e===31)&&t>=45&&t<=47;if(!(n||i))return!1;let r;const o={};e===16||e===24?(r=Math.floor((t-32)/2),o.background=HF[r],t%2===1&&(o.background=o.background+"_semi")):t===45?o.background="transparent":(o.foreground="black",t===47&&(o.underline=!0));const a=e<=23?1:2;return this.channels[a].setBkgData(o),vr(e,t,this.cmdHistory),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}this.cmdHistory=m1()}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const n=this.channels[t];n&&n.cueSplitAtTime(e)}}}function vr(s,e,t){t.a=s,t.b=e}function g1(s,e,t){return t.a===s&&t.b===e}function m1(){return{a:null,b:null}}class Ra{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var qf=function(){if(Yr!=null&&Yr.VTTCue)return self.VTTCue;const s=["","lr","rl"],e=["start","middle","end","left","right"];function t(a,l){if(typeof l!="string"||!Array.isArray(a))return!1;const c=l.toLowerCase();return~a.indexOf(c)?c:!1}function n(a){return t(s,a)}function i(a){return t(e,a)}function r(a,...l){let c=1;for(;c<arguments.length;c++){const u=arguments[c];for(const d in u)a[d]=u[d]}return a}function o(a,l,c){const u=this,d={enumerable:!0};u.hasBeenReset=!1;let f="",h=!1,p=a,g=l,m=c,_=null,y="",S=!0,C="auto",E="start",A=50,R="middle",I=50,D="middle";Object.defineProperty(u,"id",r({},d,{get:function(){return f},set:function(L){f=""+L}})),Object.defineProperty(u,"pauseOnExit",r({},d,{get:function(){return h},set:function(L){h=!!L}})),Object.defineProperty(u,"startTime",r({},d,{get:function(){return p},set:function(L){if(typeof L!="number")throw new TypeError("Start time must be set to a number.");p=L,this.hasBeenReset=!0}})),Object.defineProperty(u,"endTime",r({},d,{get:function(){return g},set:function(L){if(typeof L!="number")throw new TypeError("End time must be set to a number.");g=L,this.hasBeenReset=!0}})),Object.defineProperty(u,"text",r({},d,{get:function(){return m},set:function(L){m=""+L,this.hasBeenReset=!0}})),Object.defineProperty(u,"region",r({},d,{get:function(){return _},set:function(L){_=L,this.hasBeenReset=!0}})),Object.defineProperty(u,"vertical",r({},d,{get:function(){return y},set:function(L){const M=n(L);if(M===!1)throw new SyntaxError("An invalid or illegal string was specified.");y=M,this.hasBeenReset=!0}})),Object.defineProperty(u,"snapToLines",r({},d,{get:function(){return S},set:function(L){S=!!L,this.hasBeenReset=!0}})),Object.defineProperty(u,"line",r({},d,{get:function(){return C},set:function(L){if(typeof L!="number"&&L!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");C=L,this.hasBeenReset=!0}})),Object.defineProperty(u,"lineAlign",r({},d,{get:function(){return E},set:function(L){const M=i(L);if(!M)throw new SyntaxError("An invalid or illegal string was specified.");E=M,this.hasBeenReset=!0}})),Object.defineProperty(u,"position",r({},d,{get:function(){return A},set:function(L){if(L<0||L>100)throw new Error("Position must be between 0 and 100.");A=L,this.hasBeenReset=!0}})),Object.defineProperty(u,"positionAlign",r({},d,{get:function(){return R},set:function(L){const M=i(L);if(!M)throw new SyntaxError("An invalid or illegal string was specified.");R=M,this.hasBeenReset=!0}})),Object.defineProperty(u,"size",r({},d,{get:function(){return I},set:function(L){if(L<0||L>100)throw new Error("Size must be between 0 and 100.");I=L,this.hasBeenReset=!0}})),Object.defineProperty(u,"align",r({},d,{get:function(){return D},set:function(L){const M=i(L);if(!M)throw new SyntaxError("An invalid or illegal string was specified.");D=M,this.hasBeenReset=!0}})),u.displayState=void 0}return o.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},o}();class qF{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function d_(s){function e(n,i,r,o){return(n|0)*3600+(i|0)*60+(r|0)+parseFloat(o||0)}const t=s.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class KF{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let i=0;i<n.length;++i)if(t===n[i]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}function f_(s,e,t,n){const i=n?s.split(n):[s];for(const r in i){if(typeof i[r]!="string")continue;const o=i[r].split(t);if(o.length!==2)continue;const a=o[0],l=o[1];e(a,l)}}const Sd=new qf(0,0,""),Ia=Sd.align==="middle"?"middle":"center";function WF(s,e,t){const n=s;function i(){const a=d_(s);if(a===null)throw new Error("Malformed timestamp: "+n);return s=s.replace(/^[^\sa-zA-Z-]+/,""),a}function r(a,l){const c=new KF;f_(a,function(f,h){let p;switch(f){case"region":for(let g=t.length-1;g>=0;g--)if(t[g].id===h){c.set(f,t[g].region);break}break;case"vertical":c.alt(f,h,["rl","lr"]);break;case"line":p=h.split(","),c.integer(f,p[0]),c.percent(f,p[0])&&c.set("snapToLines",!1),c.alt(f,p[0],["auto"]),p.length===2&&c.alt("lineAlign",p[1],["start",Ia,"end"]);break;case"position":p=h.split(","),c.percent(f,p[0]),p.length===2&&c.alt("positionAlign",p[1],["start",Ia,"end","line-left","line-right","auto"]);break;case"size":c.percent(f,h);break;case"align":c.alt(f,h,["start",Ia,"end","left","right"]);break}},/:/,/\s/),l.region=c.get("region",null),l.vertical=c.get("vertical","");let u=c.get("line","auto");u==="auto"&&Sd.line===-1&&(u=-1),l.line=u,l.lineAlign=c.get("lineAlign","start"),l.snapToLines=c.get("snapToLines",!0),l.size=c.get("size",100),l.align=c.get("align",Ia);let d=c.get("position","auto");d==="auto"&&Sd.position===50&&(d=l.align==="start"||l.align==="left"?0:l.align==="end"||l.align==="right"?100:50),l.position=d}function o(){s=s.replace(/^\s+/,"")}if(o(),e.startTime=i(),o(),s.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+n);s=s.slice(3),o(),e.endTime=i(),o(),r(s,e)}function h_(s){return s.replace(/<br(?: \/)?>/gi,`
`)}class YF{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new qF,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function n(){let r=t.buffer,o=0;for(r=h_(r);o<r.length&&r[o]!=="\r"&&r[o]!==`
`;)++o;const a=r.slice(0,o);return r[o]==="\r"&&++o,r[o]===`
`&&++o,t.buffer=r.slice(o),a}function i(r){f_(r,function(o,a){},/:/)}try{let r="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;r=n();const a=r.match(/^()?WEBVTT([ \t].*)?$/);if(!(a!=null&&a[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let o=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(o?o=!1:r=n(),t.state){case"HEADER":/:/.test(r)?i(r):r||(t.state="ID");continue;case"NOTE":r||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(r)){t.state="NOTE";break}if(!r)continue;if(t.cue=new qf(0,0,""),t.state="CUE",r.indexOf("-->")===-1){t.cue.id=r;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{WF(r,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const a=r.indexOf("-->")!==-1;if(!r||a&&(o=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=r}continue;case"BADCUE":r||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const ZF=/\r\n|\n\r|\n|\r/g,au=function(e,t,n=0){return e.slice(n,n+t.length)===t},XF=function(e){let t=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),i=parseInt(e.slice(-9,-7)),r=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!Ee(t)||!Ee(n)||!Ee(i)||!Ee(r))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=60*1e3*i,t+=60*60*1e3*r,t},lu=function(e){let t=5381,n=e.length;for(;n;)t=t*33^e.charCodeAt(--n);return(t>>>0).toString()};function Kf(s,e,t){return lu(s.toString())+lu(e.toString())+lu(t)}const QF=function(e,t,n){let i=e[t],r=e[i.prevCC];if(!r||!r.new&&i.new){e.ccOffset=e.presentationOffset=i.start,i.new=!1;return}for(;(o=r)!=null&&o.new;){var o;e.ccOffset+=i.start-r.start,i.new=!1,i=r,r=e[i.prevCC]}e.presentationOffset=n};function JF(s,e,t,n,i,r,o){const a=new YF,l=bn(new Uint8Array(s)).trim().replace(ZF,`
`).split(`
`),c=[],u=e?yF(e.baseTime,e.timescale):0;let d="00:00.000",f=0,h=0,p,g=!0;a.oncue=function(m){const _=t[n];let y=t.ccOffset;const S=(f-u)/9e4;if(_!=null&&_.new&&(h!==void 0?y=t.ccOffset=_.start:QF(t,n,S)),S){if(!e){p=new Error("Missing initPTS for VTT MPEGTS");return}y=S-t.presentationOffset}const C=m.endTime-m.startTime,E=Ns((m.startTime+y-h)*9e4,i*9e4)/9e4;m.startTime=Math.max(E,0),m.endTime=Math.max(E+C,0);const A=m.text.trim();m.text=decodeURIComponent(encodeURIComponent(A)),m.id||(m.id=Kf(m.startTime,m.endTime,A)),m.endTime>0&&c.push(m)},a.onparsingerror=function(m){p=m},a.onflush=function(){if(p){o(p);return}r(c)},l.forEach(m=>{if(g)if(au(m,"X-TIMESTAMP-MAP=")){g=!1,m.slice(16).split(",").forEach(_=>{au(_,"LOCAL:")?d=_.slice(6):au(_,"MPEGTS:")&&(f=parseInt(_.slice(7)))});try{h=XF(d)/1e3}catch(_){p=_}return}else m===""&&(g=!1);a.parse(m+`
`)}),a.flush()}const cu="stpp.ttml.im1t",p_=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,g_=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,eO={left:"start",center:"center",right:"end",start:"start",end:"end"};function v1(s,e,t,n){const i=Ze(new Uint8Array(s),["mdat"]);if(i.length===0){n(new Error("Could not parse IMSC1 mdat"));return}const r=i.map(a=>bn(a)),o=_F(e.baseTime,1,e.timescale);try{r.forEach(a=>t(tO(a,o)))}catch(a){n(a)}}function tO(s,e){const i=new DOMParser().parseFromString(s,"text/xml").getElementsByTagName("tt")[0];if(!i)throw new Error("Invalid ttml");const r={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},o=Object.keys(r).reduce((d,f)=>(d[f]=i.getAttribute(`ttp:${f}`)||r[f],d),{}),a=i.getAttribute("xml:space")!=="preserve",l=_1(uu(i,"styling","style")),c=_1(uu(i,"layout","region")),u=uu(i,"body","[begin]");return[].map.call(u,d=>{const f=m_(d,a);if(!f||!d.hasAttribute("begin"))return null;const h=fu(d.getAttribute("begin"),o),p=fu(d.getAttribute("dur"),o);let g=fu(d.getAttribute("end"),o);if(h===null)throw y1(d);if(g===null){if(p===null)throw y1(d);g=h+p}const m=new qf(h-e,g-e,f);m.id=Kf(m.startTime,m.endTime,m.text);const _=c[d.getAttribute("region")],y=l[d.getAttribute("style")],S=sO(_,y,l),{textAlign:C}=S;if(C){const E=eO[C];E&&(m.lineAlign=E),m.align=C}return Vt(m,S),m}).filter(d=>d!==null)}function uu(s,e,t){const n=s.getElementsByTagName(e)[0];return n?[].slice.call(n.querySelectorAll(t)):[]}function _1(s){return s.reduce((e,t)=>{const n=t.getAttribute("xml:id");return n&&(e[n]=t),e},{})}function m_(s,e){return[].slice.call(s.childNodes).reduce((t,n,i)=>{var r;return n.nodeName==="br"&&i?t+`
`:(r=n.childNodes)!=null&&r.length?m_(n,e):e?t+n.textContent.trim().replace(/\s+/g," "):t+n.textContent},"")}function sO(s,e,t){const n="http://www.w3.org/ns/ttml#styling";let i=null;const r=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],o=s!=null&&s.hasAttribute("style")?s.getAttribute("style"):null;return o&&t.hasOwnProperty(o)&&(i=t[o]),r.reduce((a,l)=>{const c=du(e,n,l)||du(s,n,l)||du(i,n,l);return c&&(a[l]=c),a},{})}function du(s,e,t){return s&&s.hasAttributeNS(e,t)?s.getAttributeNS(e,t):null}function y1(s){return new Error(`Could not parse ttml timestamp ${s}`)}function fu(s,e){if(!s)return null;let t=d_(s);return t===null&&(p_.test(s)?t=nO(s,e):g_.test(s)&&(t=iO(s,e))),t}function nO(s,e){const t=p_.exec(s),n=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+n/e.frameRate}function iO(s,e){const t=g_.exec(s),n=Number(t[1]);switch(t[2]){case"h":return n*3600;case"m":return n*60;case"ms":return n*1e3;case"f":return n/e.frameRate;case"t":return n/e.tickRate}return n}class rO{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=b1(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(b.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(b.FRAG_LOADING,this.onFragLoading,this),e.on(b.FRAG_LOADED,this.onFragLoaded,this),e.on(b.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(b.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(b.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(b.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(b.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(b.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(b.FRAG_LOADING,this.onFragLoading,this),e.off(b.FRAG_LOADED,this.onFragLoaded,this),e.off(b.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(b.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(b.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(b.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){if(this.config.enableCEA708Captions&&(!this.cea608Parser1||!this.cea608Parser2)){const e=new Ra(this,"textTrack1"),t=new Ra(this,"textTrack2"),n=new Ra(this,"textTrack3"),i=new Ra(this,"textTrack4");this.cea608Parser1=new p1(1,e,t),this.cea608Parser2=new p1(3,n,i)}}addCues(e,t,n,i,r){let o=!1;for(let a=r.length;a--;){const l=r[a],c=oO(l[0],l[1],t,n);if(c>=0&&(l[0]=Math.min(l[0],t),l[1]=Math.max(l[1],n),o=!0,c/(n-t)>.5))return}if(o||r.push([t,n]),this.config.renderTextTracksNatively){const a=this.captionsTracks[e];this.Cues.newCue(a,t,n,i)}else{const a=this.Cues.newCue(null,t,n,i);this.hls.trigger(b.CUES_PARSED,{type:"captions",cues:a,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:r}){const{unparsedVttFrags:o}=this;n==="main"&&(this.initPTS[t.cc]={baseTime:i,timescale:r}),o.length&&(this.unparsedVttFrags=[],o.forEach(a=>{this.onFragLoaded(b.FRAG_LOADED,a)}))}getExistingTrack(e,t){const{media:n}=this;if(n)for(let i=0;i<n.textTracks.length;i++){const r=n.textTracks[i];if(x1(r,{name:e,lang:t,attrs:{}}))return r}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:n,media:i}=this,{label:r,languageCode:o}=t[e],a=this.getExistingTrack(r,o);if(a)n[e]=a,Ar(n[e]),Mv(n[e],i);else{const l=this.createTextTrack("captions",r,o);l&&(l[e]=!0,n[e]=l)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const n=t.label,i={_id:e,label:n,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=i,this.hls.trigger(b.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[i]})}createTextTrack(e,t,n){const i=this.media;if(!!i)return i.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:e}=this;Object.keys(e).forEach(t=>{Ar(e[t]),delete e[t]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=b1(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let n=0;n<t.length;n++)Ar(t[n])}onSubtitleTracksUpdated(e,t){const n=t.subtitleTracks||[],i=n.some(r=>r.textCodec===cu);if(this.config.enableWebVTT||i&&this.config.enableIMSC1){if(l_(this.tracks,n)){this.tracks=n;return}if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const o=this.media,a=o?Qa(o.textTracks):null;if(this.tracks.forEach((l,c)=>{let u;if(a){let d=null;for(let f=0;f<a.length;f++)if(a[f]&&x1(a[f],l)){d=a[f],a[f]=null;break}d&&(u=d)}if(u)Ar(u);else{const d=v_(l);u=this.createTextTrack(d,l.name,l.lang),u&&(u.mode="disabled")}u&&this.textTracks.push(u)}),a!=null&&a.length){const l=a.filter(c=>c!==null).map(c=>c.label);l.length&&V.warn(`Media element contains unused subtitle tracks: ${l.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const o=this.tracks.map(a=>({label:a.name,kind:a.type.toLowerCase(),default:a.default,subtitleTrack:a}));this.hls.trigger(b.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:o})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(n=>{const i=/(?:CC|SERVICE)([1-4])/.exec(n.instreamId);if(!i)return;const r=`textTrack${i[1]}`,o=this.captionsProperties[r];!o||(o.label=n.name,n.lang&&(o.languageCode=n.lang),o.media=n)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){this.initCea608Parsers();const{cea608Parser1:n,cea608Parser2:i,lastCc:r,lastSn:o,lastPartIndex:a}=this;if(!(!this.enabled||!n||!i)&&t.frag.type===He.MAIN){var l,c;const{cc:u,sn:d}=t.frag,f=(l=t==null||(c=t.part)==null?void 0:c.index)!=null?l:-1;d===o+1||d===o&&f===a+1||u===r||(n.reset(),i.reset()),this.lastCc=u,this.lastSn=d,this.lastPartIndex=f}}onFragLoaded(e,t){const{frag:n,payload:i}=t;if(n.type===He.SUBTITLE)if(i.byteLength){const r=n.decryptdata,o="stats"in t;if(r==null||!r.encrypted||o){const a=this.tracks[n.level],l=this.vttCCs;l[n.cc]||(l[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),a&&a.textCodec===cu?this._parseIMSC1(n,i):this._parseVTTs(t)}}else this.hls.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const n=this.hls;v1(t,this.initPTS[e.cc],i=>{this._appendCues(i,e.level),n.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},i=>{V.log(`Failed to parse IMSC1: ${i}`),n.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:i})})}_parseVTTs(e){var t;const{frag:n,payload:i}=e,{initPTS:r,unparsedVttFrags:o}=this,a=r.length-1;if(!r[n.cc]&&a===-1){o.push(e);return}const l=this.hls,c=(t=n.initSegment)!=null&&t.data?Ks(n.initSegment.data,new Uint8Array(i)):i;JF(c,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,u=>{this._appendCues(u,n.level),l.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},u=>{const d=u.message==="Missing initPTS for VTT MPEGTS";d?o.push(e):this._fallbackToIMSC1(n,i),V.log(`Failed to parse VTT cue: ${u}`),!(d&&a>n.cc)&&l.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:u})})}_fallbackToIMSC1(e,t){const n=this.tracks[e.level];n.textCodec||v1(t,this.initPTS[e.cc],()=>{n.textCodec=cu,this._parseIMSC1(e,t)},()=>{n.textCodec="wvtt"})}_appendCues(e,t){const n=this.hls;if(this.config.renderTextTracksNatively){const i=this.textTracks[t];if(!i||i.mode==="disabled")return;e.forEach(r=>$v(i,r))}else{const i=this.tracks[t];if(!i)return;const r=i.default?"default":"subtitles"+t;n.trigger(b.CUES_PARSED,{type:"subtitles",cues:e,track:r})}}onFragDecrypted(e,t){const{frag:n}=t;n.type===He.SUBTITLE&&this.onFragLoaded(b.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){this.initCea608Parsers();const{cea608Parser1:n,cea608Parser2:i}=this;if(!this.enabled||!n||!i)return;const{frag:r,samples:o}=t;if(!(r.type===He.MAIN&&this.closedCaptionsForLevel(r)==="NONE"))for(let a=0;a<o.length;a++){const l=o[a].bytes;if(l){const c=this.extractCea608Data(l);n.addData(o[a].pts,c[0]),i.addData(o[a].pts,c[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:i,type:r}){const{media:o}=this;if(!(!o||o.currentTime<n)){if(!r||r==="video"){const{captionsTracks:a}=this;Object.keys(a).forEach(l=>md(a[l],t,n))}if(this.config.renderTextTracksNatively&&t===0&&i!==void 0){const{textTracks:a}=this;Object.keys(a).forEach(l=>md(a[l],t,i))}}}extractCea608Data(e){const t=[[],[]],n=e[0]&31;let i=2;for(let r=0;r<n;r++){const o=e[i++],a=127&e[i++],l=127&e[i++];if(a===0&&l===0)continue;if((4&o)!==0){const u=3&o;(u===0||u===1)&&(t[u].push(a),t[u].push(l))}}return t}}function v_(s){return s.characteristics&&/transcribes-spoken-dialog/gi.test(s.characteristics)&&/describes-music-and-sound/gi.test(s.characteristics)?"captions":"subtitles"}function x1(s,e){return!!s&&s.kind===v_(e)&&wd(e,s)}function oO(s,e,t,n){return Math.min(e,n)-Math.max(s,t)}function b1(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}class Wf{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(b.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(b.BUFFER_CODECS,this.onBufferCodecs,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(b.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(b.BUFFER_CODECS,this.onBufferCodecs,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&Ee(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,n=this.getMaxLevel(e.length-1);n!==this.autoLevelCapping&&V.log(`Setting autoLevelCapping to ${n}: ${e[n].height}p@${e[n].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=n,t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const n=t.filter((i,r)=>this.isLevelAllowed(i)&&r<=e);return this.clientRect=null,Wf.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,!t.width&&!t.height&&(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return e}isLevelAllowed(e){return!this.restrictedLevels.some(n=>e.bitrate===n.bitrate&&e.width===n.width&&e.height===n.height)}static getMaxLevelByMediaSize(e,t,n){if(!(e!=null&&e.length))return-1;const i=(a,l)=>l?a.width!==l.width||a.height!==l.height:!0;let r=e.length-1;const o=Math.max(t,n);for(let a=0;a<e.length;a+=1){const l=e[a];if((l.width>=o||l.height>=o)&&i(l,e[a+1])){r=a;break}}return r}}class aO{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const n=this.hls.config;if(n.capLevelOnFPSDrop){const i=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=i,i&&typeof i.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,n){const i=performance.now();if(t){if(this.lastTime){const r=i-this.lastTime,o=n-this.lastDroppedFrames,a=t-this.lastDecodedFrames,l=1e3*o/r,c=this.hls;if(c.trigger(b.FPS_DROP,{currentDropped:o,currentDecoded:a,totalDroppedFrames:n}),l>0&&o>c.config.fpsDroppedMonitoringThreshold*a){let u=c.currentLevel;V.warn("drop FPS ratio greater than max allowed value for currentLevel: "+u),u>0&&(c.autoLevelCapping===-1||c.autoLevelCapping>=u)&&(u=u-1,c.trigger(b.FPS_DROP_LEVEL_CAPPING,{level:u,droppedLevel:c.currentLevel}),c.autoLevelCapping=u,this.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}const Da="[eme]";class Vr{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=Vr.CDMCleanupPromise?[Vr.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=V.debug.bind(V,Da),this.log=V.log.bind(V,Da),this.warn=V.warn.bind(V,Da),this.error=V.error.bind(V,Da),this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(b.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(b.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(b.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(b.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(b.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(b.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:n}=this.config,i=t[e];if(i)return i.licenseUrl;if(e===Ct.WIDEVINE&&n)return n;throw new Error(`no license server URL configured for key-system "${e}"`)}getServerCertificateUrl(e){const{drmSystems:t}=this.config,n=t[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,n=(o,a,l)=>!!o&&l.indexOf(o)===a,i=t.map(o=>o.audioCodec).filter(n),r=t.map(o=>o.videoCodec).filter(n);return i.length+r.length===0&&r.push("avc1.42e01e"),new Promise((o,a)=>{const l=c=>{const u=c.shift();this.getMediaKeysPromise(u,i,r).then(d=>o({keySystem:u,mediaKeys:d})).catch(d=>{c.length?l(c):d instanceof Ms?a(d):a(new Ms({type:Ge.KEY_SYSTEM_ERROR,details:j.KEY_SYSTEM_NO_ACCESS,error:d,fatal:!0},d.message))})};l(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:n}=this.config;if(typeof n!="function"){let i=`Configured requestMediaKeySystemAccess is not a function ${n}`;return Sv===null&&self.location.protocol==="http:"&&(i=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(i))}return n(e,t)}getMediaKeysPromise(e,t,n){const i=_D(e,t,n,this.config.drmSystemOptions),r=this.keySystemAccessPromises[e];let o=r==null?void 0:r.keySystemAccess;if(!o){this.log(`Requesting encrypted media "${e}" key-system access with config: ${JSON.stringify(i)}`),o=this.requestMediaKeySystemAccess(e,i);const a=this.keySystemAccessPromises[e]={keySystemAccess:o};return o.catch(l=>{this.log(`Failed to obtain access to key-system "${e}": ${l}`)}),o.then(l=>{this.log(`Access for key-system "${l.keySystem}" obtained`);const c=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),a.mediaKeys=l.createMediaKeys().then(u=>(this.log(`Media-keys created for "${e}"`),c.then(d=>d?this.setMediaKeysServerCertificate(u,e,d):u))),a.mediaKeys.catch(u=>{this.error(`Failed to create media-keys for "${e}"}: ${u}`)}),a.mediaKeys})}return o.then(()=>r.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:n}){this.log(`Creating key-system session "${t}" keyId: ${pn.hexDump(e.keyId||[])}`);const i=n.createSession(),r={decryptdata:e,keySystem:t,mediaKeys:n,mediaKeysSession:i,keyStatus:"status-pending"};return this.mediaKeySessions.push(r),r}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const n=this.createMediaKeySessionContext(e),i=this.getKeyIdString(t),r="cenc";this.keyIdToKeySessionPromise[i]=this.generateRequestWithPreferredKeySession(n,r,t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return pn.hexDump(e.keyId)}updateKeySession(e,t){var n;const i=e.mediaKeysSession;return this.log(`Updating key-session "${i.sessionId}" for keyID ${pn.hexDump(((n=e.decryptdata)==null?void 0:n.keyId)||[])}
      } (data length: ${t&&t.byteLength})`),i.update(t)}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise((t,n)=>{const i=Wc(this.config),r=e.map(Cp).filter(o=>!!o&&i.indexOf(o)!==-1);return this.getKeySystemSelectionPromise(r).then(({keySystem:o})=>{const a=Ap(o);a?t(a):n(new Error(`Unable to find format for key-system "${o}"`))}).catch(n)})}loadKey(e){const t=e.keyInfo.decryptdata,n=this.getKeyIdString(t),i=`(keyId: ${n} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${i}`);let r=this.keyIdToKeySessionPromise[n];return r||(r=this.keyIdToKeySessionPromise[n]=this.getKeySystemForKeyPromise(t).then(({keySystem:o,mediaKeys:a})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${i}`),this.attemptSetMediaKeys(o,a).then(()=>{this.throwIfDestroyed();const l=this.createMediaKeySessionContext({keySystem:o,mediaKeys:a,decryptdata:t}),c="cenc";return this.generateRequestWithPreferredKeySession(l,c,t.pssh,"playlist-key")}))),r.catch(o=>this.handleError(o))),r}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){!this.hls||(this.error(e.message),e instanceof Ms?this.hls.trigger(b.ERROR,e.data):this.hls.trigger(b.ERROR,{type:Ge.KEY_SYSTEM_ERROR,details:j.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),n=this.keyIdToKeySessionPromise[t];if(!n){const i=Cp(e.keyFormat),r=i?[i]:Wc(this.config);return this.attemptKeySystemAccess(r)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=Wc(this.config)),e.length===0)throw new Ms({type:Ge.KEY_SYSTEM_ERROR,details:j.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}_onMediaEncrypted(e){const{initDataType:t,initData:n}=e;if(this.debug(`"${e.type}" event: init data type: "${t}"`),n===null)return;let i,r;if(t==="sinf"&&this.config.drmSystems[Ct.FAIRPLAY]){const u=Bt(new Uint8Array(n));try{const d=Pf(JSON.parse(u).sinf),f=Iv(new Uint8Array(d));if(!f)return;i=f.subarray(8,24),r=Ct.FAIRPLAY}catch{this.warn('Failed to parse sinf "encrypted" event message initData');return}}else{const u=GD(n);if(u===null)return;u.version===0&&u.systemId===wv.WIDEVINE&&u.data&&(i=u.data.subarray(8,24)),r=vD(u.systemId)}if(!r||!i)return;const o=pn.hexDump(i),{keyIdToKeySessionPromise:a,mediaKeySessions:l}=this;let c=a[o];for(let u=0;u<l.length;u++){const d=l[u],f=d.decryptdata;if(f.pssh||!f.keyId)continue;const h=pn.hexDump(f.keyId);if(o===h||f.uri.replace(/-/g,"").indexOf(o)!==-1){c=a[h],delete a[h],f.pssh=new Uint8Array(n),f.keyId=i,c=a[o]=c.then(()=>this.generateRequestWithPreferredKeySession(d,t,n,"encrypted-event-key-match"));break}}c||(c=a[o]=this.getKeySystemSelectionPromise([r]).then(({keySystem:u,mediaKeys:d})=>{var f;this.throwIfDestroyed();const h=new jo("ISO-23001-7",o,(f=Ap(u))!=null?f:"");return h.pssh=new Uint8Array(n),h.keyId=i,this.attemptSetMediaKeys(u,d).then(()=>{this.throwIfDestroyed();const p=this.createMediaKeySessionContext({decryptdata:h,keySystem:u,mediaKeys:d});return this.generateRequestWithPreferredKeySession(p,t,n,"encrypted-event-no-match")})})),c.catch(u=>this.handleError(u))}_onWaitingForKey(e){this.log(`"${e.type}" event`)}attemptSetMediaKeys(e,t){const n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const i=Promise.all(n).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.setMediaKeysQueue.push(i),i.then(()=>{this.log(`Media-keys set for "${e}"`),n.push(i),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(r=>n.indexOf(r)===-1)})}generateRequestWithPreferredKeySession(e,t,n,i){var r,o;const a=(r=this.config.drmSystems)==null||(o=r[e.keySystem])==null?void 0:o.generateRequest;if(a)try{const p=a.call(this.hls,t,n,e);if(!p)throw new Error("Invalid response from configured generateRequest filter");t=p.initDataType,n=e.decryptdata.pssh=p.initData?new Uint8Array(p.initData):null}catch(p){var l;if(this.warn(p.message),(l=this.hls)!=null&&l.config.debug)throw p}if(n===null)return this.log(`Skipping key-session request for "${i}" (no initData)`),Promise.resolve(e);const c=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${i}": ${c} (init data type: ${t} length: ${n?n.byteLength:null})`);const u=new jf,d=e._onmessage=p=>{const g=e.mediaKeysSession;if(!g){u.emit("error",new Error("invalid state"));return}const{messageType:m,message:_}=p;this.log(`"${m}" message event for session "${g.sessionId}" message size: ${_.byteLength}`),m==="license-request"||m==="license-renewal"?this.renewLicense(e,_).catch(y=>{this.handleError(y),u.emit("error",y)}):m==="license-release"?e.keySystem===Ct.FAIRPLAY&&(this.updateKeySession(e,pd("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${m}"`)},f=e._onkeystatuseschange=p=>{if(!e.mediaKeysSession){u.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(e);const m=e.keyStatus;u.emit("keyStatus",m),m==="expired"&&(this.warn(`${e.keySystem} expired for key ${c}`),this.renewKeySession(e))};e.mediaKeysSession.addEventListener("message",d),e.mediaKeysSession.addEventListener("keystatuseschange",f);const h=new Promise((p,g)=>{u.on("error",g),u.on("keyStatus",m=>{m.startsWith("usable")?p():m==="output-restricted"?g(new Ms({type:Ge.KEY_SYSTEM_ERROR,details:j.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):m==="internal-error"?g(new Ms({type:Ge.KEY_SYSTEM_ERROR,details:j.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${m}"`)):m==="expired"?g(new Error("key expired while generating request")):this.warn(`unhandled key status change "${m}"`)})});return e.mediaKeysSession.generateRequest(t,n).then(()=>{var p;this.log(`Request generated for key-session "${(p=e.mediaKeysSession)==null?void 0:p.sessionId}" keyId: ${c}`)}).catch(p=>{throw new Ms({type:Ge.KEY_SYSTEM_ERROR,details:j.KEY_SYSTEM_NO_SESSION,error:p,fatal:!1},`Error generating key-session request: ${p}`)}).then(()=>h).catch(p=>{throw u.removeAllListeners(),this.removeSession(e),p}).then(()=>(u.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,n)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${pn.hexDump("buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n))} session keyId: ${pn.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,n=t.loader,i=new n(t),r=this.getServerCertificateUrl(e);return r?(this.log(`Fetching server certificate for "${e}"`),new Promise((o,a)=>{const l={responseType:"arraybuffer",url:r},c=t.certLoadPolicy.default,u={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(f,h,p,g)=>{o(f.data)},onError:(f,h,p,g)=>{a(new Ms({type:Ge.KEY_SYSTEM_ERROR,details:j.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:p,response:Zt({url:l.url,data:void 0},f)},`"${e}" certificate request failed (${r}). Status: ${f.code} (${f.text})`))},onTimeout:(f,h,p)=>{a(new Ms({type:Ge.KEY_SYSTEM_ERROR,details:j.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:p,response:{url:l.url,data:void 0}},`"${e}" certificate request timed out (${r})`))},onAbort:(f,h,p)=>{a(new Error("aborted"))}};i.load(l,u,d)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise((i,r)=>{e.setServerCertificate(n).then(o=>{this.log(`setServerCertificate ${o?"success":"not supported by CDM"} (${n==null?void 0:n.byteLength}) on "${t}"`),i(e)}).catch(o=>{r(new Ms({type:Ge.KEY_SYSTEM_ERROR,details:j.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:o,fatal:!0},o.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(n=>this.updateKeySession(e,new Uint8Array(n)).catch(i=>{throw new Ms({type:Ge.KEY_SYSTEM_ERROR,details:j.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:i,fatal:!0},i.message)}))}unpackPlayReadyKeyMessage(e,t){const n=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!n.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const i=new DOMParser().parseFromString(n,"application/xml"),r=i.querySelectorAll("HttpHeader");if(r.length>0){let u;for(let d=0,f=r.length;d<f;d++){var o,a;u=r[d];const h=(o=u.querySelector("name"))==null?void 0:o.textContent,p=(a=u.querySelector("value"))==null?void 0:a.textContent;h&&p&&e.setRequestHeader(h,p)}}const l=i.querySelector("Challenge"),c=l==null?void 0:l.textContent;if(!c)throw new Error("Cannot find <Challenge> in key message");return pd(atob(c))}setupLicenseXHR(e,t,n,i){const r=this.config.licenseXhrSetup;return r?Promise.resolve().then(()=>{if(!n.decryptdata)throw new Error("Key removed");return r.call(this.hls,e,t,n,i)}).catch(o=>{if(!n.decryptdata)throw o;return e.open("POST",t,!0),r.call(this.hls,e,t,n,i)}).then(o=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:o||i})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:i}))}requestLicense(e,t){const n=this.config.keyLoadPolicy.default;return new Promise((i,r)=>{const o=this.getLicenseServerUrl(e.keySystem);this.log(`Sending license request to URL: ${o}`);const a=new XMLHttpRequest;a.responseType="arraybuffer",a.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return r(new Error("invalid state"));if(a.readyState===4)if(a.status===200){this._requestLicenseFailureCount=0;let l=a.response;this.log(`License received ${l instanceof ArrayBuffer?l.byteLength:l}`);const c=this.config.licenseResponseCallback;if(c)try{l=c.call(this.hls,a,o,e)}catch(u){this.error(u)}i(l)}else{const l=n.errorRetry,c=l?l.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>c||a.status>=400&&a.status<500)r(new Ms({type:Ge.KEY_SYSTEM_ERROR,details:j.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:a,response:{url:o,data:void 0,code:a.status,text:a.statusText}},`License Request XHR failed (${o}). Status: ${a.status} (${a.statusText})`));else{const u=c-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${u} attempts left`),this.requestLicense(e,t).then(i,r)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=a,this.setupLicenseXHR(a,o,e,t).then(({xhr:l,licenseChallenge:c})=>{e.keySystem==Ct.PLAYREADY&&(c=this.unpackPlayReadyKeyMessage(l,c)),l.send(c)})})}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const n=t.media;this.media=n,n.addEventListener("encrypted",this.onMediaEncrypted),n.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media,t=this.mediaKeySessions;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},jo.clearKeyUriToKeyIdMap();const n=t.length;Vr.CDMCleanupPromise=Promise.all(t.map(i=>this.removeSession(i)).concat(e==null?void 0:e.setMediaKeys(null).catch(i=>{this.log(`Could not clear media keys: ${i}`)}))).then(()=>{n&&(this.log("finished closing key sessions and clearing media keys"),t.length=0)}).catch(i=>{this.log(`Could not close sessions and clear media keys: ${i}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const n=t.reduce((i,r)=>(i.indexOf(r.keyFormat)===-1&&i.push(r.keyFormat),i),[]);this.log(`Selecting key-system from session-keys ${n.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(n)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:n}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const i=this.mediaKeySessions.indexOf(e);return i>-1&&this.mediaKeySessions.splice(i,1),t.remove().catch(r=>{this.log(`Could not remove session: ${r}`)}).then(()=>t.close()).catch(r=>{this.log(`Could not close session: ${r}`)})}}}Vr.CDMCleanupPromise=void 0;class Ms extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}var cs;(function(s){s.MANIFEST="m",s.AUDIO="a",s.VIDEO="v",s.MUXED="av",s.INIT="i",s.CAPTION="c",s.TIMED_TEXT="tt",s.KEY="k",s.OTHER="o"})(cs||(cs={}));var Ed;(function(s){s.DASH="d",s.HLS="h",s.SMOOTH="s",s.OTHER="o"})(Ed||(Ed={}));var Gi;(function(s){s.OBJECT="CMCD-Object",s.REQUEST="CMCD-Request",s.SESSION="CMCD-Session",s.STATUS="CMCD-Status"})(Gi||(Gi={}));const lO={[Gi.OBJECT]:["br","d","ot","tb"],[Gi.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[Gi.SESSION]:["cid","pr","sf","sid","st","v"],[Gi.STATUS]:["bs","rtp"]};class Qr{constructor(e,t){this.value=void 0,this.params=void 0,Array.isArray(e)&&(e=e.map(n=>n instanceof Qr?n:new Qr(n))),this.value=e,this.params=t}}class __{constructor(e){this.description=void 0,this.description=e}}const cO="Dict";function uO(s){return Array.isArray(s)?JSON.stringify(s):s instanceof Map?"Map{}":s instanceof Set?"Set{}":typeof s=="object"?JSON.stringify(s):String(s)}function dO(s,e,t,n){return new Error(`failed to ${s} "${uO(e)}" as ${t}`,{cause:n})}const w1="Bare Item",fO="Boolean",hO="Byte Sequence",pO="Decimal",gO="Integer";function mO(s){return s<-999999999999999||999999999999999<s}const vO=/[\x00-\x1f\x7f]+/,_O="Token",yO="Key";function An(s,e,t){return dO("serialize",s,e,t)}function xO(s){if(typeof s!="boolean")throw An(s,fO);return s?"?1":"?0"}function bO(s){return btoa(String.fromCharCode(...s))}function wO(s){if(ArrayBuffer.isView(s)===!1)throw An(s,hO);return`:${bO(s)}:`}function y_(s){if(mO(s))throw An(s,gO);return s.toString()}function SO(s){return`@${y_(s.getTime()/1e3)}`}function x_(s,e){if(s<0)return-x_(-s,e);const t=Math.pow(10,e);if(Math.abs(s*t%1-.5)<Number.EPSILON){const i=Math.floor(s*t);return(i%2===0?i:i+1)/t}else return Math.round(s*t)/t}function EO(s){const e=x_(s,3);if(Math.floor(Math.abs(e)).toString().length>12)throw An(s,pO);const t=e.toString();return t.includes(".")?t:`${t}.0`}const TO="String";function CO(s){if(vO.test(s))throw An(s,TO);return`"${s.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function AO(s){return s.description||s.toString().slice(7,-1)}function S1(s){const e=AO(s);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw An(e,_O);return e}function Td(s){switch(typeof s){case"number":if(!Ee(s))throw An(s,w1);return Number.isInteger(s)?y_(s):EO(s);case"string":return CO(s);case"symbol":return S1(s);case"boolean":return xO(s);case"object":if(s instanceof Date)return SO(s);if(s instanceof Uint8Array)return wO(s);if(s instanceof __)return S1(s);default:throw An(s,w1)}}function Cd(s){if(/^[a-z*][a-z0-9\-_.*]*$/.test(s)===!1)throw An(s,yO);return s}function Yf(s){return s==null?"":Object.entries(s).map(([e,t])=>t===!0?`;${Cd(e)}`:`;${Cd(e)}=${Td(t)}`).join("")}function b_(s){return s instanceof Qr?`${Td(s.value)}${Yf(s.params)}`:Td(s)}function kO(s){return`(${s.value.map(b_).join(" ")})${Yf(s.params)}`}function LO(s,e={whitespace:!0}){if(typeof s!="object")throw An(s,cO);const t=s instanceof Map?s.entries():Object.entries(s),n=e!=null&&e.whitespace?" ":"";return Array.from(t).map(([i,r])=>{r instanceof Qr||(r=new Qr(r));let o=Cd(i);return r.value===!0?o+=Yf(r.params):(o+="=",Array.isArray(r.value)?o+=kO(r):o+=b_(r)),o}).join(`,${n}`)}function RO(s,e){return LO(s,e)}const IO=s=>s==="ot"||s==="sf"||s==="st",DO=s=>typeof s=="number"?Ee(s):s!=null&&s!==""&&s!==!1;function PO(s,e){const t=new URL(s),n=new URL(e);if(t.origin!==n.origin)return s;const i=t.pathname.split("/").slice(1),r=n.pathname.split("/").slice(1,-1);for(;i[0]===r[0];)i.shift(),r.shift();for(;r.length;)r.shift(),i.unshift("..");return i.join("/")}function FO(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,i=>{const r=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(i=="x"?r:r&3|8).toString(16)})}}}const nl=s=>Math.round(s),OO=(s,e)=>(e!=null&&e.baseUrl&&(s=PO(s,e.baseUrl)),encodeURIComponent(s)),Pa=s=>nl(s/100)*100,MO={br:nl,d:nl,bl:Pa,dl:Pa,mtp:Pa,nor:OO,rtp:Pa,tb:nl};function $O(s,e){const t={};if(s==null||typeof s!="object")return t;const n=Object.keys(s).sort(),i=Vt({},MO,e==null?void 0:e.formatters),r=e==null?void 0:e.filter;return n.forEach(o=>{if(r!=null&&r(o))return;let a=s[o];const l=i[o];l&&(a=l(a,e)),!(o==="v"&&a===1)&&(o=="pr"&&a===1||!DO(a)||(IO(o)&&typeof a=="string"&&(a=new __(a)),t[o]=a))}),t}function w_(s,e={}){return s?RO($O(s,e),Vt({whitespace:!1},e)):""}function NO(s,e={}){if(!s)return{};const t=Object.entries(s),n=Object.entries(lO).concat(Object.entries((e==null?void 0:e.customHeaderMap)||{})),i=t.reduce((r,o)=>{var a,l;const[c,u]=o,d=((a=n.find(f=>f[1].includes(c)))==null?void 0:a[0])||Gi.REQUEST;return(l=r[d])!=null||(r[d]={}),r[d][c]=u,r},{});return Object.entries(i).reduce((r,[o,a])=>(r[o]=w_(a,e),r),{})}function VO(s,e,t){return Vt(s,NO(e,t))}const BO="CMCD";function UO(s,e={}){if(!s)return"";const t=w_(s,e);return`${BO}=${encodeURIComponent(t)}`}const E1=/CMCD=[^&#]+/;function HO(s,e,t){const n=UO(e,t);if(!n)return s;if(E1.test(s))return s.replace(E1,n);const i=s.includes("?")?"&":"?";return`${s}${i}${n}`}class GO{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=i=>{try{this.apply(i,{ot:cs.MANIFEST,su:!this.initialized})}catch(r){V.warn("Could not generate manifest CMCD data.",r)}},this.applyFragmentData=i=>{try{const r=i.frag,o=this.hls.levels[r.level],a=this.getObjectType(r),l={d:r.duration*1e3,ot:a};(a===cs.VIDEO||a===cs.AUDIO||a==cs.MUXED)&&(l.br=o.bitrate/1e3,l.tb=this.getTopBandwidth(a)/1e3,l.bl=this.getBufferLength(a)),this.apply(i,l)}catch(r){V.warn("Could not generate segment CMCD data.",r)}},this.hls=e;const t=this.config=e.config,{cmcd:n}=t;n!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||FO(),this.cid=n.contentId,this.useHeaders=n.useHeaders===!0,this.includeKeys=n.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHED,this.onMediaDetached,this),e.on(b.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHED,this.onMediaDetached,this),e.off(b.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){!this.media||(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,i;this.audioBuffer=(n=t.tracks.audio)==null?void 0:n.buffer,this.videoBuffer=(i=t.tracks.video)==null?void 0:i.buffer}createData(){var e;return{v:1,sf:Ed.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){Vt(t,this.createData());const n=t.ot===cs.INIT||t.ot===cs.VIDEO||t.ot===cs.MUXED;this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:i}=this;i&&(t=Object.keys(t).reduce((r,o)=>(i.includes(o)&&(r[o]=t[o]),r),{})),this.useHeaders?(e.headers||(e.headers={}),VO(e.headers,t)):e.url=HO(e.url,t)}getObjectType(e){const{type:t}=e;if(t==="subtitle")return cs.TIMED_TEXT;if(e.sn==="initSegment")return cs.INIT;if(t==="audio")return cs.AUDIO;if(t==="main")return this.hls.audioTracks.length?cs.VIDEO:cs.MUXED}getTopBandwidth(e){let t=0,n;const i=this.hls;if(e===cs.AUDIO)n=i.audioTracks;else{const r=i.maxAutoLevel,o=r>-1?r+1:i.levels.length;n=i.levels.slice(0,o)}for(const r of n)r.bitrate>t&&(t=r.bitrate);return t>0?t:NaN}getBufferLength(e){const t=this.hls.media,n=e===cs.AUDIO?this.audioBuffer:this.videoBuffer;return!n||!t?NaN:wt.bufferInfo(n,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(r){this.loader=void 0,this.loader=new n(r)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(r,o,a){t(r),this.loader.load(r,o,a)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(r){this.loader=void 0,this.loader=new n(r)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(r,o,a){t(r),this.loader.load(r,o,a)}}}}const zO=3e5;class jO{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=V.log.bind(V,"[content-steering]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;!e||(e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.ERROR,this.onError,this))}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(n=>n!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:n}=t;n!==null&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:n}=t;if((n==null?void 0:n.action)===ts.SendAlternateToPenaltyBox&&n.flags===Qs.MoveAllAlternatesMatchingHost){const i=this.levels;let r=this.pathwayPriority,o=this.pathwayId;if(t.context){const{groupId:a,pathwayId:l,type:c}=t.context;a&&i?o=this.getPathwayForGroupId(a,c,o):l&&(o=l)}o in this.penalizedPathways||(this.penalizedPathways[o]=performance.now()),!r&&i&&(r=i.reduce((a,l)=>(a.indexOf(l.pathwayId)===-1&&a.push(l.pathwayId),a),[])),r&&r.length>1&&(this.updatePathwayPriority(r),n.resolved=this.pathwayId!==o),n.resolved||V.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${o} levels: ${i&&i.length} priorities: ${JSON.stringify(r)} penalized: ${JSON.stringify(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length?(this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t):e}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this.pathwayPriority=e;let t;const n=this.penalizedPathways,i=performance.now();Object.keys(n).forEach(r=>{i-n[r]>zO&&delete n[r]});for(let r=0;r<e.length;r++){const o=e[r];if(o in n)continue;if(o===this.pathwayId)return;const a=this.hls.nextLoadLevel,l=this.hls.levels[a];if(t=this.getLevelsForPathway(o),t.length>0){this.log(`Setting Pathway to "${o}"`),this.pathwayId=o,Uv(t),this.hls.trigger(b.LEVELS_UPDATED,{levels:t});const c=this.hls.levels[a];l&&c&&this.levels&&(c.attrs["STABLE-VARIANT-ID"]!==l.attrs["STABLE-VARIANT-ID"]&&c.bitrate!==l.bitrate&&this.log(`Unstable Pathways change from bitrate ${l.bitrate} to ${c.bitrate}`),this.hls.nextLoadLevel=a);break}}}getPathwayForGroupId(e,t,n){const i=this.getLevelsForPathway(n).concat(this.levels||[]);for(let r=0;r<i.length;r++)if(t===rt.AUDIO_TRACK&&i[r].hasAudioGroup(e)||t===rt.SUBTITLE_TRACK&&i[r].hasSubtitleGroup(e))return i[r].pathwayId;return n}clonePathways(e){const t=this.levels;if(!t)return;const n={},i={};e.forEach(r=>{const{ID:o,"BASE-ID":a,"URI-REPLACEMENT":l}=r;if(t.some(u=>u.pathwayId===o))return;const c=this.getLevelsForPathway(a).map(u=>{const d=new Lt(u.attrs);d["PATHWAY-ID"]=o;const f=d.AUDIO&&`${d.AUDIO}_clone_${o}`,h=d.SUBTITLES&&`${d.SUBTITLES}_clone_${o}`;f&&(n[d.AUDIO]=f,d.AUDIO=f),h&&(i[d.SUBTITLES]=h,d.SUBTITLES=h);const p=S_(u.uri,d["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",l),g=new Zr({attrs:d,audioCodec:u.audioCodec,bitrate:u.bitrate,height:u.height,name:u.name,url:p,videoCodec:u.videoCodec,width:u.width});if(u.audioGroups)for(let m=1;m<u.audioGroups.length;m++)g.addGroupId("audio",`${u.audioGroups[m]}_clone_${o}`);if(u.subtitleGroups)for(let m=1;m<u.subtitleGroups.length;m++)g.addGroupId("text",`${u.subtitleGroups[m]}_clone_${o}`);return g});t.push(...c),T1(this.audioTracks,n,l,o),T1(this.subtitleTracks,i,l,o)})}loadSteeringManifest(e){const t=this.hls.config,n=t.loader;this.loader&&this.loader.destroy(),this.loader=new n(t);let i;try{i=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(i.protocol!=="data:"){const u=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;i.searchParams.set("_HLS_pathway",this.pathwayId),i.searchParams.set("_HLS_throughput",""+u)}const r={responseType:"json",url:i.href},o=t.steeringManifestLoadPolicy.default,a=o.errorRetry||o.timeoutRetry||{},l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},c={onSuccess:(u,d,f,h)=>{this.log(`Loaded steering manifest: "${i}"`);const p=u.data;if(p.VERSION!==1){this.log(`Steering VERSION ${p.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=p.TTL;const{"RELOAD-URI":g,"PATHWAY-CLONES":m,"PATHWAY-PRIORITY":_}=p;if(g)try{this.uri=new self.URL(g,i).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${g}`);return}this.scheduleRefresh(this.uri||f.url),m&&this.clonePathways(m);const y={steeringManifest:p,url:i.toString()};this.hls.trigger(b.STEERING_MANIFEST_LOADED,y),_&&this.updatePathwayPriority(_)},onError:(u,d,f,h)=>{if(this.log(`Error loading steering manifest: ${u.code} ${u.text} (${d.url})`),this.stopLoad(),u.code===410){this.enabled=!1,this.log(`Steering manifest ${d.url} no longer available`);return}let p=this.timeToLoad*1e3;if(u.code===429){const g=this.loader;if(typeof(g==null?void 0:g.getResponseHeader)=="function"){const m=g.getResponseHeader("Retry-After");m&&(p=parseFloat(m)*1e3)}this.log(`Steering manifest ${d.url} rate limited`);return}this.scheduleRefresh(this.uri||d.url,p)},onTimeout:(u,d,f)=>{this.log(`Timeout loading steering manifest (${d.url})`),this.scheduleRefresh(this.uri||d.url)}};this.log(`Requesting steering manifest: ${i}`),this.loader.load(r,l,c)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var n;const i=(n=this.hls)==null?void 0:n.media;if(i&&!i.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function T1(s,e,t,n){!s||Object.keys(e).forEach(i=>{const r=s.filter(o=>o.groupId===i).map(o=>{const a=Vt({},o);return a.details=void 0,a.attrs=new Lt(a.attrs),a.url=a.attrs.URI=S_(o.url,o.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),a.groupId=a.attrs["GROUP-ID"]=e[i],a.attrs["PATHWAY-ID"]=n,a});s.push(...r)})}function S_(s,e,t,n){const{HOST:i,PARAMS:r,[t]:o}=n;let a;e&&(a=o==null?void 0:o[e],a&&(s=a));const l=new self.URL(s);return i&&!a&&(l.host=i),r&&Object.keys(r).sort().forEach(c=>{c&&l.searchParams.set(c,r[c])}),l.href}const qO=/^age:\s*[\d.]+\s*$/im;class E_{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new mc,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null,this.stats=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const n=this.loader=new self.XMLHttpRequest,i=this.stats;i.loading.first=0,i.loaded=0,i.aborted=!1;const r=this.xhrSetup;r?Promise.resolve().then(()=>{if(!this.stats.aborted)return r(n,t.url)}).catch(o=>(n.open("GET",t.url,!0),r(n,t.url))).then(()=>{this.stats.aborted||this.openAndSendXhr(n,t,e)}).catch(o=>{this.callbacks.onError({code:n.status,text:o.message},t,n,i)}):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);const i=t.headers,{maxTimeToFirstByteMs:r,maxLoadTimeMs:o}=n.loadPolicy;if(i)for(const a in i)e.setRequestHeader(a,i[a]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=r&&Ee(r)?r:o,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:n}=this;if(!e||!t)return;const i=t.readyState,r=this.config;if(!n.aborted&&i>=2&&(n.loading.first===0&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),r.timeout!==r.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),r.timeout=r.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),i===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const o=t.status,a=t.responseType!=="text";if(o>=200&&o<300&&(a&&t.response||t.responseText!==null)){n.loading.end=Math.max(self.performance.now(),n.loading.first);const l=a?t.response:t.responseText,c=t.responseType==="arraybuffer"?l.byteLength:l.length;if(n.loaded=n.total=c,n.bwEstimate=n.total*8e3/(n.loading.end-n.loading.first),!this.callbacks)return;const u=this.callbacks.onProgress;if(u&&u(n,e,l,t),!this.callbacks)return;const d={url:t.responseURL,data:l,code:o};this.callbacks.onSuccess(d,n,e,t)}else{const l=r.loadPolicy.errorRetry,c=n.retry,u={url:e.url,data:void 0,code:o};Ml(l,c,!1,u)?this.retry(l):(V.error(`${o} while loading ${e.url}`),this.callbacks.onError({code:o,text:t.statusText},e,t,n))}}}loadtimeout(){var e;const t=(e=this.config)==null?void 0:e.loadPolicy.timeoutRetry,n=this.stats.retry;if(Ml(t,n,!0))this.retry(t);else{var i;V.warn(`timeout while loading ${(i=this.context)==null?void 0:i.url}`);const r=this.callbacks;r&&(this.abortInternal(),r.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:n}=this;this.retryDelay=Mf(e,n.retry),n.retry++,V.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t==null?void 0:t.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&qO.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}function KO(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const WO=/(\d+)-(\d+)\/(\d+)/;class C1{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||QO,this.controller=new self.AbortController,this.stats=new mc}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){const i=this.stats;if(i.loading.start)throw new Error("Loader can only be used once.");i.loading.start=self.performance.now();const r=YO(e,this.controller.signal),o=n.onProgress,a=e.responseType==="arraybuffer",l=a?"byteLength":"length",{maxTimeToFirstByteMs:c,maxLoadTimeMs:u}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,r),self.clearTimeout(this.requestTimeout),t.timeout=c&&Ee(c)?c:u,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(i,e,this.response)},t.timeout),self.fetch(this.request).then(d=>{this.response=this.loader=d;const f=Math.max(self.performance.now(),i.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=u,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(i,e,this.response)},u-(f-i.loading.start)),!d.ok){const{status:h,statusText:p}=d;throw new JO(p||"fetch, bad network response",h,d)}return i.loading.first=f,i.total=XO(d.headers)||i.total,o&&Ee(t.highWaterMark)?this.loadProgressively(d,i,e,t.highWaterMark,o):a?d.arrayBuffer():e.responseType==="json"?d.json():d.text()}).then(d=>{const f=this.response;if(!f)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),i.loading.end=Math.max(self.performance.now(),i.loading.first);const h=d[l];h&&(i.loaded=i.total=h);const p={url:f.url,data:d,code:f.status};o&&!Ee(t.highWaterMark)&&o(i,e,d,f),n.onSuccess(p,i,e,f)}).catch(d=>{if(self.clearTimeout(this.requestTimeout),i.aborted)return;const f=d&&d.code||0,h=d?d.message:null;n.onError({code:f,text:h},e,d?d.details:null,i)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,i=0,r){const o=new jv,a=e.body.getReader(),l=()=>a.read().then(c=>{if(c.done)return o.dataLength&&r(t,n,o.flush(),e),Promise.resolve(new ArrayBuffer(0));const u=c.value,d=u.length;return t.loaded+=d,d<i||o.dataLength?(o.push(u),o.dataLength>=i&&r(t,n,o.flush(),e)):r(t,n,u,e),l()}).catch(()=>Promise.reject());return l()}}function YO(s,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(Vt({},s.headers))};return s.rangeEnd&&t.headers.set("Range","bytes="+s.rangeStart+"-"+String(s.rangeEnd-1)),t}function ZO(s){const e=WO.exec(s);if(e)return parseInt(e[2])-parseInt(e[1])+1}function XO(s){const e=s.get("Content-Range");if(e){const n=ZO(e);if(Ee(n))return n}const t=s.get("Content-Length");if(t)return parseInt(t)}function QO(s,e){return new self.Request(s.url,e)}class JO extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}}const eM=/\s/,tM={newCue(s,e,t,n){const i=[];let r,o,a,l,c;const u=self.VTTCue||self.TextTrackCue;for(let f=0;f<n.rows.length;f++)if(r=n.rows[f],a=!0,l=0,c="",!r.isEmpty()){var d;for(let g=0;g<r.chars.length;g++)eM.test(r.chars[g].uchar)&&a?l++:(c+=r.chars[g].uchar,a=!1);r.cueStartTime=e,e===t&&(t+=1e-4),l>=16?l--:l++;const h=h_(c.trim()),p=Kf(e,t,h);s!=null&&(d=s.cues)!=null&&d.getCueById(p)||(o=new u(e,t,h),o.id=p,o.line=f+1,o.align="left",o.position=10+Math.min(80,Math.floor(l*8/32)*10),i.push(o))}return s&&i.length&&(i.sort((f,h)=>f.line==="auto"||h.line==="auto"?0:f.line>8&&h.line>8?h.line-f.line:f.line-h.line),i.forEach(f=>$v(s,f))),i}},sM={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},T_=Zt(Zt({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:E_,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:DP,bufferController:MF,capLevelController:Wf,errorController:xP,fpsController:aO,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:Sv,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,useMediaCapabilities:!0,certLoadPolicy:{default:sM},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},nM()),{},{subtitleStreamController:DF,subtitleTrackController:FF,timelineController:rO,audioStreamController:RF,audioTrackController:IF,emeController:Vr,cmcdController:GO,contentSteeringController:jO});function nM(){return{cueHandler:tM,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function iM(s,e){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const t=Ad(s),n=["manifest","level","frag"],i=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return n.forEach(r=>{const o=`${r==="level"?"playlist":r}LoadPolicy`,a=e[o]===void 0,l=[];i.forEach(c=>{const u=`${r}Loading${c}`,d=e[u];if(d!==void 0&&a){l.push(u);const f=t[o].default;switch(e[o]={default:f},c){case"TimeOut":f.maxLoadTimeMs=d,f.maxTimeToFirstByteMs=d;break;case"MaxRetry":f.errorRetry.maxNumRetry=d,f.timeoutRetry.maxNumRetry=d;break;case"RetryDelay":f.errorRetry.retryDelayMs=d,f.timeoutRetry.retryDelayMs=d;break;case"MaxRetryTimeout":f.errorRetry.maxRetryDelayMs=d,f.timeoutRetry.maxRetryDelayMs=d;break}}}),l.length&&V.warn(`hls.js config: "${l.join('", "')}" setting(s) are deprecated, use "${o}": ${JSON.stringify(e[o])}`)}),Zt(Zt({},t),e)}function Ad(s){return s&&typeof s=="object"?Array.isArray(s)?s.map(Ad):Object.keys(s).reduce((e,t)=>(e[t]=Ad(s[t]),e),{}):s}function rM(s){const e=s.loader;e!==C1&&e!==E_?(V.log("[config]: Custom loader detected, cannot enable progressive streaming"),s.progressive=!1):KO()&&(s.loader=C1,s.progressive=!0,s.enableSoftwareAES=!0,V.log("[config]: Progressive streaming enabled, using FetchLoader"))}let hu;class oM extends $f{constructor(e,t){super(e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(b.LEVEL_LOADED,this.onLevelLoaded,this),e.on(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(b.FRAG_BUFFERED,this.onFragBuffered,this),e.on(b.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(b.LEVEL_LOADED,this.onLevelLoaded,this),e.off(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(b.FRAG_BUFFERED,this.onFragBuffered,this),e.off(b.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const n=this.hls.config.preferManagedMediaSource,i=[],r={},o={};let a=!1,l=!1,c=!1;t.levels.forEach(u=>{var d,f;const h=u.attrs;let{audioCodec:p,videoCodec:g}=u;((d=p)==null?void 0:d.indexOf("mp4a.40.34"))!==-1&&(hu||(hu=/chrome|firefox/i.test(navigator.userAgent)),hu&&(u.audioCodec=p=void 0)),p&&(u.audioCodec=p=Pl(p,n)),((f=g)==null?void 0:f.indexOf("avc1"))===0&&(g=u.videoCodec=YD(g));const{width:m,height:_,unknownCodecs:y}=u;if(a||(a=!!(m&&_)),l||(l=!!g),c||(c=!!p),y!=null&&y.length||p&&!Qc(p,"audio",n)||g&&!Qc(g,"video",n))return;const{CODECS:S,"FRAME-RATE":C,"HDCP-LEVEL":E,"PATHWAY-ID":A,RESOLUTION:R,"VIDEO-RANGE":I}=h,L=`${`${A||"."}-`}${u.bitrate}-${R}-${C}-${S}-${I}-${E}`;if(r[L])if(r[L].uri!==u.url&&!u.attrs["PATHWAY-ID"]){const M=o[L]+=1;u.attrs["PATHWAY-ID"]=new Array(M+1).join(".");const $=new Zr(u);r[L]=$,i.push($)}else r[L].addGroupId("audio",h.AUDIO),r[L].addGroupId("text",h.SUBTITLES);else{const M=new Zr(u);r[L]=M,o[L]=1,i.push(M)}}),this.filterAndSortMediaOptions(i,t,a,l,c)}filterAndSortMediaOptions(e,t,n,i,r){let o=[],a=[],l=e;if((n||i)&&r&&(l=l.filter(({videoCodec:p,videoRange:g,width:m,height:_})=>(!!p||!!(m&&_))&&lP(g))),l.length===0){Promise.resolve().then(()=>{if(this.hls){t.levels.length&&this.warn(`One or more CODECS in variant not supported: ${JSON.stringify(t.levels[0].attrs)}`);const p=new Error("no level with compatible codecs found in manifest");this.hls.trigger(b.ERROR,{type:Ge.MEDIA_ERROR,details:j.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:p,reason:p.message})}});return}if(t.audioTracks){const{preferManagedMediaSource:p}=this.hls.config;o=t.audioTracks.filter(g=>!g.audioCodec||Qc(g.audioCodec,"audio",p)),A1(o)}t.subtitles&&(a=t.subtitles,A1(a));const c=l.slice(0);l.sort((p,g)=>{if(p.attrs["HDCP-LEVEL"]!==g.attrs["HDCP-LEVEL"])return(p.attrs["HDCP-LEVEL"]||"")>(g.attrs["HDCP-LEVEL"]||"")?1:-1;if(n&&p.height!==g.height)return p.height-g.height;if(p.frameRate!==g.frameRate)return p.frameRate-g.frameRate;if(p.videoRange!==g.videoRange)return Fl.indexOf(p.videoRange)-Fl.indexOf(g.videoRange);if(p.videoCodec!==g.videoCodec){const m=Dp(p.videoCodec),_=Dp(g.videoCodec);if(m!==_)return _-m}if(p.uri===g.uri&&p.codecSet!==g.codecSet){const m=Dl(p.codecSet),_=Dl(g.codecSet);if(m!==_)return _-m}return p.averageBitrate!==g.averageBitrate?p.averageBitrate-g.averageBitrate:0});let u=c[0];if(this.steering&&(l=this.steering.filterParsedLevels(l),l.length!==c.length)){for(let p=0;p<c.length;p++)if(c[p].pathwayId===l[0].pathwayId){u=c[p];break}}this._levels=l;for(let p=0;p<l.length;p++)if(l[p]===u){var d;this._firstLevel=p;const g=u.bitrate,m=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${l.length} level(s) found, first bitrate: ${g}`),((d=this.hls.userConfig)==null?void 0:d.abrEwmaDefaultEstimate)===void 0){const _=Math.min(g,this.hls.config.abrEwmaDefaultEstimateMax);_>m&&m===T_.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=_)}break}const f=r&&!i,h={levels:l,audioTracks:o,subtitleTracks:a,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:r,video:i,altAudio:!f&&o.some(p=>!!p.url)};this.hls.trigger(b.MANIFEST_PARSED,h),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return this._levels.length===0?null:this._levels}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const u=new Error("invalid level idx"),d=e<0;if(this.hls.trigger(b.ERROR,{type:Ge.OTHER_ERROR,details:j.LEVEL_SWITCH_ERROR,level:e,fatal:d,error:u,reason:u.message}),d)return;e=Math.min(e,t.length-1)}const n=this.currentLevelIndex,i=this.currentLevel,r=i?i.attrs["PATHWAY-ID"]:void 0,o=t[e],a=o.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=o,n===e&&o.details&&i&&r===a)return;this.log(`Switching to level ${e} (${o.height?o.height+"p ":""}${o.videoRange?o.videoRange+" ":""}${o.codecSet?o.codecSet+" ":""}@${o.bitrate})${a?" with Pathway "+a:""} from level ${n}${r?" with Pathway "+r:""}`);const l={level:e,attrs:o.attrs,details:o.details,bitrate:o.bitrate,averageBitrate:o.averageBitrate,maxBitrate:o.maxBitrate,realBitrate:o.realBitrate,width:o.width,height:o.height,codecSet:o.codecSet,audioCodec:o.audioCodec,videoCodec:o.videoCodec,audioGroups:o.audioGroups,subtitleGroups:o.subtitleGroups,loaded:o.loaded,loadError:o.loadError,fragmentError:o.fragmentError,name:o.name,id:o.id,uri:o.uri,url:o.url,urlId:0,audioGroupIds:o.audioGroupIds,textGroupIds:o.textGroupIds};this.hls.trigger(b.LEVEL_SWITCHING,l);const c=o.details;if(!c||c.live){const u=this.switchParams(o.uri,i==null?void 0:i.details);this.loadPlaylist(u)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){t.fatal||!t.context||t.context.type===rt.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===He.MAIN){const n=t.elementaryStreams;if(!Object.keys(n).some(r=>!!n[r]))return;const i=this._levels[t.level];i!=null&&i.loadError&&(this.log(`Resetting level error count of ${i.loadError} on frag buffered`),i.loadError=0)}}onLevelLoaded(e,t){var n;const{level:i,details:r}=t,o=this._levels[i];if(!o){var a;this.warn(`Invalid level index ${i}`),(a=t.deliveryDirectives)!=null&&a.skip&&(r.deltaUpdateFailed=!0);return}i===this.currentLevelIndex?(o.fragmentError===0&&(o.loadError=0),this.playlistLoaded(i,t,o.details)):(n=t.deliveryDirectives)!=null&&n.skip&&(r.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist();const t=this.currentLevelIndex,n=this.currentLevel;if(n&&this.shouldLoadPlaylist(n)){let i=n.uri;if(e)try{i=e.addDirectives(i)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}const r=n.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${(e==null?void 0:e.msn)!==void 0?" at sn "+e.msn+" part "+e.part:""} with${r?" Pathway "+r:""} ${i}`),this.clearTimer(),this.hls.trigger(b.LEVEL_LOADING,{url:i,level:t,pathwayId:n.attrs["PATHWAY-ID"],id:0,deliveryDirectives:e||null})}}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;const n=this._levels.filter((i,r)=>r!==e?!0:(this.steering&&this.steering.removeLevel(i),i===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,i.details&&i.details.fragments.forEach(o=>o.level=-1)),!1));Uv(n),this._levels=n,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.hls.trigger(b.LEVELS_UPDATED,{levels:n})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:n}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(b.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))}}function A1(s){const e={};s.forEach(t=>{const n=t.groupId||"";t.id=e[n]=e[n]||0,e[n]++})}class aM{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const n in this.keyUriToKeyInfo){const i=this.keyUriToKeyInfo[n].loader;if(i){var t;if(e&&e!==((t=i.context)==null?void 0:t.frag.type))return;i.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=j.KEY_LOAD_ERROR,n,i,r){return new Fn({type:Ge.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:r,error:n,networkDetails:i})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:n,cc:i}=e;for(let r=0;r<t.length;r++){const o=t[r];if(i<=o.cc&&(n==="initSegment"||o.sn==="initSegment"||n<o.sn)){this.emeController.selectKeySystemFormat(o).then(a=>{o.setKeyFormat(a)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var n,i;t&&e.setKeyFormat(t);const r=e.decryptdata;if(!r){const c=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,j.KEY_LOAD_ERROR,c))}const o=r.uri;if(!o)return Promise.reject(this.createKeyLoadError(e,j.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${o}"`)));let a=this.keyUriToKeyInfo[o];if((n=a)!=null&&n.decryptdata.key)return r.key=a.decryptdata.key,Promise.resolve({frag:e,keyInfo:a});if((i=a)!=null&&i.keyLoadPromise){var l;switch((l=a.mediaKeySessionContext)==null?void 0:l.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return a.keyLoadPromise.then(c=>(r.key=c.keyInfo.decryptdata.key,{frag:e,keyInfo:a}))}}switch(a=this.keyUriToKeyInfo[o]={decryptdata:r,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},r.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return r.keyFormat==="identity"?this.loadKeyHTTP(a,e):this.loadKeyEME(a,e);case"AES-128":return this.loadKeyHTTP(a,e);default:return Promise.reject(this.createKeyLoadError(e,j.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${r.method}"`)))}}loadKeyEME(e,t){const n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const i=this.emeController.loadKey(n);if(i)return(e.keyLoadPromise=i.then(r=>(e.mediaKeySessionContext=r,n))).catch(r=>{throw e.keyLoadPromise=null,r})}return Promise.resolve(n)}loadKeyHTTP(e,t){const n=this.config,i=n.loader,r=new i(n);return t.keyLoader=e.loader=r,e.keyLoadPromise=new Promise((o,a)=>{const l={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},c=n.keyLoadPolicy.default,u={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(f,h,p,g)=>{const{frag:m,keyInfo:_,url:y}=p;if(!m.decryptdata||_!==this.keyUriToKeyInfo[y])return a(this.createKeyLoadError(m,j.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),g));_.decryptdata.key=m.decryptdata.key=new Uint8Array(f.data),m.keyLoader=null,_.loader=null,o({frag:m,keyInfo:_})},onError:(f,h,p,g)=>{this.resetLoader(h),a(this.createKeyLoadError(t,j.KEY_LOAD_ERROR,new Error(`HTTP Error ${f.code} loading key ${f.text}`),p,Zt({url:l.url,data:void 0},f)))},onTimeout:(f,h,p)=>{this.resetLoader(h),a(this.createKeyLoadError(t,j.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),p))},onAbort:(f,h,p)=>{this.resetLoader(h),a(this.createKeyLoadError(t,j.INTERNAL_ABORTED,new Error("key loading aborted"),p))}};r.load(l,u,d)})}resetLoader(e){const{frag:t,keyInfo:n,url:i}=e,r=n.loader;t.keyLoader===r&&(t.keyLoader=null,n.loader=null),delete this.keyUriToKeyInfo[i],r&&r.destroy()}}function C_(){return self.SourceBuffer||self.WebKitSourceBuffer}function A_(){if(!no())return!1;const e=C_();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function lM(){if(!A_())return!1;const s=no();return typeof(s==null?void 0:s.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>s.isTypeSupported(qo(e,"video")))||["mp4a.40.2","fLaC"].some(e=>s.isTypeSupported(qo(e,"audio"))))}function cM(){var s;const e=C_();return typeof(e==null||(s=e.prototype)==null?void 0:s.changeType)=="function"}const uM=250,il=2,dM=.1,fM=.05;class hM{constructor(e,t,n,i){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=n,this.hls=i}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){const{config:n,media:i,stalled:r}=this;if(i===null)return;const{currentTime:o,seeking:a}=i,l=this.seeking&&!a,c=!this.seeking&&a;if(this.seeking=a,o!==e){if(this.moved=!0,a||(this.nudgeRetry=0),r!==null){if(this.stallReported){const m=self.performance.now()-r;V.warn(`playback not stuck anymore @${o}, after ${Math.round(m)}ms`),this.stallReported=!1}this.stalled=null}return}if(c||l){this.stalled=null;return}if(i.paused&&!a||i.ended||i.playbackRate===0||!wt.getBuffered(i).length){this.nudgeRetry=0;return}const u=wt.bufferInfo(i,o,0),d=u.nextStart||0;if(a){const m=u.len>il,_=!d||t&&t.start<=o||d-o>il&&!this.fragmentTracker.getPartialFragment(o);if(m||_)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var f;if(!(u.len>0)&&!d)return;const _=Math.max(d,u.start||0)-o,y=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,C=(y==null||(f=y.details)==null?void 0:f.live)?y.details.targetduration*2:il,E=this.fragmentTracker.getPartialFragment(o);if(_>0&&(_<=C||E)){i.paused||this._trySkipBufferHole(E);return}}const h=self.performance.now();if(r===null){this.stalled=h;return}const p=h-r;if(!a&&p>=uM&&(this._reportStall(u),!this.media))return;const g=wt.bufferInfo(i,o,n.maxBufferHole);this._tryFixBufferStall(g,p)}_tryFixBufferStall(e,t){const{config:n,fragmentTracker:i,media:r}=this;if(r===null)return;const o=r.currentTime,a=i.getPartialFragment(o);a&&(this._trySkipBufferHole(a)||!this.media)||(e.len>n.maxBufferHole||e.nextStart&&e.nextStart-o<n.maxBufferHole)&&t>n.highBufferWatchdogPeriod*1e3&&(V.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){const{hls:t,media:n,stallReported:i}=this;if(!i&&n){this.stallReported=!0;const r=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${JSON.stringify(e)})`);V.warn(r.message),t.trigger(b.ERROR,{type:Ge.MEDIA_ERROR,details:j.BUFFER_STALLED_ERROR,fatal:!1,error:r,buffer:e.len})}}_trySkipBufferHole(e){const{config:t,hls:n,media:i}=this;if(i===null)return 0;const r=i.currentTime,o=wt.bufferInfo(i,r,0),a=r<o.start?o.start:o.nextStart;if(a){const l=o.len<=t.maxBufferHole,c=o.len>0&&o.len<1&&i.readyState<3,u=a-r;if(u>0&&(l||c)){if(u>t.maxBufferHole){const{fragmentTracker:f}=this;let h=!1;if(r===0){const p=f.getAppendedFrag(0,He.MAIN);p&&a<p.end&&(h=!0)}if(!h){const p=e||f.getAppendedFrag(r,He.MAIN);if(p){let g=!1,m=p.end;for(;m<a;){const _=f.getPartialFragment(m);if(_)m+=_.duration;else{g=!0;break}}if(g)return 0}}}const d=Math.max(a+fM,r+dM);if(V.warn(`skipping hole, adjusting currentTime from ${r} to ${d}`),this.moved=!0,this.stalled=null,i.currentTime=d,e&&!e.gap){const f=new Error(`fragment loaded with buffer holes, seeking from ${r} to ${d}`);n.trigger(b.ERROR,{type:Ge.MEDIA_ERROR,details:j.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:f,reason:f.message,frag:e})}return d}}return 0}_tryNudgeBuffer(){const{config:e,hls:t,media:n,nudgeRetry:i}=this;if(n===null)return;const r=n.currentTime;if(this.nudgeRetry++,i<e.nudgeMaxRetry){const o=r+(i+1)*e.nudgeOffset,a=new Error(`Nudging 'currentTime' from ${r} to ${o}`);V.warn(a.message),n.currentTime=o,t.trigger(b.ERROR,{type:Ge.MEDIA_ERROR,details:j.BUFFER_NUDGE_ON_STALL,error:a,fatal:!1})}else{const o=new Error(`Playhead still not moving while enough data buffered @${r} after ${e.nudgeMaxRetry} nudges`);V.error(o.message),t.trigger(b.ERROR,{type:Ge.MEDIA_ERROR,details:j.BUFFER_STALLED_ERROR,error:o,fatal:!0})}}}const pM=100;class gM extends Bf{constructor(e,t,n){super(e,t,n,"[stream-controller]",He.MAIN),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.LEVEL_LOADING,this.onLevelLoading,this),e.on(b.LEVEL_LOADED,this.onLevelLoaded,this),e.on(b.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(b.ERROR,this.onError,this),e.on(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(b.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(b.BUFFER_CREATED,this.onBufferCreated,this),e.on(b.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(b.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.LEVEL_LOADED,this.onLevelLoaded,this),e.off(b.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(b.ERROR,this.onError,this),e.off(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(b.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(b.BUFFER_CREATED,this.onBufferCreated,this),e.off(b.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(b.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying()}startLoad(e){if(this.levels){const{lastCurrentTime:t,hls:n}=this;if(this.stopLoad(),this.setInterval(pM),this.level=-1,!this.startFragRequested){let i=n.startLevel;i===-1&&(n.config.testBandwidth&&this.levels.length>1?(i=0,this.bitrateTest=!0):i=n.firstAutoLevel),n.nextLoadLevel=i,this.level=n.loadLevel,this.loadedmetadata=!1}t>0&&e===-1&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state=J.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=J.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case J.WAITING_LEVEL:{const{levels:t,level:n}=this,i=t==null?void 0:t[n],r=i==null?void 0:i.details;if(r&&(!r.live||this.levelLastLoaded===i)){if(this.waitForCdnTuneIn(r))break;this.state=J.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=J.IDLE;break}break}case J.FRAG_LOADING_WAITING_RETRY:{var e;const t=self.performance.now(),n=this.retryDate;if(!n||t>=n||(e=this.media)!=null&&e.seeking){const{levels:i,level:r}=this,o=i==null?void 0:i[r];this.resetStartWhenNotLoaded(o||null),this.state=J.IDLE}}break}this.state===J.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:n,media:i}=this,{config:r,nextLoadLevel:o}=e;if(t===null||!i&&(this.startFragRequested||!r.startFragPrefetch)||this.altAudio&&this.audioOnly||!(n!=null&&n[o]))return;const a=n[o],l=this.getMainFwdBufferInfo();if(l===null)return;const c=this.getLevelDetails();if(c&&this._streamEnded(l,c)){const m={};this.altAudio&&(m.type="video"),this.hls.trigger(b.BUFFER_EOS,m),this.state=J.ENDED;return}e.loadLevel!==o&&e.manualLevel===-1&&this.log(`Adapting to level ${o} from level ${this.level}`),this.level=e.nextLoadLevel=o;const u=a.details;if(!u||this.state===J.WAITING_LEVEL||u.live&&this.levelLastLoaded!==a){this.level=o,this.state=J.WAITING_LEVEL;return}const d=l.len,f=this.getMaxBufferLength(a.maxBitrate);if(d>=f)return;this.backtrackFragment&&this.backtrackFragment.start>l.end&&(this.backtrackFragment=null);const h=this.backtrackFragment?this.backtrackFragment.start:l.end;let p=this.getNextFragment(h,u);if(this.couldBacktrack&&!this.fragPrevious&&p&&p.sn!=="initSegment"&&this.fragmentTracker.getState(p)!==Wt.OK){var g;const _=((g=this.backtrackFragment)!=null?g:p).sn-u.startSN,y=u.fragments[_-1];y&&p.cc===y.cc&&(p=y,this.fragmentTracker.removeFragment(y))}else this.backtrackFragment&&l.len&&(this.backtrackFragment=null);if(p&&this.isLoopLoading(p,h)){if(!p.gap){const _=this.audioOnly&&!this.altAudio?mt.AUDIO:mt.VIDEO,y=(_===mt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;y&&this.afterBufferFlushed(y,_,He.MAIN)}p=this.getNextFragmentLoopLoading(p,u,l,He.MAIN,f)}!p||(p.initSegment&&!p.initSegment.data&&!this.bitrateTest&&(p=p.initSegment),this.loadFragment(p,a,h))}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);this.fragCurrent=e,i===Wt.NOT_LOADED||i===Wt.PARTIAL?e.sn==="initSegment"?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,n)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,He.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let n;const i=this.getAppendedFrag(t.currentTime);i&&i.start>1&&this.flushMainBuffer(0,i.start-1);const r=this.getLevelDetails();if(r!=null&&r.live){const a=this.getMainFwdBufferInfo();if(!a||a.len<r.targetduration*2)return}if(!t.paused&&e){const a=this.hls.nextLoadLevel,l=e[a],c=this.fragLastKbps;c&&this.fragCurrent?n=this.fragCurrent.duration*l.maxBitrate/(1e3*c)+1:n=0}else n=0;const o=this.getBufferedFrag(t.currentTime+n);if(o){const a=this.followingBufferedFrag(o);if(a){this.abortCurrentFrag();const l=a.maxStartPTS?a.maxStartPTS:a.start,c=a.duration,u=Math.max(o.end,l+Math.min(Math.max(c-this.config.maxFragLookUpTolerance,c*(this.couldBacktrack?.5:.125)),c*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(u,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case J.KEY_LOADING:case J.FRAG_LOADING:case J.FRAG_LOADING_WAITING_RETRY:case J.PARSING:case J.PARSED:this.state=J.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const n=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),n.addEventListener("playing",this.onvplaying),n.addEventListener("seeked",this.onvseeked),this.gapController=new hM(this.config,n,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const e=this.media,t=e?e.currentTime:null;Ee(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);const n=this.getMainFwdBufferInfo();if(n===null||n.len===0){this.warn(`Main forward buffer length on "seeked" event ${n?n.len:"empty"})`);return}this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(b.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=this.fragLastKbps=0,this.levels=this.fragPlaying=this.backtrackFragment=this.levelLastLoaded=null,this.altAudio=this.audioOnly=this.startFragRequested=!1}onManifestParsed(e,t){let n=!1,i=!1;t.levels.forEach(r=>{const o=r.audioCodec;o&&(n=n||o.indexOf("mp4a.40.2")!==-1,i=i||o.indexOf("mp4a.40.5")!==-1)}),this.audioCodecSwitch=n&&i&&!cM(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:n}=this;if(!n||this.state!==J.IDLE)return;const i=n[t.level];(!i.details||i.details.live&&this.levelLastLoaded!==i||this.waitForCdnTuneIn(i.details))&&(this.state=J.WAITING_LEVEL)}onLevelLoaded(e,t){var n;const{levels:i}=this,r=t.level,o=t.details,a=o.totalduration;if(!i){this.warn(`Levels were reset while loading level ${r}`);return}this.log(`Level ${r} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""}, cc [${o.startCC}, ${o.endCC}] duration:${a}`);const l=i[r],c=this.fragCurrent;c&&(this.state===J.FRAG_LOADING||this.state===J.FRAG_LOADING_WAITING_RETRY)&&c.level!==t.level&&c.loader&&this.abortCurrentFrag();let u=0;if(o.live||(n=l.details)!=null&&n.live){var d;if(this.checkLiveUpdate(o),o.deltaUpdateFailed)return;u=this.alignPlaylists(o,l.details,(d=this.levelLastLoaded)==null?void 0:d.details)}if(l.details=o,this.levelLastLoaded=l,this.hls.trigger(b.LEVEL_UPDATED,{details:o,level:r}),this.state===J.WAITING_LEVEL){if(this.waitForCdnTuneIn(o))return;this.state=J.IDLE}this.startFragRequested?o.live&&this.synchronizeToLiveEdge(o):this.setStartPosition(o,u),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:i,payload:r}=e,{levels:o}=this;if(!o){this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const a=o[n.level],l=a.details;if(!l){this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),this.fragmentTracker.removeFragment(n);return}const c=a.videoCodec,u=l.PTSKnown||!l.live,d=(t=n.initSegment)==null?void 0:t.data,f=this._getAudioCodec(a),h=this.transmuxer=this.transmuxer||new a_(this.hls,He.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),p=i?i.index:-1,g=p!==-1,m=new Nf(n.level,n.sn,n.stats.chunkCount,r.byteLength,p,g),_=this.initPTS[n.cc];h.push(r,d,f,c,n,i,l.totalduration,u,m,_)}onAudioTrackSwitching(e,t){const n=this.altAudio;if(!!!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const o=this.fragCurrent;o&&(this.log("Switching to main audio track, cancel main fragment load"),o.abortRequests(),this.fragmentTracker.removeFragment(o)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const r=this.hls;n&&(r.trigger(b.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),r.trigger(b.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const n=t.id,i=!!this.hls.audioTracks[n].url;if(i){const r=this.videoBuffer;r&&this.mediaBuffer!==r&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=r)}this.altAudio=i,this.tick()}onBufferCreated(e,t){const n=t.tracks;let i,r,o=!1;for(const a in n){const l=n[a];if(l.id==="main"){if(r=a,i=l,a==="video"){const c=n[a];c&&(this.videoBuffer=c.buffer)}}else o=!0}o&&i?(this.log(`Alternate track found, use ${r}.buffered to schedule main fragment loading`),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:n,part:i}=t;if(n&&n.type!==He.MAIN)return;if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),this.state===J.PARSED&&(this.state=J.IDLE);return}const r=i?i.stats:n.stats;this.fragLastKbps=Math.round(8*r.total/(r.buffering.end-r.loading.first)),n.sn!=="initSegment"&&(this.fragPrevious=n),this.fragBufferedComplete(n,i)}onError(e,t){var n;if(t.fatal){this.state=J.ERROR;return}switch(t.details){case j.FRAG_GAP:case j.FRAG_PARSING_ERROR:case j.FRAG_DECRYPT_ERROR:case j.FRAG_LOAD_ERROR:case j.FRAG_LOAD_TIMEOUT:case j.KEY_LOAD_ERROR:case j.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(He.MAIN,t);break;case j.LEVEL_LOAD_ERROR:case j.LEVEL_LOAD_TIMEOUT:case j.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===J.WAITING_LEVEL&&((n=t.context)==null?void 0:n.type)===rt.LEVEL&&(this.state=J.IDLE);break;case j.BUFFER_APPEND_ERROR:case j.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="main")return;if(t.details===j.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case j.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}checkBuffer(){const{media:e,gapController:t}=this;if(!(!e||!t||!e.readyState)){if(this.loadedmetadata||!wt.getBuffered(e).length){const n=this.state!==J.IDLE?this.fragCurrent:null;t.poll(this.lastCurrentTime,n)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=J.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==mt.AUDIO||this.audioOnly&&!this.altAudio){const n=(t===mt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(n,t,He.MAIN),this.tick()}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let n=this.startPosition;if(n>=0&&t<n){if(e.seeking){this.log(`could not seek to ${n}, already seeking at ${t}`);return}const i=wt.getBuffered(e),o=(i.length?i.start(0):0)-n;o>0&&(o<this.config.maxBufferHole||o<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${o} to match buffer start`),n+=o,this.startPosition=n),this.log(`seek to target start position ${n} from current time ${t}`),e.currentTime=n}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(n=>{const{hls:i}=this;if(!n||this.fragContextChanged(e))return;t.fragmentError=0,this.state=J.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const r=e.stats;r.parsing.start=r.parsing.end=r.buffering.start=r.buffering.end=self.performance.now(),i.trigger(b.FRAG_LOADED,n),e.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const n="main",{hls:i}=this,{remuxResult:r,chunkMeta:o}=e,a=this.getCurrentContext(o);if(!a){this.resetWhenMissingContext(o);return}const{frag:l,part:c,level:u}=a,{video:d,text:f,id3:h,initSegment:p}=r,{details:g}=u,m=this.altAudio?void 0:r.audio;if(this.fragContextChanged(l)){this.fragmentTracker.removeFragment(l);return}if(this.state=J.PARSING,p){if(p!=null&&p.tracks){const S=l.initSegment||l;this._bufferInitSegment(u,p.tracks,S,o),i.trigger(b.FRAG_PARSING_INIT_SEGMENT,{frag:S,id:n,tracks:p.tracks})}const _=p.initPTS,y=p.timescale;Ee(_)&&(this.initPTS[l.cc]={baseTime:_,timescale:y},i.trigger(b.INIT_PTS_FOUND,{frag:l,id:n,initPTS:_,timescale:y}))}if(d&&g&&l.sn!=="initSegment"){const _=g.fragments[l.sn-1-g.startSN],y=l.sn===g.startSN,S=!_||l.cc>_.cc;if(r.independent!==!1){const{startPTS:C,endPTS:E,startDTS:A,endDTS:R}=d;if(c)c.elementaryStreams[d.type]={startPTS:C,endPTS:E,startDTS:A,endDTS:R};else if(d.firstKeyFrame&&d.independent&&o.id===1&&!S&&(this.couldBacktrack=!0),d.dropped&&d.independent){const I=this.getMainFwdBufferInfo(),D=(I?I.end:this.getLoadPosition())+this.config.maxBufferHole,L=d.firstKeyFramePTS?d.firstKeyFramePTS:C;if(!y&&D<L-this.config.maxBufferHole&&!S){this.backtrack(l);return}else S&&(l.gap=!0);l.setElementaryStreamInfo(d.type,l.start,E,l.start,R,!0)}else y&&C>il&&(l.gap=!0);l.setElementaryStreamInfo(d.type,C,E,A,R),this.backtrackFragment&&(this.backtrackFragment=l),this.bufferFragmentData(d,l,c,o,y||S)}else if(y||S)l.gap=!0;else{this.backtrack(l);return}}if(m){const{startPTS:_,endPTS:y,startDTS:S,endDTS:C}=m;c&&(c.elementaryStreams[mt.AUDIO]={startPTS:_,endPTS:y,startDTS:S,endDTS:C}),l.setElementaryStreamInfo(mt.AUDIO,_,y,S,C),this.bufferFragmentData(m,l,c,o)}if(g&&h!=null&&(t=h.samples)!=null&&t.length){const _={id:n,frag:l,details:g,samples:h.samples};i.trigger(b.FRAG_PARSING_METADATA,_)}if(g&&f){const _={id:n,frag:l,details:g,samples:f.samples};i.trigger(b.FRAG_PARSING_USERDATA,_)}}_bufferInitSegment(e,t,n,i){if(this.state!==J.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;const{audio:r,video:o,audiovideo:a}=t;if(r){let l=e.audioCodec;const c=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(l&&(l.indexOf("mp4a.40.5")!==-1?l="mp4a.40.2":l="mp4a.40.5"),r.metadata.channelCount!==1&&c.indexOf("firefox")===-1&&(l="mp4a.40.5")),l&&l.indexOf("mp4a.40.5")!==-1&&c.indexOf("android")!==-1&&r.container!=="audio/mpeg"&&(l="mp4a.40.2",this.log(`Android: force audio codec to ${l}`)),e.audioCodec&&e.audioCodec!==l&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${l}"`),r.levelCodec=l,r.id="main",this.log(`Init audio buffer, container:${r.container}, codecs[selected/level/parsed]=[${l||""}/${e.audioCodec||""}/${r.codec}]`)}o&&(o.levelCodec=e.videoCodec,o.id="main",this.log(`Init video buffer, container:${o.container}, codecs[level/parsed]=[${e.videoCodec||""}/${o.codec}]`)),a&&this.log(`Init audiovideo buffer, container:${a.container}, codecs[level/parsed]=[${e.codecs}/${a.codec}]`),this.hls.trigger(b.BUFFER_CODECS,t),Object.keys(t).forEach(l=>{const u=t[l].initSegment;u!=null&&u.byteLength&&this.hls.trigger(b.BUFFER_APPENDING,{type:l,data:u,frag:n,part:null,chunkMeta:i,parent:n.type})}),this.tickImmediate()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,He.MAIN)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=J.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const n=e.currentTime;if(wt.isBuffered(e,n)?t=this.getAppendedFrag(n):wt.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;const i=this.fragPlaying,r=t.level;(!i||t.sn!==i.sn||i.level!==r)&&(this.fragPlaying=t,this.hls.trigger(b.FRAG_CHANGED,{frag:t}),(!i||i.level!==r)&&this.hls.trigger(b.LEVEL_SWITCHED,{level:r}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){const e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){const e=this.media;if(e){const t=e.currentTime,n=this.currentFrag;if(n&&Ee(t)&&Ee(n.programDateTime)){const i=n.programDateTime+(t-n.start)*1e3;return new Date(i)}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class Nn{static get version(){return"1.5.4"}static isMSESupported(){return A_()}static isSupported(){return lM()}static getMediaSource(){return no()}static get Events(){return b}static get ErrorTypes(){return Ge}static get ErrorDetails(){return j}static get DefaultConfig(){return Nn.defaultConfig?Nn.defaultConfig:T_}static set DefaultConfig(e){Nn.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this.started=!1,this._emitter=new jf,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,this.triggeringException=void 0,aD(e.debug||!1,"Hls instance");const t=this.config=iM(Nn.DefaultConfig,e);this.userConfig=e,t.progressive&&rM(t);const{abrController:n,bufferController:i,capLevelController:r,errorController:o,fpsController:a}=t,l=new o(this),c=this.abrController=new n(this),u=this.bufferController=new i(this),d=this.capLevelController=new r(this),f=new a(this),h=new eP(this),p=new rP(this),g=t.contentSteeringController,m=g?new g(this):null,_=this.levelController=new oM(this,m),y=new FP(this),S=new aM(this.config),C=this.streamController=new gM(this,y,S);d.setStreamController(C),f.setStreamController(C);const E=[h,_,C];m&&E.splice(1,0,m),this.networkControllers=E;const A=[c,u,d,f,p,y];this.audioTrackController=this.createController(t.audioTrackController,E);const R=t.audioStreamController;R&&E.push(new R(this,y,S)),this.subtitleTrackController=this.createController(t.subtitleTrackController,E);const I=t.subtitleStreamController;I&&E.push(new I(this,y,S)),this.createController(t.timelineController,A),S.emeController=this.emeController=this.createController(t.emeController,A),this.cmcdController=this.createController(t.cmcdController,A),this.latencyController=this.createController(oP,A),this.coreComponents=A,E.push(l);const D=l.onErrorOut;typeof D=="function"&&this.on(b.ERROR,D,l)}createController(e,t){if(e){const n=new e(this);return t&&t.push(n),n}return null}on(e,t,n=this){this._emitter.on(e,t,n)}once(e,t,n=this){this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,n=this,i){this._emitter.off(e,t,n,i)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(n){if(V.error("An internal error happened while handling event "+e+'. Error message: "'+n.message+'". Here is a stacktrace:',n),!this.triggeringException){this.triggeringException=!0;const i=e===b.ERROR;this.trigger(b.ERROR,{type:Ge.OTHER_ERROR,details:j.INTERNAL_EXCEPTION,fatal:i,event:e,error:n}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){V.log("destroy"),this.trigger(b.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){V.log("attachMedia"),this._media=e,this.trigger(b.MEDIA_ATTACHING,{media:e})}detachMedia(){V.log("detachMedia"),this.trigger(b.MEDIA_DETACHING,void 0),this._media=null}loadSource(e){this.stopLoad();const t=this.media,n=this.url,i=this.url=Df.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,V.log(`loadSource:${i}`),t&&n&&(n!==i||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(b.MANIFEST_LOADING,{url:e})}startLoad(e=-1){V.log(`startLoad(${e})`),this.started=!0,this.networkControllers.forEach(t=>{t.startLoad(e)})}stopLoad(){V.log("stopLoad"),this.started=!1,this.networkControllers.forEach(e=>{e.stopLoad()})}resumeBuffering(){this.started&&this.networkControllers.forEach(e=>{"fragmentLoader"in e&&e.startLoad(-1)})}pauseBuffering(){this.networkControllers.forEach(e=>{"fragmentLoader"in e&&e.stopLoad()})}swapAudioCodec(){V.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){V.log("recoverMediaError");const e=this._media;this.detachMedia(),e&&this.attachMedia(e)}removeLevel(e){this.levelController.removeLevel(e)}get levels(){const e=this.levelController.levels;return e||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){V.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){V.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){V.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){V.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){V.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(V.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){aP(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const n=e.length;for(let i=0;i<n;i++)if(e[i].maxBitrate>=t)return i;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this;let i;if(t===-1&&e!=null&&e.length?i=e.length-1:i=t,n)for(let r=i;r--;){const o=e[r].attrs["HDCP-LEVEL"];if(o&&o<=n)return r}return i}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}setAudioOption(e){var t;return(t=this.audioTrackController)==null?void 0:t.setAudioOption(e)}setSubtitleOption(e){var t;return(t=this.subtitleTrackController)==null||t.setSubtitleOption(e),null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}Nn.defaultConfig=void 0;const mM={viewBox:"0 0 24 24",fill:"currentColor"},vM=["d"],Ys=De({__name:"MIcon",props:{path:{}},setup(s){const e=s;return(t,n)=>(x(),T("svg",mM,[v("path",{d:e.path},null,8,vM)]))}}),Fa=11526/51,pu=400,k1=De({__name:"HandyEmulator",props:{position:{default:0}},setup(s){const e=s,t=ue({});let n=null;const i=new Image;i.src="/handy.positions.vertical.webp",Xt(()=>{n=t.value.getContext("2d"),t.value.width=pu,t.value.height=Fa,r(e.position)}),dt(()=>e.position,()=>r(e.position));const r=o=>{if(!n)return;const a=Math.floor(o/100*51);n.drawImage(i,0,a*Fa,pu,Fa,0,0,pu,Fa)};return(o,a)=>(x(),T("canvas",{ref_key:"canvas",ref:t},null,512))}}),_M=De({__name:"RangeSlider",props:{modelValue:{}},emits:["update:modelValue"],setup(s,{emit:e}){const t=s,n=e,i=ue(!1),r=ue();Xt(()=>{document.addEventListener("mousemove",o),document.addEventListener("mouseup",l)}),Ci(()=>{document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",l)});const o=c=>{if(!i.value)return;const u=c.clientX,d=r.value.offsetWidth,{left:f}=r.value.getBoundingClientRect();let p=(u-f)/d;p>1&&(p=1),p<0&&(p=0),n("update:modelValue",p)},a=c=>{i.value=!0,o(c)},l=()=>{i.value=!1};return(c,u)=>(x(),T("div",null,[v("div",{class:"bg-white/20 relative cursor-pointer select-none w-full h-full rounded-full",ref_key:"seekbar",ref:r,onMousedown:a,onMouseup:l},[v("div",{class:"bg-white h-full rounded-l-full",style:Vs(`width: ${t.modelValue*100}%`)},null,4),v("div",{class:"h-3 w-3 absolute -top-1 rounded-full bg-white",style:Vs(`left: calc(${t.modelValue*100}% - 6px)`)},null,4)],544)]))}}),yM={class:"bg-white/50 rounded-full relative z-0 lg:!h-1",style:{height:"2px"}},xM=v("div",{class:"bg-white rounded-full",style:{height:"8px",width:"8px"}},null,-1),bM=[xM],wM=["viewBox"],SM=["id"],EM=["points"],TM=["clip-path"],CM=v("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"rgba(33,29,27,0.75)"},null,-1),L1=De({__name:"Seekbar",props:{value:{},max:{},actions:{}},emits:["seek"],setup(s,{emit:e}){const t=s,n=e,i=Math.random().toString(36).substr(2,9),r=ue(),o=ue({enabled:!1,progress:0,overallProgress:0});Xt(()=>{window.addEventListener("mousemove",a),window.addEventListener("mouseup",l)}),Ci(()=>{window.removeEventListener("mousemove",a),window.removeEventListener("mouseup",l)});const a=h=>{const p=h.touches?h.touches[0].clientX:h.clientX,g=r.value.offsetWidth,{left:m}=r.value.getBoundingClientRect();let y=(p-m)/g;y>1&&(y=1),y<0&&(y=0),o.value.overallProgress=y,o.value.enabled&&(o.value.progress=y)},l=()=>{!o.value.enabled||(n("seek",o.value.progress*t.max),o.value.enabled=!1)},c=h=>{o.value.enabled=!0,a(h)},u=ut(()=>o.value.enabled?o.value.progress*100:t.value/t.max*100),d=ut(()=>{if(!t.actions||!t.actions.length)return"";let h=Math.max(9/3600*t.max,.75);const p=[];let g=0,m="",_=0;for(let y=0;y<t.max;y+=h){const S=[];for(let E=_;E<t.actions.length;E++){if(t.actions[E][0]/1e3>=y+h){_=E;break}S.push(t.actions[E])}const C=f(S);C>g&&(g=C),p.push([y,C])}if(!p.length)return"";p[0][1]=0,p[p.length-1][1]=0;for(let y=0;y<p.length;y++){let S=p[y][1]/g*100;S=Math.round(Math.abs(100-S)),m+=`${p[y][0]},${S||0} `}return m}),f=h=>{let p=0;if(h.length===0)return p;for(let g=0;g<h.length-1;g++){let m=h[g],_=h[g+1];if(m[0]!==_[0]){if(_[0]<m[0]){let y=_;_=m,m=y}p+=1e3*Math.abs(_[1]-m[1])/Math.abs(_[0]-m[0])}}return p/h.length};return(h,p)=>(x(),T("div",{class:"w-full cursor-pointer py-2 touch-none select-none group",ref_key:"seekbar",ref:r,onMousedown:c,onTouchstart:c,onTouchmove:a,onTouchcancel:p[0]||(p[0]=g=>o.value.enabled=!1),onTouchend:l},[v("div",yM,[v("div",{class:"h-full bg-white rounded-l-full",style:Vs(`width: ${u.value}%`)},null,4),v("div",{class:Je(["absolute bg-zinc-300/20 rounded-full flex items-center justify-center top-1/2 transform -translate-y-1/2",{"!bg-zinc-300/50":o.value.enabled}]),style:Vs([{height:"22px",width:"22px"},`left: calc(${u.value}% - 11px)`])},bM,6),v("div",{class:Je(["absolute bg-zinc-900 shadow text-white text-sm font-medium rounded-full py-1 px-2 -top-16 lg:-top-10 hidden group-hover:block",{"!block":o.value.enabled}]),style:Vs(`left: calc(${o.value.overallProgress*100}% - 26.5px)`)},Z(w(Cr)(t.max*o.value.overallProgress)),7),(x(),T("svg",{viewBox:`0 0 ${t.max} 100`,preserveAspectRatio:"none",class:"absolute left-0 -z-10 w-full h-6 lg:!-top-6",style:{top:"-24px"}},[v("defs",null,[v("clipPath",{id:`hotspots-${w(i)}`,clipPathUnits:"userSpaceOnUse"},[v("polygon",{points:d.value},null,8,EM)],8,SM)]),v("g",{"clip-path":`url(#hotspots-${w(i)})`},[CM,v("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"#635b58",style:Vs(`transform: translate3d(-${100-u.value}%, 0px, 0px);`)},null,4)],8,TM)],8,wM))])],544))}}),AM={class:"flex flex-col"},kM={key:2,class:"font-medium text-center text-base lg:text-xl flex items-center flex-col"},LM=v("p",{class:"text-2xl font-medium"},"Interactive Content",-1),RM=v("span",{class:"text-zinc-300 mt-6"},"Please Buy or Connect your Handy to continue watching this video",-1),IM={class:"mt-3 mx-auto flex gap-3"},DM={key:0,class:"absolute right-4 top-4 rounded-lg bg-zinc-900/75 p-2 z-40 hidden lg:block lg:w-1/5 overflow-hidden"},PM={class:"bg-white rounded-lg w-full aspect-video overflow-hidden pointer-events-none"},FM=Yo('<div class="text-start"><p class="font-medium text-white">This Video is Interactive</p><p class="text-sm text-zinc-300">Feel what you see with <b class="font-medium text-white">The Handy</b> - the interactive, automatic stroker that syncs up with every <span class="font-medium text-white">FapTap</span> video</p></div><p>Use Code <b class="font-bold text-green-400">FAPTAP</b> for <b class="font-bold text-green-400">10% OFF</b></p>',2),OM={key:0,class:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"},MM={class:"font-medium"},$M={class:"flex items-center flex-grow"},NM={class:"flex justify-between items-center"},VM={class:"font-medium"},BM={key:0,class:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-white"},UM={class:"flex justify-between"},HM={class:"whitespace-nowrap",style:{"flex-basis":"96px","flex-grow":"0","flex-shrink":"0"}},GM={class:"font-bold"},zM={class:"flex gap-x-2 items-center group"},jM={class:"flex justify-between items-center gap-x-2"},qM={class:"bg-zinc-900 text-xs font-medium py-0.5 px-1.5 rounded-full shadow"},KM=v("video",{id:"player",playsinline:"",loop:"",class:"absolute w-full h-full bg-black"},null,-1),WM={class:"min-height-div text-white text-lg font-bold flex items-center justify-center"},YM={key:0,class:"rounded-lg bg-zinc-900/75 p-2 z-40 flex lg:hidden overflow-hidden"},ZM={class:"bg-white rounded-lg flex-grow max-w-full aspect-video overflow-hidden pointer-events-none"},XM={class:"flex flex-col flex-shrink max-w-xs"},QM=Yo('<div class="text-start"><p class="font-medium text-white">This Video is Interactive</p><p class="text-sm text-zinc-300">Feel what you see with <b class="font-medium text-white">The Handy</b> - the interactive, automatic stroker that syncs up with every <span class="font-medium text-white">FapTap</span> video</p></div><p>Use Code <b class="font-bold text-green-400">FAPTAP</b> for <b class="font-bold text-green-400">10% OFF</b></p>',2),JM=De({__name:"Player",props:{video:{}},setup(s){const e=s,t=or(),{handy:n,ui:i}=Gt(t),r=ue(),{isMobile:o}=Ai(),a=Ps({hls:new Nn,sources:[],actions:[],el:{},state:{settings:!1,state:1,ui:!0,currentTime:0,lastCurrentTime:0,duration:0,playing:!1,fullscreen:!1,loading:!0,source:void 0,volume:0},intervals:{status:-1,progress:-1},timeouts:{hidePlayer:-1}});Xt(async()=>{a.el=document.querySelector("#player");try{a.sources=await qe.videos.getSources(e.video.id)}catch(D){console.log(D)}if(!a.sources||!a.sources.length){a.state.message="No video sources found",a.state.state=2,Qo.capture("Video File Removed",{videoId:e.video.id});return}qe.videos.viewVideo(e.video.id).then();try{a.actions=await qe.videos.getScript(e.video.script.url)}catch(D){console.log(D),a.state.message="No video script found",a.state.state=2;return}document.addEventListener("keydown",l),a.state.volume=a.el.volume,a.state.duration=e.video.duration,a.el.addEventListener("loadedmetadata",()=>{a.state.duration=a.el.duration,a.state.lastCurrentTime>0&&h(a.state.lastCurrentTime),f(!1)}),a.el.addEventListener("canplay",()=>{a.state.loading=!1,a.state.playing&&n.value.play(Math.floor(a.state.currentTime*1e3))}),a.el.addEventListener("waiting",()=>{a.state.loading=!0,C()}),a.el.addEventListener("timeupdate",()=>{!(a&&a.el)||(a.state.currentTime=a.el.currentTime)}),a.el.addEventListener("volumechange",()=>{a.state.volume=a.el.volume}),a.el.addEventListener("pause",()=>{a.state.playing=!1,C()}),a.el.addEventListener("play",()=>{n.value.play(Math.floor(a.state.currentTime*1e3)),a.state.playing=!0,a.state.loading=!1}),document.addEventListener("fullscreenchange",()=>{a.state.fullscreen=document.fullscreenElement!==null}),document.addEventListener("webkitfullscreenchange",()=>{a.state.fullscreen=document.fullscreenElement!==null}),a.el.addEventListener("webkitendfullscreen",()=>{a.el.setAttribute("playsinline",""),a.state.fullscreen=!1}),a.intervals.status=setInterval(c,10),await S(),p(g(a.sources))}),Ci(()=>{a.hls.stopLoad(),document.removeEventListener("keydown",l),C(),clearInterval(a.intervals.status),clearInterval(a.intervals.progress)});const l=D=>{var L,M;if(!(((L=document.activeElement)==null?void 0:L.tagName.toLowerCase())==="input"||((M=document.activeElement)==null?void 0:M.tagName.toLowerCase())==="textarea"||!a.el)&&!(D.ctrlKey||D.shiftKey))switch(D.preventDefault(),D.key){case" ":a.state.playing&&(a.state.ui=!0),f(!1),m();break;case"ArrowRight":h(a.state.currentTime+10);break;case"ArrowLeft":h(a.state.currentTime-10);break;case"f":u();break}},c=()=>a.state.loading=a.el.readyState<3,u=()=>{const D=r.value;if(a.state.fullscreen)document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen();else{D.requestFullscreen?D.requestFullscreen():D.webkitRequestFullscreen?D.webkitRequestFullscreen():D.mozRequestFullScreen?D.mozRequestFullScreen():D.msRequestFullscreen?D.msRequestFullscreen():D.webkitEnterFullscreen&&D.webkitEnterFullscreen();const L=a.el;"webkitEnterFullscreen"in L&&(L.removeAttribute("playsinline"),L.webkitEnterFullscreen(),a.state.fullscreen=!0)}},d=D=>D.currentTime>0&&!D.paused&&!D.ended&&D.readyState>D.HAVE_CURRENT_DATA,f=async(D=!0)=>{d(a.el)?(a.el.pause(),D&&(a.state.ui=!0)):(a.state.shouldPlay=!1,a.el.play(),D&&(a.state.ui=!1))},h=D=>{a.el.currentTime=D,a.state.currentTime=D},p=(D,L)=>{if(a.state.lastCurrentTime=a.state.currentTime,a.state.source=D,a.state.loading=!0,D.format==="mp4")a.el.src=D.url.startsWith("http")?D.url:`/api/${D.url}`,f(!1);else if(D.format==="hls"){const M=D.url.startsWith("http")?D.url:`/api/${D.url}`;Nn.isSupported()?(a.hls.stopLoad(),a.hls.loadSource(M),a.hls.attachMedia(a.el),a.hls.on(Nn.Events.MANIFEST_PARSED,()=>f(!1))):(a.el.src=M,f(!1))}L&&localStorage.setItem("quality",D.quality)},g=D=>{const L=D.map(H=>parseInt(H.quality)),M=parseInt(localStorage.getItem("quality")||"")||720;let $=L.findIndex(H=>H<=M);return $>-1?D[$]:D[0]},m=()=>{clearTimeout(a.timeouts.hidePlayer),a.timeouts.hidePlayer=setTimeout(()=>{a.state.playing&&(a.state.ui=!1)},2500)},_=D=>a.el.volume=D;dt(()=>a.state.volume,D=>_(D));const y=ut(()=>a.state.duration>0?a.state.duration:e.video.duration/1e3),S=async()=>{try{a.state.message="Preparing...",a.state.state=1,a.el.pause(),await n.value.prepare(gi(e.video.script.url)),a.state.state=0,a.state.message=void 0;try{a.el.play().then()}catch{}}catch(D){console.log(D),a.state.state=2,a.state.message="Failed to prepare video"}};dt(()=>n.value.connected,async D=>{!D||await S()});const C=()=>{clearInterval(R),t.devices.forEach(D=>{switch(D.connector){case Cs.Handy:t.handy.stop();break;case Cs.Intiface:D.instance.stop();break;case Cs.Bluetooth:D.instance.stop();break}})},E=()=>{if(!a.el||!d(a.el)){requestAnimationFrame(E);return}const D=a.el.currentTime*1e3,L=a.actions;let M=-1;for(let te=0;te<L.length;te++)if(L[te][0]>=D){M=te;break}if(M===-1){requestAnimationFrame(E);return}const $=L[M],H=L[M-1],ie=$[0]-D;if(H!==void 0){const te=H[1]+($[1]-H[1])*(D-H[0])/($[0]-H[0]);I.value=Math.round(te)}if(M===A){requestAnimationFrame(E);return}A=M,console.log(`[Player] pos=${$[1]} in=${ie.toFixed(0)}ms`),t.devices.forEach(te=>{switch(te.connector){case Cs.OSR:t.osr.move($[1],ie);break;case Cs.LOOB:t.loob.move($[1],ie);break;case Cs.Handy:break;default:try{if(te.instance.messageAttributes(2)&&te.instance.linear(t.bluetooth.limit($[1])/100,ie),te.instance.messageAttributes(0)){clearInterval(R);const X=125,de=Math.floor(ie/X);let xe=0;R=setInterval(()=>{xe++;const le=xe/de;if(le>=1){clearInterval(R),te.instance.vibrate(t.bluetooth.limit(100-$[1])/100);return}let re=$[1]+(H[1]-$[1])*le;re=Math.max(0,Math.min(100,re)),te.instance.vibrate(t.bluetooth.limit(100-re)/100)},X)}te.instance.messageAttributes(1)&&te.instance.rotate(t.bluetooth.limit(100-$[1])/100,H[1]>$[1])}catch(X){console.log(X)}}}),requestAnimationFrame(E)};let A=-1,R=-1;const I=ue(0);return requestAnimationFrame(E),(D,L)=>{var M;return x(),T("div",AM,[v("div",{class:"relative aspect-video overflow-hidden",ref_key:"container",ref:r},[ht(v("div",{onClick:L[1]||(L[1]=()=>{a.state.state===3&&(w(i).open=!0)}),class:Je(["h-full w-full flex items-center justify-center absolute z-10 bg-black/90 text-white flex-col",{"cursor-pointer":a.state.state===3}])},[a.state.state===1?(x(),ae(Za,{key:0,class:"h-16 w-16 text-white",loading:!0})):a.state.state===2?(x(),ae(Ys,{key:1,path:w(q9),class:"h-16 w-16"},null,8,["path"])):pe("",!0),a.state.state===3?(x(),T("div",kM,[LM,RM,v("div",IM,[P(Me,{theme:"green",class:"mx-auto"},{default:z(()=>[W("Buy Or Connect")]),_:1}),P(Me,{onClick:L[0]||(L[0]=Is(()=>{},["stop"])),href:D.video.stream_url,target:"_blank",theme:"light"},{default:z(()=>[W("Continue Video")]),_:1},8,["href"])])])):(x(),T("span",{key:3,class:Je(["font-medium text-center text-xl absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 mt-12",{"text-base mt-16":!a.state.fullscreen}])},Z(a.state.message),3))],2),[[Kt,a.state.state!=0]]),!w(t).devices.length&&!w(o)?(x(),T("div",DM,[v("a",{href:"https://www.thehandy.com/?ref=faptap&utm_source=faptap&utm_medium=affiliate&utm_campaign=The+Handy+Affiliate+program&tap_s=3539267-2a196b&tm_subid1=player",target:"_blank","data-ph-capture-attribute-invideo-handy-ad":"1",onClick:L[2]||(L[2]=()=>{a.state.playing&&f()}),class:"leading-normal flex flex-col gap-2 w-full h-full"},[v("div",PM,[P(k1,{position:I.value,class:"w-full h-full"},null,8,["position"])]),FM,P(Me,{class:"w-full",theme:"green"},{default:z(()=>[W("Buy Now")]),_:1})])])):pe("",!0),ht(v("div",null,[v("div",{class:Je(["flex flex-col text-zinc-300 transition-colors absolute w-full h-full top-0 left-0 z-30 xl:hidden",{"bg-black/50":a.state.ui}])},[a.state.loading?(x(),T("div",OM,[P(Za,{loading:"",class:"h-16 w-16 text-white drop-shadow"})])):(x(),T("div",{key:1,class:Je(["flex items-center gap-x-2 absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",{invisible:!a.state.ui&&!a.state.loading}])},[v("button",{onClick:L[3]||(L[3]=$=>h(a.state.currentTime-10)),class:"p-4"},[P(Ys,{path:w(Z9),name:"rewind-10",class:"h-6 w-6"},null,8,["path"])]),v("button",{onClick:L[4]||(L[4]=$=>f())},[a.state.playing?(x(),ae(Ys,{key:0,path:w(wp),class:"h-16 w-16"},null,8,["path"])):(x(),ae(Ys,{key:1,path:w(Sp),class:"h-16 w-16"},null,8,["path"]))]),v("button",{onClick:L[5]||(L[5]=$=>h(a.state.currentTime+10)),class:"p-4"},[P(Ys,{path:w(W9),class:"h-6 w-6"},null,8,["path"])])],2)),v("div",{class:Je(["row-span-1 flex justify-end transition-transform",a.state.ui?"":["-translate-y-16"]])},[v("button",{onClick:L[6]||(L[6]=$=>a.state.settings=!0),class:"p-2"},[P(Ys,{path:w(K9),class:"w-6 h-6"},null,8,["path"])])],2),v("div",{class:"flex-grow flex",onClick:L[7]||(L[7]=$=>a.state.ui=!a.state.ui)}),v("div",{class:Je(["p-2 flex items-center text-sm gap-x-2 transition-transform",a.state.ui?"":["translate-y-16"]])},[v("div",{class:Je(["w-12 flex items-center justify-start ml-2",{"w-14":a.state.duration>=3600}])},[v("span",MM,Z(w(Cr)(a.state.currentTime)),1)],2),v("div",$M,[P(L1,{class:"w-full flex-1 mx-4 ml-1",max:a.state.duration,value:a.state.currentTime,actions:a.actions,onSeek:L[8]||(L[8]=$=>h($))},null,8,["max","value","actions"])]),v("div",NM,[v("span",VM,Z(w(Cr)(y.value)),1),v("button",{class:"ml-2",onClick:u},[P(Ys,{path:a.state.fullscreen?w(bp):w(xp),class:"h-8 w-8"},null,8,["path"])])])],2)],2),v("div",{onMousemove:L[15]||(L[15]=$=>(a.state.ui=!0,m())),class:Je([{"cursor-none":!a.state.ui},"flex-col h-full text-zinc-300 transition-colors absolute w-full top-0 left-0 z-30 hidden xl:flex"])},[a.state.loading?(x(),T("div",BM,[P(Za,{loading:"",class:"h-16 w-16"})])):pe("",!0),v("div",{class:"flex-grow flex",onDblclick:u,onClick:L[9]||(L[9]=$=>f(!1))},null,32),v("div",{class:Je(["px-3 py-2 text-sm transition-transform bg-gradient-to-t from-black/80 to-transparent",a.state.ui?"":["translate-y-20"]])},[P(L1,{class:"w-full",max:a.state.duration,value:a.state.currentTime,actions:a.actions,onSeek:L[10]||(L[10]=$=>h($))},null,8,["max","value","actions"]),v("div",UM,[v("div",{class:Je(["w-12 flex items-center gap-x-3 justify-start",{"w-14":a.state.duration>=3600}])},[v("button",{onClick:L[11]||(L[11]=$=>f(!1)),class:"hover:text-white"},[P(Ys,{path:a.state.playing?w(wp):w(Sp),class:"h-7 w-7"},null,8,["path"])]),v("div",HM,[v("span",GM,Z(w(Cr)(a.state.currentTime)),1),W(" / "),v("span",null,Z(w(Cr)(y.value)),1)]),v("div",zM,[v("button",{class:"hover:!text-white",onClick:L[12]||(L[12]=$=>_(a.state.volume>0?0:1))},[P(Ys,{path:a.state.volume>0?w(X9):w(Q9),class:"w-6 h-6"},null,8,["path"])]),P(_M,{class:"h-1 w-20",modelValue:a.state.volume,"onUpdate:modelValue":L[13]||(L[13]=$=>a.state.volume=$)},null,8,["modelValue"])])],2),v("div",jM,[a.state.source?(x(),T("button",{key:0,ref:"qualityChooser",onClick:L[14]||(L[14]=$=>a.state.settings=!0),class:"hover:!text-white flex items-center"},[v("span",qM,Z((M=a.state.source)==null?void 0:M.quality)+"p ",1),P(Ys,{path:w(Y9),class:"w-6 h-6 ml-1"},null,8,["path"])],512)):pe("",!0),v("button",{class:"hover:!text-white",onClick:u},[P(Ys,{path:a.state.fullscreen?w(bp):w(xp),class:"h-8 w-8"},null,8,["path"])])])])],2)],34)],512),[[Kt,a.state.state===0]]),(x(),ae(vn(w(o)?$n:on),{modelValue:a.state.settings,"onUpdate:modelValue":L[16]||(L[16]=$=>a.state.settings=$),target:D.$refs.qualityChooser,teleport:!1,placement:"top-end",offset:8,class:"w-40"},{default:z(()=>[(x(!0),T(_e,null,st(a.sources,$=>(x(),ae(Xe,{class:"text-center",active:a.state.source&&a.state.source.quality===$.quality,onClick:H=>(p($,!0),a.state.settings=!1)},{default:z(()=>[W(Z($.quality)+"p ",1)]),_:2},1032,["active","onClick"]))),256))]),_:1},8,["modelValue","target"])),KM],512),v("div",WM,[!w(t).devices.length&&w(o)?(x(),T("div",YM,[v("a",{href:"https://www.thehandy.com/?ref=faptap&utm_source=faptap&utm_medium=affiliate&utm_campaign=The+Handy+Affiliate+program&tap_s=3539267-2a196b&tm_subid1=player",target:"_blank","data-ph-capture-attribute-invideo-handy-ad":"1",onClick:L[17]||(L[17]=()=>{a.state.playing&&f()}),class:"leading-normal flex gap-2 w-full h-full"},[v("div",ZM,[P(k1,{position:I.value,class:"w-full h-full object-contain"},null,8,["position"])]),v("div",XM,[QM,P(Me,{class:"w-full",theme:"green"},{default:z(()=>[W("Buy Now")]),_:1})])])])):pe("",!0)])])}}}),e$=async s=>{const e=await qe.videos.getScript(s.script.url),t={metadata:{title:s.name,description:s.description,performers:s.performers?s.performers.map(i=>i.name):[],video_url:s.stream_url,tags:s.tags?s.tags.map(i=>i.name):[],duration:s.duration*1e3,average_speed:s.script.average_speed,creator:s.user.username},actions:e.map(i=>({at:i[0],pos:i[1]}))},n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(JSON.stringify(t))),n.setAttribute("download",`${s.name}.funscript`),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)},t$=["src","type","quality"],k_=De({__name:"VRPlayer",props:{video:{}},setup(s){const e=or(),t=s,n=ue([]);let i=[],r={},o=!1;Xt(async()=>{var g;const p=await qe.videos.getSources(t.video.id);n.value=p.map(m=>({url:m.url.startsWith("http")?m.url:`/api/${m.url}`,type:m.format==="mp4"?"video/mp4":"application/x-mpegurl",quality:m.quality+"p"}));try{i=await qe.videos.getScript(t.video.script.url)}catch(m){console.log(m);return}(g=document.querySelector("dl8-advertisement"))==null||g.setAttribute("on-request-advertisement","onRequestAdvertisement"),window.onRequestAdvertisement=h,await a(),await new Promise(m=>setTimeout(m,100)),r=document.querySelector("dl8-video"),r.addEventListener("play",()=>{o=!0,e.handy.play(Math.floor(r.currentTime*1e3))}),r.addEventListener("seeked",()=>{e.handy.play(Math.floor(r.currentTime*1e3))}),r.addEventListener("pause",()=>{o=!1,c()}),await qe.videos.viewVideo(t.video.id),await l()}),Yl(()=>{r.pause(),c()});const a=()=>{new Promise((p,g)=>{if("__dl8__iframe"in window){p(null);return}const m=document.createElement("script");m.src="/vr.js",m.onload=p,m.onerror=g,document.head.appendChild(m)})},l=async()=>{try{await e.handy.prepare(gi(t.video.script.url));try{r.pause(),r.play().then()}catch{}}catch(p){console.log(p)}};dt(()=>e.handy.connected,async p=>{!p||await l()});const c=()=>{e.devices.forEach(p=>{switch(p.connector){case Cs.Handy:e.handy.stop();break;case Cs.Intiface:p.instance.stop();break;case Cs.Bluetooth:p.instance.stop();break}})},u=()=>{if(!o){requestAnimationFrame(u);return}const p=r.currentTime*1e3;let g=-1;for(let S=0;S<i.length;S++)if(i[S][0]>=p){g=S;break}if(g===-1||g===d){requestAnimationFrame(u);return}const m=i[g],_=i[g-1];d=g;const y=m[0]-p;console.log(`[Player] pos=${m[1]} in=${y.toFixed(0)}ms`),e.devices.forEach(S=>{switch(S.connector){case Cs.OSR:e.osr.move(m[1],y);break;case Cs.LOOB:e.loob.move(m[1],y);break;case Cs.Handy:break;default:try{if(S.instance.messageAttributes(2)&&S.instance.linear(e.bluetooth.limit(m[1])/100,y),S.instance.messageAttributes(0)){clearInterval(f);const C=125,E=Math.floor(y/C);let A=0;f=setInterval(()=>{A++;const R=A/E;if(R>=1){clearInterval(f),S.instance.vibrate(e.bluetooth.limit(100-m[1])/100);return}let I=m[1]+(_[1]-m[1])*R;I=Math.max(0,Math.min(100,I)),S.instance.vibrate(e.bluetooth.limit(100-I)/100)},C)}S.instance.messageAttributes(1)&&S.instance.rotate(e.bluetooth.limit(100-m[1])/100,_[1]>m[1])}catch(C){console.log(C)}}}),requestAnimationFrame(u)};let d=-1,f=-1;requestAnimationFrame(u);const h=(p,g,m)=>{switch(p.spot){case"DESKTOP_PAUSE_CENTRE_RECTANGLE_300X250":case"MOBILE_PAUSE_CENTRE_RECTANGLE_300X250":return m({type:"image",payload:{uri:"/affiliates/vr/slr.1.png",adLink:"https://www.sexlikereal.com/?a=63e4b20bb7a0b71d6e675d47"}});case"VR_HUD_BOTTOM_BANNER_468X60":return m({type:"image",payload:{uri:"/affiliates/vr/slr.2.png",adLink:"https://www.sexlikereal.com/?a=63e4b20bb7a0b71d6e675d47"}})}return m(null)};return(p,g)=>{const m=Es("dl8-advertisement"),_=Es("dl8-video");return x(),T("div",null,[P(_,{poster:w(gi)(p.video.thumbnail_url),title:t.video.name,author:t.video.user.username,format:"STEREO_FISHEYE_200_LR",height:"100%",width:"100%"},{default:z(()=>[(x(!0),T(_e,null,st(n.value,y=>(x(),T("source",{src:y.url,type:y.type,quality:y.quality},null,8,t$))),256)),P(m)]),_:1},8,["poster","title","author"])])}}});const s$=["href","data-ph-capture-attribute-product"],n$={class:"aspect-square overflow-hidden bg-[#F6F5F3] shrink-0"},i$=["src"],r$={key:0,class:"p-2.5"},o$={class:"line-clamp-2 h-12 text-zinc-200"},a$={class:"text-sm text-zinc-400"},l$={class:"font-bold text-blue-500 text-base"},c$={class:"flex justify-between items-end mt-1.5"},u$={class:"text-4xl lg:text-3xl font-bold text-blue-500"},d$={class:"text-lg font-medium text-red-400 line-through"},f$={key:1,class:"p-2.5"},h$={class:"line-clamp-2 h-12 text-zinc-200"},p$={class:"text-sm text-zinc-400"},g$={class:"font-bold text-blue-500 text-base"},m$=v("b",{class:"font-bold text-blue-500"},"FAPTAP",-1),v$={class:"flex justify-between items-end mt-1.5"},_$={class:"text-4xl lg:text-3xl font-bold text-blue-500"},y$={class:"text-lg font-medium text-red-400 line-through"},L_=De({__name:"ProductScroller",props:{products:{},vertical:{type:Boolean},subId:{}},setup(s){const e=s;or();const t=ut(()=>{let i=e.products.filter(o=>o.category!=="bundles");return[...e.products.filter(o=>o.category==="bundles"),...i]}),n=i=>{const r=i.discount_original_price?i.discount_original_price:i.price,o=i.price-i.price*.1;return Math.round((r-o)/r*100)};return(i,r)=>(x(),ae(Si,{gap:"gap-4"},{default:z(()=>[(x(!0),T(_e,null,st(t.value,o=>(x(),T("a",{class:Je(["bg-zinc-800 rounded-lg overflow-hidden group h-full flex",i.vertical?["flex-row","!h-32","w-80"]:["flex-col","w-52"]]),href:`${o.url}?ref=faptap&utm_source=faptap&utm_medium=affiliate&utm_campaign=The+Handy+Affiliate+program&tap_s=3539267-2a196b&tm_subid1=${i.subId}`,"data-ph-capture-attribute-product":o.name,target:"_blank"},[v("div",n$,[v("img",{src:o.image,class:"object-cover w-full h-full group-hover:scale-105 transition-transform"},null,8,i$)]),o.discount_original_price?(x(),T("div",r$,[v("p",o$,Z(o.name),1),v("div",a$,[W("Get "),v("b",l$,Z(((1-o.price/o.discount_original_price)*100).toFixed(0))+"% OFF",1)]),v("div",c$,[v("p",u$,Z(Intl.NumberFormat("en-US",{style:"currency",currency:o.currency,minimumFractionDigits:0,maximumFractionDigits:0}).format(o.price)),1),v("p",d$,Z(Intl.NumberFormat("en-US",{style:"currency",currency:o.currency,minimumFractionDigits:0,maximumFractionDigits:0}).format(o.discount_original_price?o.discount_original_price:o.price)),1)])])):(x(),T("div",f$,[v("p",h$,Z(o.name),1),v("div",p$,[v("b",g$,Z(n(o))+"% OFF",1),W(" - Code "),m$]),v("div",v$,[v("p",_$,Z(Intl.NumberFormat("en-US",{style:"currency",currency:o.currency,minimumFractionDigits:0,maximumFractionDigits:0}).format(o.price-o.price*.1)),1),v("p",y$,Z(Intl.NumberFormat("en-US",{style:"currency",currency:o.currency,minimumFractionDigits:0,maximumFractionDigits:0}).format(o.discount_original_price?o.discount_original_price:o.price)),1)])]))],10,s$))),256))]),_:1}))}}),x$={key:0,class:"text-white text-center mt-4 mb-2"},b$=["href"],w$=v("p",null,[v("span",null,[W("Continue watching the complete video in better quality on "),v("b",null,"SexLikeReal")])],-1),S$={key:1,target:"_blank",rel:"nofollow",href:"https://www.sexlikereal.com/tags/interactive-sex-toys-vr?a=63e4b20bb7a0b71d6e675d47",class:"bg-blue-900/50 cursor-pointer p-2.5 lg:rounded-md block lg:flex gap-3 items-center justify-between lg:mt-2.5"},E$=v("p",null,[v("span",null,[W("Watch this video in better quality and many more on "),v("b",null,"SexLikeReal")])],-1),T$={class:"flex items-center gap-x-3 flex-col lg:flex-row"},C$=v("span",null,[W("Use Code "),v("b",null,"FAPTAP"),W(" for "),v("b",null,"57% OFF")],-1),A$={key:4,"data-ph-capture-attribute-adulttime-banner":"1",target:"_blank",rel:"nofollow",href:"https://www.g2fame.com/adulttime/go.php?pr=8&su=1&si=247&ad=280096&cl=/toys&ar=&campaign=457485&buffer=",class:"bg-blue-700/50 cursor-pointer p-2.5 lg:rounded-md block lg:flex gap-3 items-center justify-between lg:mt-2.5"},k$=v("p",null,[v("span",null,[W("Watch this video in better quality and 1000+ others on "),v("b",null,"AdultTime")])],-1),L$={class:"text-white flex flex-col gap-y-2 mt-3 px-2 md:px-0"},R$=["title"],I$={class:"font-medium flex justify-between text-sm -mt-2 text-zinc-400"},D$=["title"],P$={class:"flex items-center gap-1"},F$=["title"],O$={class:"flex flex-col-reverse lg:flex-row lg:items-center justify-between gap-y-2"},M$={class:"flex items-center gap-x-8 justify-between"},$$={class:"flex flex-col"},N$={class:"text-sm text-white font-medium"},V$={class:"text-xs text-zinc-500"},B$={class:"flex gap-1.5"},U$=v("span",{class:"hidden lg:!block"},"Support",-1),H$=v("span",{class:"text-white font-semibold"},"Edit",-1),G$=v("span",null,"Comments",-1),z$=v("span",null,"Script",-1),j$=v("span",null,"Source",-1),q$={name:"watch",components:{VRPlayer:k_,ProductScroller:L_}},K$=De({...q$,async setup(s){let e,t;const{isAuthorized:n,user:i,isAdmin:r}=vs(),o=Xi(),{isMobile:a}=Ai();Gt(or());const{authDialog:l}=Gt(jn()),c=([e,t]=js(()=>qe.videos.getVideo(o.params.id)),e=await e,t(),e),u=ue(!1),d=ue(o.query.comments==="true"||a);let f;try{f=([e,t]=js(()=>qe.products.getProducts()),e=await e,t(),e)}catch(p){console.log(p)}const h=p=>{window.location.reload()};return Xt(()=>{window.scroll({top:0})}),Ds(`${c.name} | FapTap`),(p,g)=>{const m=Es("router-link");return x(),T(_e,null,[w(n)?pe("",!0):(x(),T("div",x$,[v("p",null,[v("span",{onClick:g[0]||(g[0]=_=>l.value=!0),class:"text-blue-500 cursor-pointer"},"Sign up / Log in"),W(" to remove ads and request scripts.")])])),w(c).vr?(x(),ae(k_,{key:1,video:w(c),class:"aspect-video bg-black overflow-hidden -mt-2 lg:mt-0 lg:max-h-[60vh] w-full lg:rounded-md"},null,8,["video"])):(x(),ae(JM,{key:2,video:w(c),class:"aspect-video -mt-2 lg:mt-0 lg:max-h-[60vh] w-full lg:rounded-md"},null,8,["video"])),w(c).stream_url.startsWith("https://www.sexlikereal.com/scenes/")?(x(),T(_e,{key:3},[w(c).user.username.toLowerCase()==="realcumber"?(x(),T("a",{key:0,target:"_blank",rel:"nofollow",href:w(c).stream_url,class:"bg-blue-900/50 cursor-pointer p-2.5 lg:rounded-md block lg:flex gap-3 items-center justify-between lg:mt-2.5"},[w$,P(Me,{theme:"blue",class:"w-full mt-3 lg:w-auto lg:mt-0"},{default:z(()=>[W("Watch Now")]),_:1})],8,b$)):(x(),T("a",S$,[E$,v("span",T$,[C$,P(Me,{theme:"blue",class:"w-full mt-3 lg:w-auto lg:mt-0"},{default:z(()=>[W("Watch Now")]),_:1})])]))],64)):pe("",!0),w(c).stream_url.startsWith("https://members.adulttime")?(x(),T("a",A$,[k$,P(Me,{theme:"blue",class:"w-full mt-3 lg:w-auto lg:mt-0"},{default:z(()=>[W("Watch Now")]),_:1})])):pe("",!0),v("div",L$,[v("h1",{title:w(c).name,class:"font-medium text-xl lg:text-2xl leading-none"},Z(w(c).name),9,R$),v("div",I$,[v("span",{title:w(c).views.toString()},Z(w(_i)(w(c).views))+" views \u2022 "+Z(w(lv)(new Date(w(c).created_at)))+" ago ",9,D$),v("span",P$,[W(Z(w(c).script.average_speed)+" ",1),P(Re,{name:"speedometer",class:"h-4 w-4"}),W(" \u2022 "),v("span",{title:w(c).script.total_actions.toString()},Z(w(_i)(w(c).script.total_actions))+" actions",9,F$)])]),v("div",O$,[v("div",M$,[P(m,{to:`/u/${w(c).user.username}`,class:"flex gap-x-3 items-center"},{default:z(()=>[P(ki,{image:w(c).user.avatar_url,icon:"account",class:"h-9 w-9"},null,8,["image"]),v("div",$$,[v("span",N$,Z(w(c).user.username),1),v("span",V$,Z(w(c).user.subscribers)+" subscribers",1)])]),_:1},8,["to"]),v("div",B$,[w(c).user.profile.support_url&&w(c).user.profile.support_url.length?(x(),ae(Me,{key:0,href:w(c).user.profile.support_url,class:"lg:w-28",theme:"green"},{default:z(()=>[P(Re,{name:"currency",class:"h-5 w-5 lg:hidden"}),U$]),_:1},8,["href"])):pe("",!0),P(Lf,{user:w(c).user,class:"w-28"},null,8,["user"])])]),P(Si,{gap:"gap-2",class:"-mx-2 lg:mx-0"},{default:z(()=>{var _,y,S,C;return[P(_v,{"thing-type":w(hl).Video,"thing-id":(_=w(c))==null?void 0:_.id,likes:(y=w(c))==null?void 0:y.rating.likes,liked:(S=w(c))==null?void 0:S.rating.liked},null,8,["thing-type","thing-id","likes","liked"]),w(n)&&(((C=w(i))==null?void 0:C.id)===w(c).user.id||w(r))?(x(),ae(Me,{key:0,onClick:g[1]||(g[1]=E=>u.value=!0),class:"flex items-center justify-center gap-x-2"},{default:z(()=>[P(Re,{name:"pencil",class:"h-5 w-5"}),H$]),_:1})):pe("",!0),P(Me,{onClick:g[2]||(g[2]=E=>d.value=!d.value),class:"items-center justify-center gap-x-2 !px-3 hidden md:flex"},{default:z(()=>[P(Re,{name:"comments",class:"h-5 w-5"}),G$]),_:1}),w(c).downloadable?(x(),ae(Me,{key:1,onClick:g[3]||(g[3]=E=>w(n)?w(e$)(w(c)):l.value=!0),class:"flex items-center justify-center gap-x-2 !px-3"},{default:z(()=>[P(Re,{name:"download",class:"h-5 w-5"}),z$]),_:1})):pe("",!0),w(c).stream_url&&!w(c).stream_url.startsWith("https://members.adulttime")?(x(),ae(Me,{key:2,href:w(c).stream_url,class:"flex items-center justify-center gap-x-2 !px-3"},{default:z(()=>[P(Re,{name:"link",class:"h-5 w-5"}),j$]),_:1},8,["href"])):pe("",!0)]}),_:1})]),w(c).description?(x(),ae(vv,{key:0,class:"text-sm mt-3",height:80,text:w(c).description},null,8,["text"])):pe("",!0),w(c).performers&&w(c).performers.length>0||w(c).tags&&w(c).tags.length>0?(x(),ae(Si,{key:1,gap:"gap-1.5",class:"-mx-2 lg:mx-0"},{default:z(()=>[(x(!0),T(_e,null,st(w(c).performers,_=>(x(),ae(Me,{to:`/p/${_.slug}`},{default:z(()=>[v("span",null,Z(_.name),1)]),_:2},1032,["to"]))),256)),(x(!0),T(_e,null,st(w(c).tags,_=>(x(),ae(Me,{to:`/t/${_.slug}`},{default:z(()=>[W(Z(_.name),1)]),_:2},1032,["to"]))),256))]),_:1})):pe("",!0)]),P(L_,{vertical:"",class:"my-4",subId:"products-video",products:w(f)},null,8,["products"]),d.value?(x(),ae(p9,{key:5,"thing-id":w(c).id,"thing-type":w(hl).Video,class:"my-3 max-w-3xl text-white"},null,8,["thing-id","thing-type"])):pe("",!0),w(c)?(x(),ae(ar,{key:6,video:w(c).id,filters:!1},null,8,["video"])):pe("",!0),P(oc,{modelValue:u.value,"onUpdate:modelValue":g[4]||(g[4]=_=>u.value=_),title:"Edit Video"},{default:z(()=>[P(j9,{video:w(c),onSubmitVideo:h},null,8,["video"])]),_:1},8,["modelValue"])],64)}}}),W$=()=>ta(()=>import("./Studio.1a941abe.js"),[]),Y$=()=>ta(()=>import("./Videos.cc3bf1ab.js"),[]),Z$=()=>ta(()=>import("./CreateVideo.a6ba1096.js"),[]),X$=()=>ta(()=>import("./EditVideo.de245151.js"),[]),Q$=[{path:"/",name:"home",component:sI},{path:"/feed",name:"feed",component:G7},{path:"/videos",name:"videos",component:Q7},{path:"/likes",name:"likes",component:j7},{path:"/preferences",name:"preferences",component:b7},{path:"/u/:username",name:"user",component:e7},{path:"/p/:slug",name:"performer",component:c7},{path:"/t/:slug*",name:"tag",component:D7},{path:"/creators",name:"creators",component:m7},{path:"/v/:id",name:"watch",alias:"/watch/:id",component:K$},{path:"/tags",name:"tags",component:A7},{path:"/performers",name:"performers",component:Z7},{path:"/studio",name:"studio",component:W$},{path:"/studio/videos",name:"studio-videos",component:Y$},{path:"/studio/videos/create",name:"create-video",component:Z$},{path:"/studio/videos/:id",name:"edit-video",component:X$},{path:"/admin",name:"admin",component:()=>ta(()=>import("./Admin.bdcaa5ac.js"),[])},{path:"/:pathMatch(.*)*",name:"NotFound",redirect:"/"}],R_=gb({history:Ix(),routes:Q$,scrollBehavior(s,e,t){return t||{top:0}}});R_.afterEach(s=>{so(()=>{Qo.capture("$pageview",{$current_url:s.fullPath})})});var dn=(s=>(s.LOADING="loading",s.LOADED="loaded",s.ERROR="error",s))(dn||{});const J$=typeof window<"u"&&window!==null,eN=iN(),tN=Object.prototype.propertyIsEnumerable,R1=Object.getOwnPropertySymbols;function Ro(s){return typeof s=="function"||toString.call(s)==="[object Object]"}function sN(s){return typeof s=="object"?s===null:typeof s!="function"}function nN(s){return s!=="__proto__"&&s!=="constructor"&&s!=="prototype"}function iN(){return J$&&"IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype?("isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get(){return this.intersectionRatio>0}}),!0):!1}function rN(s,...e){if(!Ro(s))throw new TypeError("expected the first argument to be an object");if(e.length===0||typeof Symbol!="function"||typeof R1!="function")return s;for(const t of e){const n=R1(t);for(const i of n)tN.call(t,i)&&(s[i]=t[i])}return s}function I_(s,...e){let t=0;for(sN(s)&&(s=e[t++]),s||(s={});t<e.length;t++)if(Ro(e[t])){for(const n of Object.keys(e[t]))nN(n)&&(Ro(s[n])&&Ro(e[t][n])?I_(s[n],e[t][n]):s[n]=e[t][n]);rN(s,e[t])}return s}const I1="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",oN="",aN={rootMargin:"0px",threshold:0},_r="data-lazy-timeout-id";class lN{constructor(e){this.options={loading:I1,error:oN,observerOptions:aN,log:!0,lifecycle:{},logLevel:"error"},this._images=new WeakMap,this.config(e)}config(e={}){I_(this.options,e)}mount(e,t){if(!e)return;const{src:n,loading:i,error:r,lifecycle:o,delay:a}=this._valueFormatter(typeof t=="string"?t:t.value);this._lifecycle(dn.LOADING,o,e),e.setAttribute("src",i||I1),eN||(this.loadImages(e,n,r,o),this._log(()=>{this._logger("Not support IntersectionObserver!")})),this._initIntersectionObserver(e,n,r,o,a)}update(e,t){var a;if(!e)return;(a=this._realObserver(e))==null||a.unobserve(e);const{src:n,error:i,lifecycle:r,delay:o}=this._valueFormatter(typeof t=="string"?t:t.value);this._initIntersectionObserver(e,n,i,r,o)}unmount(e){var t;!e||((t=this._realObserver(e))==null||t.unobserve(e),this._images.delete(e))}loadImages(e,t,n,i){this._setImageSrc(e,t,n,i)}_setImageSrc(e,t,n,i){e.tagName.toLowerCase()==="img"?(t&&e.getAttribute("src")!==t&&e.setAttribute("src",t),this._listenImageStatus(e,()=>{this._lifecycle(dn.LOADED,i,e)},()=>{var r;e.onload=null,this._lifecycle(dn.ERROR,i,e),(r=this._realObserver(e))==null||r.disconnect(),n&&e.getAttribute("src")!==n&&e.setAttribute("src",n),this._log(()=>{this._logger(`Image failed to load!And failed src was: ${t} `)})})):e.style.backgroundImage=`url('${t}')`}_initIntersectionObserver(e,t,n,i,r){var a;const o=this.options.observerOptions;this._images.set(e,new IntersectionObserver(l=>{Array.prototype.forEach.call(l,c=>{r&&r>0?this._delayedIntersectionCallback(e,c,r,t,n,i):this._intersectionCallback(e,c,t,n,i)})},o)),(a=this._realObserver(e))==null||a.observe(e)}_intersectionCallback(e,t,n,i,r){var o;t.isIntersecting&&((o=this._realObserver(e))==null||o.unobserve(t.target),this._setImageSrc(e,n,i,r))}_delayedIntersectionCallback(e,t,n,i,r,o){if(t.isIntersecting){if(t.target.hasAttribute(_r))return;const a=setTimeout(()=>{this._intersectionCallback(e,t,i,r,o),t.target.removeAttribute(_r)},n);t.target.setAttribute(_r,String(a))}else t.target.hasAttribute(_r)&&(clearTimeout(Number(t.target.getAttribute(_r))),t.target.removeAttribute(_r))}_listenImageStatus(e,t,n){e.onload=t,e.onerror=n}_valueFormatter(e){let t=e,n=this.options.loading,i=this.options.error,r=this.options.lifecycle,o=this.options.delay;return Ro(e)&&(t=e.src,n=e.loading||this.options.loading,i=e.error||this.options.error,r=e.lifecycle||this.options.lifecycle,o=e.delay||this.options.delay),{src:t,loading:n,error:i,lifecycle:r,delay:o}}_log(e){this.options.log&&e()}_lifecycle(e,t,n){switch(e){case dn.LOADING:n==null||n.setAttribute("lazy",dn.LOADING),t!=null&&t.loading&&t.loading(n);break;case dn.LOADED:n==null||n.setAttribute("lazy",dn.LOADED),t!=null&&t.loaded&&t.loaded(n);break;case dn.ERROR:n==null||n.setAttribute("lazy",dn.ERROR),t!=null&&t.error&&t.error(n);break}}_realObserver(e){return this._images.get(e)}_logger(e,...t){let n=console.error;switch(this.options.logLevel){case"error":n=console.error;break;case"warn":n=console.warn;break;case"info":n=console.info;break;case"debug":n=console.debug;break}n(e,t)}}const cN={install(s,e){const t=new lN(e);s.config.globalProperties.$Lazyload=t,s.provide("Lazyload",t),s.directive("lazy",{mounted:t.mount.bind(t),updated:t.update.bind(t),unmounted:t.unmount.bind(t)})}},uN="phc_zc1EuYtTWZKEHv1aWddyphRW0SirWKSViC3KNZ46Rp0";Qo.init(uN,{api_host:"https://app.posthog.com"});const D1=dx(C6).use(cN,{}).use(gk());qe.user.getSession().then(s=>s&&vs().setUser(s)).finally(async()=>{D1.use(R_),or().handy.connect(),D1.mount("#app")});export{pe as A,kn as B,Ps as C,Me as D,oc as E,_e as F,j9 as G,hs as H,on as I,yp as J,Bh as K,Nh as L,Kt as M,Is as N,Xi as O,wa as P,Re as _,Ds as a,ql as b,T as c,De as d,v as e,w as f,st as g,W as h,Yo as i,qe as j,x as k,ae as l,z as m,ht as n,Xt as o,gi as p,lv as q,Es as r,Gt as s,Z as t,vs as u,ue as v,js as w,Ci as x,nr as y,P as z};
